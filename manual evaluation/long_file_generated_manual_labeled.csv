,repo,file path,code,data division,paragraphs,call relations,LOC,summary,Linked Programs,Called Programs,File Calls,granite 34b,business,functionality,completeness,refined summary2,functoinality
4,bmcsoftware_vscode-ispw,X-COBOL/X-COBOL/COBOL_Files/bmcsoftware_vscode-ispw/IB4OP01.cbl,,"       FILE SECTION.                                                            
       FD  TRANS-FILE RECORDING MODE F BLOCK 0 RECORDS.                         
       01  TRAN-INQY.
           03  TI-TRAN             PIC XX.
           03  TI-ORDR-NO          PIC X(6).
           03  FILLER              PIC X(72).
       01  TRAN-ORD-BASE.
           03  FILLER              PIC X(8).
           03  TB-CUST-NO          PIC X(6).
           03  TB-DESCR            PIC X(40).
           03  TB-PO-QTY           PIC 9(5).
           03  TB-PO-QTY-X REDEFINES TB-PO-QTY PIC X(5).
           03  TB-PO-AMT           PIC 9(5)V99.
           03  TB-PO-AMT-X REDEFINES TB-PO-AMT PIC X(7).
           03  TB-ORDR-TYPE        PIC XX.
           03  TB-PRTY             PIC X.
           03  FILLER              PIC X(11).
       01  TRAN-ACTIVITY.
           03  FILLER              PIC X(8).
           03  TA-ORD-STATUS       PIC 99.
           03  TA-ACT-DATE         PIC X(8).
           03  TA-LAST-ACT-DATE    PIC X(8).
           03  TA-UNITS-STARTED    PIC 9(5).
           03  TA-UNITS-STARTED-X REDEFINES TA-UNITS-STARTED PIC X(5).
           03  TA-UNITS-COMPL      PIC 9(5).
           03  TA-UNITS-COMPL-X REDEFINES TA-UNITS-COMPL PIC X(5).
           03  FILLER              PIC X(44).
       FD  RPT-FILE RECORDING MODE F BLOCK 0 RECORDS.                           
       01  RPT-REC.                                                             
           03  R-CC               PIC X.                                        
           03  FILLER             PIC X(132).                                   
       FD  ERR-FILE RECORDING MODE F BLOCK 0 RECORDS.                           
       01  ERR-REC.                                                             
           03  E-CC               PIC X.                                        
           03  E-TRAN-ID          PIC X(12).                                    
           03  FILLER             PIC XX.                                       
           03  E-MESSAGE          PIC X(100).                                   
           03  FILLER             PIC X(18).                                    
       WORKING-STORAGE SECTION.                                                 
       77  MAX-LINES           PIC S9999 COMP VALUE +55.                        
       77  CUR-LINE-CNT        PIC S9999 COMP VALUE +256.                       
       77  ERR-LINE-CNT        PIC S9999 COMP VALUE +256.                       
       77  ADV-LINES           PIC S9999 COMP VALUE +1.                         
       77  LOGICAL-LINE        PIC S9999 COMP VALUE +1.                         
       77  FS-TRANS            PIC 99.                                          
       77  FS-RPT              PIC 99.                                          
       77  FS-ERR              PIC 99.                                          
       77  TRANS-EOF           PIC X VALUE ' '.                                 
           88  TRANS-PRESENT     VALUE ' '.                                     
           88  NO-MORE-TRANS     VALUE 'Y'.                                     
       77  TRANS-STATUS        PIC X.                                           
           88  VALID-INCOMPL     VALUE ' '.                                     
           88  VALID-TRANS       VALUE 'V'.                                     
           88  TRAN-WARN         VALUE 'W'.                                     
           88  TRAN-ERR          VALUE 'E'.                                     
       77  ACTION              PIC XXXX.                                        
       01  PRT-DTL.                                                             
           03  P-CC            PIC X.                                           
           03  P-TRANS         PIC X(5).                                        
           03  FILLER          PIC X.                                           
           03  P-ORD-NUM       PIC X(6).                                        
           03  FILLER          PIC X.                                           
           03  P-ACT           PIC X(10).                                       
           03  FILLER          PIC X.                                           
           03  P-F1-DTL.                                                        
               05 P-CUST-NO    PIC X(6).                                        
               05 FILLER       PIC X.                                           
               05 P-DESCR      PIC X(40).                                       
               05 FILLER       PIC X.                                           
               05 P-ORD-QTY    PIC ZZ,ZZ9.                                      
               05 P-ORD-QTY-X  REDEFINES P-ORD-QTY PIC X(6).                    
               05 FILLER       PIC X.                                           
               05 P-ORD-AMT    PIC ZZ,ZZ9.99-.                                  
               05 P-ORD-AMT-X  REDEFINES P-ORD-AMT PIC X(10).                   
               05 FILLER       PIC X.                                           
               05 P-TYPE       PIC XX.                                          
               05 FILLER       PIC X.                                           
               05 P-ORD-STAT   PIC 99.                                          
               05 P-ORD-STAT-X REDEFINES P-ORD-STAT PIC XX.                     
               05 FILLER       PIC X.                                           
               05 P-PRTY-CD    PIC X.                                           
               05 FILLER       PIC X.                                           
               05 P-ACT-ORD-QTY PIC ZZ,ZZ9.                                     
               05 P-ACT-ORD-QTY-X REDEFINES P-ACT-ORD-QTY PIC X(6).             
               05 FILLER       PIC X.                                           
               05 P-TOT-SCRAP  PIC ZZ,ZZ9.                                      
               05 P-TOT-SCRAP-X REDEFINES P-TOT-SCRAP PIC X(6).                 
               05 FILLER       PIC X(21).                                       
           03  P-F2-DTL REDEFINES P-F1-DTL.                                     
               05 FILLER       PIC X(7).                                        
               05 P-STRT-CAPT  PIC X(8).                                        
               05 P-UNIT-STRT  PIC ZZ,ZZ9.                                      
               05 P-UNIT-STRT-X REDEFINES P-UNIT-STRT PIC X(6).                 
               05 FILLER       PIC X.                                           
               05 P-PCT-STRT   PIC ZZ,ZZ9.999-.                                 
               05 P-PCT-STRT-X REDEFINES P-PCT-STRT PIC X(11).                  
               05 P-PCT-CAPT   PIC XX.                                          
               05 P-COMP-CAPT  PIC X(8).                                        
               05 P-UNIT-COMP  PIC ZZ,ZZ9.                                      
               05 P-UNIT-COMP-X REDEFINES P-UNIT-COMP PIC X(6).                 
               05 FILLER       PIC X.                                           
               05 P-PCT-COMP   PIC ZZ,ZZ9.999-.                                 
               05 P-PCT-COMP-X REDEFINES P-PCT-COMP PIC X(11).                  
               05 P-PCT-CAPT2  PIC X.                                           
               05 FILLER       PIC X(25).                                       
               05 P-DATE       PIC X(10).                                       
               05 FILLER       PIC X.                                           
               05 P-DATE-L     PIC X(10).                                       
       01  ERR-DTL.                                                             
           03  P-CC            PIC X.                                           
           03  P-TRANS         PIC X(5).                                        
           03  FILLER          PIC X.                                           
           03  P-ORD-NUM       PIC X(6).                                        
           03  FILLER          PIC X.                                           
           03  P-ACT           PIC X(10).                                       
           03  FILLER          PIC X.                                           
           03  P-F1-DTL.                                                        
               05 P-CUST-NO    PIC X(6).                                        
               05 FILLER       PIC X.                                           
               05 P-DESCR      PIC X(40).                                       
               05 FILLER       PIC X.                                           
               05 P-ORD-QTY    PIC ZZ,ZZ9.                                      
               05 P-ORD-QTY-X  REDEFINES P-ORD-QTY PIC X(6).                    
               05 FILLER       PIC X.                                           
               05 P-ORD-AMT    PIC ZZ,ZZ9.99-.                                  
               05 P-ORD-AMT-X  REDEFINES P-ORD-AMT PIC X(10).                   
               05 FILLER       PIC X.                                           
               05 P-TYPE       PIC XX.                                          
               05 FILLER       PIC X.                                           
               05 P-ORD-STAT   PIC 99.                                          
               05 P-ORD-STAT-X REDEFINES P-ORD-STAT PIC XX.                     
               05 FILLER       PIC X.                                           
               05 P-PRTY-CD    PIC X.                                           
               05 FILLER       PIC X.                                           
               05 P-ACT-ORD-QTY PIC ZZ,ZZ9.                                     
               05 P-ACT-ORD-QTY-X REDEFINES P-ACT-ORD-QTY PIC X(6).             
               05 FILLER       PIC X.                                           
               05 P-TOT-SCRAP  PIC ZZ,ZZ9.                                      
               05 P-TOT-SCRAP-X REDEFINES P-TOT-SCRAP PIC X(6).                 
               05 FILLER       PIC X(21).                                       
           03  P-F2-DTL REDEFINES P-F1-DTL.                                     
               05 FILLER       PIC X(7).                                        
               05 P-STRT-CAPT  PIC X(8).                                        
               05 P-UNIT-STRT  PIC ZZ,ZZ9.                                      
               05 P-UNIT-STRT-X REDEFINES P-UNIT-STRT PIC X(6).                 
               05 FILLER       PIC X.                                           
               05 P-PCT-STRT   PIC ZZ,ZZ9.999-.                                 
               05 P-PCT-STRT-X REDEFINES P-PCT-STRT PIC X(11).                  
               05 P-PCT-CAPT   PIC XX.                                          
               05 P-COMP-CAPT  PIC X(8).                                        
               05 P-UNIT-COMP  PIC ZZ,ZZ9.                                      
               05 P-UNIT-COMP-X REDEFINES P-UNIT-COMP PIC X(6).                 
               05 FILLER       PIC X.                                           
               05 P-PCT-COMP   PIC ZZ,ZZ9.999-.                                 
               05 P-PCT-COMP-X REDEFINES P-PCT-COMP PIC X(11).                  
               05 P-PCT-CAPT2  PIC X.                                           
               05 FILLER       PIC X(25).                                       
               05 P-DATE       PIC X(10).                                       
               05 FILLER       PIC X.                                           
               05 P-DATE-L     PIC X(10).                                       
       01  H1.                                                                  
           03  FILLER             PIC X(45) VALUE IS                            
           '                                             '.                     
           03  FILLER             PIC X(50) VALUE IS                            
           ' ORDER PROCESSING                                 '.                
           03  FILLER             PIC X(32) VALUE IS                            
           '                                '.                                  
       01  H1-E.                                                                
           03  FILLER             PIC X(40) VALUE IS                            
           '                                        '.                          
           03  FILLER             PIC X(50) VALUE IS                            
           ' ORDER PROCESSING ERRORS                          '.                
           03  FILLER             PIC X(32) VALUE IS                            
           '                                '.                                  
       01  H2.                                                                  
           03  FILLER             PIC X(50) VALUE IS                            
           ' TRANS  ORDR    ACTION   CUST#  * -------------- '.                 
           03  FILLER             PIC X(50) VALUE IS                            
           'DESCRIPTION -------- *   QTY     AMT     TP       '.                
           03  FILLER             PIC X(32) VALUE IS                            
           '            FIRST ACT  LAST ACT '.                                  
       01  W-DATE-FMT.                                                          
           03  W-YYYY          PIC X(4).                                        
           03  FILLER          PIC X VALUE '/'.                                 
           03  W-MM            PIC XX.                                          
           03  FILLER          PIC X VALUE '/'.                                 
           03  W-DD            PIC XX.                                          
       01  W-DATE.                                                              
           03  W-YYYY          PIC XXXX.                                        
           03  W-MM            PIC XX.                                          
           03  W-DD            PIC XX.                                          
       01  SSA-1.                                                               
           03  S1-SEG-NAME     PIC X(8) VALUE IS 'ORDR010 '.                    
           03  FILLER          PIC X VALUE '('.                                 
           03  S1-FLD-NAME     PIC X(8) VALUE 'ORDRKEY '.                       
           03  S1-SC-OP        PIC XX VALUE ' ='.                               
           03  SSA-1-KEY       PIC X(6).                                        
           03  FILLER          PIC XX VALUE ') '.                               
       01  SSA-2.                                                               
           03  S2-SEG-NAME     PIC X(8) VALUE IS 'ORDR010 '.                    
           03  FILLER          PIC X VALUE ' '.                                 
       01  ORDER-ROOT-DATA.                                                     
           05 ORDER-ROOT-KEY.                                                   
               07 ORDER-NUMBER-PREFIX      PIC  X(02).                          
               07 ORDER-NUMBER             PIC  9(04).                          
           05  ORDKEY-REDEF  REDEFINES    ORDER-ROOT-KEY                        
                                           PIC  X(06).                          
           05 ORDER-DESCRIPTION            PIC  X(40).                          
           05 CUSTOMER-NUMBER              PIC  X(06).                          
           05 PLANNED-ORDER-QUANTITY       PIC  S9(05)       COMP-3.            
           05 PLANNED-ORDER-AMOUNT         PIC  9(05)V99     COMP-3.            
           05 ORDER-TYPE                   PIC  X(02).                          
           05 ACTUAL-ORDER-QUANTITY        PIC  S9(05)       COMP-3.            
           05 TOTAL-SCRAP-QUANTITY         PIC  S9(05)       COMP-3.            
           05 TOTAL-SCRAP-REDEFINES                                             
               REDEFINES TOTAL-SCRAP-QUANTITY PIC  X(03).                       
           05 ORDER-STATUS                 PIC  9(02).                          
           05 FILLER                       PIC  X(01).                          
           05 FIRST-ACTIVITY-DATE.                                              
               07 FIRST-ACTIVITY-DATE-YR   PIC  X(04).                          
               07 FIRST-ACTIVITY-DATE-MM   PIC  X(02).                          
               07 FIRST-ACTIVITY-DATE-DD   PIC  X(02).                          
           05 LAST-ACTIVITY-DATE           PIC  X(08).                          
           05 WEEKLY-STATUS-DATA OCCURS       5 TIMES.                          
               07 NUMBER-UNITS-STARTED     PIC  9(05)        COMP-3.            
               07 NUMBER-UNITS-COMPLETED   PIC  9(05)        COMP-3.            
               07 PERCENTAGE-STARTED       PIC  S9(05)V9(03) COMP-3.            
               07 PERCENTAGE-COMPLETE      PIC  S9(05)V9(03) COMP-3.            
           05 PRIORITY-CODE                PIC  X(01).                          
       LINKAGE SECTION.                                                         
       01  DBPCB.                                                               
           02  DBD-NAME        PIC  X(8).                                       
           02  SEG-LEVEL       PIC  X(2).                                       
           02  DBSTATUS        PIC  X(2).                                       
           02  PROC-OPTIONS    PIC  X(4).                                       
           02  RESERVE-DLI     PIC  X(4).                                       
           02  SEG-NAME-FB     PIC  X(8).                                       
           02  LENGTH-FB-KEY   PIC  9(4).                                       
           02  NUMB-SENS-SEGS  PIC  9(4).                                       
           02  KEY-FB-AREA     PIC  X(17).                                      
       01  IOPCB.                                                               
           02  I-DBD-NAME        PIC  X(8).                                     
           02  I-SEG-LEVEL       PIC  X(2).                                     
           02  I-DBSTATUS        PIC  X(2).                                     
           02  I-PROC-OPTIONS    PIC  X(4).                                     
           02  I-RESERVE-DLI     PIC  X(4).                                     
           02  I-SEG-NAME-FB     PIC  X(8).                                     
           02  I-LENGTH-FB-KEY   PIC  9(4).                                     
           02  I-NUMB-SENS-SEGS  PIC  9(4).                                     
           02  I-KEY-FB-AREA     PIC  X(17).                                    
","['I100-INIT', 'R010-READ', 'P100-VALIDATE', 'P300-PROCESS', 'P500-REPORT', 'P600-PRINT-TRAN', 'P700-PRINT', 'P750-PRINT', 'P800-ERR-RPT', 'P810-ERR-PRINT', 'P850-ERR-PRINT', 'P900-IMS-ERR']","Paragraph R010-READ calls paragraph P100-VALIDATE, P800-ERR-RPT, P500-REPORT, P300-PROCESS, P600-PRINT-TRAN.
Paragraph P300-PROCESS calls paragraph P900-IMS-ERR, P500-REPORT.
Paragraph P500-REPORT calls paragraph P700-PRINT, P750-PRINT.
Paragraph P600-PRINT-TRAN calls paragraph P750-PRINT.
Paragraph P700-PRINT calls paragraph P750-PRINT.
Paragraph P800-ERR-RPT calls paragraph P810-ERR-PRINT, P850-ERR-PRINT.
Paragraph P810-ERR-PRINT calls paragraph P850-ERR-PRINT.
",683,THIS PROGRAM IS A BATCH DLI TRANSACTION PROCESSING PROGRAM.,,"['CBLTDLI', 'AIBTDLI']",,Error Long,0.75,1,1,"This COBOL program initializes, reads, validates, and processes transaction data before generating reports and handling errors. It first reads from TRANS-FILE and validates the data. Valid transactions lead to order processing, report generation, and printing. Error handling routines ensure that any issues are recorded and displayed appropriately. Overall, it efficiently manages transaction data while providing detailed reports and error feedback for effective monitoring. ",
6,bmcsoftware_vscode-ispw,X-COBOL/X-COBOL/COBOL_Files/bmcsoftware_vscode-ispw/CWKTDB2X.cbl,"       IDENTIFICATION DIVISION.
       PROGRAM-ID.       CWKTDB2X.
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT EMPLOYEE-FILE ASSIGN TO EMPFILE.
           SELECT REPORT-FILE   ASSIGN TO RPTFILE.
       DATA DIVISION.
       FILE SECTION.
       FD  EMPLOYEE-FILE
           LABEL RECORDS ARE STANDARD
           BLOCK CONTAINS 0 RECORDS
           RECORDING MODE IS F.
       01  EMPLOYEE-RECORD            PIC X(80).
       FD  REPORT-FILE
           LABEL RECORDS ARE STANDARD
           BLOCK CONTAINS 0 RECORDS
           RECORDING MODE IS F.
       01  REPORT-RECORD              PIC X(80).
       WORKING-STORAGE SECTION.
           EXEC SQL INCLUDE SQLCA END-EXEC.
           EXEC SQL DECLARE KT_DEMOTAB1 TABLE
           ( EMP_NUM                        CHAR(5) NOT NULL,
             WAGE_TYPE                      CHAR(1),
             REGION                         SMALLINT,
             FIRST_LAST_NAME                VARCHAR(15),
             STREET_ADDR                    VARCHAR(15),
             CITY                           VARCHAR(8),
             STATE                          CHAR(2),
             ZIP                            CHAR(6),
             HIREDATE                       CHAR(6),
             HOURS                          DECIMAL(2, 0),
             SALARY                         DECIMAL(6, 2),
             OVERTIME                       DECIMAL(6, 2),
             COMM                           DECIMAL(6, 2)
           ) END-EXEC.
       01  KTDCL-DEMOTAB1.
           10 EMP-NUM              PIC X(5).
           10 WAGE-TYPE            PIC X(1).
           10 REGION               PIC S9(4) USAGE COMP.
           10 FIRST-LAST-NAME.
              49 FIRST-LAST-NAME-LEN
                 PIC S9(4) USAGE COMP.
              49 FIRST-LAST-NAME-TEXT
                 PIC X(15).
           10 STREET-ADDR.
              49 STREET-ADDR-LEN   PIC S9(4) USAGE COMP.
              49 STREET-ADDR-TEXT
                 PIC X(15).
           10 CITY.
              49 CITY-LEN          PIC S9(4) USAGE COMP.
              49 CITY-TEXT         PIC X(8).
           10 STATE                PIC X(2).
           10 ZIP                  PIC X(6).
           10 HIREDATE             PIC X(6).
           10 HOURS                PIC S9(2)V USAGE COMP-3.
           10 SALARY               PIC S9(4)V9(2) USAGE COMP-3.
           10 OVERTIME             PIC S9(4)V9(2) USAGE COMP-3.
           10 COMM                 PIC S9(4)V9(2) USAGE COMP-3.
       01  IKT-DEMOTAB1.
           10 INDSTRUC           PIC S9(4) USAGE COMP OCCURS 13 TIMES.
           EXEC SQL DECLARE EMPLOYEE_CURSOR CURSOR FOR
                SELECT *
                FROM KT_DEMOTAB1
                WHERE EMP_NUM = :EMP-NUM
                FOR UPDATE OF WAGES, OVERTIME, COMM
           END-EXEC.
       01  ERROR-MESSAGE.
               02  ERROR-LEN   PIC S9(4)  COMP VALUE +960.
               02  ERROR-TEXT  PIC X(120) OCCURS 10 TIMES
                                          INDEXED BY ERROR-INDEX.
       77  ERROR-TEXT-LEN      PIC S9(9)  COMP VALUE +120.
       01  SWITCHES.
           05  JUMP-SW                PIC X        VALUE 'N'.
               88  JUMPING                         VALUE 'Y'.
           05  EOF-SW                 PIC X        VALUE 'N'.
               88  END-OF-FILE                     VALUE 'Y'.
           05  REGION-ERROR-SW        PIC X        VALUE 'N'.
               88  INVALID-REGION                  VALUE 'Y'.
               88  VALID-REGION                    VALUE 'N'.
           05  PARM-ERROR-SW          PIC X        VALUE 'N'.
               88  BAD-PARM                        VALUE 'Y'.
               88  GOOD-PARM                       VALUE 'N'.
           05  END-OF-MONTH-SW        PIC X        VALUE 'N'.
               88  END-OF-MONTH                    VALUE 'Y'.
       01  COUNTERS.
           05  PAGE-COUNT             PIC 9(3)     VALUE 1.
           05  EMP-LINE-COUNT         PIC S99      VALUE +56.
           05  REG-LINE-COUNT         PIC S99      VALUE +56.
           05  START-NUMBER           PIC 999.
           05  RECORDS-READ           PIC 999      VALUE 0.
           05  NORTH-COUNT            PIC 9(2)     VALUE 0.
           05  SOUTH-COUNT            PIC 9(2)     VALUE 0.
           05  EAST-COUNT             PIC 9(2)     VALUE 0.
           05  WEST-COUNT             PIC 9(2)     VALUE 0.
       01  REGION-SUB                 PIC 9        VALUE 0.
       01  YRS-OF-SERVICE             PIC 99       VALUE 0.
       01  TODAYS-DATE                PIC X(6).
       01  DATE-FIELDS REDEFINES TODAYS-DATE.
           05  DATE-YY                PIC 9(2).
           05  DATE-MM                PIC 9(2).
           05  DATE-DD                PIC 9(2).
       01  HOLD-TABLE.
           05  HOLD-AREA        OCCURS 4 TIMES
                                INDEXED BY REG-IX.
               10  HOLD-LINE    OCCURS 20 TIMES
                                INDEXED BY HOLD-IX.
                   15  HOLD-NAME               PIC X(15).
                   15  HOLD-REGION             PIC X(5).
                   15  HOLD-TYPE               PIC X.
                   15  HOLD-YEARS              PIC 9(2).
                   15  HOLD-HIRE-DATE.
                       20  HOLD-HIRE-YY        PIC 9(2).
                       20  HOLD-HIRE-MM        PIC 9(2).
                       20  HOLD-HIRE-DD        PIC 9(2).
                   15  HOLD-WAGES              PIC 9(5)V99.
                   15  HOLD-OT                 PIC 9(5)V99.
                   15  HOLD-COMM               PIC 9(5)V99.
                   15  HOLD-TOTAL              PIC 9(5)V99.
       01  REGION-NAME-TABLE.
           05  FILLER            PIC X(5)    VALUE 'NORTH'.
           05  FILLER            PIC X(5)    VALUE 'SOUTH'.
           05  FILLER            PIC X(5)    VALUE 'EAST '.
           05  FILLER            PIC X(5)    VALUE 'WEST '.
       01  REGION-TABLE     REDEFINES REGION-NAME-TABLE.
           05  REGION-ID         PIC X(5)  OCCURS 4 TIMES.
       01  REGION-SALES-TABLE.
           05  REGION-DATA         OCCURS 4 TIMES.
               10  REGION-NAME       PIC X(5).
               10  REGION-MANAGER    PIC X(15).
               10  REGION-SALARY     PIC 9(4)V99.
               10  REGION-SALES      PIC 9(6)V99.
               10  REGION-COMMENT    PIC X(5).
       01  CALC-COMMISSION-FIELDS.
           05  EMP-TYPE              PIC X.
           05  CALC-SALES            PIC 9(6)V99           VALUE 0.
           05  CALC-COMMISSION       PIC 9(5)V99  COMP-3   VALUE 0.
       01  TOTAL-FIELDS.
           05  EMP-WAGES             PIC 9(5)V99    COMP-3.
           05  EMP-COMPENSATION      PIC 9(5)V99    COMP-3.
           05  MGMT-COMPENSATION     PIC 9(5)V99    COMP-3.
       01  GRAND-TOTAL-FIELDS.
           05  GRAND-TOTAL-EMP       PIC 9(7)V99   COMP-3  VALUE 0.
           05  GRAND-TOTAL-MGMT      PIC 9(7)V99   COMP-3  VALUE 0.
       01  OVERTIME-FIELDS.
           05  OT-AMOUNT             PIC 9(5)V99    COMP-3.
           05  OT-HOURS              PIC 9(2).
       01  WS-DISPLAY-SQLCODE        PIC +ZZ99.
       01  WS-EMP-NUM                PIC X(5).
       01  NUMBER-OF-EMPLOYEES       PIC S9(9) COMP-4 VALUE 0.
       01  EMPLOYEE-COUNT            PIC X(5).
       01  WS-CURSOR-SWITCH          PIC X VALUE 'C'.
           88  CURSOR-OPEN                 VALUE 'O'.
           88  CURSOR-CLOSE                VALUE 'C'.
           88  CURSOR-FETCHED              VALUE 'F'.
           88  CURSOR-NOT-FETCHED          VALUE 'N'.
       01  EMPLOYEE-WORK-AREA.
           05  WA-EMP-NUM            PIC 9(5).
           05  WA-EMP-TYPE           PIC X.
               88  HOURLY            VALUE 'H'.
               88  SALES             VALUE 'S'.
               88  MANAGEMENT        VALUE 'M'.
               88  DELETED           VALUE 'D'.
           05  WA-EMP-REGION         PIC 9.
               88  NORTH             VALUE 1.
               88  SOUTH             VALUE 2.
               88  EAST              VALUE 3.
               88  WEST              VALUE 4.
           05  WA-EMP-NAME           PIC X(15).
           05  WA-EMP-ADDRESS.
               10  WA-EMP-STREET     PIC X(15).
               10  WA-EMP-CITY       PIC X(8).
               10  WA-EMP-STATE      PIC XX.
               10  WA-EMP-ZIP        PIC X(9).
           05  WA-HOURLY-EMPLOYEE-DATA.
               10  WA-EMP-HOURS      PIC 9(2).
               10  WA-EMP-RATE       PIC 9(3)V99     COMP-3.
               10  FILLER            PIC X(8).
           05  WA-SALES-EMPLOYEE-DATA   REDEFINES
                                        WA-HOURLY-EMPLOYEE-DATA.
               10  WA-SALES-SALARY   PIC 9(5)V99     COMP-3.
               10  WA-SALES-AMOUNT   PIC 9(5)V99.
               10  FILLER            PIC X(2).
           05  WA-MGMT-EMPLOYEE-DATA   REDEFINES
                                        WA-SALES-EMPLOYEE-DATA.
               10  WA-MGMT-SALARY    PIC 9(5)V99     COMP-3.
               10  FILLER            PIC X(9).
           05  WA-EMP-HIRE-DATE.
               10  WA-EMP-HIRE-YY    PIC 9(2).
               10  WA-EMP-HIRE-MM    PIC 9(2).
               10  WA-EMP-HIRE-DD    PIC 9(2).
           05  FILLER                PIC X(5).
       01  EMPLOYEE-HDR1.
           05  FILLER      PIC X         VALUE SPACES.
           05  FILLER      PIC X(10)
                              VALUE  'RUN DATE  '.
           05  EMP-RUN-MM
                           PIC 99.
           05  FILLER      PIC X         VALUE '/'.
           05  EMP-RUN-DD
                           PIC 99.
           05  FILLER      PIC X         VALUE '/'.
           05  EMP-RUN-YY
                           PIC 99.
           05  FILLER      PIC X(7)      VALUE SPACES.
           05  FILLER      PIC X(28)
                              VALUE  'EMPLOYEE COMPENSATION REPORT'.
           05  FILLER      PIC X(18)     VALUE SPACES.
           05  FILLER      PIC X(5)      VALUE 'PAGE '.
           05  EMP-PAGE    PIC ZZ9.
       01  EMPLOYEE-HDR2.
           05  FILLER      PIC X(31)     VALUE SPACES.
           05  FILLER      PIC X(4)      VALUE 'HIRE'.
           05  FILLER      PIC X(2)      VALUE SPACES.
           05  FILLER      PIC X(6)      VALUE 'YRS OF'.
           05  FILLER      PIC X(37)     VALUE SPACES.
       01  EMPLOYEE-HDR3.
           05  FILLER      PIC X         VALUE SPACES.
           05  FILLER      PIC X(13)     VALUE 'EMPLOYEE NAME'.
           05  FILLER      PIC X(3)      VALUE SPACES.
           05  FILLER      PIC X(6)      VALUE 'REGION'.
           05  FILLER      PIC X         VALUE SPACES.
           05  FILLER      PIC X(4)      VALUE 'TYPE'.
           05  FILLER      PIC X(3)      VALUE SPACES.
           05  FILLER      PIC X(4)      VALUE 'DATE'.
           05  FILLER      PIC X(2)      VALUE SPACES.
           05  FILLER      PIC X(7)      VALUE 'SERVICE'.
           05  FILLER      PIC X(2)      VALUE SPACES.
           05  FILLER      PIC X(6)      VALUE 'SALARY'.
           05  FILLER      PIC X(3)      VALUE SPACES.
           05  FILLER      PIC X(3)      VALUE 'O/T'.
           05  FILLER      PIC X(3)      VALUE SPACES.
           05  FILLER      PIC X(10)     VALUE 'COMMISSION'.
           05  FILLER      PIC X(4)      VALUE SPACES.
           05  FILLER      PIC X(5)      VALUE 'TOTAL'.
       01  EMPLOYEE-DTL.
           05  FILLER                  PIC X         VALUE SPACES.
           05  EMP-DTL-NAME            PIC X(15).
           05  FILLER                  PIC X         VALUE SPACES.
           05  EMP-DTL-REGION          PIC X(5).
           05  FILLER                  PIC X(3)      VALUE SPACES.
           05  EMP-DTL-TYPE            PIC X.
           05  FILLER                  PIC X(3)      VALUE SPACES.
           05  EMP-DTL-HIRE-MM         PIC 9(2).
           05  EMP-DTL-SLASH1          PIC X         VALUE SPACES.
           05  EMP-DTL-HIRE-DD         PIC 9(2).
           05  EMP-DTL-SLASH2          PIC X         VALUE SPACES.
           05  EMP-DTL-HIRE-YY         PIC 9(2).
           05  FILLER                  PIC X(3)      VALUE SPACES.
           05  EMP-DTL-YRS-OF-SERVICE  PIC 9(2).
           05  FILLER                  PIC X(2)      VALUE SPACES.
           05  EMP-DTL-WAGES           PIC ZZZZ9V99.
           05  FILLER                  PIC X         VALUE SPACES.
           05  EMP-DTL-OT              PIC ZZZZ9V99.
           05  FILLER                  PIC X(2)      VALUE SPACES.
           05  EMP-DTL-COMM            PIC ZZZZ9V99.
           05  FILLER                  PIC X         VALUE SPACES.
           05  EMP-DTL-TOTAL           PIC ZZZZ9V99.
       01  EMP-TOTAL-DTL.
           05  FILLER            PIC X(4)      VALUE SPACES.
           05  FILLER            PIC X(5)      VALUE 'TOTAL'.
           05  FILLER            PIC X(61)     VALUE SPACES.
           05  EMP-GRAND-TOTAL   PIC ZZZZZZ9V99.
       01  REGION-HDR1.
           05  FILLER      PIC X      VALUE SPACES.
           05  FILLER      PIC X(10)  VALUE 'RUN DATE  '.
           05  REG-RUN-MONTH
                           PIC 99.
           05  FILLER      PIC X      VALUE '/'.
           05  REG-RUN-DAY PIC 99.
           05  FILLER      PIC X      VALUE '/'.
           05  REG-RUN-YEAR
                           PIC 99.
           05  FILLER      PIC X(11)  VALUE SPACES.
           05  FILLER      PIC X(21)  VALUE  'REGIONAL SALES REPORT'.
           05  FILLER      PIC X(21)  VALUE SPACES.
           05  FILLER      PIC X(5)   VALUE 'PAGE '.
           05  REG-PAGE    PIC ZZ9.
       01  REGION-HDR2.
           05  FILLER      PIC X      VALUE SPACES.
           05  FILLER      PIC X(7)   VALUE 'MANAGER'.
           05  FILLER      PIC X(9)   VALUE SPACES.
           05  FILLER      PIC X(6)   VALUE 'REGION'.
           05  FILLER      PIC X(3)   VALUE SPACES.
           05  FILLER      PIC X(11)  VALUE 'TOTAL SALES'.
           05  FILLER      PIC X(5)   VALUE SPACES.
           05  FILLER      PIC X(6)   VALUE 'SALARY'.
           05  FILLER      PIC X(5)   VALUE SPACES.
           05  FILLER      PIC X(10)  VALUE 'COMMISSION'.
           05  FILLER      PIC X(3)   VALUE SPACES.
           05  FILLER      PIC X(5)   VALUE 'TOTAL'.
           05  FILLER      PIC X(9)   VALUE SPACES.
       01  REGION-DETAIL.
           05  FILLER             PIC X         VALUE SPACES.
           05  REG-DTL-MANAGER    PIC X(15).
           05  FILLER             PIC X         VALUE SPACES.
           05  REG-DTL-REGION     PIC X(5).
           05  FILLER             PIC X(5)      VALUE SPACES.
           05  REG-DTL-SALES      PIC ZZZZZ9V99.
           05  FILLER             PIC X(5)      VALUE SPACES.
           05  REG-DTL-SALARY     PIC ZZZ9.99.
           05  FILLER             PIC X(5)      VALUE SPACES.
           05  REG-DTL-COMM       PIC ZZZZ9V99.
           05  FILLER             PIC X(3)      VALUE SPACES.
           05  REG-DTL-TOTAL      PIC ZZZZ9V99.
           05  FILLER             PIC X         VALUE SPACES.
           05  REG-DTL-COMMENT    PIC X(5).
       01  MGMT-TOTAL-DTL.
           05  FILLER             PIC X(4)      VALUE SPACES.
           05  FILLER             PIC X(5)      VALUE 'TOTAL'.
           05  FILLER             PIC X(53)     VALUE SPACES.
           05  MGMT-GRAND-TOTAL   PIC ZZZZZZ9V99.
           05  FILLER             PIC X(8)      VALUE SPACES.
       01  ERROR-LINE             PIC X(80).
       01  BLANK-LINE             PIC X(80)   VALUE SPACES.
       LINKAGE SECTION.
       01  PARMINFO.
           03  PARM-LTH          PIC S9(4) COMP.
           03  PARM-DATA          PIC X(5).
           03  GRAND-TOTAL        PIC S9(7) COMP.
           03  TOTAL-RECORD       PIC 999      VALUE 0.
       PROCEDURE DIVISION USING PARMINFO.
       0000-MAINLINE.
           DISPLAY 'IN 0000-MAINLINE'.
           DISPLAY 'PARM-LTH= ', PARM-LTH.
           DISPLAY 'PARM-DATA= ', PARM-DATA.
           DISPLAY 'GRAND-TOTAL= ', GRAND-TOTAL.
           DISPLAY 'TOTAL-RECORD= ', TOTAL-RECORD.
           PERFORM 9000-OPEN.
           PERFORM 9100-CHECK-PARM.
           IF GOOD-PARM
              PERFORM 9200-INIT
              PERFORM 8000-READ-INPUT
                   UNTIL RECORDS-READ = START-NUMBER
                   OR END-OF-FILE
              PERFORM 1000-PROCESS-DATA
                    UNTIL END-OF-FILE
              PERFORM 6000-PRINT-EMPLOYEE-REPORT
              MOVE 1 TO REGION-SUB
              IF END-OF-MONTH
                  PERFORM 7000-PRINT-REGION-REPORT
                        UNTIL REGION-SUB > 4.
              MOVE RECORDS-READ TO TOTAL-RECORD.
              MOVE EMP-GRAND-TOTAL TO GRAND-TOTAL.
           PERFORM 9900-CLOSE.
       PROG-END.
           GOBACK.
       1000-PROCESS-DATA.
           DISPLAY 'IN 1000-PROCESS-DATA'.
           IF HOURLY
               DISPLAY 'HOURLY'
               PERFORM 2000-PROCESS-HOURLY
           ELSE
               IF SALES
                   DISPLAY 'SALES'
                   PERFORM 3000-PROCESS-SALES
               ELSE
                   IF MANAGEMENT
                       DISPLAY 'MANAGEMENT'
                       PERFORM 4000-PROCESS-MANAGEMENT
                   ELSE
                      IF DELETED
                          DISPLAY 'DELETED'
                          IF CURSOR-FETCHED
                            DISPLAY 'DELETE WS-CURSOR-SWITCH= ',
                            WS-CURSOR-SWITCH
                            EXEC SQL DELETE KT_DEMOTAB1
                                      WHERE CURRENT OF EMPLOYEE_CURSOR
                            END-EXEC
                          ELSE
                            DISPLAY 'DELETE WS-CURSOR-SWITCH= ',
                            WS-CURSOR-SWITCH
                            IF DELETED AND CURSOR-NOT-FETCHED
                                EXEC SQL DELETE KT_DEMOTAB1
                                      WHERE EMP_NUM = :EMP-NUM
                                END-EXEC
                          END-IF
                          DISPLAY 'ENDIF CURSOR FETCHED'
                          IF SQLCODE NOT EQUAL TO 0
                             MOVE SQLCODE TO WS-DISPLAY-SQLCODE
                             DISPLAY 'ERROR ON DELETE - SQLCODE = ',
                             WS-DISPLAY-SQLCODE
                          END-IF
                      ELSE
                          DISPLAY 'INVALID EMPLOYEE TYPE', WA-EMP-TYPE
                          IF RECORDS-READ NOT EQUAL TO ZERO
                             MOVE ' INVALID EMPLOYEE TYPE '
                                TO ERROR-LINE
                             WRITE REPORT-RECORD FROM ERROR-LINE
                         END-IF
                      END-IF
                   END-IF
               END-IF
           END-IF.
           DISPLAY 'IN 1000-PROCESS-DATA BEFORE CLOSE CURSOR'
           IF CURSOR-OPEN OR CURSOR-FETCHED
                EXEC SQL CLOSE EMPLOYEE_CURSOR END-EXEC
                DISPLAY 'CLOSED CURSOR, WS-CURSOR-SWITCH= ',
                     WS-CURSOR-SWITCH
                MOVE 'C' TO WS-CURSOR-SWITCH
                IF SQLCODE NOT EQUAL TO 0
                   MOVE SQLCODE TO WS-DISPLAY-SQLCODE
                   DISPLAY 'ERROR ON CLOSE CURSOR - SQLCODE = ',
                   WS-DISPLAY-SQLCODE
                END-IF
            END-IF.
           DISPLAY 'IN 1000-PROCESS-DATA BEFORE 8000-READ-INPUT'.
           PERFORM 8000-READ-INPUT.
       2000-PROCESS-HOURLY.
           DISPLAY 'IN 2000-PROCESS-HOURLY'.
           MOVE ZERO TO OT-AMOUNT.
           IF WA-EMP-HOURS GREATER THAN 40
               COMPUTE EMP-WAGES = WA-EMP-RATE * 40
               COMPUTE OT-HOURS  = WA-EMP-HOURS - 40
               COMPUTE OT-AMOUNT = OT-HOURS * (WA-EMP-RATE * 1.5)
           ELSE
               COMPUTE EMP-WAGES = WA-EMP-HOURS * WA-EMP-RATE.
           COMPUTE EMP-COMPENSATION = EMP-WAGES + OT-AMOUNT.
           ADD EMP-COMPENSATION TO GRAND-TOTAL-EMP.
           CALL 'CWKTDATE' USING END-OF-MONTH-SW
                                 YRS-OF-SERVICE
                                 TODAYS-DATE
                                 WA-EMP-HIRE-DATE.
           PERFORM 5000-STORE-EMPLOYEE-DETAIL.
           SET HOLD-IX UP BY 1.
       3000-PROCESS-SALES.
           DISPLAY 'IN 3000-PROCESS-SALES'.
           IF WA-SALES-AMOUNT > 0
              ADD  WA-SALES-AMOUNT  TO REGION-SALES (WA-EMP-REGION)
              MOVE WA-SALES-AMOUNT  TO CALC-SALES
              MOVE 0 TO CALC-COMMISSION
              MOVE 'S' TO EMP-TYPE
              CALL 'CWKTSUBC' USING EMP-TYPE,
                                    CALC-SALES,
                                    CALC-COMMISSION
           ELSE
              MOVE 'UH-OH' TO REGION-COMMENT (WA-EMP-REGION).
           COMPUTE EMP-COMPENSATION = WA-SALES-SALARY +
                                      CALC-COMMISSION.
           ADD  EMP-COMPENSATION TO GRAND-TOTAL-EMP.
           CALL 'CWKTDATE' USING END-OF-MONTH-SW
                                 YRS-OF-SERVICE
                                 TODAYS-DATE
                                 WA-EMP-HIRE-DATE.
           PERFORM 5000-STORE-EMPLOYEE-DETAIL.
           SET HOLD-IX UP BY 1.
       4000-PROCESS-MANAGEMENT.
           DISPLAY 'IN 4000-PROCESS-MANAGEMENT'.
           MOVE WA-EMP-NAME    TO REGION-MANAGER (WA-EMP-REGION).
           MOVE WA-MGMT-SALARY TO REGION-SALARY (WA-EMP-REGION).
       5000-STORE-EMPLOYEE-DETAIL.
           DISPLAY 'IN 5000-STORE-EMPLOYEE-DETAIL'.
           PERFORM 5100-SET-INDEX.
           IF VALID-REGION
               MOVE WA-EMP-NAME TO HOLD-NAME (REG-IX, HOLD-IX)
               MOVE REGION-ID (WA-EMP-REGION)
                                TO HOLD-REGION (REG-IX, HOLD-IX)
               MOVE WA-EMP-TYPE TO HOLD-TYPE (REG-IX, HOLD-IX)
               MOVE WA-EMP-HIRE-DATE TO HOLD-HIRE-DATE (REG-IX, HOLD-IX)
               MOVE YRS-OF-SERVICE TO HOLD-YEARS (REG-IX, HOLD-IX)
               MOVE EMP-COMPENSATION
                                TO HOLD-TOTAL (REG-IX, HOLD-IX)
               IF HOURLY
                  DISPLAY 'IN HOURLY'
                  MOVE EMP-WAGES TO HOLD-WAGES (REG-IX, HOLD-IX)
                  MOVE OT-AMOUNT TO HOLD-OT (REG-IX, HOLD-IX)
                  MOVE ZEROS     TO HOLD-COMM (REG-IX, HOLD-IX)
                  MOVE EMP-WAGES TO SALARY
                  MOVE OT-AMOUNT TO OVERTIME
                  MOVE ZEROS TO COMM
                  DISPLAY 'WS-CURSOR-SWITCH= ',WS-CURSOR-SWITCH
                  IF CURSOR-FETCHED
                    DISPLAY 'HOURLY UPDATE-SWITCH 1= ',WS-CURSOR-SWITCH
                  ELSE
                    DISPLAY 'HOURLY UPDATE-SWITCH 2= ',WS-CURSOR-SWITCH
                 END-IF
               ELSE
                  DISPLAY 'IN SALES '
                  MOVE WA-SALES-SALARY
                                 TO HOLD-WAGES(REG-IX, HOLD-IX)
                  MOVE CALC-COMMISSION
                                 TO HOLD-COMM (REG-IX, HOLD-IX)
                  MOVE ZERO      TO HOLD-OT   (REG-IX, HOLD-IX)
                  MOVE CALC-COMMISSION TO COMM
                  MOVE WA-SALES-SALARY TO SALARY
                  MOVE ZERO TO OVERTIME
                  DISPLAY 'WS-CURSOR-SWITCH= ',WS-CURSOR-SWITCH
                  IF CURSOR-OPEN OR CURSOR-FETCHED
                    DISPLAY 'SALES UPDATE SWITCH= ',WS-CURSOR-SWITCH
                       EXEC SQL UPDATE KT_DEMOTAB1
                             SET (WAGES, OVERTIME, COMM)
                             = (:SALARY, :OVERTIME, :COMM)
                             WHERE CURRENT OF EMPLOYEE_CURSOR
                       END-EXEC
                  ELSE
                    DISPLAY 'SECOND IN ELSE SALES '
                    DISPLAY 'SALES UPDATE SWITCH= ',WS-CURSOR-SWITCH
                       EXEC SQL UPDATE KT_DEMOTAB1
                             SET (WAGES, OVERTIME, COMM)
                             = (:SALARY, :OVERTIME, :COMM)
                             WHERE EMP_NUM = :EMP-NUM
                       END-EXEC
                  END-IF
               END-IF.
       5100-SET-INDEX.
           DISPLAY 'IN 5100-SET-INDEX'.
           MOVE 'N' TO REGION-ERROR-SW.
           IF NORTH
               ADD 1 TO NORTH-COUNT
               SET HOLD-IX TO NORTH-COUNT
           ELSE
               IF SOUTH
                   ADD 1 TO SOUTH-COUNT
                   SET HOLD-IX TO SOUTH-COUNT
               ELSE
                   IF EAST
                       ADD 1 TO EAST-COUNT
                       SET HOLD-IX TO EAST-COUNT
                   ELSE
                       IF WEST
                           ADD 1 TO WEST-COUNT
                           SET HOLD-IX TO WEST-COUNT
                       ELSE
                           MOVE 'Y' TO REGION-ERROR-SW.
           IF VALID-REGION
               SET REG-IX TO WA-EMP-REGION.
       6000-PRINT-EMPLOYEE-REPORT.
           DISPLAY 'IN 6000-PRINT-EMPLOYEE-REPORT'.
           SET REG-IX TO 1.
           PERFORM 6100-PRINT-EMPLOYEE-DETAIL
                 VARYING HOLD-IX FROM 1 BY 1
                 UNTIL HOLD-IX > NORTH-COUNT.
           SET REG-IX TO 2.
           PERFORM 6100-PRINT-EMPLOYEE-DETAIL
                 VARYING HOLD-IX FROM 1 BY 1
                 UNTIL HOLD-IX > SOUTH-COUNT.
           SET REG-IX TO 3.
           PERFORM 6100-PRINT-EMPLOYEE-DETAIL
                 VARYING HOLD-IX FROM 1 BY 1
                 UNTIL HOLD-IX > EAST-COUNT.
           SET REG-IX TO 4.
           PERFORM 6100-PRINT-EMPLOYEE-DETAIL
                 VARYING HOLD-IX FROM 1 BY 1
                 UNTIL HOLD-IX > WEST-COUNT.
           WRITE REPORT-RECORD FROM BLANK-LINE.
           MOVE GRAND-TOTAL-EMP TO EMP-GRAND-TOTAL.
           WRITE REPORT-RECORD FROM EMP-TOTAL-DTL.
       6100-PRINT-EMPLOYEE-DETAIL.
           DISPLAY 'IN 6100-PRINT-EMPLOYEE-DETAIL'.
           IF EMP-LINE-COUNT GREATER THAN 55
                 PERFORM 6200-PRINT-EMPLOYEE-HEADERS.
           MOVE HOLD-NAME   (REG-IX, HOLD-IX) TO EMP-DTL-NAME.
           MOVE HOLD-REGION (REG-IX, HOLD-IX) TO EMP-DTL-REGION.
           MOVE HOLD-TYPE   (REG-IX, HOLD-IX) TO EMP-DTL-TYPE.
           MOVE HOLD-HIRE-MM(REG-IX, HOLD-IX) TO EMP-DTL-HIRE-MM.
           MOVE '/'                           TO EMP-DTL-SLASH1.
           MOVE HOLD-HIRE-DD(REG-IX, HOLD-IX) TO EMP-DTL-HIRE-DD.
           MOVE '/'                           TO EMP-DTL-SLASH2.
           MOVE HOLD-HIRE-YY(REG-IX, HOLD-IX) TO EMP-DTL-HIRE-YY.
           MOVE HOLD-YEARS  (REG-IX, HOLD-IX) TO EMP-DTL-YRS-OF-SERVICE.
           MOVE HOLD-WAGES  (REG-IX, HOLD-IX) TO EMP-DTL-WAGES.
           MOVE HOLD-OT     (REG-IX, HOLD-IX) TO EMP-DTL-OT.
           MOVE HOLD-COMM   (REG-IX, HOLD-IX) TO EMP-DTL-COMM.
           MOVE HOLD-TOTAL  (REG-IX, HOLD-IX) TO EMP-DTL-TOTAL.
           WRITE REPORT-RECORD FROM EMPLOYEE-DTL
             AFTER ADVANCING 1 LINE.
           ADD  1 TO EMP-LINE-COUNT.
           MOVE SPACES TO EMPLOYEE-DTL.
       6200-PRINT-EMPLOYEE-HEADERS.
           DISPLAY 'IN 6200-PRINT-EMPLOYEE-HEADERS'.
               MOVE PAGE-COUNT TO EMP-PAGE.
               MOVE DATE-YY TO EMP-RUN-YY.
               MOVE DATE-MM TO EMP-RUN-MM.
               MOVE DATE-DD TO EMP-RUN-DD.
               WRITE REPORT-RECORD FROM BLANK-LINE.
               WRITE REPORT-RECORD FROM BLANK-LINE.
               WRITE REPORT-RECORD FROM BLANK-LINE.
               WRITE REPORT-RECORD FROM EMPLOYEE-HDR1.
               WRITE REPORT-RECORD FROM BLANK-LINE.
               WRITE REPORT-RECORD FROM BLANK-LINE.
               WRITE REPORT-RECORD FROM EMPLOYEE-HDR2.
               WRITE REPORT-RECORD FROM EMPLOYEE-HDR3.
               WRITE REPORT-RECORD FROM BLANK-LINE.
               ADD 1 TO PAGE-COUNT.
               MOVE 5 TO EMP-LINE-COUNT.
       7000-PRINT-REGION-REPORT.
           DISPLAY 'IN 7000-PRINT-REGION-REPORT'.
           IF REG-LINE-COUNT GREATER THAN 55
               PERFORM 7100-PRINT-REGION-HEADERS.
           MOVE SPACES TO REGION-DETAIL.
           MOVE REGION-NAME    (REGION-SUB) TO REG-DTL-REGION.
           MOVE REGION-MANAGER (REGION-SUB) TO REG-DTL-MANAGER.
           MOVE REGION-SALARY  (REGION-SUB) TO REG-DTL-SALARY.
           MOVE REGION-SALES   (REGION-SUB) TO REG-DTL-SALES.
           MOVE REGION-SALES   (REGION-SUB) TO CALC-SALES.
           MOVE REGION-COMMENT (REGION-SUB) TO REG-DTL-COMMENT.
           MOVE 'M' TO EMP-TYPE.
           CALL 'CWKTSUBC' USING EMP-TYPE,
                                 CALC-SALES,
                                 CALC-COMMISSION.
           MOVE CALC-COMMISSION TO REG-DTL-COMM.
           COMPUTE MGMT-COMPENSATION = CALC-COMMISSION +
                                      REGION-SALARY(REGION-SUB).
           ADD  MGMT-COMPENSATION TO GRAND-TOTAL-MGMT.
           MOVE MGMT-COMPENSATION TO REG-DTL-TOTAL.
           WRITE REPORT-RECORD FROM REGION-DETAIL.
           IF REGION-SUB = 4
              WRITE REPORT-RECORD FROM BLANK-LINE
              MOVE GRAND-TOTAL-MGMT TO MGMT-GRAND-TOTAL
              WRITE REPORT-RECORD FROM MGMT-TOTAL-DTL.
           ADD 1 TO REG-LINE-COUNT.
           ADD 1 TO REGION-SUB.
       7100-PRINT-REGION-HEADERS.
           DISPLAY 'IN 7100-PRINT-REGION-HEADERS'.
               MOVE PAGE-COUNT TO REG-PAGE.
               MOVE DATE-YY TO REG-RUN-YEAR.
               MOVE DATE-MM TO REG-RUN-MONTH.
               MOVE DATE-DD TO REG-RUN-DAY.
               WRITE REPORT-RECORD FROM BLANK-LINE.
               WRITE REPORT-RECORD FROM BLANK-LINE.
               WRITE REPORT-RECORD FROM BLANK-LINE.
               WRITE REPORT-RECORD FROM BLANK-LINE.
               WRITE REPORT-RECORD FROM BLANK-LINE.
               WRITE REPORT-RECORD FROM REGION-HDR1.
               WRITE REPORT-RECORD FROM BLANK-LINE.
               WRITE REPORT-RECORD FROM BLANK-LINE.
               WRITE REPORT-RECORD FROM REGION-HDR2.
               WRITE REPORT-RECORD FROM BLANK-LINE.
               ADD 1 TO PAGE-COUNT.
               MOVE 4 TO REG-LINE-COUNT.
       8000-READ-INPUT.
           DISPLAY 'IN 8000-READ-INPUT'.
           READ EMPLOYEE-FILE INTO EMPLOYEE-WORK-AREA
               AT END
                    MOVE 'Y' TO EOF-SW.
           MOVE WA-EMP-NUM TO EMP-NUM
           DISPLAY 'WA-EMP-NUM=', WA-EMP-NUM.
           DISPLAY 'WA-EMP-REGION=', WA-EMP-REGION.
           IF EOF-SW NOT EQUAL TO 'Y' THEN
              EXEC SQL OPEN EMPLOYEE_CURSOR END-EXEC
              IF SQLCODE NOT EQUAL TO 0 THEN
                 MOVE ' ' TO WS-CURSOR-SWITCH
                 MOVE SQLCODE TO WS-DISPLAY-SQLCODE
                 DISPLAY 'ERROR ON OPEN CURSOR - SQLCODE = ',
                 WS-DISPLAY-SQLCODE
              ELSE
                 MOVE 'O' TO WS-CURSOR-SWITCH
              END-IF
           END-IF.
           IF EOF-SW NOT EQUAL TO 'Y' THEN
              EXEC SQL FETCH EMPLOYEE_CURSOR INTO
                   :KTDCL-DEMOTAB1
              END-EXEC
              MOVE SQLCODE TO WS-DISPLAY-SQLCODE
              DISPLAY 'SQLCODE ON FETCH - SQLCODE = ',
                 WS-DISPLAY-SQLCODE
              IF SQLCODE = 0 THEN
                 MOVE 'F' TO WS-CURSOR-SWITCH
                 MOVE EMP-NUM TO WA-EMP-NUM
                 MOVE WAGE-TYPE  TO WA-EMP-TYPE
                 MOVE REGION TO WA-EMP-REGION
                 MOVE HOURS TO WA-EMP-HOURS
                 MOVE STATE TO WA-EMP-STATE
                 MOVE ZIP   TO WA-EMP-ZIP
                 MOVE HOURS TO WA-EMP-HOURS
                 MOVE SALARY TO WA-EMP-RATE
                 MOVE HIREDATE TO WA-EMP-HIRE-DATE
              END-IF
              IF SQLCODE = 100 THEN
                 IF NOT DELETED THEN
                    DISPLAY 'WS-CURSOR-SWITCH= ',WS-CURSOR-SWITCH
                    MOVE WA-EMP-NUM TO EMP-NUM
                    MOVE WA-EMP-HOURS TO HOURS
                    MOVE WA-EMP-TYPE  TO WAGE-TYPE
                    MOVE WA-EMP-HIRE-DATE TO HIREDATE
                    DISPLAY 'EMP-NUM= ', EMP-NUM
                    DISPLAY 'WAGE-TYPE= ', WAGE-TYPE
                    DISPLAY 'WA-EMP-TYPE= ', WA-EMP-TYPE
                    DISPLAY 'HIREDATE= ', HIREDATE
                    MOVE WA-EMP-REGION TO REGION
                    EXEC SQL
                       INSERT INTO KT_DEMOTAB1
                       (
                       EMP_NUM               ,
                       WAGE_TYPE             ,
                       REGION                ,
                       FIRST_LAST_NAME       ,
                       STREET_ADDR           ,
                       CITY                  ,
                       STATE                 ,
                       ZIP                   ,
                       HIREDATE              ,
                       HOURS  )
                       VALUES (
                      :EMP-NUM            ,
                      :WA-EMP-TYPE     ,
                      :REGION         ,
                      :WA-EMP-NAME           ,
                      :WA-EMP-STREET         ,
                      :WA-EMP-CITY           ,
                      :WA-EMP-STATE          ,
                      :WA-EMP-ZIP            ,
                      :HIREDATE              ,
                      :HOURS          )
                       END-EXEC
                       DISPLAY 'AFTER INSERT WS-CURSOR-SWITCH= ',
                       WS-CURSOR-SWITCH
                       IF SQLCODE NOT EQUAL TO 0 THEN
                           MOVE SQLCODE TO WS-DISPLAY-SQLCODE
                           DISPLAY 'ERROR ON INSERT - SQLCODE = ',
                           WS-DISPLAY-SQLCODE
                       ELSE
                           MOVE SQLCODE TO WS-DISPLAY-SQLCODE
                           DISPLAY 'INSERT SUCCESSFUL-SQLCODE = ',
                           WS-DISPLAY-SQLCODE
                       END-IF
                 END-IF
              END-IF
              ADD 1 TO RECORDS-READ
           END-IF.
       9000-OPEN.
           DISPLAY 'IN 9000-OPEN'.
           OPEN INPUT  EMPLOYEE-FILE.
           OPEN OUTPUT REPORT-FILE.
       9100-CHECK-PARM.
           DISPLAY 'IN 9100-CHECK-PARM'.
           MOVE '000000' TO EMP-NUM.
           EXEC SQL SELECT COUNT(*)
                    INTO :NUMBER-OF-EMPLOYEES
                   FROM KT_DEMOTAB1
                   WHERE EMP_NUM > :EMP-NUM
           END-EXEC.
           IF SQLCODE NOT EQUAL TO 0
             MOVE SQLCODE TO WS-DISPLAY-SQLCODE
              DISPLAY 'ERROR ON SELECT COUNT - SQLCODE = ',
              WS-DISPLAY-SQLCODE
           END-IF.
           DISPLAY 'NUMBER OF EMPLOYEES IN KT_DEMOTAB1= ',
              NUMBER-OF-EMPLOYEES.
           MOVE NUMBER-OF-EMPLOYEES TO EMPLOYEE-COUNT.
           IF PARM-LTH = 5
               IF PARM-DATA IS NUMERIC
                   MOVE PARM-DATA TO START-NUMBER
               ELSE
                   PERFORM 9800-BAD-PARM
           ELSE
               IF PARM-LTH = 0
                   MOVE 1 TO START-NUMBER
               ELSE
                   PERFORM 9800-BAD-PARM.
       9200-INIT.
           DISPLAY 'IN 9200-INIT'.
           MOVE 'NORTH' TO REGION-NAME (1).
           MOVE 'SOUTH' TO REGION-NAME (2).
           MOVE 'EAST ' TO REGION-NAME (3).
           MOVE 'WEST ' TO REGION-NAME (4).
           MOVE 1 TO REGION-SUB.
           PERFORM 9300-INITIALIZE-REGION-TABLE
              UNTIL REGION-SUB > 4.
           SET HOLD-IX TO 1.
           ACCEPT TODAYS-DATE FROM DATE.
           CALL 'CWKTDATE' USING END-OF-MONTH-SW
                                 YRS-OF-SERVICE
                                 TODAYS-DATE
                                 WA-EMP-HIRE-DATE.
       9300-INITIALIZE-REGION-TABLE.
           DISPLAY 'IN 9300-INITIALIZE-REGION-TABLE'.
           MOVE SPACES TO REGION-MANAGER (REGION-SUB).
           MOVE SPACES TO REGION-COMMENT (REGION-SUB).
           MOVE 0 TO REGION-SALARY (REGION-SUB).
           MOVE 0 TO REGION-SALES  (REGION-SUB).
           ADD  1 TO REGION-SUB.
       9800-BAD-PARM.
           DISPLAY 'IN 9800-BAD-PARM'.
           MOVE 'Y' TO PARM-ERROR-SW.
           MOVE '   PARAMETER LENGTH OR DATA IS INCORRECT   '
               TO ERROR-LINE.
           WRITE REPORT-RECORD FROM ERROR-LINE.
       9900-CLOSE.
           DISPLAY 'IN 9900-CLOSE'.
           CLOSE EMPLOYEE-FILE.
           CLOSE REPORT-FILE.
       9990-GET-SQL-DIAG.
                CALL 'DSNTIAR' USING SQLCA ERROR-MESSAGE ERROR-TEXT-LEN.
                IF RETURN-CODE = ZERO
                   PERFORM ERROR-PRINT VARYING ERROR-INDEX
                      FROM 1 BY 1 UNTIL ERROR-INDEX GREATER THAN 10.
                GO TO PROG-END.
       ERROR-PRINT.
                WRITE REPORT-RECORD FROM ERROR-TEXT (ERROR-INDEX)
                   AFTER ADVANCING 1 LINE.
       9999-RIP.
           DISPLAY '    ************    '.
           DISPLAY '   *            *   '.
           DISPLAY '  *   T H I S    *  '.
           DISPLAY ' *                * '.
           DISPLAY ' *      I S       * '.
           DISPLAY ' *                * '.
           DISPLAY ' *    D E A D     * '.
           DISPLAY ' *                * '.
           DISPLAY ' *    C O D E     * '.
           DISPLAY ' ****************** '.","       FILE SECTION.
       FD  EMPLOYEE-FILE
           LABEL RECORDS ARE STANDARD
           BLOCK CONTAINS 0 RECORDS
           RECORDING MODE IS F.
       01  EMPLOYEE-RECORD            PIC X(80).
       FD  REPORT-FILE
           LABEL RECORDS ARE STANDARD
           BLOCK CONTAINS 0 RECORDS
           RECORDING MODE IS F.
       01  REPORT-RECORD              PIC X(80).
       WORKING-STORAGE SECTION.
           EXEC SQL INCLUDE SQLCA END-EXEC.
           EXEC SQL DECLARE KT_DEMOTAB1 TABLE
           ( EMP_NUM                        CHAR(5) NOT NULL,
             WAGE_TYPE                      CHAR(1),
             REGION                         SMALLINT,
             FIRST_LAST_NAME                VARCHAR(15),
             STREET_ADDR                    VARCHAR(15),
             CITY                           VARCHAR(8),
             STATE                          CHAR(2),
             ZIP                            CHAR(6),
             HIREDATE                       CHAR(6),
             HOURS                          DECIMAL(2, 0),
             SALARY                         DECIMAL(6, 2),
             OVERTIME                       DECIMAL(6, 2),
             COMM                           DECIMAL(6, 2)
           ) END-EXEC.
       01  KTDCL-DEMOTAB1.
           10 EMP-NUM              PIC X(5).
           10 WAGE-TYPE            PIC X(1).
           10 REGION               PIC S9(4) USAGE COMP.
           10 FIRST-LAST-NAME.
              49 FIRST-LAST-NAME-LEN
                 PIC S9(4) USAGE COMP.
              49 FIRST-LAST-NAME-TEXT
                 PIC X(15).
           10 STREET-ADDR.
              49 STREET-ADDR-LEN   PIC S9(4) USAGE COMP.
              49 STREET-ADDR-TEXT
                 PIC X(15).
           10 CITY.
              49 CITY-LEN          PIC S9(4) USAGE COMP.
              49 CITY-TEXT         PIC X(8).
           10 STATE                PIC X(2).
           10 ZIP                  PIC X(6).
           10 HIREDATE             PIC X(6).
           10 HOURS                PIC S9(2)V USAGE COMP-3.
           10 SALARY               PIC S9(4)V9(2) USAGE COMP-3.
           10 OVERTIME             PIC S9(4)V9(2) USAGE COMP-3.
           10 COMM                 PIC S9(4)V9(2) USAGE COMP-3.
       01  IKT-DEMOTAB1.
           10 INDSTRUC           PIC S9(4) USAGE COMP OCCURS 13 TIMES.
           EXEC SQL DECLARE EMPLOYEE_CURSOR CURSOR FOR
                SELECT *
                FROM KT_DEMOTAB1
                WHERE EMP_NUM = :EMP-NUM
                FOR UPDATE OF WAGES, OVERTIME, COMM
           END-EXEC.
       01  ERROR-MESSAGE.
               02  ERROR-LEN   PIC S9(4)  COMP VALUE +960.
               02  ERROR-TEXT  PIC X(120) OCCURS 10 TIMES
                                          INDEXED BY ERROR-INDEX.
       77  ERROR-TEXT-LEN      PIC S9(9)  COMP VALUE +120.
       01  SWITCHES.
           05  JUMP-SW                PIC X        VALUE 'N'.
               88  JUMPING                         VALUE 'Y'.
           05  EOF-SW                 PIC X        VALUE 'N'.
               88  END-OF-FILE                     VALUE 'Y'.
           05  REGION-ERROR-SW        PIC X        VALUE 'N'.
               88  INVALID-REGION                  VALUE 'Y'.
               88  VALID-REGION                    VALUE 'N'.
           05  PARM-ERROR-SW          PIC X        VALUE 'N'.
               88  BAD-PARM                        VALUE 'Y'.
               88  GOOD-PARM                       VALUE 'N'.
           05  END-OF-MONTH-SW        PIC X        VALUE 'N'.
               88  END-OF-MONTH                    VALUE 'Y'.
       01  COUNTERS.
           05  PAGE-COUNT             PIC 9(3)     VALUE 1.
           05  EMP-LINE-COUNT         PIC S99      VALUE +56.
           05  REG-LINE-COUNT         PIC S99      VALUE +56.
           05  START-NUMBER           PIC 999.
           05  RECORDS-READ           PIC 999      VALUE 0.
           05  NORTH-COUNT            PIC 9(2)     VALUE 0.
           05  SOUTH-COUNT            PIC 9(2)     VALUE 0.
           05  EAST-COUNT             PIC 9(2)     VALUE 0.
           05  WEST-COUNT             PIC 9(2)     VALUE 0.
       01  REGION-SUB                 PIC 9        VALUE 0.
       01  YRS-OF-SERVICE             PIC 99       VALUE 0.
       01  TODAYS-DATE                PIC X(6).
       01  DATE-FIELDS REDEFINES TODAYS-DATE.
           05  DATE-YY                PIC 9(2).
           05  DATE-MM                PIC 9(2).
           05  DATE-DD                PIC 9(2).
       01  HOLD-TABLE.
           05  HOLD-AREA        OCCURS 4 TIMES
                                INDEXED BY REG-IX.
               10  HOLD-LINE    OCCURS 20 TIMES
                                INDEXED BY HOLD-IX.
                   15  HOLD-NAME               PIC X(15).
                   15  HOLD-REGION             PIC X(5).
                   15  HOLD-TYPE               PIC X.
                   15  HOLD-YEARS              PIC 9(2).
                   15  HOLD-HIRE-DATE.
                       20  HOLD-HIRE-YY        PIC 9(2).
                       20  HOLD-HIRE-MM        PIC 9(2).
                       20  HOLD-HIRE-DD        PIC 9(2).
                   15  HOLD-WAGES              PIC 9(5)V99.
                   15  HOLD-OT                 PIC 9(5)V99.
                   15  HOLD-COMM               PIC 9(5)V99.
                   15  HOLD-TOTAL              PIC 9(5)V99.
       01  REGION-NAME-TABLE.
           05  FILLER            PIC X(5)    VALUE 'NORTH'.
           05  FILLER            PIC X(5)    VALUE 'SOUTH'.
           05  FILLER            PIC X(5)    VALUE 'EAST '.
           05  FILLER            PIC X(5)    VALUE 'WEST '.
       01  REGION-TABLE     REDEFINES REGION-NAME-TABLE.
           05  REGION-ID         PIC X(5)  OCCURS 4 TIMES.
       01  REGION-SALES-TABLE.
           05  REGION-DATA         OCCURS 4 TIMES.
               10  REGION-NAME       PIC X(5).
               10  REGION-MANAGER    PIC X(15).
               10  REGION-SALARY     PIC 9(4)V99.
               10  REGION-SALES      PIC 9(6)V99.
               10  REGION-COMMENT    PIC X(5).
       01  CALC-COMMISSION-FIELDS.
           05  EMP-TYPE              PIC X.
           05  CALC-SALES            PIC 9(6)V99           VALUE 0.
           05  CALC-COMMISSION       PIC 9(5)V99  COMP-3   VALUE 0.
       01  TOTAL-FIELDS.
           05  EMP-WAGES             PIC 9(5)V99    COMP-3.
           05  EMP-COMPENSATION      PIC 9(5)V99    COMP-3.
           05  MGMT-COMPENSATION     PIC 9(5)V99    COMP-3.
       01  GRAND-TOTAL-FIELDS.
           05  GRAND-TOTAL-EMP       PIC 9(7)V99   COMP-3  VALUE 0.
           05  GRAND-TOTAL-MGMT      PIC 9(7)V99   COMP-3  VALUE 0.
       01  OVERTIME-FIELDS.
           05  OT-AMOUNT             PIC 9(5)V99    COMP-3.
           05  OT-HOURS              PIC 9(2).
       01  WS-DISPLAY-SQLCODE        PIC +ZZ99.
       01  WS-EMP-NUM                PIC X(5).
       01  NUMBER-OF-EMPLOYEES       PIC S9(9) COMP-4 VALUE 0.
       01  EMPLOYEE-COUNT            PIC X(5).
       01  WS-CURSOR-SWITCH          PIC X VALUE 'C'.
           88  CURSOR-OPEN                 VALUE 'O'.
           88  CURSOR-CLOSE                VALUE 'C'.
           88  CURSOR-FETCHED              VALUE 'F'.
           88  CURSOR-NOT-FETCHED          VALUE 'N'.
       01  EMPLOYEE-WORK-AREA.
           05  WA-EMP-NUM            PIC 9(5).
           05  WA-EMP-TYPE           PIC X.
               88  HOURLY            VALUE 'H'.
               88  SALES             VALUE 'S'.
               88  MANAGEMENT        VALUE 'M'.
               88  DELETED           VALUE 'D'.
           05  WA-EMP-REGION         PIC 9.
               88  NORTH             VALUE 1.
               88  SOUTH             VALUE 2.
               88  EAST              VALUE 3.
               88  WEST              VALUE 4.
           05  WA-EMP-NAME           PIC X(15).
           05  WA-EMP-ADDRESS.
               10  WA-EMP-STREET     PIC X(15).
               10  WA-EMP-CITY       PIC X(8).
               10  WA-EMP-STATE      PIC XX.
               10  WA-EMP-ZIP        PIC X(9).
           05  WA-HOURLY-EMPLOYEE-DATA.
               10  WA-EMP-HOURS      PIC 9(2).
               10  WA-EMP-RATE       PIC 9(3)V99     COMP-3.
               10  FILLER            PIC X(8).
           05  WA-SALES-EMPLOYEE-DATA   REDEFINES
                                        WA-HOURLY-EMPLOYEE-DATA.
               10  WA-SALES-SALARY   PIC 9(5)V99     COMP-3.
               10  WA-SALES-AMOUNT   PIC 9(5)V99.
               10  FILLER            PIC X(2).
           05  WA-MGMT-EMPLOYEE-DATA   REDEFINES
                                        WA-SALES-EMPLOYEE-DATA.
               10  WA-MGMT-SALARY    PIC 9(5)V99     COMP-3.
               10  FILLER            PIC X(9).
           05  WA-EMP-HIRE-DATE.
               10  WA-EMP-HIRE-YY    PIC 9(2).
               10  WA-EMP-HIRE-MM    PIC 9(2).
               10  WA-EMP-HIRE-DD    PIC 9(2).
           05  FILLER                PIC X(5).
       01  EMPLOYEE-HDR1.
           05  FILLER      PIC X         VALUE SPACES.
           05  FILLER      PIC X(10)
                              VALUE  'RUN DATE  '.
           05  EMP-RUN-MM
                           PIC 99.
           05  FILLER      PIC X         VALUE '/'.
           05  EMP-RUN-DD
                           PIC 99.
           05  FILLER      PIC X         VALUE '/'.
           05  EMP-RUN-YY
                           PIC 99.
           05  FILLER      PIC X(7)      VALUE SPACES.
           05  FILLER      PIC X(28)
                              VALUE  'EMPLOYEE COMPENSATION REPORT'.
           05  FILLER      PIC X(18)     VALUE SPACES.
           05  FILLER      PIC X(5)      VALUE 'PAGE '.
           05  EMP-PAGE    PIC ZZ9.
       01  EMPLOYEE-HDR2.
           05  FILLER      PIC X(31)     VALUE SPACES.
           05  FILLER      PIC X(4)      VALUE 'HIRE'.
           05  FILLER      PIC X(2)      VALUE SPACES.
           05  FILLER      PIC X(6)      VALUE 'YRS OF'.
           05  FILLER      PIC X(37)     VALUE SPACES.
       01  EMPLOYEE-HDR3.
           05  FILLER      PIC X         VALUE SPACES.
           05  FILLER      PIC X(13)     VALUE 'EMPLOYEE NAME'.
           05  FILLER      PIC X(3)      VALUE SPACES.
           05  FILLER      PIC X(6)      VALUE 'REGION'.
           05  FILLER      PIC X         VALUE SPACES.
           05  FILLER      PIC X(4)      VALUE 'TYPE'.
           05  FILLER      PIC X(3)      VALUE SPACES.
           05  FILLER      PIC X(4)      VALUE 'DATE'.
           05  FILLER      PIC X(2)      VALUE SPACES.
           05  FILLER      PIC X(7)      VALUE 'SERVICE'.
           05  FILLER      PIC X(2)      VALUE SPACES.
           05  FILLER      PIC X(6)      VALUE 'SALARY'.
           05  FILLER      PIC X(3)      VALUE SPACES.
           05  FILLER      PIC X(3)      VALUE 'O/T'.
           05  FILLER      PIC X(3)      VALUE SPACES.
           05  FILLER      PIC X(10)     VALUE 'COMMISSION'.
           05  FILLER      PIC X(4)      VALUE SPACES.
           05  FILLER      PIC X(5)      VALUE 'TOTAL'.
       01  EMPLOYEE-DTL.
           05  FILLER                  PIC X         VALUE SPACES.
           05  EMP-DTL-NAME            PIC X(15).
           05  FILLER                  PIC X         VALUE SPACES.
           05  EMP-DTL-REGION          PIC X(5).
           05  FILLER                  PIC X(3)      VALUE SPACES.
           05  EMP-DTL-TYPE            PIC X.
           05  FILLER                  PIC X(3)      VALUE SPACES.
           05  EMP-DTL-HIRE-MM         PIC 9(2).
           05  EMP-DTL-SLASH1          PIC X         VALUE SPACES.
           05  EMP-DTL-HIRE-DD         PIC 9(2).
           05  EMP-DTL-SLASH2          PIC X         VALUE SPACES.
           05  EMP-DTL-HIRE-YY         PIC 9(2).
           05  FILLER                  PIC X(3)      VALUE SPACES.
           05  EMP-DTL-YRS-OF-SERVICE  PIC 9(2).
           05  FILLER                  PIC X(2)      VALUE SPACES.
           05  EMP-DTL-WAGES           PIC ZZZZ9V99.
           05  FILLER                  PIC X         VALUE SPACES.
           05  EMP-DTL-OT              PIC ZZZZ9V99.
           05  FILLER                  PIC X(2)      VALUE SPACES.
           05  EMP-DTL-COMM            PIC ZZZZ9V99.
           05  FILLER                  PIC X         VALUE SPACES.
           05  EMP-DTL-TOTAL           PIC ZZZZ9V99.
       01  EMP-TOTAL-DTL.
           05  FILLER            PIC X(4)      VALUE SPACES.
           05  FILLER            PIC X(5)      VALUE 'TOTAL'.
           05  FILLER            PIC X(61)     VALUE SPACES.
           05  EMP-GRAND-TOTAL   PIC ZZZZZZ9V99.
       01  REGION-HDR1.
           05  FILLER      PIC X      VALUE SPACES.
           05  FILLER      PIC X(10)  VALUE 'RUN DATE  '.
           05  REG-RUN-MONTH
                           PIC 99.
           05  FILLER      PIC X      VALUE '/'.
           05  REG-RUN-DAY PIC 99.
           05  FILLER      PIC X      VALUE '/'.
           05  REG-RUN-YEAR
                           PIC 99.
           05  FILLER      PIC X(11)  VALUE SPACES.
           05  FILLER      PIC X(21)  VALUE  'REGIONAL SALES REPORT'.
           05  FILLER      PIC X(21)  VALUE SPACES.
           05  FILLER      PIC X(5)   VALUE 'PAGE '.
           05  REG-PAGE    PIC ZZ9.
       01  REGION-HDR2.
           05  FILLER      PIC X      VALUE SPACES.
           05  FILLER      PIC X(7)   VALUE 'MANAGER'.
           05  FILLER      PIC X(9)   VALUE SPACES.
           05  FILLER      PIC X(6)   VALUE 'REGION'.
           05  FILLER      PIC X(3)   VALUE SPACES.
           05  FILLER      PIC X(11)  VALUE 'TOTAL SALES'.
           05  FILLER      PIC X(5)   VALUE SPACES.
           05  FILLER      PIC X(6)   VALUE 'SALARY'.
           05  FILLER      PIC X(5)   VALUE SPACES.
           05  FILLER      PIC X(10)  VALUE 'COMMISSION'.
           05  FILLER      PIC X(3)   VALUE SPACES.
           05  FILLER      PIC X(5)   VALUE 'TOTAL'.
           05  FILLER      PIC X(9)   VALUE SPACES.
       01  REGION-DETAIL.
           05  FILLER             PIC X         VALUE SPACES.
           05  REG-DTL-MANAGER    PIC X(15).
           05  FILLER             PIC X         VALUE SPACES.
           05  REG-DTL-REGION     PIC X(5).
           05  FILLER             PIC X(5)      VALUE SPACES.
           05  REG-DTL-SALES      PIC ZZZZZ9V99.
           05  FILLER             PIC X(5)      VALUE SPACES.
           05  REG-DTL-SALARY     PIC ZZZ9.99.
           05  FILLER             PIC X(5)      VALUE SPACES.
           05  REG-DTL-COMM       PIC ZZZZ9V99.
           05  FILLER             PIC X(3)      VALUE SPACES.
           05  REG-DTL-TOTAL      PIC ZZZZ9V99.
           05  FILLER             PIC X         VALUE SPACES.
           05  REG-DTL-COMMENT    PIC X(5).
       01  MGMT-TOTAL-DTL.
           05  FILLER             PIC X(4)      VALUE SPACES.
           05  FILLER             PIC X(5)      VALUE 'TOTAL'.
           05  FILLER             PIC X(53)     VALUE SPACES.
           05  MGMT-GRAND-TOTAL   PIC ZZZZZZ9V99.
           05  FILLER             PIC X(8)      VALUE SPACES.
       01  ERROR-LINE             PIC X(80).
       01  BLANK-LINE             PIC X(80)   VALUE SPACES.
       LINKAGE SECTION.
       01  PARMINFO.
           03  PARM-LTH          PIC S9(4) COMP.
           03  PARM-DATA          PIC X(5).
           03  GRAND-TOTAL        PIC S9(7) COMP.
           03  TOTAL-RECORD       PIC 999      VALUE 0.
","['0000-MAINLINE', 'PROG-END', '1000-PROCESS-DATA', '2000-PROCESS-HOURLY', '3000-PROCESS-SALES', '4000-PROCESS-MANAGEMENT', '5000-STORE-EMPLOYEE-DETAIL', '5100-SET-INDEX', '6000-PRINT-EMPLOYEE-REPORT', '6100-PRINT-EMPLOYEE-DETAIL', '6200-PRINT-EMPLOYEE-HEADERS', '7000-PRINT-REGION-REPORT', '7100-PRINT-REGION-HEADERS', '8000-READ-INPUT', '9000-OPEN', '9100-CHECK-PARM', '9200-INIT', '9300-INITIALIZE-REGION-TABLE', '9800-BAD-PARM', '9900-CLOSE', '9990-GET-SQL-DIAG', 'ERROR-PRINT', '9999-RIP']","Paragraph 0000-MAINLINE calls paragraph 9200-INIT, 8000-READ-INPUT, 7000-PRINT-REGION-REPORT, 9100-CHECK-PARM, 9900-CLOSE, 1000-PROCESS-DATA, 6000-PRINT-EMPLOYEE-REPORT, 9000-OPEN.
Paragraph 1000-PROCESS-DATA calls paragraph 3000-PROCESS-SALES, 8000-READ-INPUT, 2000-PROCESS-HOURLY, 4000-PROCESS-MANAGEMENT.
Paragraph 2000-PROCESS-HOURLY calls paragraph 5000-STORE-EMPLOYEE-DETAIL.
Paragraph 3000-PROCESS-SALES calls paragraph 5000-STORE-EMPLOYEE-DETAIL.
Paragraph 5000-STORE-EMPLOYEE-DETAIL calls paragraph 5100-SET-INDEX.
Paragraph 6000-PRINT-EMPLOYEE-REPORT calls paragraph 6100-PRINT-EMPLOYEE-DETAIL.
Paragraph 6100-PRINT-EMPLOYEE-DETAIL calls paragraph 6200-PRINT-EMPLOYEE-HEADERS.
Paragraph 7000-PRINT-REGION-REPORT calls paragraph 7100-PRINT-REGION-HEADERS.
Paragraph 9100-CHECK-PARM calls paragraph 9800-BAD-PARM.
Paragraph 9200-INIT calls paragraph 9300-INITIALIZE-REGION-TABLE.
Paragraph 9990-GET-SQL-DIAG calls paragraph PROG-END.
",802,THIS PROGRAM IS A DB2 COBOL DEMO PROGRAM USED FOR TOPAZ FOR TOTAL TEST TRAINING SESSIONS. INPUT FILE  - EMPLOYEE WAGE INFORMATION  - STORED IN THE ECC SLCXCNTL FILE - TTTDATD OUTPUT FILE - EMPLOYEE COMPENSATION REPORT - REGIONAL SALES REPORT RUN JCL     - STORED IN THE ECC SLCXCNTL FILE - LAUNCHDB,,"['DSNTIAR', 'CWKTSUBC', 'CWKTDATE']",,Error Long,0.5,1,1,"This COBOL program manages employee data, processing various employee types and generating detailed reports. It initializes data, checks parameters, reads input, and processes employee and regional compensation. The program includes specific handling for hourly and sales employees, storing their details, and printing reports. Error handling is incorporated alongside SQL diagnostics, ensuring proper functionality and reliability. The program concludes by closing the files and returning control to the operating system.",
11,IBM_example-health-apis,X-COBOL/X-COBOL/COBOL_Files/IBM_example-health-apis/HCP1PL01.cbl,"       IDENTIFICATION DIVISION.
       PROGRAM-ID. HCP1PL01.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       77 INQ-TRANS                    PIC X(4) VALUE 'HCP1'.
       77 ADD-TRANS                    PIC X(4) VALUE 'HCPA'.
       77 MSGEND                       PIC X(24) VALUE
                                        'Transaction ended      '.
       01  WS-RESP                   PIC S9(8) COMP.
       01  HCZMENUI.
           02  FILLER PIC X(12).
           02  HCZINPUTL    COMP  PIC  S9(4).
           02  HCZINPUTF    PICTURE X.
           02  FILLER REDEFINES HCZINPUTF.
             03 HCZINPUTA    PICTURE X.
           02  HCZINPUTI  PIC X(1).
           02  HCZMSGL    COMP  PIC  S9(4).
           02  HCZMSGF    PICTURE X.
           02  FILLER REDEFINES HCZMSGF.
             03 HCZMSGA    PICTURE X.
           02  HCZMSGI  PIC X(49).
       01  HCZMENUO REDEFINES HCZMENUI.
           02  FILLER PIC X(12).
           02  FILLER PICTURE X(3).
           02  HCZINPUTO  PIC X(1).
           02  FILLER PICTURE X(3).
           02  HCZMSGO  PIC X(49).
       01  HCP1MAPI.
           02  FILLER PIC X(12).
           02  HCP1TRNL    COMP  PIC  S9(4).
           02  HCP1TRNF    PICTURE X.
           02  FILLER REDEFINES HCP1TRNF.
             03 HCP1TRNA    PICTURE X.
           02  HCP1TRNI  PIC X(4).
           02  HCP1TITL    COMP  PIC  S9(4).
           02  HCP1TITF    PICTURE X.
           02  FILLER REDEFINES HCP1TITF.
             03 HCP1TITA    PICTURE X.
           02  HCP1TITI  PIC X(27).
           02  HCP1PNOL    COMP  PIC  S9(4).
           02  HCP1PNOF    PICTURE X.
           02  FILLER REDEFINES HCP1PNOF.
             03 HCP1PNOA    PICTURE X.
           02  HCP1PNOI  PIC X(10).
           02  HCP1FNAL    COMP  PIC  S9(4).
           02  HCP1FNAF    PICTURE X.
           02  FILLER REDEFINES HCP1FNAF.
             03 HCP1FNAA    PICTURE X.
           02  HCP1FNAI  PIC X(10).
           02  HCP1LNAL    COMP  PIC  S9(4).
           02  HCP1LNAF    PICTURE X.
           02  FILLER REDEFINES HCP1LNAF.
             03 HCP1LNAA    PICTURE X.
           02  HCP1LNAI  PIC X(20).
           02  HCP1DOBL    COMP  PIC  S9(4).
           02  HCP1DOBF    PICTURE X.
           02  FILLER REDEFINES HCP1DOBF.
             03 HCP1DOBA    PICTURE X.
           02  HCP1DOBI  PIC X(10).
           02  HCP1ADDRL    COMP  PIC  S9(4).
           02  HCP1ADDRF    PICTURE X.
           02  FILLER REDEFINES HCP1ADDRF.
             03 HCP1ADDRA    PICTURE X.
           02  HCP1ADDRI  PIC X(20).
           02  HCP1CITYL    COMP  PIC  S9(4).
           02  HCP1CITYF    PICTURE X.
           02  FILLER REDEFINES HCP1CITYF.
             03 HCP1CITYA    PICTURE X.
           02  HCP1CITYI  PIC X(20).
           02  HCP1HPCL    COMP  PIC  S9(4).
           02  HCP1HPCF    PICTURE X.
           02  FILLER REDEFINES HCP1HPCF.
             03 HCP1HPCA    PICTURE X.
           02  HCP1HPCI  PIC X(10).
           02  HCP1HP2L    COMP  PIC  S9(4).
           02  HCP1HP2F    PICTURE X.
           02  FILLER REDEFINES HCP1HP2F.
             03 HCP1HP2A    PICTURE X.
           02  HCP1HP2I  PIC X(20).
           02  HCP1HMOL    COMP  PIC  S9(4).
           02  HCP1HMOF    PICTURE X.
           02  FILLER REDEFINES HCP1HMOF.
             03 HCP1HMOA    PICTURE X.
           02  HCP1HMOI  PIC X(30).
           02  HCP1INOL    COMP  PIC  S9(4).
           02  HCP1INOF    PICTURE X.
           02  FILLER REDEFINES HCP1INOF.
             03 HCP1INOA    PICTURE X.
           02  HCP1INOI  PIC X(10).
           02  HCP1UIDL    COMP  PIC  S9(4).
           02  HCP1UIDF    PICTURE X.
           02  FILLER REDEFINES HCP1UIDF.
             03 HCP1UIDA    PICTURE X.
           02  HCP1UIDI  PIC X(10).
           02  HCP1MSGL    COMP  PIC  S9(4).
           02  HCP1MSGF    PICTURE X.
           02  FILLER REDEFINES HCP1MSGF.
             03 HCP1MSGA    PICTURE X.
           02  HCP1MSGI  PIC X(40).
       01  HCP1MAPO REDEFINES HCP1MAPI.
           02  FILLER PIC X(12).
           02  FILLER PICTURE X(3).
           02  HCP1TRNO  PIC X(4).
           02  FILLER PICTURE X(3).
           02  HCP1TITO  PIC X(27).
           02  FILLER PICTURE X(3).
           02  HCP1PNOO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCP1FNAO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCP1LNAO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCP1DOBO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCP1ADDRO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCP1CITYO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCP1HPCO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCP1HP2O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCP1HMOO  PIC X(30).
           02  FILLER PICTURE X(3).
           02  HCP1INOO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCP1UIDO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCP1MSGO  PIC X(40).
       01  HCM1MAPI.
           02  FILLER PIC X(12).
           02  HCM1CNOL    COMP  PIC  S9(4).
           02  HCM1CNOF    PICTURE X.
           02  FILLER REDEFINES HCM1CNOF.
             03 HCM1CNOA    PICTURE X.
           02  HCM1CNOI  PIC X(10).
           02  HCM1FNAL    COMP  PIC  S9(4).
           02  HCM1FNAF    PICTURE X.
           02  FILLER REDEFINES HCM1FNAF.
             03 HCM1FNAA    PICTURE X.
           02  HCM1FNAI  PIC X(10).
           02  HCM1LNAL    COMP  PIC  S9(4).
           02  HCM1LNAF    PICTURE X.
           02  FILLER REDEFINES HCM1LNAF.
             03 HCM1LNAA    PICTURE X.
           02  HCM1LNAI  PIC X(20).
           02  HCM1DNA1L    COMP  PIC  S9(4).
           02  HCM1DNA1F    PICTURE X.
           02  FILLER REDEFINES HCM1DNA1F.
             03 HCM1DNA1A    PICTURE X.
           02  HCM1DNA1I  PIC X(27).
           02  HCM1DST1L    COMP  PIC  S9(4).
           02  HCM1DST1F    PICTURE X.
           02  FILLER REDEFINES HCM1DST1F.
             03 HCM1DST1A    PICTURE X.
           02  HCM1DST1I  PIC X(20).
           02  HCM1DAM1L    COMP  PIC  S9(4).
           02  HCM1DAM1F    PICTURE X.
           02  FILLER REDEFINES HCM1DAM1F.
             03 HCM1DAM1A    PICTURE X.
           02  HCM1DAM1I  PIC X(5).
           02  HCM1DRO1L    COMP  PIC  S9(4).
           02  HCM1DRO1F    PICTURE X.
           02  FILLER REDEFINES HCM1DRO1F.
             03 HCM1DRO1A    PICTURE X.
           02  HCM1DRO1I  PIC X(20).
           02  HCM1DFR1L    COMP  PIC  S9(4).
           02  HCM1DFR1F    PICTURE X.
           02  FILLER REDEFINES HCM1DFR1F.
             03 HCM1DFR1A    PICTURE X.
           02  HCM1DFR1I  PIC X(20).
           02  HCM1DNA2L    COMP  PIC  S9(4).
           02  HCM1DNA2F    PICTURE X.
           02  FILLER REDEFINES HCM1DNA2F.
             03 HCM1DNA2A    PICTURE X.
           02  HCM1DNA2I  PIC X(27).
           02  HCM1DST2L    COMP  PIC  S9(4).
           02  HCM1DST2F    PICTURE X.
           02  FILLER REDEFINES HCM1DST2F.
             03 HCM1DST2A    PICTURE X.
           02  HCM1DST2I  PIC X(20).
           02  HCM1DAM2L    COMP  PIC  S9(4).
           02  HCM1DAM2F    PICTURE X.
           02  FILLER REDEFINES HCM1DAM2F.
             03 HCM1DAM2A    PICTURE X.
           02  HCM1DAM2I  PIC X(5).
           02  HCM1DRO2L    COMP  PIC  S9(4).
           02  HCM1DRO2F    PICTURE X.
           02  FILLER REDEFINES HCM1DRO2F.
             03 HCM1DRO2A    PICTURE X.
           02  HCM1DRO2I  PIC X(20).
           02  HCM1DFR2L    COMP  PIC  S9(4).
           02  HCM1DFR2F    PICTURE X.
           02  FILLER REDEFINES HCM1DFR2F.
             03 HCM1DFR2A    PICTURE X.
           02  HCM1DFR2I  PIC X(20).
           02  HCM1DNA3L    COMP  PIC  S9(4).
           02  HCM1DNA3F    PICTURE X.
           02  FILLER REDEFINES HCM1DNA3F.
             03 HCM1DNA3A    PICTURE X.
           02  HCM1DNA3I  PIC X(27).
           02  HCM1DST3L    COMP  PIC  S9(4).
           02  HCM1DST3F    PICTURE X.
           02  FILLER REDEFINES HCM1DST3F.
             03 HCM1DST3A    PICTURE X.
           02  HCM1DST3I  PIC X(20).
           02  HCM1DAM3L    COMP  PIC  S9(4).
           02  HCM1DAM3F    PICTURE X.
           02  FILLER REDEFINES HCM1DAM3F.
             03 HCM1DAM3A    PICTURE X.
           02  HCM1DAM3I  PIC X(5).
           02  HCM1DRO3L    COMP  PIC  S9(4).
           02  HCM1DRO3F    PICTURE X.
           02  FILLER REDEFINES HCM1DRO3F.
             03 HCM1DRO3A    PICTURE X.
           02  HCM1DRO3I  PIC X(20).
           02  HCM1DFR3L    COMP  PIC  S9(4).
           02  HCM1DFR3F    PICTURE X.
           02  FILLER REDEFINES HCM1DFR3F.
             03 HCM1DFR3A    PICTURE X.
           02  HCM1DFR3I  PIC X(20).
           02  HCM1MSGL    COMP  PIC  S9(4).
           02  HCM1MSGF    PICTURE X.
           02  FILLER REDEFINES HCM1MSGF.
             03 HCM1MSGA    PICTURE X.
           02  HCM1MSGI  PIC X(43).
       01  HCM1MAPO REDEFINES HCM1MAPI.
           02  FILLER PIC X(12).
           02  FILLER PICTURE X(3).
           02  HCM1CNOO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCM1FNAO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCM1LNAO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1DNA1O  PIC X(27).
           02  FILLER PICTURE X(3).
           02  HCM1DST1O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1DAM1O  PIC X(5).
           02  FILLER PICTURE X(3).
           02  HCM1DRO1O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1DFR1O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1DNA2O  PIC X(27).
           02  FILLER PICTURE X(3).
           02  HCM1DST2O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1DAM2O  PIC X(5).
           02  FILLER PICTURE X(3).
           02  HCM1DRO2O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1DFR2O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1DNA3O  PIC X(27).
           02  FILLER PICTURE X(3).
           02  HCM1DST3O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1DAM3O  PIC X(5).
           02  FILLER PICTURE X(3).
           02  HCM1DRO3O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1DFR3O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1MSGO  PIC X(43).
       01  HCMAMAPI.
           02  FILLER PIC X(12).
           02  HCMACNOL    COMP  PIC  S9(4).
           02  HCMACNOF    PICTURE X.
           02  FILLER REDEFINES HCMACNOF.
             03 HCMACNOA    PICTURE X.
           02  HCMACNOI  PIC X(10).
           02  HCMAFNAL    COMP  PIC  S9(4).
           02  HCMAFNAF    PICTURE X.
           02  FILLER REDEFINES HCMAFNAF.
             03 HCMAFNAA    PICTURE X.
           02  HCMAFNAI  PIC X(10).
           02  HCMALNAL    COMP  PIC  S9(4).
           02  HCMALNAF    PICTURE X.
           02  FILLER REDEFINES HCMALNAF.
             03 HCMALNAA    PICTURE X.
           02  HCMALNAI  PIC X(20).
           02  HCMADNAML    COMP  PIC  S9(4).
           02  HCMADNAMF    PICTURE X.
           02  FILLER REDEFINES HCMADNAMF.
             03 HCMADNAMA    PICTURE X.
           02  HCMADNAMI  PIC X(27).
           02  HCMADSTRL    COMP  PIC  S9(4).
           02  HCMADSTRF    PICTURE X.
           02  FILLER REDEFINES HCMADSTRF.
             03 HCMADSTRA    PICTURE X.
           02  HCMADSTRI  PIC X(20).
           02  HCMADAMOL    COMP  PIC  S9(4).
           02  HCMADAMOF    PICTURE X.
           02  FILLER REDEFINES HCMADAMOF.
             03 HCMADAMOA    PICTURE X.
           02  HCMADAMOI  PIC X(5).
           02  HCMADROUL    COMP  PIC  S9(4).
           02  HCMADROUF    PICTURE X.
           02  FILLER REDEFINES HCMADROUF.
             03 HCMADROUA    PICTURE X.
           02  HCMADROUI  PIC X(20).
           02  HCMADFREL    COMP  PIC  S9(4).
           02  HCMADFREF    PICTURE X.
           02  FILLER REDEFINES HCMADFREF.
             03 HCMADFREA    PICTURE X.
           02  HCMADFREI  PIC X(2).
           02  HCMAIDENL    COMP  PIC  S9(4).
           02  HCMAIDENF    PICTURE X.
           02  FILLER REDEFINES HCMAIDENF.
             03 HCMAIDENA    PICTURE X.
           02  HCMAIDENI  PIC X(20).
           02  HCMATYPEL    COMP  PIC  S9(4).
           02  HCMATYPEF    PICTURE X.
           02  FILLER REDEFINES HCMATYPEF.
             03 HCMATYPEA    PICTURE X.
           02  HCMATYPEI  PIC X(2).
           02  HCMASDTAL    COMP  PIC  S9(4).
           02  HCMASDTAF    PICTURE X.
           02  FILLER REDEFINES HCMASDTAF.
             03 HCMASDTAA    PICTURE X.
           02  HCMASDTAI  PIC X(10).
           02  HCMAEDTAL    COMP  PIC  S9(4).
           02  HCMAEDTAF    PICTURE X.
           02  FILLER REDEFINES HCMAEDTAF.
             03 HCMAEDTAA    PICTURE X.
           02  HCMAEDTAI  PIC X(10).
           02  HCMAMSGL    COMP  PIC  S9(4).
           02  HCMAMSGF    PICTURE X.
           02  FILLER REDEFINES HCMAMSGF.
             03 HCMAMSGA    PICTURE X.
           02  HCMAMSGI  PIC X(40).
       01  HCMAMAPO REDEFINES HCMAMAPI.
           02  FILLER PIC X(12).
           02  FILLER PICTURE X(3).
           02  HCMACNOO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCMAFNAO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCMALNAO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCMADNAMO  PIC X(27).
           02  FILLER PICTURE X(3).
           02  HCMADSTRO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCMADAMOO  PIC X(5).
           02  FILLER PICTURE X(3).
           02  HCMADROUO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCMADFREO  PIC X(2).
           02  FILLER PICTURE X(3).
           02  HCMAIDENO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCMATYPEO  PIC X(2).
           02  FILLER PICTURE X(3).
           02  HCMASDTAO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCMAEDTAO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCMAMSGO  PIC X(40).
       01  HCV1MAPI.
           02  FILLER PIC X(12).
           02  HCV1TRNL    COMP  PIC  S9(4).
           02  HCV1TRNF    PICTURE X.
           02  FILLER REDEFINES HCV1TRNF.
             03 HCV1TRNA    PICTURE X.
           02  HCV1TRNI  PIC X(4).
           02  HCV1TITL    COMP  PIC  S9(4).
           02  HCV1TITF    PICTURE X.
           02  FILLER REDEFINES HCV1TITF.
             03 HCV1TITA    PICTURE X.
           02  HCV1TITI  PIC X(33).
           02  HCV1PNOL    COMP  PIC  S9(4).
           02  HCV1PNOF    PICTURE X.
           02  FILLER REDEFINES HCV1PNOF.
             03 HCV1PNOA    PICTURE X.
           02  HCV1PNOI  PIC X(10).
           02  HCV1FNAL    COMP  PIC  S9(4).
           02  HCV1FNAF    PICTURE X.
           02  FILLER REDEFINES HCV1FNAF.
             03 HCV1FNAA    PICTURE X.
           02  HCV1FNAI  PIC X(10).
           02  HCV1LNAL    COMP  PIC  S9(4).
           02  HCV1LNAF    PICTURE X.
           02  FILLER REDEFINES HCV1LNAF.
             03 HCV1LNAA    PICTURE X.
           02  HCV1LNAI  PIC X(20).
           02  HCV1DATEL    COMP  PIC  S9(4).
           02  HCV1DATEF    PICTURE X.
           02  FILLER REDEFINES HCV1DATEF.
             03 HCV1DATEA    PICTURE X.
           02  HCV1DATEI  PIC X(10).
           02  HCV1TIMEL    COMP  PIC  S9(4).
           02  HCV1TIMEF    PICTURE X.
           02  FILLER REDEFINES HCV1TIMEF.
             03 HCV1TIMEA    PICTURE X.
           02  HCV1TIMEI  PIC X(10).
           02  HCV1HRATEL    COMP  PIC  S9(4).
           02  HCV1HRATEF    PICTURE X.
           02  FILLER REDEFINES HCV1HRATEF.
             03 HCV1HRATEA    PICTURE X.
           02  HCV1HRATEI  PIC X(20).
           02  HCV1HRTHL    COMP  PIC  S9(4).
           02  HCV1HRTHF    PICTURE X.
           02  FILLER REDEFINES HCV1HRTHF.
             03 HCV1HRTHA    PICTURE X.
           02  HCV1HRTHI  PIC X(10).
           02  HCV1BLPRL    COMP  PIC  S9(4).
           02  HCV1BLPRF    PICTURE X.
           02  FILLER REDEFINES HCV1BLPRF.
             03 HCV1BLPRA    PICTURE X.
           02  HCV1BLPRI  PIC X(20).
           02  HCV1BPTHL    COMP  PIC  S9(4).
           02  HCV1BPTHF    PICTURE X.
           02  FILLER REDEFINES HCV1BPTHF.
             03 HCV1BPTHA    PICTURE X.
           02  HCV1BPTHI  PIC X(10).
           02  HCV1MSGL    COMP  PIC  S9(4).
           02  HCV1MSGF    PICTURE X.
           02  FILLER REDEFINES HCV1MSGF.
             03 HCV1MSGA    PICTURE X.
           02  HCV1MSGI  PIC X(40).
       01  HCV1MAPO REDEFINES HCV1MAPI.
           02  FILLER PIC X(12).
           02  FILLER PICTURE X(3).
           02  HCV1TRNO  PIC X(4).
           02  FILLER PICTURE X(3).
           02  HCV1TITO  PIC X(33).
           02  FILLER PICTURE X(3).
           02  HCV1PNOO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCV1FNAO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCV1LNAO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCV1DATEO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCV1TIMEO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCV1HRATEO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCV1HRTHO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCV1BLPRO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCV1BPTHO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCV1MSGO  PIC X(40).
       01  HCT1MAPI.
           02  FILLER PIC X(12).
           02  HCT1TRNL    COMP  PIC  S9(4).
           02  HCT1TRNF    PICTURE X.
           02  FILLER REDEFINES HCT1TRNF.
             03 HCT1TRNA    PICTURE X.
           02  HCT1TRNI  PIC X(4).
           02  HCT1TITL    COMP  PIC  S9(4).
           02  HCT1TITF    PICTURE X.
           02  FILLER REDEFINES HCT1TITF.
             03 HCT1TITA    PICTURE X.
           02  HCT1TITI  PIC X(33).
           02  HCT1PNOL    COMP  PIC  S9(4).
           02  HCT1PNOF    PICTURE X.
           02  FILLER REDEFINES HCT1PNOF.
             03 HCT1PNOA    PICTURE X.
           02  HCT1PNOI  PIC X(10).
           02  HCT1FNAL    COMP  PIC  S9(4).
           02  HCT1FNAF    PICTURE X.
           02  FILLER REDEFINES HCT1FNAF.
             03 HCT1FNAA    PICTURE X.
           02  HCT1FNAI  PIC X(10).
           02  HCT1LNAL    COMP  PIC  S9(4).
           02  HCT1LNAF    PICTURE X.
           02  FILLER REDEFINES HCT1LNAF.
             03 HCT1LNAA    PICTURE X.
           02  HCT1LNAI  PIC X(20).
           02  HCT1HRTHL    COMP  PIC  S9(4).
           02  HCT1HRTHF    PICTURE X.
           02  FILLER REDEFINES HCT1HRTHF.
             03 HCT1HRTHA    PICTURE X.
           02  HCT1HRTHI  PIC X(10).
           02  HCT1BPTHL    COMP  PIC  S9(4).
           02  HCT1BPTHF    PICTURE X.
           02  FILLER REDEFINES HCT1BPTHF.
             03 HCT1BPTHA    PICTURE X.
           02  HCT1BPTHI  PIC X(10).
           02  HCT1MSGL    COMP  PIC  S9(4).
           02  HCT1MSGF    PICTURE X.
           02  FILLER REDEFINES HCT1MSGF.
             03 HCT1MSGA    PICTURE X.
           02  HCT1MSGI  PIC X(40).
       01  HCT1MAPO REDEFINES HCT1MAPI.
           02  FILLER PIC X(12).
           02  FILLER PICTURE X(3).
           02  HCT1TRNO  PIC X(4).
           02  FILLER PICTURE X(3).
           02  HCT1TITO  PIC X(33).
           02  FILLER PICTURE X(3).
           02  HCT1PNOO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCT1FNAO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCT1LNAO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCT1HRTHO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCT1BPTHO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCT1MSGO  PIC X(40).
       01 COMM-AREA.
           03 CA-REQUEST-ID            PIC X(6).
           03 CA-RETURN-CODE           PIC 9(2).
           03 CA-PATIENT-ID            PIC 9(10).
           03 CA-REQUEST-SPECIFIC      PIC X(32482).
           03 CA-PATIENT-REQUEST REDEFINES CA-REQUEST-SPECIFIC.
              05 CA-INS-CARD-NUM       PIC X(10).
              05 CA-FIRST-NAME         PIC X(10).
              05 CA-LAST-NAME          PIC X(20).
              05 CA-DOB                PIC X(10).
              05 CA-ADDRESS            PIC X(20).
              05 CA-CITY               PIC X(20).
              05 CA-POSTCODE           PIC X(10).
              05 CA-PHONE-MOBILE       PIC X(20).
              05 CA-EMAIL-ADDRESS      PIC X(50).
              05 CA-USERID             PIC X(10).
              05 CA-ADDITIONAL-DATA    PIC X(32302).
           03 CA-PATIENT-USER-REQUEST REDEFINES CA-REQUEST-SPECIFIC.
              05 CA-USERNAME           PIC X(10).
              05 CA-USERPASSWORD       PIC X(14).
              05 CA-ADDITIONAL-DATA    PIC X(32458).
           03 CA-MEDICATION-REQUEST REDEFINES CA-REQUEST-SPECIFIC.
              05 CA-DRUG-NAME          PIC X(50).
              05 CA-STRENGTH           PIC X(20).
              05 CA-AMOUNT             PIC 9(03).
              05 CA-ROUTE              PIC X(20).
              05 CA-FREQUENCY          PIC X(20).
              05 CA-IDENTIFIER         PIC X(20).
              05 CA-BIOMED-TYPE        PIC X(2).
              05 CA-START-DATE         PIC X(10).
              05 CA-END-DATE           PIC X(10).
              05 CA-PRESCRIPTION-ID    PIC 9(10).
              05 CA-ADDITIONAL-DATA    PIC X(32317).
           03 CA-MEDITATION-REQUEST REDEFINES CA-REQUEST-SPECIFIC.
              05 CA-MEDITATION-NAME    PIC X(50).
              05 CA-MEDITATION-TYPE    PIC X(20).
              05 CA-RELIEF             PIC X(20).
              05 CA-POSTURE            PIC X(20).
              05 CA-HOW-OFTEN          PIC X(20).
              05 CA-ADDITIONAL-DATA    PIC X(32352).
           03 CA-THRESHOLD-REQUEST REDEFINES CA-REQUEST-SPECIFIC.
              05 CA-HR-THRESHOLD       PIC X(10).
              05 CA-BP-THRESHOLD       PIC X(10).
              05 CA-MS-THRESHOLD       PIC X(10).
              05 CA-ADDITIONAL-DATA    PIC X(32452).
           03 CA-VISIT-REQUEST REDEFINES CA-REQUEST-SPECIFIC.
              05 CA-VISIT-DATE         PIC X(10).
              05 CA-VISIT-TIME         PIC X(10).
              05 CA-HEART-RATE         PIC X(10).
              05 CA-BLOOD-PRESSURE     PIC X(10).
              05 CA-MENTAL-STATE       PIC X(10).
              05 CA-ADDITIONAL-DATA    PIC X(32432).
       PROCEDURE DIVISION.
       MAINLINE.
           IF EIBCALEN > 0
              GO TO A-GAIN.
           Initialize HCP1MAPI.
           Initialize HCP1MAPO.
           Initialize COMM-AREA.
           MOVE LOW-VALUES To HCP1PNOO
           MOVE -1 TO HCP1PNOL
           IF EIBTRNID EQUAL ADD-TRANS
              MOVE 0 TO HCP1PNOA
              MOVE -1 TO HCP1FNAL
           END-IF
           PERFORM SETUP-SCREEN.
           EXEC CICS SEND MAP ('HCP1MAP')
                     FROM(HCP1MAPO)
                     MAPSET ('HCMAPS')
                     ERASE
                     CURSOR
                     RESP(WS-RESP)
                     END-EXEC.
       A-GAIN.
           EXEC CICS HANDLE AID
                     CLEAR(CLEARIT)
                     PF3(ENDIT)
                     PF12(CANCELIT)
                     END-EXEC.
           EXEC CICS HANDLE CONDITION
                     MAPFAIL(ENDIT)
                     END-EXEC.
           EXEC CICS RECEIVE MAP('HCP1MAP')
                     INTO(HCP1MAPI) ASIS TERMINAL
                     MAPSET('HCMAPS') END-EXEC.
           IF EIBTRNID EQUAL INQ-TRANS
                 Move '01IPAT'   To CA-REQUEST-ID
                 Move HCP1PNOI   To CA-PATIENT-ID
                 EXEC CICS LINK PROGRAM('HCP1BI01')
                           COMMAREA(COMM-AREA)
                           LENGTH(32500)
                 END-EXEC
                 IF CA-RETURN-CODE > 0
                   GO TO NO-DATA
                 END-IF
                 Move CA-FIRST-NAME to HCP1FNAO
                 Move CA-LAST-NAME  to HCP1LNAO
                 Move CA-DOB        to HCP1DOBO
                 Move CA-ADDRESS    to HCP1ADDRO
                 Move CA-CITY       to HCP1CITYO
                 Move CA-POSTCODE   to HCP1HPCO
                 Move CA-PHONE-MOBILE  to HCP1HP2O
                 Move CA-EMAIL-ADDRESS to HCP1HMOO
                 Move CA-INS-CARD-NUM to HCP1INOO
                 Move CA-USERID     to HCP1UIDO
                 EXEC CICS SEND MAP ('HCP1MAP')
                           FROM(HCP1MAPO)
                           MAPSET ('HCMAPS')
                 END-EXEC
                 GO TO ENDIT-STARTIT
             END-IF.
           IF EIBTRNID EQUAL ADD-TRANS
                 IF HCP1UIDI EQUAL SPACES or LOW-VALUES
                   GO TO USERID-REQUIRED
                 END-IF
                 Move '01APAT'   To CA-REQUEST-ID
                 Move HCP1PNOI   To CA-PATIENT-ID
                 Move HCP1FNAI   To CA-FIRST-NAME
                 Move HCP1LNAI   To CA-LAST-NAME
                 Move HCP1DOBI   To CA-DOB
                 Move HCP1ADDRI  To CA-ADDRESS
                 Move HCP1CITYI  To CA-CITY
                 Move HCP1HPCI   To CA-POSTCODE
                 Move HCP1HP2I   To CA-PHONE-MOBILE
                 Move HCP1HMOI   To CA-EMAIL-ADDRESS
                 Move HCP1INOI   to CA-INS-CARD-NUM
                 Move HCP1UIDI   to CA-USERID
                 Inspect COMM-AREA Replacing All x'00'  by x'40'
                 Move Function UPPER-CASE(CA-POSTCODE)
                      TO CA-POSTCODE
                 EXEC CICS LINK PROGRAM('HCP1BA01')
                           COMMAREA(COMM-AREA)
                           LENGTH(32500)
                 END-EXEC
                 IF CA-RETURN-CODE > 0
                   Exec CICS Syncpoint Rollback End-Exec
                   GO TO NO-ADD
                 END-IF
                 Move CA-PATIENT-ID           To HCP1PNOO
                 Move 'New Patient Inserted'  To  HCP1MSGO
                 PERFORM SETUP-SCREEN
                 EXEC CICS SEND MAP ('HCP1MAP')
                           FROM(HCP1MAPO)
                           MAPSET ('HCMAPS')
                           CURSOR
                 END-EXEC
                 GO TO ENDIT-STARTIT
             END-IF.
           EXEC CICS RETURN
           END-EXEC.
       ENDIT-STARTIT.
           EXEC CICS RETURN
                TRANSID(EIBTRNID)
                COMMAREA(COMM-AREA)
                END-EXEC.
       ENDIT.
           EXEC CICS SEND TEXT
                     FROM(MSGEND)
                     LENGTH(LENGTH OF MSGEND)
                     ERASE
                     FREEKB
           END-EXEC
           EXEC CICS RETURN
           END-EXEC.
       CLEARIT.
           Initialize HCP1MAPI.
           EXEC CICS SEND MAP ('HCP1MAP')
                     MAPSET ('HCMAPS')
                     MAPONLY
           END-EXEC
           EXEC CICS RETURN
                TRANSID(EIBTRNID)
                COMMAREA(COMM-AREA)
                END-EXEC.
       CANCELIT.
           EXEC CICS RETURN
                TRANSID('HCAZ')
                IMMEDIATE
                END-EXEC.
       SETUP-SCREEN.
           IF EIBTRNID EQUAL INQ-TRANS
              MOVE INQ-TRANS TO HCP1TRNO
              MOVE 'Inquire Patient Information' to HCP1TITO
           ELSE
           IF EIBTRNID EQUAL ADD-TRANS
              MOVE ADD-TRANS TO HCP1TRNO
              MOVE 'Add Patient Information' to HCP1TITO
           END-IF.
       USERID-REQUIRED.
           Move 'User Id is Required'          To  HCP1MSGO.
           Move -1 To HCP1UIDL.
           Go To ERROR-OUT.
       NO-UPD.
           MOVE -1 TO HCP1FNAL
           Move 'Error Updating Patient'          To  HCP1MSGO.
           Go To ERROR-OUT.
       NO-ADD.
           MOVE -1 TO HCP1FNAL
           Move 'Error Adding Patient'            To  HCP1MSGO.
           Go To ERROR-OUT.
       NO-DATA.
           Move SPACES to HCP1FNAO
                          HCP1LNAO
                          HCP1DOBO
                          HCP1ADDRO
                          HCP1CITYO
                          HCP1HPCO
                          HCP1HP2O
                          HCP1HMOO
                          HCP1INOO
                          HCP1UIDO
           MOVE -1 TO HCP1PNOL
           Move 'No data was returned.'            To  HCP1MSGO.
           Go To ERROR-OUT.
       ERROR-OUT.
           PERFORM SETUP-SCREEN.
           EXEC CICS SEND MAP ('HCP1MAP')
                     FROM(HCP1MAPO)
                     MAPSET ('HCMAPS')
                     CURSOR
           END-EXEC.
           Initialize HCP1MAPI.
           Initialize HCP1MAPO.
           Initialize COMM-AREA.
           GO TO ENDIT-STARTIT.","       WORKING-STORAGE SECTION.
       77 INQ-TRANS                    PIC X(4) VALUE 'HCP1'.
       77 ADD-TRANS                    PIC X(4) VALUE 'HCPA'.
       77 MSGEND                       PIC X(24) VALUE
                                        'Transaction ended      '.
       01  WS-RESP                   PIC S9(8) COMP.
       01  HCZMENUI.
           02  FILLER PIC X(12).
           02  HCZINPUTL    COMP  PIC  S9(4).
           02  HCZINPUTF    PICTURE X.
           02  FILLER REDEFINES HCZINPUTF.
             03 HCZINPUTA    PICTURE X.
           02  HCZINPUTI  PIC X(1).
           02  HCZMSGL    COMP  PIC  S9(4).
           02  HCZMSGF    PICTURE X.
           02  FILLER REDEFINES HCZMSGF.
             03 HCZMSGA    PICTURE X.
           02  HCZMSGI  PIC X(49).
       01  HCZMENUO REDEFINES HCZMENUI.
           02  FILLER PIC X(12).
           02  FILLER PICTURE X(3).
           02  HCZINPUTO  PIC X(1).
           02  FILLER PICTURE X(3).
           02  HCZMSGO  PIC X(49).
       01  HCP1MAPI.
           02  FILLER PIC X(12).
           02  HCP1TRNL    COMP  PIC  S9(4).
           02  HCP1TRNF    PICTURE X.
           02  FILLER REDEFINES HCP1TRNF.
             03 HCP1TRNA    PICTURE X.
           02  HCP1TRNI  PIC X(4).
           02  HCP1TITL    COMP  PIC  S9(4).
           02  HCP1TITF    PICTURE X.
           02  FILLER REDEFINES HCP1TITF.
             03 HCP1TITA    PICTURE X.
           02  HCP1TITI  PIC X(27).
           02  HCP1PNOL    COMP  PIC  S9(4).
           02  HCP1PNOF    PICTURE X.
           02  FILLER REDEFINES HCP1PNOF.
             03 HCP1PNOA    PICTURE X.
           02  HCP1PNOI  PIC X(10).
           02  HCP1FNAL    COMP  PIC  S9(4).
           02  HCP1FNAF    PICTURE X.
           02  FILLER REDEFINES HCP1FNAF.
             03 HCP1FNAA    PICTURE X.
           02  HCP1FNAI  PIC X(10).
           02  HCP1LNAL    COMP  PIC  S9(4).
           02  HCP1LNAF    PICTURE X.
           02  FILLER REDEFINES HCP1LNAF.
             03 HCP1LNAA    PICTURE X.
           02  HCP1LNAI  PIC X(20).
           02  HCP1DOBL    COMP  PIC  S9(4).
           02  HCP1DOBF    PICTURE X.
           02  FILLER REDEFINES HCP1DOBF.
             03 HCP1DOBA    PICTURE X.
           02  HCP1DOBI  PIC X(10).
           02  HCP1ADDRL    COMP  PIC  S9(4).
           02  HCP1ADDRF    PICTURE X.
           02  FILLER REDEFINES HCP1ADDRF.
             03 HCP1ADDRA    PICTURE X.
           02  HCP1ADDRI  PIC X(20).
           02  HCP1CITYL    COMP  PIC  S9(4).
           02  HCP1CITYF    PICTURE X.
           02  FILLER REDEFINES HCP1CITYF.
             03 HCP1CITYA    PICTURE X.
           02  HCP1CITYI  PIC X(20).
           02  HCP1HPCL    COMP  PIC  S9(4).
           02  HCP1HPCF    PICTURE X.
           02  FILLER REDEFINES HCP1HPCF.
             03 HCP1HPCA    PICTURE X.
           02  HCP1HPCI  PIC X(10).
           02  HCP1HP2L    COMP  PIC  S9(4).
           02  HCP1HP2F    PICTURE X.
           02  FILLER REDEFINES HCP1HP2F.
             03 HCP1HP2A    PICTURE X.
           02  HCP1HP2I  PIC X(20).
           02  HCP1HMOL    COMP  PIC  S9(4).
           02  HCP1HMOF    PICTURE X.
           02  FILLER REDEFINES HCP1HMOF.
             03 HCP1HMOA    PICTURE X.
           02  HCP1HMOI  PIC X(30).
           02  HCP1INOL    COMP  PIC  S9(4).
           02  HCP1INOF    PICTURE X.
           02  FILLER REDEFINES HCP1INOF.
             03 HCP1INOA    PICTURE X.
           02  HCP1INOI  PIC X(10).
           02  HCP1UIDL    COMP  PIC  S9(4).
           02  HCP1UIDF    PICTURE X.
           02  FILLER REDEFINES HCP1UIDF.
             03 HCP1UIDA    PICTURE X.
           02  HCP1UIDI  PIC X(10).
           02  HCP1MSGL    COMP  PIC  S9(4).
           02  HCP1MSGF    PICTURE X.
           02  FILLER REDEFINES HCP1MSGF.
             03 HCP1MSGA    PICTURE X.
           02  HCP1MSGI  PIC X(40).
       01  HCP1MAPO REDEFINES HCP1MAPI.
           02  FILLER PIC X(12).
           02  FILLER PICTURE X(3).
           02  HCP1TRNO  PIC X(4).
           02  FILLER PICTURE X(3).
           02  HCP1TITO  PIC X(27).
           02  FILLER PICTURE X(3).
           02  HCP1PNOO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCP1FNAO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCP1LNAO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCP1DOBO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCP1ADDRO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCP1CITYO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCP1HPCO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCP1HP2O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCP1HMOO  PIC X(30).
           02  FILLER PICTURE X(3).
           02  HCP1INOO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCP1UIDO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCP1MSGO  PIC X(40).
       01  HCM1MAPI.
           02  FILLER PIC X(12).
           02  HCM1CNOL    COMP  PIC  S9(4).
           02  HCM1CNOF    PICTURE X.
           02  FILLER REDEFINES HCM1CNOF.
             03 HCM1CNOA    PICTURE X.
           02  HCM1CNOI  PIC X(10).
           02  HCM1FNAL    COMP  PIC  S9(4).
           02  HCM1FNAF    PICTURE X.
           02  FILLER REDEFINES HCM1FNAF.
             03 HCM1FNAA    PICTURE X.
           02  HCM1FNAI  PIC X(10).
           02  HCM1LNAL    COMP  PIC  S9(4).
           02  HCM1LNAF    PICTURE X.
           02  FILLER REDEFINES HCM1LNAF.
             03 HCM1LNAA    PICTURE X.
           02  HCM1LNAI  PIC X(20).
           02  HCM1DNA1L    COMP  PIC  S9(4).
           02  HCM1DNA1F    PICTURE X.
           02  FILLER REDEFINES HCM1DNA1F.
             03 HCM1DNA1A    PICTURE X.
           02  HCM1DNA1I  PIC X(27).
           02  HCM1DST1L    COMP  PIC  S9(4).
           02  HCM1DST1F    PICTURE X.
           02  FILLER REDEFINES HCM1DST1F.
             03 HCM1DST1A    PICTURE X.
           02  HCM1DST1I  PIC X(20).
           02  HCM1DAM1L    COMP  PIC  S9(4).
           02  HCM1DAM1F    PICTURE X.
           02  FILLER REDEFINES HCM1DAM1F.
             03 HCM1DAM1A    PICTURE X.
           02  HCM1DAM1I  PIC X(5).
           02  HCM1DRO1L    COMP  PIC  S9(4).
           02  HCM1DRO1F    PICTURE X.
           02  FILLER REDEFINES HCM1DRO1F.
             03 HCM1DRO1A    PICTURE X.
           02  HCM1DRO1I  PIC X(20).
           02  HCM1DFR1L    COMP  PIC  S9(4).
           02  HCM1DFR1F    PICTURE X.
           02  FILLER REDEFINES HCM1DFR1F.
             03 HCM1DFR1A    PICTURE X.
           02  HCM1DFR1I  PIC X(20).
           02  HCM1DNA2L    COMP  PIC  S9(4).
           02  HCM1DNA2F    PICTURE X.
           02  FILLER REDEFINES HCM1DNA2F.
             03 HCM1DNA2A    PICTURE X.
           02  HCM1DNA2I  PIC X(27).
           02  HCM1DST2L    COMP  PIC  S9(4).
           02  HCM1DST2F    PICTURE X.
           02  FILLER REDEFINES HCM1DST2F.
             03 HCM1DST2A    PICTURE X.
           02  HCM1DST2I  PIC X(20).
           02  HCM1DAM2L    COMP  PIC  S9(4).
           02  HCM1DAM2F    PICTURE X.
           02  FILLER REDEFINES HCM1DAM2F.
             03 HCM1DAM2A    PICTURE X.
           02  HCM1DAM2I  PIC X(5).
           02  HCM1DRO2L    COMP  PIC  S9(4).
           02  HCM1DRO2F    PICTURE X.
           02  FILLER REDEFINES HCM1DRO2F.
             03 HCM1DRO2A    PICTURE X.
           02  HCM1DRO2I  PIC X(20).
           02  HCM1DFR2L    COMP  PIC  S9(4).
           02  HCM1DFR2F    PICTURE X.
           02  FILLER REDEFINES HCM1DFR2F.
             03 HCM1DFR2A    PICTURE X.
           02  HCM1DFR2I  PIC X(20).
           02  HCM1DNA3L    COMP  PIC  S9(4).
           02  HCM1DNA3F    PICTURE X.
           02  FILLER REDEFINES HCM1DNA3F.
             03 HCM1DNA3A    PICTURE X.
           02  HCM1DNA3I  PIC X(27).
           02  HCM1DST3L    COMP  PIC  S9(4).
           02  HCM1DST3F    PICTURE X.
           02  FILLER REDEFINES HCM1DST3F.
             03 HCM1DST3A    PICTURE X.
           02  HCM1DST3I  PIC X(20).
           02  HCM1DAM3L    COMP  PIC  S9(4).
           02  HCM1DAM3F    PICTURE X.
           02  FILLER REDEFINES HCM1DAM3F.
             03 HCM1DAM3A    PICTURE X.
           02  HCM1DAM3I  PIC X(5).
           02  HCM1DRO3L    COMP  PIC  S9(4).
           02  HCM1DRO3F    PICTURE X.
           02  FILLER REDEFINES HCM1DRO3F.
             03 HCM1DRO3A    PICTURE X.
           02  HCM1DRO3I  PIC X(20).
           02  HCM1DFR3L    COMP  PIC  S9(4).
           02  HCM1DFR3F    PICTURE X.
           02  FILLER REDEFINES HCM1DFR3F.
             03 HCM1DFR3A    PICTURE X.
           02  HCM1DFR3I  PIC X(20).
           02  HCM1MSGL    COMP  PIC  S9(4).
           02  HCM1MSGF    PICTURE X.
           02  FILLER REDEFINES HCM1MSGF.
             03 HCM1MSGA    PICTURE X.
           02  HCM1MSGI  PIC X(43).
       01  HCM1MAPO REDEFINES HCM1MAPI.
           02  FILLER PIC X(12).
           02  FILLER PICTURE X(3).
           02  HCM1CNOO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCM1FNAO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCM1LNAO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1DNA1O  PIC X(27).
           02  FILLER PICTURE X(3).
           02  HCM1DST1O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1DAM1O  PIC X(5).
           02  FILLER PICTURE X(3).
           02  HCM1DRO1O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1DFR1O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1DNA2O  PIC X(27).
           02  FILLER PICTURE X(3).
           02  HCM1DST2O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1DAM2O  PIC X(5).
           02  FILLER PICTURE X(3).
           02  HCM1DRO2O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1DFR2O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1DNA3O  PIC X(27).
           02  FILLER PICTURE X(3).
           02  HCM1DST3O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1DAM3O  PIC X(5).
           02  FILLER PICTURE X(3).
           02  HCM1DRO3O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1DFR3O  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCM1MSGO  PIC X(43).
       01  HCMAMAPI.
           02  FILLER PIC X(12).
           02  HCMACNOL    COMP  PIC  S9(4).
           02  HCMACNOF    PICTURE X.
           02  FILLER REDEFINES HCMACNOF.
             03 HCMACNOA    PICTURE X.
           02  HCMACNOI  PIC X(10).
           02  HCMAFNAL    COMP  PIC  S9(4).
           02  HCMAFNAF    PICTURE X.
           02  FILLER REDEFINES HCMAFNAF.
             03 HCMAFNAA    PICTURE X.
           02  HCMAFNAI  PIC X(10).
           02  HCMALNAL    COMP  PIC  S9(4).
           02  HCMALNAF    PICTURE X.
           02  FILLER REDEFINES HCMALNAF.
             03 HCMALNAA    PICTURE X.
           02  HCMALNAI  PIC X(20).
           02  HCMADNAML    COMP  PIC  S9(4).
           02  HCMADNAMF    PICTURE X.
           02  FILLER REDEFINES HCMADNAMF.
             03 HCMADNAMA    PICTURE X.
           02  HCMADNAMI  PIC X(27).
           02  HCMADSTRL    COMP  PIC  S9(4).
           02  HCMADSTRF    PICTURE X.
           02  FILLER REDEFINES HCMADSTRF.
             03 HCMADSTRA    PICTURE X.
           02  HCMADSTRI  PIC X(20).
           02  HCMADAMOL    COMP  PIC  S9(4).
           02  HCMADAMOF    PICTURE X.
           02  FILLER REDEFINES HCMADAMOF.
             03 HCMADAMOA    PICTURE X.
           02  HCMADAMOI  PIC X(5).
           02  HCMADROUL    COMP  PIC  S9(4).
           02  HCMADROUF    PICTURE X.
           02  FILLER REDEFINES HCMADROUF.
             03 HCMADROUA    PICTURE X.
           02  HCMADROUI  PIC X(20).
           02  HCMADFREL    COMP  PIC  S9(4).
           02  HCMADFREF    PICTURE X.
           02  FILLER REDEFINES HCMADFREF.
             03 HCMADFREA    PICTURE X.
           02  HCMADFREI  PIC X(2).
           02  HCMAIDENL    COMP  PIC  S9(4).
           02  HCMAIDENF    PICTURE X.
           02  FILLER REDEFINES HCMAIDENF.
             03 HCMAIDENA    PICTURE X.
           02  HCMAIDENI  PIC X(20).
           02  HCMATYPEL    COMP  PIC  S9(4).
           02  HCMATYPEF    PICTURE X.
           02  FILLER REDEFINES HCMATYPEF.
             03 HCMATYPEA    PICTURE X.
           02  HCMATYPEI  PIC X(2).
           02  HCMASDTAL    COMP  PIC  S9(4).
           02  HCMASDTAF    PICTURE X.
           02  FILLER REDEFINES HCMASDTAF.
             03 HCMASDTAA    PICTURE X.
           02  HCMASDTAI  PIC X(10).
           02  HCMAEDTAL    COMP  PIC  S9(4).
           02  HCMAEDTAF    PICTURE X.
           02  FILLER REDEFINES HCMAEDTAF.
             03 HCMAEDTAA    PICTURE X.
           02  HCMAEDTAI  PIC X(10).
           02  HCMAMSGL    COMP  PIC  S9(4).
           02  HCMAMSGF    PICTURE X.
           02  FILLER REDEFINES HCMAMSGF.
             03 HCMAMSGA    PICTURE X.
           02  HCMAMSGI  PIC X(40).
       01  HCMAMAPO REDEFINES HCMAMAPI.
           02  FILLER PIC X(12).
           02  FILLER PICTURE X(3).
           02  HCMACNOO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCMAFNAO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCMALNAO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCMADNAMO  PIC X(27).
           02  FILLER PICTURE X(3).
           02  HCMADSTRO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCMADAMOO  PIC X(5).
           02  FILLER PICTURE X(3).
           02  HCMADROUO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCMADFREO  PIC X(2).
           02  FILLER PICTURE X(3).
           02  HCMAIDENO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCMATYPEO  PIC X(2).
           02  FILLER PICTURE X(3).
           02  HCMASDTAO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCMAEDTAO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCMAMSGO  PIC X(40).
       01  HCV1MAPI.
           02  FILLER PIC X(12).
           02  HCV1TRNL    COMP  PIC  S9(4).
           02  HCV1TRNF    PICTURE X.
           02  FILLER REDEFINES HCV1TRNF.
             03 HCV1TRNA    PICTURE X.
           02  HCV1TRNI  PIC X(4).
           02  HCV1TITL    COMP  PIC  S9(4).
           02  HCV1TITF    PICTURE X.
           02  FILLER REDEFINES HCV1TITF.
             03 HCV1TITA    PICTURE X.
           02  HCV1TITI  PIC X(33).
           02  HCV1PNOL    COMP  PIC  S9(4).
           02  HCV1PNOF    PICTURE X.
           02  FILLER REDEFINES HCV1PNOF.
             03 HCV1PNOA    PICTURE X.
           02  HCV1PNOI  PIC X(10).
           02  HCV1FNAL    COMP  PIC  S9(4).
           02  HCV1FNAF    PICTURE X.
           02  FILLER REDEFINES HCV1FNAF.
             03 HCV1FNAA    PICTURE X.
           02  HCV1FNAI  PIC X(10).
           02  HCV1LNAL    COMP  PIC  S9(4).
           02  HCV1LNAF    PICTURE X.
           02  FILLER REDEFINES HCV1LNAF.
             03 HCV1LNAA    PICTURE X.
           02  HCV1LNAI  PIC X(20).
           02  HCV1DATEL    COMP  PIC  S9(4).
           02  HCV1DATEF    PICTURE X.
           02  FILLER REDEFINES HCV1DATEF.
             03 HCV1DATEA    PICTURE X.
           02  HCV1DATEI  PIC X(10).
           02  HCV1TIMEL    COMP  PIC  S9(4).
           02  HCV1TIMEF    PICTURE X.
           02  FILLER REDEFINES HCV1TIMEF.
             03 HCV1TIMEA    PICTURE X.
           02  HCV1TIMEI  PIC X(10).
           02  HCV1HRATEL    COMP  PIC  S9(4).
           02  HCV1HRATEF    PICTURE X.
           02  FILLER REDEFINES HCV1HRATEF.
             03 HCV1HRATEA    PICTURE X.
           02  HCV1HRATEI  PIC X(20).
           02  HCV1HRTHL    COMP  PIC  S9(4).
           02  HCV1HRTHF    PICTURE X.
           02  FILLER REDEFINES HCV1HRTHF.
             03 HCV1HRTHA    PICTURE X.
           02  HCV1HRTHI  PIC X(10).
           02  HCV1BLPRL    COMP  PIC  S9(4).
           02  HCV1BLPRF    PICTURE X.
           02  FILLER REDEFINES HCV1BLPRF.
             03 HCV1BLPRA    PICTURE X.
           02  HCV1BLPRI  PIC X(20).
           02  HCV1BPTHL    COMP  PIC  S9(4).
           02  HCV1BPTHF    PICTURE X.
           02  FILLER REDEFINES HCV1BPTHF.
             03 HCV1BPTHA    PICTURE X.
           02  HCV1BPTHI  PIC X(10).
           02  HCV1MSGL    COMP  PIC  S9(4).
           02  HCV1MSGF    PICTURE X.
           02  FILLER REDEFINES HCV1MSGF.
             03 HCV1MSGA    PICTURE X.
           02  HCV1MSGI  PIC X(40).
       01  HCV1MAPO REDEFINES HCV1MAPI.
           02  FILLER PIC X(12).
           02  FILLER PICTURE X(3).
           02  HCV1TRNO  PIC X(4).
           02  FILLER PICTURE X(3).
           02  HCV1TITO  PIC X(33).
           02  FILLER PICTURE X(3).
           02  HCV1PNOO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCV1FNAO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCV1LNAO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCV1DATEO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCV1TIMEO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCV1HRATEO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCV1HRTHO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCV1BLPRO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCV1BPTHO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCV1MSGO  PIC X(40).
       01  HCT1MAPI.
           02  FILLER PIC X(12).
           02  HCT1TRNL    COMP  PIC  S9(4).
           02  HCT1TRNF    PICTURE X.
           02  FILLER REDEFINES HCT1TRNF.
             03 HCT1TRNA    PICTURE X.
           02  HCT1TRNI  PIC X(4).
           02  HCT1TITL    COMP  PIC  S9(4).
           02  HCT1TITF    PICTURE X.
           02  FILLER REDEFINES HCT1TITF.
             03 HCT1TITA    PICTURE X.
           02  HCT1TITI  PIC X(33).
           02  HCT1PNOL    COMP  PIC  S9(4).
           02  HCT1PNOF    PICTURE X.
           02  FILLER REDEFINES HCT1PNOF.
             03 HCT1PNOA    PICTURE X.
           02  HCT1PNOI  PIC X(10).
           02  HCT1FNAL    COMP  PIC  S9(4).
           02  HCT1FNAF    PICTURE X.
           02  FILLER REDEFINES HCT1FNAF.
             03 HCT1FNAA    PICTURE X.
           02  HCT1FNAI  PIC X(10).
           02  HCT1LNAL    COMP  PIC  S9(4).
           02  HCT1LNAF    PICTURE X.
           02  FILLER REDEFINES HCT1LNAF.
             03 HCT1LNAA    PICTURE X.
           02  HCT1LNAI  PIC X(20).
           02  HCT1HRTHL    COMP  PIC  S9(4).
           02  HCT1HRTHF    PICTURE X.
           02  FILLER REDEFINES HCT1HRTHF.
             03 HCT1HRTHA    PICTURE X.
           02  HCT1HRTHI  PIC X(10).
           02  HCT1BPTHL    COMP  PIC  S9(4).
           02  HCT1BPTHF    PICTURE X.
           02  FILLER REDEFINES HCT1BPTHF.
             03 HCT1BPTHA    PICTURE X.
           02  HCT1BPTHI  PIC X(10).
           02  HCT1MSGL    COMP  PIC  S9(4).
           02  HCT1MSGF    PICTURE X.
           02  FILLER REDEFINES HCT1MSGF.
             03 HCT1MSGA    PICTURE X.
           02  HCT1MSGI  PIC X(40).
       01  HCT1MAPO REDEFINES HCT1MAPI.
           02  FILLER PIC X(12).
           02  FILLER PICTURE X(3).
           02  HCT1TRNO  PIC X(4).
           02  FILLER PICTURE X(3).
           02  HCT1TITO  PIC X(33).
           02  FILLER PICTURE X(3).
           02  HCT1PNOO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCT1FNAO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCT1LNAO  PIC X(20).
           02  FILLER PICTURE X(3).
           02  HCT1HRTHO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCT1BPTHO  PIC X(10).
           02  FILLER PICTURE X(3).
           02  HCT1MSGO  PIC X(40).
       01 COMM-AREA.
           03 CA-REQUEST-ID            PIC X(6).
           03 CA-RETURN-CODE           PIC 9(2).
           03 CA-PATIENT-ID            PIC 9(10).
           03 CA-REQUEST-SPECIFIC      PIC X(32482).
           03 CA-PATIENT-REQUEST REDEFINES CA-REQUEST-SPECIFIC.
              05 CA-INS-CARD-NUM       PIC X(10).
              05 CA-FIRST-NAME         PIC X(10).
              05 CA-LAST-NAME          PIC X(20).
              05 CA-DOB                PIC X(10).
              05 CA-ADDRESS            PIC X(20).
              05 CA-CITY               PIC X(20).
              05 CA-POSTCODE           PIC X(10).
              05 CA-PHONE-MOBILE       PIC X(20).
              05 CA-EMAIL-ADDRESS      PIC X(50).
              05 CA-USERID             PIC X(10).
              05 CA-ADDITIONAL-DATA    PIC X(32302).
           03 CA-PATIENT-USER-REQUEST REDEFINES CA-REQUEST-SPECIFIC.
              05 CA-USERNAME           PIC X(10).
              05 CA-USERPASSWORD       PIC X(14).
              05 CA-ADDITIONAL-DATA    PIC X(32458).
           03 CA-MEDICATION-REQUEST REDEFINES CA-REQUEST-SPECIFIC.
              05 CA-DRUG-NAME          PIC X(50).
              05 CA-STRENGTH           PIC X(20).
              05 CA-AMOUNT             PIC 9(03).
              05 CA-ROUTE              PIC X(20).
              05 CA-FREQUENCY          PIC X(20).
              05 CA-IDENTIFIER         PIC X(20).
              05 CA-BIOMED-TYPE        PIC X(2).
              05 CA-START-DATE         PIC X(10).
              05 CA-END-DATE           PIC X(10).
              05 CA-PRESCRIPTION-ID    PIC 9(10).
              05 CA-ADDITIONAL-DATA    PIC X(32317).
           03 CA-MEDITATION-REQUEST REDEFINES CA-REQUEST-SPECIFIC.
              05 CA-MEDITATION-NAME    PIC X(50).
              05 CA-MEDITATION-TYPE    PIC X(20).
              05 CA-RELIEF             PIC X(20).
              05 CA-POSTURE            PIC X(20).
              05 CA-HOW-OFTEN          PIC X(20).
              05 CA-ADDITIONAL-DATA    PIC X(32352).
           03 CA-THRESHOLD-REQUEST REDEFINES CA-REQUEST-SPECIFIC.
              05 CA-HR-THRESHOLD       PIC X(10).
              05 CA-BP-THRESHOLD       PIC X(10).
              05 CA-MS-THRESHOLD       PIC X(10).
              05 CA-ADDITIONAL-DATA    PIC X(32452).
           03 CA-VISIT-REQUEST REDEFINES CA-REQUEST-SPECIFIC.
              05 CA-VISIT-DATE         PIC X(10).
              05 CA-VISIT-TIME         PIC X(10).
              05 CA-HEART-RATE         PIC X(10).
              05 CA-BLOOD-PRESSURE     PIC X(10).
              05 CA-MENTAL-STATE       PIC X(10).
              05 CA-ADDITIONAL-DATA    PIC X(32432).
","['MAINLINE', 'A-GAIN', 'ENDIT-STARTIT', 'ENDIT', 'CLEARIT', 'CANCELIT', 'SETUP-SCREEN', 'USERID-REQUIRED', 'NO-UPD', 'NO-ADD', 'NO-DATA', 'ERROR-OUT']","Paragraph MAINLINE calls paragraph A-GAIN, SETUP-SCREEN.
Paragraph A-GAIN calls paragraph USERID-REQUIRED, NO-DATA, NO-ADD, SETUP-SCREEN, ENDIT-STARTIT.
Paragraph USERID-REQUIRED calls paragraph ERROR-OUT.
Paragraph NO-UPD calls paragraph ERROR-OUT.
Paragraph NO-ADD calls paragraph ERROR-OUT.
Paragraph NO-DATA calls paragraph ERROR-OUT.
Paragraph ERROR-OUT calls paragraph ENDIT-STARTIT, SETUP-SCREEN.
",736,Patient menu: Menu for Patient transactions,"['HCP1BA01', 'HCP1BI01']",,,Error Long,1,1,1,"This COBOL file processes patient transactions within a CICS environment, starting with checks for transaction types in MAINLINE, which calls A-GAIN to handle data retrieval or additions. A series of conditional checks validate user IDs and handle errors. The system displays appropriate messages using the SETUP-SCREEN and ERROR-OUT paragraphs, ensuring user guidance. Finally, ENDIT-STARTIT manages transaction closure, maintaining system integrity through returns and alerts, streamlining the patient data management process.",
87,shamrice_COBOL-Roguelike,X-COBOL/X-COBOL/COBOL_Files/shamrice_COBOL-Roguelike/crl_editor.cbl,"       identification division.
       program-id. cobol-roguelike-editor.
       environment division.
       configuration section.
           special-names.
               crt status is ws-crt-status.
               cursor is ws-mouse-position.
       input-output section.
       file-control.
       data division.
       file section.
       working-storage section.
       01  ws-map-files.  
           05  ws-map-name             pic x(15) value ""VOIDSPACE"".
           05  ws-map-name-temp        pic x(15) value ""VOIDSPACE"".           
           05  ws-map-dat-file         pic x(15).               
           05  ws-map-tel-file         pic x(15).
           05  ws-map-enemy-file       pic x(15).
           05  ws-map-item-file        pic x(15).
       01  ws-map-file-statuses.
           05  ws-map-file-status      pic xx.
           05  ws-teleport-file-status pic xx.
           05  ws-enemy-file-status    pic xx.
           05  ws-item-file-status     pic xx.
       01  black                          constant as 0.
       01  blue                           constant as 1.
       01  green                          constant as 2.
       01  cyan                           constant as 3.
       01  red                            constant as 4.
       01  magenta                        constant as 5.
       01  yellow                         constant as 6.  
       01  white                          constant as 7.
       78  ws-no-tile-effect-id           value 0.    
       78  ws-teleport-effect-id          value 1.
       78  ws-conveyor-right-effect-id    value 2.
       78  ws-conveyor-down-effect-id     value 3.
       78  ws-conveyor-left-effect-id     value 4.
       78  ws-conveyor-up-effect-id       value 5.
       78  ws-conveyor-reverse-effect-id  value 6.
       78  ws-player-start-effect-id      value 98.
       78  ws-load-map-tele-return-code   value 1.
       78  ws-max-view-height             value 20.
       78  ws-max-view-width              value 50.
       78  ws-max-map-height              value 25.
       78  ws-max-map-width               value 80.
       78  ws-max-num-enemies             value 99.      
       78  ws-max-num-teleports           value 999.
       78  ws-max-num-items               value 999.
       78  ws-file-status-ok              value ""00"".
       78  ws-file-status-eof             value ""10"".
       78  ws-load-status-fail            value 9.
       78  ws-load-status-read-fail       value 8.
       78  ws-load-status-bad-data        value 7.
       78  ws-load-status-success         value 0.       
       78  ws-save-status-fail            value 9.
       78  ws-save-status-success         value 0.
       78  ws-data-file-ext               value "".DAT"".
       78  ws-teleport-file-ext           value "".TEL"".
       78  ws-enemy-file-ext              value "".BGS"".
       78  ws-item-file-ext               value "".ITM"".
       01  ws-enemy-data.
           05  ws-cur-num-enemies           pic 99 comp value 0.
           05  ws-enemy             occurs 0 to ws-max-num-enemies times
                                    depending on ws-cur-num-enemies.
               10  ws-enemy-name           pic x(16) value 'NONAME'.
               10  ws-enemy-hp.
                   15  ws-enemy-hp-total    pic 999 comp value 10.
                   15  ws-enemy-hp-current  pic 999 comp value 10.
               10  ws-enemy-attack-damage   pic 999 comp value 1.
               10  ws-enemy-pos.
                   15  ws-enemy-y           pic 99.
                   15  ws-enemy-x           pic 99.
               10  ws-enemy-color           pic 9 value 4.
               10  ws-enemy-char            pic x.
               10  ws-enemy-status              pic 9 comp value 3.
                   88  ws-enemy-status-alive    value 0.
                   88  ws-enemy-status-dead     value 1.
                   88  ws-enemy-status-attacked value 2.
                   88  ws-enemy-status-other    value 3.
               10  ws-enemy-movement-ticks.
                   15  ws-enemy-current-ticks   pic 999 comp.
                   15  ws-enemy-max-ticks       pic 999 comp.
               10  ws-enemy-exp-worth           pic 9(4) comp.
       01  ws-tile-map-table-matrix.
           05  ws-tile-map           occurs ws-max-map-height times.
               10  ws-tile-map-data   occurs ws-max-map-width times.
                   15  ws-tile-fg                   pic 9.   
                   15  ws-tile-bg                   pic 9.
                   15  ws-tile-char                 pic x.
                   15  ws-tile-highlight            pic a value 'N'.
                       88 ws-tile-is-highlight      value 'Y'.
                       88 ws-tile-not-highlight     value 'N'.
                   15  ws-tile-blocking             pic a value 'N'.
                       88  ws-tile-is-blocking      value 'Y'.
                       88  ws-tile-not-blocking     value 'N'.  
                   15  ws-tile-blinking             pic a value 'N'.
                       88  ws-tile-is-blinking      value 'Y'.
                       88  ws-tile-not-blinking     value 'N'.
                   15  ws-tile-effect-id            pic 99 comp.  
                   15  ws-tile-visibility           pic 999 comp.    
       01  ws-teleport-data.
           05  ws-cur-num-teleports        pic 999 comp.
           05  ws-teleport-data-record  occurs 0 to ws-max-num-teleports
                                      depending on ws-cur-num-teleports.
               10  ws-teleport-pos.
                   15  ws-teleport-y        pic S99.
                   15  ws-teleport-x        pic S99.
               10  ws-teleport-dest-pos.
                   15  ws-teleport-dest-y   pic S99.
                   15  ws-teleport-dest-x   pic S99.
               10  ws-teleport-dest-map     pic x(15).
       01  ws-item-data.
           05  ws-cur-num-items            pic 999 comp.
           05  ws-item-data-record         occurs 0 to ws-max-num-items
                                          depending on ws-cur-num-items.
               10  ws-item-name            pic x(16).                                          
               10  ws-item-pos.
                   15  ws-item-y           pic S99.
                   15  ws-item-x           pic S99.
               10  ws-item-taken           pic a value 'N'.
                   88  ws-item-is-taken    value 'Y'.
                   88  ws-item-not-taken   value 'N'.               
               10  ws-item-effect-id       pic 99.
               10  ws-item-worth           pic 999.
               10  ws-item-color           pic 9. 
               10  ws-item-char            pic x.
       78  ws-default-draw-visibility  value 3.
       01  ws-mouse-flags              pic 9(4).
       01  ws-crt-status.
           05  ws-crt-status-key-1     pic 99.
           05  ws-crt-status-key-2     pic 99.
       01  ws-mouse-position.
           05  ws-mouse-row            pic 99.
           05  ws-mouse-col            pic 99.
       01  ws-mouse-click-status       pic a value 'N'.
           88  ws-mouse-clicked        value 'Y'.
           88  ws-mouse-not-clicked    value 'N'.
       01  ws-temp-time                pic 9(9).
       01  ws-line-mask                   pic x(50) value spaces.
       01  ws-cursor.
           05  ws-cursor-pos.
               10  ws-cursor-pos-y        pic S99.
               10  ws-cursor-pos-x        pic S99.
           05  ws-cursor-pos-delta.               
               10  ws-cursor-pos-delta-y  pic S99. 
               10  ws-cursor-pos-delta-x  pic S99.
           05  ws-cursor-scr-pos.  
               10  ws-cursor-scr-y         pic 99 value 12.
               10  ws-cursor-scr-x         pic 99 value 20.                      
           05  ws-cursor-color            pic 9 value yellow.
           05  ws-cursor-draw-color-fg    pic 9 value black.
           05  ws-cursor-draw-color-bg    pic 9 value black.
           05  ws-cursor-draw-char        pic x value space.
           05  ws-cursor-draw-highlight   pic a value 'N'.
               88  ws-cursor-highlight    value 'Y'.
               88  ws-cursor-no-highlight value 'N'.
           05  ws-cursor-draw-blocking    pic a value 'N'.
               88  ws-cursor-blocking     value 'Y'.
               88  ws-cursor-not-block    value 'N'.
           05  ws-cursor-draw-blinking    pic a value 'N'.
               88  ws-cursor-blink        value 'Y'.
               88  ws-cursor-not-blink    value 'N'.
           05  ws-cursor-draw-visibility  pic 999 
                                       value ws-default-draw-visibility.
           05  ws-cursor-enemy-settings.
               10  ws-cursor-enemy-name    pic x(16) value 'NONAME'.
               10  ws-cursor-enemy-hp              pic 999 value 10.                       
               10  ws-cursor-enemy-attack-damage   pic 999 value 1.
               10  ws-cursor-enemy-color           pic 9 value red.                                           
               10  ws-cursor-enemy-char            pic x value ""&"". 
               10  ws-cursor-enemy-movement-ticks  pic 999 value 3.
               10  ws-cursor-enemy-exp-worth       pic 9(4) value 1.
           05  ws-cursor-teleport-settings.
               10  ws-cursor-tel-dest-y            pic 99.
               10  ws-cursor-tel-dest-x            pic 99.
               10  ws-cursor-tel-dest-map          pic x(15).    
           05  ws-cursor-draw-effect               pic 99.                   
           05  ws-cursor-type                      pic a value 'T'.
               88  ws-cursor-type-tile             value 'T'.
               88  ws-cursor-type-enemy            value 'E'.                                                      
           78  ws-cursor-char             value ""+"".
       01  ws-draw-effect-temp            pic 99.
       01  ws-kb-input                    pic x.
       01  ws-is-quit                     pic a value 'N'.
           88  ws-quit                    value 'Y'.
           88  ws-not-quit                value 'N'.
       01  ws-display-mode                     pic a value 'R'.
           88  ws-display-mode-regular         value 'R'.
           88  ws-display-mode-effects         value 'E'.
       01  ws-temp-input                pic x.
       01  ws-scr-refresh-req           pic a value 'Y'.
           88  ws-scr-refresh           value 'Y'.
           88  ws-scr-no-refresh        value 'N'.
       01  ws-counter-1                 pic 999 comp.
       01  ws-counter-2                 pic 999 comp.
       01  ws-temp-map-pos.
           05  ws-temp-map-pos-y        pic S99 value 01.
           05  ws-temp-map-pos-x        pic S99 value 01.
       01  ws-filler                    pic 9(9).
       01  ws-enemy-placed-found        pic a value 'N'.
           88  ws-enemy-found           value 'Y'.
           88  ws-enemy-not-found       value 'N'.
       01  ws-enemy-found-idx           pic 99 comp.
       01  ws-replace-enemy             pic a.
       01  ws-load-return-code          pic 9.
       01  ws-save-return-code          pic 9.
       01  ws-command-line-buffer       pic x(1024).
       procedure division.
       init-setup. 
           set environment ""COB_SCREEN_EXCEPTIONS"" to 'Y'.
           set environment ""COB_SCREEN_ESC"" to 'Y'.
           set environment ""COB_SCREEN_TAB"" to 'Y'.
           set environment ""COB_TIMEOUT_SCALE"" to '3'.       
           compute ws-mouse-flags = COB-AUTO-MOUSE-HANDLING
                   + COB-ALLOW-LEFT-DOWN 
                   + COB-ALLOW-LEFT-UP 
                   + COB-ALLOW-MOUSE-MOVE
           set environment ""COB_MOUSE_FLAGS"" to ws-mouse-flags
           move zeros to ws-cursor-pos           
           display space blank screen 
           accept ws-temp-time from time 
           move function random(ws-temp-time) to ws-filler
           accept ws-command-line-buffer from command-line 
           if ws-command-line-buffer not = spaces then 
               move function upper-case(
                   function trim(ws-command-line-buffer)) to 
                   ws-map-name
               move ws-map-name to ws-map-name-temp 
               perform set-file-names
               call ""load-map-data"" using 
                   ws-map-files ws-tile-map-table-matrix 
                   ws-enemy-data ws-teleport-data
                   ws-item-data 
                   ws-load-return-code
               end-call 
               if ws-load-return-code not = 0 then 
                   display ""Error loading: "" at 0201 ws-map-name at 0225
                   accept ws-kb-input at 2101
                   move ws-map-name-temp to ws-map-name 
                   goback
               end-if                 
           else 
               perform generate-init-world-data
               perform set-file-names
           end-if 
           perform main-procedure.
       set-file-names.
           move function concatenate(
               function trim(ws-map-name), ws-data-file-ext)
               to ws-map-dat-file
           move function concatenate(
               function trim(ws-map-name), ws-teleport-file-ext)
               to ws-map-tel-file            
           move function concatenate(
               function trim(ws-map-name), ws-enemy-file-ext)
               to ws-map-enemy-file       
           exit paragraph.
       main-procedure.  
           perform until ws-quit         
               perform draw-screen               
               perform get-input
               perform move-cursor
           end-perform
           goback.
       draw-screen.
           if ws-scr-no-refresh then 
               exit paragraph 
           end-if 
           call ""draw-dynamic-screen-data"" 
               using ws-cursor ws-tile-map-table-matrix ws-enemy-data
               ws-display-mode
           end-call 
           set ws-scr-no-refresh to true
           exit paragraph.
       get-input.
           accept ws-kb-input at 2101 with auto-skip no-echo upper
           evaluate ws-crt-status 
               when COB-SCR-KEY-DOWN 
                   add 1 to ws-cursor-pos-delta-y
               when COB-SCR-KEY-UP
                   subtract 1 from ws-cursor-pos-delta-y
               when COB-SCR-KEY-LEFT
                   subtract 1 from ws-cursor-pos-delta-x
               when COB-SCR-KEY-RIGHT
                   add 1 to ws-cursor-pos-delta-x
               when COB-SCR-ESC
                   display ""QUITING"" at 0917 
                   set ws-quit to true 
               when COB-SCR-F1 
                   call ""display-help""
                   set ws-scr-refresh to true 
               when COB-SCR-F2
                   perform write-world-data 
                   exit paragraph 
               when COB-SCR-F3
                   perform load-map-data
                   exit paragraph 
               when COB-SCR-F6 
                   if ws-display-mode-effects then 
                       set ws-display-mode-regular to true 
                   else 
                       set ws-display-mode-effects to true 
                   end-if 
               when COB-SCR-TAB                    
                   if ws-cursor-type-tile then 
                       set ws-cursor-type-enemy to true 
                   else 
                       set ws-cursor-type-tile to true 
                   end-if
               when COB-SCR-LEFT-PRESSED 
                   set ws-mouse-clicked to true 
               when COB-SCR-LEFT-RELEASED
                   set ws-mouse-not-clicked to true 
           end-evaluate
           if ws-mouse-position not = zeros                
               and ws-mouse-row <= 20 
               and ws-mouse-clicked then                      
               perform place-item-at-mouse-pos      
           end-if 
           evaluate true
               when ws-kb-input = 'Q'
                   display ""QUITING"" at 0917
                   set ws-quit to true              
               when ws-kb-input = '0' 
                   move zero to ws-cursor-draw-color-fg
               when ws-kb-input = 'B'
                   perform toggle-blocking-mode
               when ws-kb-input = 'C'
                   perform set-tile-char
               when ws-kb-input = 'D'
                   perform set-enemy-settings
               when ws-kb-input = 'E'
                   perform set-effect-id
               when ws-kb-input = 'F'
                   perform set-foreground-color
               when ws-kb-input = 'G'
                   perform set-background-color
               when ws-kb-input = 'H'
                   perform toggle-fg-highlight
               when ws-kb-input = 'K'
                   perform toggle-blink
               when ws-kb-input = 'L'
                   perform load-map-data
               when ws-kb-input = 'O' 
                   perform write-world-data    
               when ws-kb-input = 'V' 
                   perform set-tile-visibility
               when ws-kb-input = space
                   if ws-crt-status not = COB-SCR-TIME-OUT
                       and ws-cursor-pos-delta = zeros 
                       and ws-crt-status = zeros      
                       then       
                           perform place-item-at-cursor-pos
                   end-if 
               when other   
                   display ""KB INPUT: "" at 2601 ws-kb-input at 2610
           end-evaluate
           exit paragraph.
       move-cursor.
           if ws-cursor-pos-delta <> 0 then 
               move ws-cursor-pos to ws-temp-map-pos
               add ws-cursor-scr-y to ws-temp-map-pos-y
               add ws-cursor-scr-x to ws-temp-map-pos-x
               add ws-cursor-pos-delta-y to ws-temp-map-pos-y
               add ws-cursor-pos-delta-x to ws-temp-map-pos-x
               if ws-temp-map-pos-y >= ws-max-map-height 
                  or ws-temp-map-pos-x >= ws-max-map-width
                  or ws-temp-map-pos-y <= 0 or ws-temp-map-pos-x <= 0 
               then
                   display     
                       ""Caught out of bounds: "" at 2532 
                       ws-temp-map-pos-y at 2555
                       ws-temp-map-pos-x at 2557
                   end-display
                   move zeros to ws-cursor-pos-delta
                   exit paragraph
               end-if 
               add ws-cursor-pos-delta-x to ws-cursor-pos-x
               add ws-cursor-pos-delta-y to ws-cursor-pos-y 
               set ws-scr-refresh to true                
           end-if
           move zeros to ws-cursor-pos-delta
           exit paragraph.
       set-foreground-color.     
           display ""Foreground color [ "" at 2101
           display ""0"" at 2119 
               foreground-color 0 background-color 0
               highlight 
           end-display 
           display ""1"" at 2120 
               foreground-color 1 background-color 1
               highlight 
           end-display 
           display ""2"" at 2121 
               foreground-color 2 background-color 2
               highlight 
           end-display 
           display ""3"" at 2122 
               foreground-color 3 background-color 3
               highlight 
           end-display 
           display ""4"" at 2123 
               foreground-color 4 background-color 4
               highlight 
           end-display 
           display ""5"" at 2124 
               foreground-color 5 background-color 5
               highlight 
           end-display 
           display ""6"" at 2125 
               foreground-color 6 background-color 6
               highlight 
           end-display 
           display ""7"" at 2126 
               foreground-color 7 background-color 7
               highlight 
           end-display 
           display ""]:"" at 2127 foreground-color 7 background-color 0               
           accept ws-cursor-draw-color-fg at 2130 update
           if ws-cursor-draw-color-fg > 7 then 
               move 7 to ws-cursor-draw-color-fg
           end-if 
           set ws-scr-refresh to true 
           exit paragraph.
       set-background-color.
           display ""Background color [ "" at 2101                   
           display ""0"" at 2119 foreground-color 7 background-color 0
           display ""1"" at 2120 foreground-color 0 background-color 1
           display ""2"" at 2121 foreground-color 0 background-color 2
           display ""3"" at 2122 foreground-color 0 background-color 3
           display ""4"" at 2123 foreground-color 0 background-color 4
           display ""5"" at 2124 foreground-color 0 background-color 5
           display ""6"" at 2125 foreground-color 0 background-color 6
           display ""7"" at 2126 foreground-color 0 background-color 7
           display ""]:"" at 2127 foreground-color 7 background-color 0
           accept ws-cursor-draw-color-bg at 2130 update
           if ws-cursor-draw-color-bg > 7 then 
               move 7 to ws-cursor-draw-color-bg
           end-if 
           set ws-scr-refresh to true 
           exit paragraph. 
       set-tile-char.
           display ""Tile character: "" at 2101
           accept 
               ws-cursor-draw-char at 2117 update 
               foreground-color ws-cursor-draw-color-bg
               background-color ws-cursor-draw-color-fg
           end-accept
           set ws-scr-refresh to true 
           exit paragraph.        
       toggle-fg-highlight.
           if ws-cursor-highlight then
               set ws-cursor-no-highlight to true 
           else 
               set ws-cursor-highlight to true
           end-if 
           exit paragraph. 
       toggle-blocking-mode.
           if ws-cursor-blocking then 
               set ws-cursor-not-block to true 
           else 
               set ws-cursor-blocking to true 
           end-if 
           exit paragraph.
       toggle-blink.
           if ws-cursor-blink then 
               set ws-cursor-not-blink to true 
           else 
               set ws-cursor-blink to true 
           end-if 
           exit paragraph.
       set-effect-id. 
           move ws-cursor-draw-effect to ws-draw-effect-temp
           display ""Tile effect id: "" at 2101
           display ""[99 to cancel]"" at 2122
           accept ws-cursor-draw-effect at 2117 update 
           if ws-cursor-draw-effect not = 99 then 
               call ""setup-tile-effect"" using 
                   ws-cursor-draw-effect ws-cursor-teleport-settings
                   ws-cursor-draw-char
           else 
               move ws-draw-effect-temp to ws-cursor-draw-effect
           end-if 
           set ws-scr-refresh to true 
           exit paragraph.
       set-tile-visibility.
           display ""Tile visibility: "" at 2101
           accept ws-cursor-draw-visibility at 2118 update 
           exit paragraph.
       load-map-data.
           display ""Map name to load: "" at 2101
           display ""[Blank to cancel]"" at 2135
           accept ws-map-name at 2120 update upper
           display ws-line-mask at 2101
           if ws-map-name not = spaces then 
               call ""load-map-data"" using 
                   ws-map-files ws-tile-map-table-matrix 
                   ws-enemy-data ws-teleport-data
                   ws-item-data 
                   ws-load-return-code
               end-call 
               if ws-load-return-code not = 0 then 
                   display ""Error loading: "" at 0201 ws-map-name at 0225
                   accept ws-kb-input at 2101
                   move ws-map-name-temp to ws-map-name 
               else
                   move ws-map-name to ws-map-name-temp 
               end-if  
           end-if 
           exit paragraph.
       set-enemy-settings.
           display ""Enter enemy name: "" at 2101
           accept ws-cursor-enemy-name at 2120 update 
           display ws-line-mask at 2101
           display ""Enter enemy max hp:"" at 2101
           accept ws-cursor-enemy-hp at 2121 update 
           display ""Enter enemy attack damage: "" at 2101
           accept ws-cursor-enemy-attack-damage at 2128 update
           display ws-line-mask at 2101  
           display ""Enter enemy color [0-7]: "" at 2101
           accept ws-cursor-enemy-color at 2126 update 
           display ws-line-mask at 2101  
           display ""Enter enemy character: "" at 2101
           accept ws-cursor-enemy-char at 2124 update 
           display ws-line-mask at 2101  
           display ""Enter enemy ticks to move: "" at 2101
           accept ws-cursor-enemy-movement-ticks at 2128 update 
           display ws-line-mask at 2101
           display ""Enter enemy exp worth: "" at 2101
           accept ws-cursor-enemy-exp-worth at 2124
           exit paragraph.
       place-item-at-mouse-pos.           
           compute ws-temp-map-pos-y = ws-cursor-pos-y + ws-mouse-row                   
           compute ws-temp-map-pos-x = ws-cursor-pos-x + ws-mouse-col 
           if ws-temp-map-pos-y > 0
               and ws-temp-map-pos-x > 0 
               and ws-temp-map-pos-y <= ws-max-map-height
               and ws-temp-map-pos-x <= ws-max-map-width then 
               display ""MOUSE: "" at 2260 ws-temp-map-pos at 2270
               if ws-cursor-type-tile then 
                   perform place-tile                  
               else 
                   perform place-enemy
               end-if 
           end-if 
           exit paragraph.
       place-item-at-cursor-pos.
           compute ws-temp-map-pos-y = ws-cursor-pos-y + ws-cursor-scr-y
           compute ws-temp-map-pos-x = ws-cursor-pos-x + ws-cursor-scr-x                   
           if ws-cursor-type-tile then 
                   perform place-tile                  
               else 
                   perform place-enemy
               end-if 
           exit paragraph.
       place-tile.
           move ws-cursor-draw-color-fg 
               to ws-tile-fg(ws-temp-map-pos-y, ws-temp-map-pos-x)
           move ws-cursor-draw-color-bg 
               to ws-tile-bg(ws-temp-map-pos-y, ws-temp-map-pos-x)
           move ws-cursor-draw-char
               to ws-tile-char(ws-temp-map-pos-y, ws-temp-map-pos-x)
           move ws-cursor-draw-highlight
               to ws-tile-highlight(
                   ws-temp-map-pos-y, ws-temp-map-pos-x)
           move ws-cursor-draw-blocking 
               to ws-tile-blocking(ws-temp-map-pos-y, ws-temp-map-pos-x)
           move ws-cursor-draw-blinking
               to ws-tile-blinking(ws-temp-map-pos-y, ws-temp-map-pos-x)
           move ws-cursor-draw-visibility
               to ws-tile-visibility(
                   ws-temp-map-pos-y, ws-temp-map-pos-x)
           call ""set-tile-effect"" using
               ws-temp-map-pos
               ws-tile-effect-id(
                   ws-temp-map-pos-y, ws-temp-map-pos-x)
               ws-cursor ws-teleport-data 
           end-call 
           display ""Tile placed at:"" at 2501 ws-temp-map-pos at 2517
           exit paragraph.
       place-enemy.
           set ws-enemy-not-found to true
           move zeros to ws-enemy-found-idx
           perform varying ws-counter-1 from 1 by 1
               until ws-counter-1 > ws-cur-num-enemies
               if ws-temp-map-pos = ws-enemy-pos(ws-counter-1) then 
                   set ws-enemy-found to true 
                   move ws-counter-1 to ws-enemy-found-idx                   
                   exit perform 
               end-if 
           end-perform 
           if ws-enemy-found then 
               display ""Remove placed enemy? [y/n] "" at 2101                
               accept ws-replace-enemy at 2128 with auto-skip upper
               if ws-replace-enemy = 'Y' then 
                   perform varying ws-counter-1 
                       from ws-enemy-found-idx by 1 
                       until ws-counter-1 > ws-cur-num-enemies + 1
                       move ws-enemy(ws-counter-1 + 1) to 
                           ws-enemy(ws-counter-1)
                   end-perform 
                   subtract 1 from ws-cur-num-enemies
               end-if 
               exit paragraph 
           end-if 
           if ws-cursor-enemy-hp not = zeros 
               and ws-cursor-enemy-char not = spaces 
               and ws-cursor-enemy-movement-ticks not = zeros then 
               add 1 to ws-cur-num-enemies
               move ws-cursor-enemy-name 
                   to ws-enemy-name(ws-cur-num-enemies)
               move ws-cursor-enemy-color 
                   to ws-enemy-color(ws-cur-num-enemies)
               move ws-cursor-enemy-attack-damage 
                   to ws-enemy-attack-damage(ws-cur-num-enemies)
               move ws-cursor-enemy-char 
                   to ws-enemy-char(ws-cur-num-enemies)
               move ws-cursor-enemy-hp 
                   to ws-enemy-hp-current(ws-cur-num-enemies)
               move ws-cursor-enemy-hp 
                   to ws-enemy-hp-total(ws-cur-num-enemies)
               move ws-cursor-enemy-movement-ticks 
                   to ws-enemy-max-ticks(ws-cur-num-enemies) 
               move ws-cursor-enemy-movement-ticks
                   to ws-enemy-current-ticks(ws-cur-num-enemies)              
               move ws-cursor-enemy-exp-worth 
                   to ws-enemy-exp-worth(ws-cur-num-enemies)
               move ws-temp-map-pos-y to ws-enemy-y(ws-cur-num-enemies) 
               move ws-temp-map-pos-x to ws-enemy-x(ws-cur-num-enemies)
               display 
                   ""Enemy placed at:"" at 2501 ws-temp-map-pos at 2517                  
               end-display
           end-if 
           exit paragraph.
       generate-init-world-data.
           perform varying ws-counter-1 
           from 1 by 1 until ws-counter-1 > ws-max-map-height
               perform varying ws-counter-2 
               from 1 by 1 until ws-counter-2 > ws-max-map-width                        
                   move white to 
                       ws-tile-fg(ws-counter-1, ws-counter-2)
                   move black to 
                       ws-tile-bg(ws-counter-1, ws-counter-2)
                   set ws-tile-not-highlight(ws-counter-1, ws-counter-2)
                       to true 
                   set ws-tile-is-blocking(ws-counter-1, ws-counter-2)
                       to true 
                   set ws-tile-not-blinking(ws-counter-1, ws-counter-2) 
                       to true 
                   move space 
                       to ws-tile-char(ws-counter-1, ws-counter-2)    
                   move zero 
                       to ws-tile-effect-id(ws-counter-1, ws-counter-2)                                          
                   move ws-default-draw-visibility
                       to ws-tile-visibility(ws-counter-1, ws-counter-2)
               end-perform
           end-perform    
           exit paragraph.                                  
       write-world-data.
           display ""Save map name as: "" at 2101
           display ""[Blank to cancel]"" at 2134
           accept ws-map-name at 2119 update upper
           display ws-line-mask at 2101
           if ws-map-name = spaces then 
               move ws-map-name-temp to ws-map-name 
               exit paragraph 
           else 
               move ws-map-name to ws-map-name-temp 
               perform set-file-names 
           end-if 
           call ""write-map-data"" using 
               ws-map-files, ws-tile-map-table-matrix,
               ws-enemy-data, ws-teleport-data, ws-item-data, 
               ws-save-return-code
           end-call 
           if ws-save-return-code = zero then 
               display 
                   ""Saved map data: "" at 2101
                   ws-map-name at 2117
               end-display 
           else 
               display 
                   function concatenate(
                       ""Error saving map: "", ws-map-name, 
                       "" Return code: "", ws-save-return-code)
                   at 2101
               end-display 
           end-if 
           accept omitted at 2150
           exit paragraph. 
       end program cobol-roguelike-editor.
","       file section.
       working-storage section.
       01  ws-map-files.  
           05  ws-map-name             pic x(15) value ""VOIDSPACE"".
           05  ws-map-name-temp        pic x(15) value ""VOIDSPACE"".           
           05  ws-map-dat-file         pic x(15).               
           05  ws-map-tel-file         pic x(15).
           05  ws-map-enemy-file       pic x(15).
           05  ws-map-item-file        pic x(15).
       01  ws-map-file-statuses.
           05  ws-map-file-status      pic xx.
           05  ws-teleport-file-status pic xx.
           05  ws-enemy-file-status    pic xx.
           05  ws-item-file-status     pic xx.
       01  black                          constant as 0.
       01  blue                           constant as 1.
       01  green                          constant as 2.
       01  cyan                           constant as 3.
       01  red                            constant as 4.
       01  magenta                        constant as 5.
       01  yellow                         constant as 6.  
       01  white                          constant as 7.
       78  ws-no-tile-effect-id           value 0.    
       78  ws-teleport-effect-id          value 1.
       78  ws-conveyor-right-effect-id    value 2.
       78  ws-conveyor-down-effect-id     value 3.
       78  ws-conveyor-left-effect-id     value 4.
       78  ws-conveyor-up-effect-id       value 5.
       78  ws-conveyor-reverse-effect-id  value 6.
       78  ws-player-start-effect-id      value 98.
       78  ws-load-map-tele-return-code   value 1.
       78  ws-max-view-height             value 20.
       78  ws-max-view-width              value 50.
       78  ws-max-map-height              value 25.
       78  ws-max-map-width               value 80.
       78  ws-max-num-enemies             value 99.      
       78  ws-max-num-teleports           value 999.
       78  ws-max-num-items               value 999.
       78  ws-file-status-ok              value ""00"".
       78  ws-file-status-eof             value ""10"".
       78  ws-load-status-fail            value 9.
       78  ws-load-status-read-fail       value 8.
       78  ws-load-status-bad-data        value 7.
       78  ws-load-status-success         value 0.       
       78  ws-save-status-fail            value 9.
       78  ws-save-status-success         value 0.
       78  ws-data-file-ext               value "".DAT"".
       78  ws-teleport-file-ext           value "".TEL"".
       78  ws-enemy-file-ext              value "".BGS"".
       78  ws-item-file-ext               value "".ITM"".
       01  ws-enemy-data.
           05  ws-cur-num-enemies           pic 99 comp value 0.
           05  ws-enemy             occurs 0 to ws-max-num-enemies times
                                    depending on ws-cur-num-enemies.
               10  ws-enemy-name           pic x(16) value 'NONAME'.
               10  ws-enemy-hp.
                   15  ws-enemy-hp-total    pic 999 comp value 10.
                   15  ws-enemy-hp-current  pic 999 comp value 10.
               10  ws-enemy-attack-damage   pic 999 comp value 1.
               10  ws-enemy-pos.
                   15  ws-enemy-y           pic 99.
                   15  ws-enemy-x           pic 99.
               10  ws-enemy-color           pic 9 value 4.
               10  ws-enemy-char            pic x.
               10  ws-enemy-status              pic 9 comp value 3.
                   88  ws-enemy-status-alive    value 0.
                   88  ws-enemy-status-dead     value 1.
                   88  ws-enemy-status-attacked value 2.
                   88  ws-enemy-status-other    value 3.
               10  ws-enemy-movement-ticks.
                   15  ws-enemy-current-ticks   pic 999 comp.
                   15  ws-enemy-max-ticks       pic 999 comp.
               10  ws-enemy-exp-worth           pic 9(4) comp.
       01  ws-tile-map-table-matrix.
           05  ws-tile-map           occurs ws-max-map-height times.
               10  ws-tile-map-data   occurs ws-max-map-width times.
                   15  ws-tile-fg                   pic 9.   
                   15  ws-tile-bg                   pic 9.
                   15  ws-tile-char                 pic x.
                   15  ws-tile-highlight            pic a value 'N'.
                       88 ws-tile-is-highlight      value 'Y'.
                       88 ws-tile-not-highlight     value 'N'.
                   15  ws-tile-blocking             pic a value 'N'.
                       88  ws-tile-is-blocking      value 'Y'.
                       88  ws-tile-not-blocking     value 'N'.  
                   15  ws-tile-blinking             pic a value 'N'.
                       88  ws-tile-is-blinking      value 'Y'.
                       88  ws-tile-not-blinking     value 'N'.
                   15  ws-tile-effect-id            pic 99 comp.  
                   15  ws-tile-visibility           pic 999 comp.    
       01  ws-teleport-data.
           05  ws-cur-num-teleports        pic 999 comp.
           05  ws-teleport-data-record  occurs 0 to ws-max-num-teleports
                                      depending on ws-cur-num-teleports.
               10  ws-teleport-pos.
                   15  ws-teleport-y        pic S99.
                   15  ws-teleport-x        pic S99.
               10  ws-teleport-dest-pos.
                   15  ws-teleport-dest-y   pic S99.
                   15  ws-teleport-dest-x   pic S99.
               10  ws-teleport-dest-map     pic x(15).
       01  ws-item-data.
           05  ws-cur-num-items            pic 999 comp.
           05  ws-item-data-record         occurs 0 to ws-max-num-items
                                          depending on ws-cur-num-items.
               10  ws-item-name            pic x(16).                                          
               10  ws-item-pos.
                   15  ws-item-y           pic S99.
                   15  ws-item-x           pic S99.
               10  ws-item-taken           pic a value 'N'.
                   88  ws-item-is-taken    value 'Y'.
                   88  ws-item-not-taken   value 'N'.               
               10  ws-item-effect-id       pic 99.
               10  ws-item-worth           pic 999.
               10  ws-item-color           pic 9. 
               10  ws-item-char            pic x.
       78  ws-default-draw-visibility  value 3.
       01  ws-mouse-flags              pic 9(4).
       01  ws-crt-status.
           05  ws-crt-status-key-1     pic 99.
           05  ws-crt-status-key-2     pic 99.
       01  ws-mouse-position.
           05  ws-mouse-row            pic 99.
           05  ws-mouse-col            pic 99.
       01  ws-mouse-click-status       pic a value 'N'.
           88  ws-mouse-clicked        value 'Y'.
           88  ws-mouse-not-clicked    value 'N'.
       01  ws-temp-time                pic 9(9).
       01  ws-line-mask                   pic x(50) value spaces.
       01  ws-cursor.
           05  ws-cursor-pos.
               10  ws-cursor-pos-y        pic S99.
               10  ws-cursor-pos-x        pic S99.
           05  ws-cursor-pos-delta.               
               10  ws-cursor-pos-delta-y  pic S99. 
               10  ws-cursor-pos-delta-x  pic S99.
           05  ws-cursor-scr-pos.  
               10  ws-cursor-scr-y         pic 99 value 12.
               10  ws-cursor-scr-x         pic 99 value 20.                      
           05  ws-cursor-color            pic 9 value yellow.
           05  ws-cursor-draw-color-fg    pic 9 value black.
           05  ws-cursor-draw-color-bg    pic 9 value black.
           05  ws-cursor-draw-char        pic x value space.
           05  ws-cursor-draw-highlight   pic a value 'N'.
               88  ws-cursor-highlight    value 'Y'.
               88  ws-cursor-no-highlight value 'N'.
           05  ws-cursor-draw-blocking    pic a value 'N'.
               88  ws-cursor-blocking     value 'Y'.
               88  ws-cursor-not-block    value 'N'.
           05  ws-cursor-draw-blinking    pic a value 'N'.
               88  ws-cursor-blink        value 'Y'.
               88  ws-cursor-not-blink    value 'N'.
           05  ws-cursor-draw-visibility  pic 999 
                                       value ws-default-draw-visibility.
           05  ws-cursor-enemy-settings.
               10  ws-cursor-enemy-name    pic x(16) value 'NONAME'.
               10  ws-cursor-enemy-hp              pic 999 value 10.                       
               10  ws-cursor-enemy-attack-damage   pic 999 value 1.
               10  ws-cursor-enemy-color           pic 9 value red.                                           
               10  ws-cursor-enemy-char            pic x value ""&"". 
               10  ws-cursor-enemy-movement-ticks  pic 999 value 3.
               10  ws-cursor-enemy-exp-worth       pic 9(4) value 1.
           05  ws-cursor-teleport-settings.
               10  ws-cursor-tel-dest-y            pic 99.
               10  ws-cursor-tel-dest-x            pic 99.
               10  ws-cursor-tel-dest-map          pic x(15).    
           05  ws-cursor-draw-effect               pic 99.                   
           05  ws-cursor-type                      pic a value 'T'.
               88  ws-cursor-type-tile             value 'T'.
               88  ws-cursor-type-enemy            value 'E'.                                                      
           78  ws-cursor-char             value ""+"".
       01  ws-draw-effect-temp            pic 99.
       01  ws-kb-input                    pic x.
       01  ws-is-quit                     pic a value 'N'.
           88  ws-quit                    value 'Y'.
           88  ws-not-quit                value 'N'.
       01  ws-display-mode                     pic a value 'R'.
           88  ws-display-mode-regular         value 'R'.
           88  ws-display-mode-effects         value 'E'.
       01  ws-temp-input                pic x.
       01  ws-scr-refresh-req           pic a value 'Y'.
           88  ws-scr-refresh           value 'Y'.
           88  ws-scr-no-refresh        value 'N'.
       01  ws-counter-1                 pic 999 comp.
       01  ws-counter-2                 pic 999 comp.
       01  ws-temp-map-pos.
           05  ws-temp-map-pos-y        pic S99 value 01.
           05  ws-temp-map-pos-x        pic S99 value 01.
       01  ws-filler                    pic 9(9).
       01  ws-enemy-placed-found        pic a value 'N'.
           88  ws-enemy-found           value 'Y'.
           88  ws-enemy-not-found       value 'N'.
       01  ws-enemy-found-idx           pic 99 comp.
       01  ws-replace-enemy             pic a.
       01  ws-load-return-code          pic 9.
       01  ws-save-return-code          pic 9.
       01  ws-command-line-buffer       pic x(1024).
","['init-setup', 'set-file-names', 'main-procedure', 'draw-screen', 'get-input', 'move-cursor', 'set-foreground-color', 'set-background-color', 'set-tile-char', 'toggle-fg-highlight', 'toggle-blocking-mode', 'toggle-blink', 'set-effect-id', 'set-tile-visibility', 'load-map-data', 'set-enemy-settings', 'place-item-at-mouse-pos', 'place-item-at-cursor-pos', 'place-tile', 'place-enemy', 'generate-init-world-data', 'write-world-data']","Paragraph init-setup calls paragraph generate-init-world-data, set-file-names, main-procedure.
Paragraph main-procedure calls paragraph draw-screen, move-cursor, get-input.
Paragraph get-input calls paragraph set-enemy-settings, toggle-blink, place-item-at-cursor-pos, set-effect-id, set-foreground-color, set-background-color, load-map-data, set-tile-visibility, place-item-at-mouse-pos, toggle-fg-highlight, toggle-blocking-mode, set-tile-char, write-world-data.
Paragraph place-item-at-mouse-pos calls paragraph place-enemy, place-tile.
Paragraph place-item-at-cursor-pos calls paragraph place-enemy, place-tile.
Paragraph write-world-data calls paragraph set-file-names.
",692,Map editor for the game,,,,Error Long,1,1,1,"This COBOL file manages a map-based program, initializing parameters, loading map data, and facilitating user interactions like placing items and managing enemy settings. It begins with setup (init-setup), followed by file name configuration (set-file-names) and the main program loop (main-procedure), which includes drawing the screen (draw-screen), getting user input (get-input), and cursor movement (move-cursor). It allows item placement (place-item-at-mouse-pos, place-item-at-cursor-pos) and includes functionalities for saving map data (write-world-data).",
89,shamrice_COBOL-Roguelike,X-COBOL/X-COBOL/COBOL_Files/shamrice_COBOL-Roguelike/crl_engine.cbl,"       identification division.
       program-id. cobol-roguelike-engine.
       environment division.
       configuration section.
       special-names.
           crt status is ws-crt-status.
       input-output section.
       file-control.
       data division.
       file section.
       working-storage section.
       01  black                          constant as 0.
       01  blue                           constant as 1.
       01  green                          constant as 2.
       01  cyan                           constant as 3.
       01  red                            constant as 4.
       01  magenta                        constant as 5.
       01  yellow                         constant as 6.  
       01  white                          constant as 7.
       78  ws-no-tile-effect-id           value 0.    
       78  ws-teleport-effect-id          value 1.
       78  ws-conveyor-right-effect-id    value 2.
       78  ws-conveyor-down-effect-id     value 3.
       78  ws-conveyor-left-effect-id     value 4.
       78  ws-conveyor-up-effect-id       value 5.
       78  ws-conveyor-reverse-effect-id  value 6.
       78  ws-player-start-effect-id      value 98.
       78  ws-load-map-tele-return-code   value 1.
       78  ws-max-view-height             value 20.
       78  ws-max-view-width              value 50.
       78  ws-max-map-height              value 25.
       78  ws-max-map-width               value 80.
       78  ws-max-num-enemies             value 99.      
       78  ws-max-num-teleports           value 999.
       78  ws-max-num-items               value 999.
       78  ws-file-status-ok              value ""00"".
       78  ws-file-status-eof             value ""10"".
       78  ws-load-status-fail            value 9.
       78  ws-load-status-read-fail       value 8.
       78  ws-load-status-bad-data        value 7.
       78  ws-load-status-success         value 0.       
       78  ws-save-status-fail            value 9.
       78  ws-save-status-success         value 0.
       78  ws-data-file-ext               value "".DAT"".
       78  ws-teleport-file-ext           value "".TEL"".
       78  ws-enemy-file-ext              value "".BGS"".
       78  ws-item-file-ext               value "".ITM"".
       01  ws-teleport-data.
           05  ws-cur-num-teleports        pic 999 comp.
           05  ws-teleport-data-record  occurs 0 to ws-max-num-teleports
                                      depending on ws-cur-num-teleports.
               10  ws-teleport-pos.
                   15  ws-teleport-y        pic S99.
                   15  ws-teleport-x        pic S99.
               10  ws-teleport-dest-pos.
                   15  ws-teleport-dest-y   pic S99.
                   15  ws-teleport-dest-x   pic S99.
               10  ws-teleport-dest-map     pic x(15).
       01  ws-map-files.  
           05  ws-map-name             pic x(15) value ""VOIDSPACE"".
           05  ws-map-name-temp        pic x(15) value ""VOIDSPACE"".           
           05  ws-map-dat-file         pic x(15).               
           05  ws-map-tel-file         pic x(15).
           05  ws-map-enemy-file       pic x(15).
           05  ws-map-item-file        pic x(15).
       01  ws-map-file-statuses.
           05  ws-map-file-status      pic xx.
           05  ws-teleport-file-status pic xx.
           05  ws-enemy-file-status    pic xx.
           05  ws-item-file-status     pic xx.
       01  ws-enemy-data.
           05  ws-cur-num-enemies           pic 99 comp value 0.
           05  ws-enemy             occurs 0 to ws-max-num-enemies times
                                    depending on ws-cur-num-enemies.
               10  ws-enemy-name           pic x(16) value 'NONAME'.
               10  ws-enemy-hp.
                   15  ws-enemy-hp-total    pic 999 comp value 10.
                   15  ws-enemy-hp-current  pic 999 comp value 10.
               10  ws-enemy-attack-damage   pic 999 comp value 1.
               10  ws-enemy-pos.
                   15  ws-enemy-y           pic 99.
                   15  ws-enemy-x           pic 99.
               10  ws-enemy-color           pic 9 value 4.
               10  ws-enemy-char            pic x.
               10  ws-enemy-status              pic 9 comp value 3.
                   88  ws-enemy-status-alive    value 0.
                   88  ws-enemy-status-dead     value 1.
                   88  ws-enemy-status-attacked value 2.
                   88  ws-enemy-status-other    value 3.
               10  ws-enemy-movement-ticks.
                   15  ws-enemy-current-ticks   pic 999 comp.
                   15  ws-enemy-max-ticks       pic 999 comp.
               10  ws-enemy-exp-worth           pic 9(4) comp.
       01  ws-tile-map-table-matrix.
           05  ws-tile-map           occurs ws-max-map-height times.
               10  ws-tile-map-data   occurs ws-max-map-width times.
                   15  ws-tile-fg                   pic 9.   
                   15  ws-tile-bg                   pic 9.
                   15  ws-tile-char                 pic x.
                   15  ws-tile-highlight            pic a value 'N'.
                       88 ws-tile-is-highlight      value 'Y'.
                       88 ws-tile-not-highlight     value 'N'.
                   15  ws-tile-blocking             pic a value 'N'.
                       88  ws-tile-is-blocking      value 'Y'.
                       88  ws-tile-not-blocking     value 'N'.  
                   15  ws-tile-blinking             pic a value 'N'.
                       88  ws-tile-is-blinking      value 'Y'.
                       88  ws-tile-not-blinking     value 'N'.
                   15  ws-tile-effect-id            pic 99 comp.  
                   15  ws-tile-visibility           pic 999 comp.    
       01  ws-action-history.
           05  ws-action-history-item      occurs 150 times.
               10  ws-action-history-text  pic x(75).
       01  ws-action-history-temp          pic x(75).      
       01  ws-item-data.
           05  ws-cur-num-items            pic 999 comp.
           05  ws-item-data-record         occurs 0 to ws-max-num-items
                                          depending on ws-cur-num-items.
               10  ws-item-name            pic x(16).                                          
               10  ws-item-pos.
                   15  ws-item-y           pic S99.
                   15  ws-item-x           pic S99.
               10  ws-item-taken           pic a value 'N'.
                   88  ws-item-is-taken    value 'Y'.
                   88  ws-item-not-taken   value 'N'.               
               10  ws-item-effect-id       pic 99.
               10  ws-item-worth           pic 999.
               10  ws-item-color           pic 9. 
               10  ws-item-char            pic x.
       01  ws-crt-status.
           05  ws-crt-status-key-1     pic 99.
           05  ws-crt-status-key-2     pic 99.
       01  ws-temp-time                pic 9(9).
       01  ws-player.
           05  ws-player-name          pic x(16) value ""Adventurer"".
           05  ws-player-hp.
               10  ws-player-hp-current        pic 999 value 100.
               10  ws-player-hp-max            pic 999 value 100.
           05  ws-player-pos.
               10  ws-player-y             pic S99.
               10  ws-player-x             pic S99.
           05  ws-player-pos-delta.    
               10  ws-player-pos-delta-y   pic S99.
               10  ws-player-pos-delta-x   pic S99.
           05  ws-player-scr-pos.  
               10  ws-player-scr-y         pic 99 value 12. 
               10  ws-player-scr-x         pic 99 value 20. 
           05  ws-player-status              pic 9 value 0.
               88  ws-player-status-alive    value 0.
               88  ws-player-status-dead     value 1.
               88  ws-player-status-attacked value 2.
               88  ws-player-status-other    value 3.
           05  ws-player-attack-damage.    
               10  ws-player-atk-cur       pic 999 value 1.
               10  ws-player-atk-base      pic 999 value 1.
           05  ws-player-defense-power.
               10  ws-player-def-cur       pic 999 value 1.
               10  ws-player-def-base      pic 999 value 1.
           05  ws-player-level             pic 999 value 1.
           05  ws-player-experience.
               10  ws-player-exp-total     pic 9(7) value 0.
               10  ws-player-exp-next-lvl  pic 9(7) value 75.
           78  ws-player-char               value ""@"". 
       01  ws-equiped-items.
           05  ws-equiped-weapon.
               10  ws-equip-weapon-name        pic x(16) value ""None"".
               10  ws-equip-weapon-atk         pic 999 value 0.
               10  ws-equip-weapon-status      pic x value ""0"".
                   88  ws-equip-weapon-curse   value ""-"".
                   88  ws-equip-weapon-normal  value ""0"".
                   88  ws-equip-weapon-bless   value ""+"".                   
           05  ws-equiped-armor.
               10  ws-equip-armor-name         pic x(16) value ""None"".
               10  ws-equip-armor-def          pic 999 value 0.
               10  ws-equip-armor-status       pic x value ""0"".
                   88  ws-equip-armor-curse    value ""-"".
                   88  ws-equip-armor-normal   value ""0"".
                   88  ws-equip-armor-bless    value ""+"".                   
       01  ws-map-explored-data.
           05  ws-map-explored-y         occurs ws-max-map-height times.
               10  ws-map-explored-x     occurs ws-max-map-width times.
                   15  ws-map-explored        pic a value 'N'.
                       88  ws-is-explored     value 'Y'.
                       88  ws-is-not-explored value 'N'.
       01  ws-temp-damage-delt            pic S999 value 0.
       01  ws-enemy-placed-found        pic a value 'N'.
           88  ws-enemy-found           value 'Y'.
           88  ws-enemy-not-found       value 'N'.
       01  ws-enemy-found-idx           pic 99 comp.
       01  ws-enemy-exp-disp            pic z(7).
       01  ws-enemy-temp-pos.
           05  ws-enemy-temp-y          pic 99.
           05  ws-enemy-temp-x          pic 99.
       01  ws-kb-input                  pic x.
       01  ws-is-quit                   pic a value 'N'.
           88  ws-quit                  value 'Y'.
           88  ws-not-quit              value 'N'.
       01  ws-counter-1                 pic 999 comp.
       01  ws-counter-2                 pic 999 comp.
       01  ws-enemy-idx                 pic 99 comp.
       01  ws-enemy-search-idx          pic 99 comp.
       01  ws-tele-idx                  pic 999 comp.
       01  ws-temp-color                pic 9.
       01  ws-temp-map-pos.
           05  ws-temp-map-pos-y        pic S99.
           05  ws-temp-map-pos-x        pic S99.    
       01  ws-filler                    pic 9(9).
       01  ws-attack-attempt            pic 9(9).
       01  ws-eof                       pic a value 'N'.
           88 ws-is-eof                 value 'Y'.
           88 ws-not-eof                value 'N'.
       01  ws-load-return-code          pic 9.
       01  ws-tile-effect-return-code   pic 99.
       01  ws-player-moved-sw           pic a value 'N'.
           88  ws-player-moved          value 'Y'.
           88  ws-player-not-moved      value 'N'.
       01  ws-teleport-used-sw          pic a value 'N'.
           88  ws-teleport-used         value 'Y'.
           88  ws-teleport-not-used     value 'N'.
       01  ws-frame-rate.
           05  ws-start-frame           pic 9(2).
           05  ws-end-frame             pic 9(2).
           05  ws-frame-diff            pic 9(2).
           05  ws-sleep-time            pic 9(2).
       01 ws-current-date-data.
           05  ws-current-date.
               10  ws-current-year         PIC 9(04).
               10  ws-current-month        PIC 9(02).
               10  ws-current-day          PIC 9(02).
           05  ws-current-time.
               10  ws-current-hour         PIC 9(02).
               10  ws-current-minute       PIC 9(02).
               10  ws-current-second       PIC 9(02).
               10  ws-current-millisecond  PIC 9(02).
       01  ws-command-line-buffer         pic x(2048).
       procedure division.
           set environment ""COB_SCREEN_EXCEPTIONS"" to 'Y'.
           set environment ""COB_SCREEN_ESC"" to 'Y'.
           set environment ""COB_TIMEOUT_SCALE"" to '3'.
       init-setup.                                     
           accept ws-temp-time from time 
           move function random(ws-temp-time) to ws-filler
           accept ws-command-line-buffer from command-line 
           if ws-command-line-buffer not = spaces then 
               call ""command-line-parser"" using 
                   ws-command-line-buffer
                   ws-map-name
                   ws-map-name-temp 
               end-call 
           end-if 
           display space blank screen                
           .
       load-tile-map.
           move function concatenate(""Entering "",
               function trim(ws-map-name), ""..."")
               to ws-action-history-temp
           call ""add-action-history-item"" using 
               ws-action-history-temp ws-action-history
           end-call 
           call ""load-map-data"" using 
               ws-map-files ws-tile-map-table-matrix 
               ws-enemy-data ws-teleport-data
               ws-item-data 
               ws-load-return-code
           end-call 
           if ws-load-return-code > 0 then 
               display space blank screen 
               display 
                   ""FATAL ERROR :: Failed to load area data: "" at 0101
                   ws-map-name at 0143 
                   ""Please make sure related DAT, BGS, TEL files exist""
                   & "" in level data directory."" at 0201
               end-display 
               stop run 
           end-if
           if ws-teleport-not-used then 
               perform set-player-start-position
           end-if 
           set ws-teleport-not-used to true 
           initialize ws-map-explored-data
           move ws-player-pos to ws-temp-map-pos
           add ws-player-scr-y to ws-temp-map-pos-y
           add ws-player-scr-x to ws-temp-map-pos-x  
           call ""set-map-exploration"" using 
               ws-map-explored-data, ws-temp-map-pos,
               ws-tile-visibility(
                   ws-temp-map-pos-y, ws-temp-map-pos-x)
           end-call 
           perform draw-playfield 
           .
       main-procedure.
           perform until ws-quit or ws-player-status-dead   
               perform get-input                           
               perform move-player                 
               perform move-enemy                       
               perform draw-playfield 
           end-perform
           if ws-player-status-dead then 
               display 
                   ""You died. Game over. Press 'Q' to continue"" at 1005
                   foreground-color 7 
                   background-color 0 
               end-display 
               perform  with test after until ws-kb-input = 'Q'
                   accept ws-kb-input  
                       with auto-skip no-echo upper at 1004
                   end-accept 
               end-perform
           end-if 
           call ""action-history-log-end"" 
           goback.
       draw-playfield.           
           call ""draw-dynamic-screen-data"" using 
               ws-player ws-tile-map-table-matrix ws-enemy-data
               ws-action-history ws-map-explored-data 
               ws-equiped-items             
           end-call 
           exit paragraph.
       get-input.
           accept ws-kb-input at 2051 
               with auto-skip no-echo 
               time-out after 250
               upper 
           end-accept 
           evaluate ws-crt-status 
               when COB-SCR-KEY-DOWN 
                   add 1 to ws-player-pos-delta-y
               when COB-SCR-KEY-UP
                   subtract 1 from ws-player-pos-delta-y
               when COB-SCR-KEY-LEFT
                   subtract 1 from ws-player-pos-delta-x
               when COB-SCR-KEY-RIGHT
                   add 1 to ws-player-pos-delta-x
               when COB-SCR-ESC
                   set ws-quit to true 
               when COB-SCR-F1
                   call ""display-debug"" using 
                       ws-player ws-tile-map-table-matrix ws-enemy-data
                       ws-temp-map-pos   
                   end-call                        
               when COB-SCR-F9
                   perform debug-set-full-map-exploration
           end-evaluate
           evaluate true
               when ws-kb-input = 'Q'
                   set ws-quit to true 
               when ws-kb-input = 'S' 
                   add 1 to ws-player-pos-delta-y
               when ws-kb-input = 'W' 
                   subtract 1 from ws-player-pos-delta-y
               when ws-kb-input = 'D'
                   add 1 to ws-player-pos-delta-x
               when ws-kb-input = 'A'
                   subtract 1 from ws-player-pos-delta-x
               when ws-kb-input = 'R'
                   perform restart-level
           end-evaluate
           exit paragraph.
       move-player.
           move ws-player-pos to ws-temp-map-pos
           add ws-player-scr-y to ws-temp-map-pos-y
           add ws-player-scr-x to ws-temp-map-pos-x             
           add ws-player-pos-delta-y to ws-temp-map-pos-y               
           add ws-player-pos-delta-x to ws-temp-map-pos-x               
           if ws-temp-map-pos-y >= ws-max-map-height 
               or ws-temp-map-pos-x >= ws-max-map-width
               or ws-temp-map-pos-y <= 0 or ws-temp-map-pos-x <= 0 
           then
               move zeros to ws-player-pos-delta
               set ws-player-not-moved to true 
               exit paragraph
           end-if 
           move zero to ws-enemy-found-idx
           perform varying ws-enemy-idx 
           from 1 by 1 until ws-enemy-idx > ws-cur-num-enemies
               if ws-enemy-y(ws-enemy-idx) = ws-temp-map-pos-y 
               and ws-enemy-x(ws-enemy-idx) = ws-temp-map-pos-x
               and not ws-enemy-status-dead(ws-enemy-idx) 
               then 
                   move ws-enemy-idx to ws-enemy-found-idx
                   perform player-attack
                   exit perform
               end-if 
           end-perform 
           if ws-enemy-found-idx = 0 and ws-tile-not-blocking(
               ws-temp-map-pos-y, ws-temp-map-pos-x)                
           then                          
               add ws-player-pos-delta-x to ws-player-x
               add ws-player-pos-delta-y to ws-player-y
               call ""set-map-exploration"" using 
                   ws-map-explored-data, ws-temp-map-pos,
                   ws-tile-visibility(
                       ws-temp-map-pos-y, ws-temp-map-pos-x)
               end-call 
               if ws-player-pos-delta not zeros then
                   set ws-player-moved to true 
               else 
                   set ws-player-not-moved to true   
               end-if
               perform check-tile-effect
           end-if                            
           move zeros to ws-player-pos-delta
           exit paragraph.
       check-tile-effect.
           call ""tile-effect-handler"" using
               ws-tile-effect-id(ws-temp-map-pos-y, ws-temp-map-pos-x) 
               ws-tile-char(ws-temp-map-pos-y, ws-temp-map-pos-x)
               ws-player ws-temp-map-pos ws-teleport-data ws-map-files
               ws-tile-map-table-matrix
               ws-player-moved-sw 
               ws-action-history
               ws-tile-effect-return-code
           end-call
           evaluate ws-tile-effect-return-code
               when ws-load-map-tele-return-code
                   set ws-teleport-used to true  
                   perform load-tile-map
           end-evaluate
           exit paragraph.
       move-enemy.
           perform varying ws-enemy-idx 
           from 1 by 1 until ws-enemy-idx > ws-cur-num-enemies
               if not ws-enemy-status-dead(ws-enemy-idx) then 
                   add 15 to ws-enemy-current-ticks(ws-enemy-idx)
                   if ws-enemy-current-ticks(ws-enemy-idx) >= 
                   ws-enemy-max-ticks(ws-enemy-idx) then 
                       move 0 to ws-enemy-current-ticks(ws-enemy-idx)
                       if ws-enemy-status-attacked(ws-enemy-idx) 
                       then 
                           set ws-enemy-status-alive(ws-enemy-idx) 
                               to true 
                       end-if 
                       move ws-enemy-pos(ws-enemy-idx) 
                           to ws-enemy-temp-pos 
                       if ws-enemy-y(ws-enemy-idx) not = 
                       ws-player-y + ws-player-scr-y then 
                           if ws-enemy-y(ws-enemy-idx) < 
                           ws-player-y + ws-player-scr-y then                                                          
                               add 1 to ws-enemy-temp-y
                           else 
                               subtract 1 from ws-enemy-temp-y
                           end-if  
                       end-if 
                       if ws-enemy-x(ws-enemy-idx) not = 
                       ws-player-x + ws-player-scr-x then 
                           if ws-enemy-x(ws-enemy-idx) < 
                           ws-player-x + ws-player-scr-x then                
                               add 1 to ws-enemy-temp-x                                                              
                           else                            
                               subtract 1 from ws-enemy-temp-x 
                           end-if 
                       end-if 
                       if ws-enemy-temp-x = 
                       ws-player-x + ws-player-scr-x 
                       and ws-enemy-temp-y = 
                       ws-player-y + ws-player-scr-y then 
                           perform enemy-attack
                       else                        
                           move zero to ws-enemy-found-idx 
                           perform varying ws-enemy-search-idx
                           from 1 by 1 until 
                           ws-enemy-search-idx > ws-cur-num-enemies
                               if ws-enemy-search-idx not = ws-enemy-idx 
                               then 
                                   if ws-enemy-temp-x = 
                                   ws-enemy-x(ws-enemy-search-idx) and
                                   ws-enemy-temp-y = 
                                   ws-enemy-y(ws-enemy-search-idx) then
                                       move ws-enemy-search-idx
                                           to ws-enemy-found-idx 
                                       exit perform 
                                   end-if 
                               end-if
                           end-perform 
                           if ws-enemy-found-idx = 0 then 
                               if ws-tile-not-blocking(
                               ws-enemy-y(ws-enemy-idx), 
                               ws-enemy-temp-x) then 
                                   move ws-enemy-temp-x
                                       to ws-enemy-x(ws-enemy-idx) 
                               end-if 
                               if ws-tile-not-blocking(
                               ws-enemy-temp-y, 
                               ws-enemy-x(ws-enemy-idx)) then 
                                   move ws-enemy-temp-y
                                       to ws-enemy-y(ws-enemy-idx) 
                               end-if 
                           end-if 
                       end-if                        
                   end-if 
               end-if 
           end-perform 
           exit paragraph.
       enemy-attack.
           compute ws-attack-attempt = function random * 100 + 1
           if ws-attack-attempt > 65 then 
               move function concatenate(
                   function trim(ws-enemy-name(ws-enemy-idx)), 
                   "" missed "", 
                   function trim(ws-player-name), "".""
               ) to ws-action-history-temp
               call ""add-action-history-item"" using
                   ws-action-history-temp ws-action-history
               end-call 
               exit paragraph
           end-if 
           compute ws-temp-damage-delt = 
               ws-enemy-attack-damage(ws-enemy-idx) - ws-player-def-cur
           end-compute 
           if ws-temp-damage-delt <= 0 then 
               move function concatenate(
                   function trim(ws-enemy-name(ws-enemy-idx)), 
                   "" attacks but does no damage to "", 
                   function trim(ws-player-name), "".""
               ) to ws-action-history-temp
               call ""add-action-history-item"" using
                   ws-action-history-temp ws-action-history
               end-call 
               exit paragraph     
           end-if       
           if ws-temp-damage-delt > ws-player-hp-current then 
               set ws-player-status-dead to true 
               move zero to ws-player-hp-current
           else        
               subtract ws-temp-damage-delt from ws-player-hp-current
           end-if 
           move 
               function concatenate(
                   function trim(ws-player-name), 
                   "" is attacked by a "",
                   function trim(ws-enemy-name(ws-enemy-idx)),
                   "" for "",
                   ws-temp-damage-delt,
                   "" damange."")
               to ws-action-history-temp
           call ""add-action-history-item"" using 
               ws-action-history-temp
               ws-action-history
           end-call 
           exit paragraph.
       player-attack.
           if ws-enemy-hp-current(ws-enemy-idx) > 0
           and not ws-enemy-status-dead(ws-enemy-idx) then
               compute ws-attack-attempt = function random * 100 + 1      
               if ws-attack-attempt > 80 then 
                   move function concatenate(
                       function trim(ws-player-name), "" missed "", 
                       function trim(ws-enemy-name(ws-enemy-idx)), "".""
                   ) to ws-action-history-temp
                   call ""add-action-history-item"" using
                       ws-action-history-temp ws-action-history
                   end-call 
                   exit paragraph
               end-if 
               if ws-player-attack-damage <= 
               ws-enemy-hp-current(ws-enemy-idx) then 
                   subtract ws-player-atk-cur 
                       from ws-enemy-hp-current(ws-enemy-idx)
                   end-subtract
                   set ws-enemy-status-attacked(ws-enemy-idx) to true
               else 
                   move zero to ws-enemy-hp-current(ws-enemy-idx)
               end-if 
               move function concatenate(
                   function trim(ws-player-name), "" attacks "", 
                   function trim(ws-enemy-name(ws-enemy-idx)), "" for "",
                   ws-player-atk-cur, "" damage.""
               ) to ws-action-history-temp
               call ""add-action-history-item"" using
                   ws-action-history-temp ws-action-history
               end-call 
               if ws-enemy-hp-current(ws-enemy-idx) <= 0 then                     
                   set ws-enemy-status-dead(ws-enemy-idx) to true 
                   move ws-enemy-exp-worth(ws-enemy-idx) 
                       to ws-enemy-exp-disp
                   move function concatenate(                       
                       function trim(ws-enemy-name(ws-enemy-idx)), 
                       "" expires giving "",
                       function trim(ws-enemy-exp-disp), 
                       "" experience points.""
                   ) to ws-action-history-temp
                   call ""add-action-history-item"" using
                       ws-action-history-temp ws-action-history
                   end-call 
                   if ws-enemy-exp-worth(ws-enemy-idx) >= 
                   ws-player-exp-next-lvl then 
                       move zero to ws-player-exp-next-lvl
                   else
                       subtract ws-enemy-exp-worth(ws-enemy-idx) from 
                           ws-player-exp-next-lvl
                       end-subtract
                   end-if 
                   add ws-enemy-exp-worth(ws-enemy-idx) 
                       to ws-player-exp-total                   
                   if ws-player-exp-next-lvl = 0 then 
                       compute ws-player-exp-next-lvl = 
                           (ws-player-level * 20) + 75
                       end-compute 
                       add 1 to ws-player-level 
                       compute ws-player-hp-max = 
                           ws-player-hp-max + (ws-player-level * 5)
                       end-compute 
                       move ws-player-hp-max to ws-player-hp-current
                       compute ws-player-atk-base = 
                           ws-player-level * 1.5
                       end-compute 
                       compute ws-player-atk-cur = 
                           ws-player-atk-base + ws-equip-weapon-atk
                       end-compute 
                       compute ws-player-def-base = 
                           ws-player-level * 1.25
                       end-compute 
                       compute ws-player-def-cur = 
                           ws-player-def-base + ws-equip-armor-def
                       end-compute 
                       move function concatenate(                       
                           function trim(ws-player-name), 
                           "" has leveled up to level "",
                           ws-player-level, ""!""
                       ) to ws-action-history-temp
                       call ""add-action-history-item"" using
                           ws-action-history-temp ws-action-history
                       end-call 
                   end-if                        
               end-if 
           end-if   
           exit paragraph.
       set-player-start-position.
           compute ws-player-y = 1 - ws-player-scr-y 
           compute ws-player-x = 1 - ws-player-scr-x 
           perform varying ws-counter-1 
           from 1 by 1 until ws-counter-1 > ws-max-map-height
               perform varying ws-counter-2 
               from 1 by 1 until ws-counter-2 > ws-max-map-width
                   if ws-tile-effect-id(ws-counter-1, ws-counter-2)
                   = ws-player-start-effect-id then
                       compute ws-player-y = 
                           ws-counter-1 - ws-player-scr-y
                       end-compute 
                       compute ws-player-x =
                           ws-counter-2 - ws-player-scr-x 
                       end-compute 
                       exit paragraph 
                   end-if 
               end-perform
           end-perform 
           exit paragraph.
       restart-level.
           display ""Restart level? [Y/N]: "" 
               foreground-color 0
               background-color 7
               at 1010 
           end-display 
           accept ws-kb-input upper at 1032
           if ws-kb-input = 'Y' then 
               perform load-tile-map
           end-if         
           exit paragraph.
       debug-set-full-map-exploration.
           perform varying ws-counter-1 
           from 1 by 1 until ws-counter-1 > ws-max-map-height
               perform varying ws-counter-2 
               from 1 by 1 until ws-counter-2 > ws-max-map-width
                   set ws-is-explored(ws-counter-1, ws-counter-2) 
                       to true    
               end-perform 
           end-perform 
           exit paragraph.
       end program cobol-roguelike-engine.
","       file section.
       working-storage section.
       01  black                          constant as 0.
       01  blue                           constant as 1.
       01  green                          constant as 2.
       01  cyan                           constant as 3.
       01  red                            constant as 4.
       01  magenta                        constant as 5.
       01  yellow                         constant as 6.  
       01  white                          constant as 7.
       78  ws-no-tile-effect-id           value 0.    
       78  ws-teleport-effect-id          value 1.
       78  ws-conveyor-right-effect-id    value 2.
       78  ws-conveyor-down-effect-id     value 3.
       78  ws-conveyor-left-effect-id     value 4.
       78  ws-conveyor-up-effect-id       value 5.
       78  ws-conveyor-reverse-effect-id  value 6.
       78  ws-player-start-effect-id      value 98.
       78  ws-load-map-tele-return-code   value 1.
       78  ws-max-view-height             value 20.
       78  ws-max-view-width              value 50.
       78  ws-max-map-height              value 25.
       78  ws-max-map-width               value 80.
       78  ws-max-num-enemies             value 99.      
       78  ws-max-num-teleports           value 999.
       78  ws-max-num-items               value 999.
       78  ws-file-status-ok              value ""00"".
       78  ws-file-status-eof             value ""10"".
       78  ws-load-status-fail            value 9.
       78  ws-load-status-read-fail       value 8.
       78  ws-load-status-bad-data        value 7.
       78  ws-load-status-success         value 0.       
       78  ws-save-status-fail            value 9.
       78  ws-save-status-success         value 0.
       78  ws-data-file-ext               value "".DAT"".
       78  ws-teleport-file-ext           value "".TEL"".
       78  ws-enemy-file-ext              value "".BGS"".
       78  ws-item-file-ext               value "".ITM"".
       01  ws-teleport-data.
           05  ws-cur-num-teleports        pic 999 comp.
           05  ws-teleport-data-record  occurs 0 to ws-max-num-teleports
                                      depending on ws-cur-num-teleports.
               10  ws-teleport-pos.
                   15  ws-teleport-y        pic S99.
                   15  ws-teleport-x        pic S99.
               10  ws-teleport-dest-pos.
                   15  ws-teleport-dest-y   pic S99.
                   15  ws-teleport-dest-x   pic S99.
               10  ws-teleport-dest-map     pic x(15).
       01  ws-map-files.  
           05  ws-map-name             pic x(15) value ""VOIDSPACE"".
           05  ws-map-name-temp        pic x(15) value ""VOIDSPACE"".           
           05  ws-map-dat-file         pic x(15).               
           05  ws-map-tel-file         pic x(15).
           05  ws-map-enemy-file       pic x(15).
           05  ws-map-item-file        pic x(15).
       01  ws-map-file-statuses.
           05  ws-map-file-status      pic xx.
           05  ws-teleport-file-status pic xx.
           05  ws-enemy-file-status    pic xx.
           05  ws-item-file-status     pic xx.
       01  ws-enemy-data.
           05  ws-cur-num-enemies           pic 99 comp value 0.
           05  ws-enemy             occurs 0 to ws-max-num-enemies times
                                    depending on ws-cur-num-enemies.
               10  ws-enemy-name           pic x(16) value 'NONAME'.
               10  ws-enemy-hp.
                   15  ws-enemy-hp-total    pic 999 comp value 10.
                   15  ws-enemy-hp-current  pic 999 comp value 10.
               10  ws-enemy-attack-damage   pic 999 comp value 1.
               10  ws-enemy-pos.
                   15  ws-enemy-y           pic 99.
                   15  ws-enemy-x           pic 99.
               10  ws-enemy-color           pic 9 value 4.
               10  ws-enemy-char            pic x.
               10  ws-enemy-status              pic 9 comp value 3.
                   88  ws-enemy-status-alive    value 0.
                   88  ws-enemy-status-dead     value 1.
                   88  ws-enemy-status-attacked value 2.
                   88  ws-enemy-status-other    value 3.
               10  ws-enemy-movement-ticks.
                   15  ws-enemy-current-ticks   pic 999 comp.
                   15  ws-enemy-max-ticks       pic 999 comp.
               10  ws-enemy-exp-worth           pic 9(4) comp.
       01  ws-tile-map-table-matrix.
           05  ws-tile-map           occurs ws-max-map-height times.
               10  ws-tile-map-data   occurs ws-max-map-width times.
                   15  ws-tile-fg                   pic 9.   
                   15  ws-tile-bg                   pic 9.
                   15  ws-tile-char                 pic x.
                   15  ws-tile-highlight            pic a value 'N'.
                       88 ws-tile-is-highlight      value 'Y'.
                       88 ws-tile-not-highlight     value 'N'.
                   15  ws-tile-blocking             pic a value 'N'.
                       88  ws-tile-is-blocking      value 'Y'.
                       88  ws-tile-not-blocking     value 'N'.  
                   15  ws-tile-blinking             pic a value 'N'.
                       88  ws-tile-is-blinking      value 'Y'.
                       88  ws-tile-not-blinking     value 'N'.
                   15  ws-tile-effect-id            pic 99 comp.  
                   15  ws-tile-visibility           pic 999 comp.    
       01  ws-action-history.
           05  ws-action-history-item      occurs 150 times.
               10  ws-action-history-text  pic x(75).
       01  ws-action-history-temp          pic x(75).      
       01  ws-item-data.
           05  ws-cur-num-items            pic 999 comp.
           05  ws-item-data-record         occurs 0 to ws-max-num-items
                                          depending on ws-cur-num-items.
               10  ws-item-name            pic x(16).                                          
               10  ws-item-pos.
                   15  ws-item-y           pic S99.
                   15  ws-item-x           pic S99.
               10  ws-item-taken           pic a value 'N'.
                   88  ws-item-is-taken    value 'Y'.
                   88  ws-item-not-taken   value 'N'.               
               10  ws-item-effect-id       pic 99.
               10  ws-item-worth           pic 999.
               10  ws-item-color           pic 9. 
               10  ws-item-char            pic x.
       01  ws-crt-status.
           05  ws-crt-status-key-1     pic 99.
           05  ws-crt-status-key-2     pic 99.
       01  ws-temp-time                pic 9(9).
       01  ws-player.
           05  ws-player-name          pic x(16) value ""Adventurer"".
           05  ws-player-hp.
               10  ws-player-hp-current        pic 999 value 100.
               10  ws-player-hp-max            pic 999 value 100.
           05  ws-player-pos.
               10  ws-player-y             pic S99.
               10  ws-player-x             pic S99.
           05  ws-player-pos-delta.    
               10  ws-player-pos-delta-y   pic S99.
               10  ws-player-pos-delta-x   pic S99.
           05  ws-player-scr-pos.  
               10  ws-player-scr-y         pic 99 value 12. 
               10  ws-player-scr-x         pic 99 value 20. 
           05  ws-player-status              pic 9 value 0.
               88  ws-player-status-alive    value 0.
               88  ws-player-status-dead     value 1.
               88  ws-player-status-attacked value 2.
               88  ws-player-status-other    value 3.
           05  ws-player-attack-damage.    
               10  ws-player-atk-cur       pic 999 value 1.
               10  ws-player-atk-base      pic 999 value 1.
           05  ws-player-defense-power.
               10  ws-player-def-cur       pic 999 value 1.
               10  ws-player-def-base      pic 999 value 1.
           05  ws-player-level             pic 999 value 1.
           05  ws-player-experience.
               10  ws-player-exp-total     pic 9(7) value 0.
               10  ws-player-exp-next-lvl  pic 9(7) value 75.
           78  ws-player-char               value ""@"". 
       01  ws-equiped-items.
           05  ws-equiped-weapon.
               10  ws-equip-weapon-name        pic x(16) value ""None"".
               10  ws-equip-weapon-atk         pic 999 value 0.
               10  ws-equip-weapon-status      pic x value ""0"".
                   88  ws-equip-weapon-curse   value ""-"".
                   88  ws-equip-weapon-normal  value ""0"".
                   88  ws-equip-weapon-bless   value ""+"".                   
           05  ws-equiped-armor.
               10  ws-equip-armor-name         pic x(16) value ""None"".
               10  ws-equip-armor-def          pic 999 value 0.
               10  ws-equip-armor-status       pic x value ""0"".
                   88  ws-equip-armor-curse    value ""-"".
                   88  ws-equip-armor-normal   value ""0"".
                   88  ws-equip-armor-bless    value ""+"".                   
       01  ws-map-explored-data.
           05  ws-map-explored-y         occurs ws-max-map-height times.
               10  ws-map-explored-x     occurs ws-max-map-width times.
                   15  ws-map-explored        pic a value 'N'.
                       88  ws-is-explored     value 'Y'.
                       88  ws-is-not-explored value 'N'.
       01  ws-temp-damage-delt            pic S999 value 0.
       01  ws-enemy-placed-found        pic a value 'N'.
           88  ws-enemy-found           value 'Y'.
           88  ws-enemy-not-found       value 'N'.
       01  ws-enemy-found-idx           pic 99 comp.
       01  ws-enemy-exp-disp            pic z(7).
       01  ws-enemy-temp-pos.
           05  ws-enemy-temp-y          pic 99.
           05  ws-enemy-temp-x          pic 99.
       01  ws-kb-input                  pic x.
       01  ws-is-quit                   pic a value 'N'.
           88  ws-quit                  value 'Y'.
           88  ws-not-quit              value 'N'.
       01  ws-counter-1                 pic 999 comp.
       01  ws-counter-2                 pic 999 comp.
       01  ws-enemy-idx                 pic 99 comp.
       01  ws-enemy-search-idx          pic 99 comp.
       01  ws-tele-idx                  pic 999 comp.
       01  ws-temp-color                pic 9.
       01  ws-temp-map-pos.
           05  ws-temp-map-pos-y        pic S99.
           05  ws-temp-map-pos-x        pic S99.    
       01  ws-filler                    pic 9(9).
       01  ws-attack-attempt            pic 9(9).
       01  ws-eof                       pic a value 'N'.
           88 ws-is-eof                 value 'Y'.
           88 ws-not-eof                value 'N'.
       01  ws-load-return-code          pic 9.
       01  ws-tile-effect-return-code   pic 99.
       01  ws-player-moved-sw           pic a value 'N'.
           88  ws-player-moved          value 'Y'.
           88  ws-player-not-moved      value 'N'.
       01  ws-teleport-used-sw          pic a value 'N'.
           88  ws-teleport-used         value 'Y'.
           88  ws-teleport-not-used     value 'N'.
       01  ws-frame-rate.
           05  ws-start-frame           pic 9(2).
           05  ws-end-frame             pic 9(2).
           05  ws-frame-diff            pic 9(2).
           05  ws-sleep-time            pic 9(2).
       01 ws-current-date-data.
           05  ws-current-date.
               10  ws-current-year         PIC 9(04).
               10  ws-current-month        PIC 9(02).
               10  ws-current-day          PIC 9(02).
           05  ws-current-time.
               10  ws-current-hour         PIC 9(02).
               10  ws-current-minute       PIC 9(02).
               10  ws-current-second       PIC 9(02).
               10  ws-current-millisecond  PIC 9(02).
       01  ws-command-line-buffer         pic x(2048).
","['Top function with no name', 'init-setup', 'load-tile-map', 'main-procedure', 'draw-playfield', 'get-input', 'move-player', 'check-tile-effect', 'move-enemy', 'enemy-attack', 'player-attack', 'set-player-start-position', 'restart-level', 'debug-set-full-map-exploration']","Paragraph load-tile-map calls paragraph draw-playfield, set-player-start-position.
Paragraph main-procedure calls paragraph move-player, move-enemy, get-input, draw-playfield.
Paragraph get-input calls paragraph debug-set-full-map-exploration, restart-level.
Paragraph move-player calls paragraph check-tile-effect, player-attack.
Paragraph check-tile-effect calls paragraph load-tile-map.
Paragraph move-enemy calls paragraph enemy-attack.
Paragraph restart-level calls paragraph load-tile-map.
",670,COBOL Rogulike engine main entry point.,,,,Error Long,1,1,1,"This COBOL program simulates a game by initializing variables, loading tile maps, and managing player and enemy interactions. It includes procedures for handling user input, moving players, and executing attacks. The main procedure orchestrates game flow, while specific subroutines manage map exploration, player positioning, and actions like enemy movement and attacking. Functions for state management, such as restarting the game and exploring maps fully, enhance gameplay dynamics and user experience.",
122,walmartlabs_zECS,X-COBOL/X-COBOL/COBOL_Files/walmartlabs_zECS/ZECS001.cbl,,"       WORKING-STORAGE SECTION.
       01  USERID                 PIC  X(08) VALUE SPACES.
       01  APPLID                 PIC  X(08) VALUE SPACES.
       01  SYSID                  PIC  X(04) VALUE SPACES.
       01  ST-CODE                PIC  X(02) VALUE SPACES.
       01  BINARY-ZEROES          PIC  X(01) VALUE LOW-VALUES.
       01  DUPLICATE-POST         PIC  X(01) VALUE LOW-VALUES.
       01  ZECS002                PIC  X(08) VALUE 'ZECS002 '.
       01  ZECS003                PIC  X(08) VALUE 'ZECS003 '.
       01  INTERNAL-KEY           PIC  X(08) VALUE LOW-VALUES.
       01  ZRECOVERY              PIC  X(10) VALUE '/zRecovery'.
       01  ZCOMPLETE              PIC  X(10) VALUE '/zComplete'.
       01  RESOURCES              PIC  X(10) VALUE '/resources'.
       01  REPLICATE              PIC  X(10) VALUE '/replicate'.
       01  DEPLICATE              PIC  X(10) VALUE '/deplicate'.
       01  CRLF                   PIC  X(02) VALUE X'0D25'.
       01  BINARY-ZERO            PIC  X(01) VALUE X'00'.
       01  ZUIDSTCK               PIC  X(08) VALUE 'ZUIDSTCK'.
       01  THE-TOD                PIC  X(16) VALUE LOW-VALUES.
       01  LINKAGE-ADDRESSES.
           02  CACHE-ADDRESS      USAGE POINTER.
           02  CACHE-ADDRESS-X    REDEFINES CACHE-ADDRESS
                                  PIC S9(08) COMP.
           02  SAVE-ADDRESS       USAGE POINTER.
           02  SAVE-ADDRESS-X     REDEFINES SAVE-ADDRESS
                                  PIC S9(08) COMP.
       01  GETMAIN-LENGTH         PIC S9(08) COMP VALUE ZEROES.
       01  ZECS-COUNTER.
           02  NC-TRANID          PIC  X(04) VALUE 'ZC##'.
           02  FILLER             PIC  X(05) VALUE '_ZECS'.
           02  FILLER             PIC  X(07) VALUE SPACES.
       01  FILLER.
           02  ZECS-VALUE         PIC  9(16) COMP VALUE ZEROES.
           02  FILLER REDEFINES ZECS-VALUE.
               05  FILLER         PIC  X(06).
               05  ZECS-NC-HW     PIC  X(02).
       01  ZECS-INCREMENT         PIC  9(16) COMP VALUE  1.
       01  WEBRESP                PIC S9(08) COMP VALUE ZEROES.
       01  READ-RESP              PIC S9(08) COMP VALUE ZEROES.
       01  WRITE-RESP             PIC S9(08) COMP VALUE ZEROES.
       01  ETTL-STATUS            PIC S9(08) COMP VALUE ZEROES.
       01  ETTL-RESP              PIC S9(08) COMP VALUE ZEROES.
       01  SEVEN-DAYS             PIC S9(08) COMP VALUE 604800.
       01  TWENTY-FOUR-HOURS      PIC S9(08) COMP VALUE 86400.
       01  THIRTY-MINUTES         PIC S9(08) COMP VALUE 1800.
       01  FIVE-MINUTES           PIC S9(08) COMP VALUE 300.
       01  TWO-FIFTY-FIVE         PIC S9(08) COMP VALUE 255.
       01  THIRTY                 PIC S9(08) COMP VALUE 30.
       01  TWELVE                 PIC S9(08) COMP VALUE 12.
       01  TEN                    PIC S9(08) COMP VALUE 10.
       01  SEVEN                  PIC S9(08) COMP VALUE  7.
       01  SIX                    PIC S9(08) COMP VALUE  6.
       01  FIVE                   PIC S9(08) COMP VALUE  5.
       01  TWO                    PIC S9(08) COMP VALUE  2.
       01  ONE                    PIC S9(08) COMP VALUE  1.
       01  HTTP-NAME-LENGTH       PIC S9(08) COMP VALUE ZEROES.
       01  HTTP-VALUE-LENGTH      PIC S9(08) COMP VALUE ZEROES.
       01  CLIENT-CONVERT         PIC S9(08) COMP VALUE ZEROES.
       01  HTTP-HEADER            PIC  X(13) VALUE 'Authorization'.
       01  HTTP-HEADER-VALUE      PIC  X(64) VALUE SPACES.
       01  HEADER-ACAO.
           02  FILLER             PIC  X(16) VALUE 'Access-Control-A'.
           02  FILLER             PIC  X(11) VALUE 'llow-Origin'.
       01  HEADER-ACAO-LENGTH     PIC S9(08) COMP VALUE 27.
       01  VALUE-ACAO             PIC  X(01) VALUE '*'.
       01  VALUE-ACAO-LENGTH      PIC S9(08) COMP VALUE 01.
       01  ZECS003-COMM-AREA.
           02  CA-TYPE            PIC  X(03) VALUE 'ADR'.
           02  CA-URI-FIELD-01    PIC  X(10) VALUE SPACES.
       01  ZECS002-COMM-AREA.
           02  CA-RETURN-CODE     PIC  X(02) VALUE '00'.
           02  FILLER             PIC  X(02) VALUE SPACES.
           02  CA-USERID          PIC  X(08) VALUE SPACES.
           02  CA-PASSWORD        PIC  X(08) VALUE SPACES.
           02  CA-ENCODE          PIC  X(24) VALUE SPACES.
           02  FILLER             PIC  X(04) VALUE SPACES.
           02  CA-DECODE          PIC  X(18) VALUE SPACES.
       01  HTTP-STATUS-200        PIC S9(04) COMP VALUE 200.
       01  HTTP-STATUS-201        PIC S9(04) COMP VALUE 201.
       01  HTTP-STATUS-204        PIC S9(04) COMP VALUE 204.
       01  HTTP-STATUS-400        PIC S9(04) COMP VALUE 400.
       01  HTTP-STATUS-401        PIC S9(04) COMP VALUE 401.
       01  HTTP-STATUS-409        PIC S9(04) COMP VALUE 409.
       01  HTTP-STATUS-507        PIC S9(04) COMP VALUE 507.
       01  HTTP-201-TEXT          PIC  X(32) VALUE SPACES.
       01  HTTP-201-LENGTH        PIC S9(08) COMP VALUE 32.
       01  HTTP-204-TEXT          PIC  X(24) VALUE SPACES.
       01  HTTP-204-LENGTH        PIC S9(08) COMP VALUE ZEROES.
       01  HTTP-400-TEXT          PIC  X(32) VALUE SPACES.
       01  HTTP-400-LENGTH        PIC S9(08) COMP VALUE 32.
       01  HTTP-409-TEXT          PIC  X(32) VALUE SPACES.
       01  HTTP-409-LENGTH        PIC S9(08) COMP VALUE 32.
       01  HTTP-507-TEXT          PIC  X(24) VALUE SPACES.
       01  HTTP-507-LENGTH        PIC S9(08) COMP VALUE ZEROES.
       01  HTTP-OK                PIC  X(02) VALUE 'OK'.
       01  HTTP-NOT-FOUND         PIC  X(16) VALUE 'Record not found'.
       01  HTTP-KEY-ERROR         PIC  X(16) VALUE 'ZCxxKEY  error'.
       01  HTTP-FILE-ERROR        PIC  X(16) VALUE 'ZCxxFILE error'.
       01  FILLER.
           02  HTTP-ABSTIME       PIC  9(15) VALUE ZEROES.
       01  HTTP-NOT-FOUND-LENGTH  PIC S9(08) COMP VALUE 16.
       01  HTTP-KEY-LENGTH        PIC S9(08) COMP VALUE 16.
       01  HTTP-FILE-LENGTH       PIC S9(08) COMP VALUE 16.
       01  HTTP-ABSTIME-LENGTH    PIC S9(08) COMP VALUE 15.
       01  TEXT-ANYTHING          PIC  X(04) VALUE 'text'.
       01  TEXT-PLAIN             PIC  X(56) VALUE 'text/plain'.
       01  TEXT-HTML              PIC  X(56) VALUE 'text/html'.
       01  APPLICATION-XML        PIC  X(56) VALUE 'application/xml'.
       01  THE-URI.
           02  URI-TRANID         PIC  X(04) VALUE SPACES.
           02  FILLER             PIC  X(04) VALUE SPACES.
       01  URI-USERID             PIC  X(08) VALUE SPACES.
       01  AUTHENTICATE           PIC  X(01) VALUE SPACES.
       01  USER-ACCESS            PIC  X(01) VALUE SPACES.
       01  PROCESS-COMPLETE       PIC  X(01) VALUE SPACES.
       01  ZF-SUCCESSFUL          PIC  X(01) VALUE SPACES.
       01  HTTP-WEB-ERROR.
           02  FILLER             PIC  X(16) VALUE 'WEB RECEIVE erro'.
           02  FILLER             PIC  X(16) VALUE 'r               '.
       01  HTTP-KEY-PLUS.
           02  FILLER             PIC  X(16) VALUE 'Key exceeds maxi'.
           02  FILLER             PIC  X(16) VALUE 'mum 255 bytes   '.
       01  HTTP-KEY-ZERO.
           02  FILLER             PIC  X(16) VALUE 'Key must be grea'.
           02  FILLER             PIC  X(16) VALUE 'ter than 0 bytes'.
       01  HTTP-INVALID-URI.
           02  FILLER             PIC  X(16) VALUE 'Invalid URI form'.
           02  FILLER             PIC  X(16) VALUE 'at              '.
       01  HTTP-AUTH-ERROR.
           02  FILLER             PIC  X(16) VALUE 'Basic Authentica'.
           02  FILLER             PIC  X(16) VALUE 'tion failed     '.
       01  HTTP-CONFLICT.
           02  FILLER             PIC  X(16) VALUE 'POST/PUT conflic'.
           02  FILLER             PIC  X(16) VALUE 't with DELETE   '.
       01  HTTP-NOT-EXPIRED.
           02  FILLER             PIC  X(16) VALUE 'Record has not e'.
           02  FILLER             PIC  X(16) VALUE 'xpired.         '.
       01  CURRENT-ABS            PIC S9(15) VALUE ZEROES COMP-3.
       01  RELATIVE-TIME          PIC S9(15) VALUE ZEROES COMP-3.
       01  TTL-MILLISECONDS       PIC S9(15) VALUE ZEROES COMP-3.
       01  FILLER.
           02  TTL-SEC-MS.
               03  TTL-SECONDS    PIC  9(06) VALUE ZEROES.
               03  FILLER         PIC  9(03) VALUE ZEROES.
           02  FILLER REDEFINES TTL-SEC-MS.
               03  TTL-TIME       PIC  9(09).
       01  URI-FIELD-00           PIC  X(01).
       01  URI-FIELD-01           PIC  X(64).
       01  URI-FIELD-02           PIC  X(64).
       01  URI-FIELD-03           PIC  X(64).
       01  URI-FIELD-04           PIC  X(64).
       01  URI-KEY                PIC X(255) VALUE LOW-VALUES.
       01  URI-KEY-LENGTH         PIC S9(08) COMP VALUE ZEROES.
       01  URI-PATH-POINTER       PIC S9(08) COMP VALUE ZEROES.
       01  URI-PATH-LENGTH        PIC S9(08) COMP VALUE ZEROES.
       01  WEB-MEDIA-TYPE         PIC  X(56).
       01  SPACE-COUNTER          PIC S9(04) COMP VALUE ZEROES.
       01  SLASH-COUNTER          PIC S9(04) COMP VALUE ZEROES.
       01  SLASH                  PIC  X(01) VALUE '/'.
       01  EQUAL-SIGN             PIC  X(01) VALUE '='.
       01  QUERY-TEXT             PIC  X(10) VALUE SPACES.
       01  CLEAR-TEXT             PIC  X(01) VALUE SPACES.
       01  TTL-TYPE               PIC  X(03) VALUE SPACES.
       01  LAST-ACCESS-TIME       PIC  X(03) VALUE 'LAT'.
       01  LAST-UPDATE-TIME       PIC  X(03) VALUE 'LUT'.
       01  CONTAINER-LENGTH       PIC S9(08) COMP VALUE ZEROES.
       01  SEND-LENGTH            PIC S9(08) COMP VALUE ZEROES.
       01  RECEIVE-LENGTH         PIC S9(08) COMP VALUE 3200000.
       01  MAXIMUM-LENGTH         PIC S9(08) COMP VALUE 3200000.
       01  THREE-POINT-TWO-MB     PIC S9(08) COMP VALUE 3200000.
       01  THIRTY-TWO-KB          PIC S9(08) COMP VALUE 32000.
       01  MAX-SEGMENT-COUNT      PIC S9(08) COMP VALUE ZEROES.
       01  SEGMENT-COUNT          PIC S9(08) COMP VALUE ZEROES.
       01  SEGMENT-REMAINDER      PIC S9(08) COMP VALUE ZEROES.
       01  UNSEGMENTED-LENGTH     PIC S9(08) COMP VALUE ZEROES.
       01  SEND-ACTION            PIC S9(08) COMP VALUE ZEROES.
       01  ZECS-CONTAINER         PIC  X(16) VALUE 'ZECS_CONTAINER'.
       01  ZECS-CHANNEL           PIC  X(16) VALUE 'ZECS_CHANNEL'.
       01  WEB-METHOD             PIC S9(08) COMP VALUE ZEROES.
       01  WEB-SCHEME             PIC S9(08) COMP VALUE ZEROES.
       01  WEB-HOST-LENGTH        PIC S9(08) COMP VALUE 120.
       01  WEB-HTTPMETHOD-LENGTH  PIC S9(08) COMP VALUE 10.
       01  WEB-HTTPVERSION-LENGTH PIC S9(08) COMP VALUE 15.
       01  WEB-PATH-LENGTH        PIC S9(08) COMP VALUE 512.
       01  WEB-QUERYSTRING-LENGTH PIC S9(08) COMP VALUE 256.
       01  WEB-REQUESTTYPE        PIC S9(08) COMP VALUE ZEROES.
       01  WEB-PORT               PIC S9(08) COMP VALUE ZEROES.
       01  WEB-PORT-NUMBER        PIC  9(05)      VALUE ZEROES.
       01  WEB-HTTPMETHOD         PIC  X(10) VALUE SPACES.
       01  WEB-HTTP-PUT           PIC  X(10) VALUE 'PUT'.
       01  WEB-HTTP-GET           PIC  X(10) VALUE 'GET'.
       01  WEB-HTTP-POST          PIC  X(10) VALUE 'POST'.
       01  WEB-HTTP-DELETE        PIC  X(10) VALUE 'DELETE'.
       01  WEB-HTTPVERSION        PIC  X(15) VALUE SPACES.
       01  WEB-HOST               PIC X(120) VALUE SPACES.
       01  WEB-PATH               PIC X(512) VALUE LOW-VALUES.
       01  WEB-QUERYSTRING        PIC X(256) VALUE SPACES.
       01  FC-READ                PIC  X(07) VALUE 'READ   '.
       01  FC-WRITE               PIC  X(07) VALUE 'WRITE  '.
       01  FC-REWRITE             PIC  X(07) VALUE 'REWRITE'.
       01  CSSL                   PIC  X(04) VALUE '@tdq@'.
       01  TD-LENGTH              PIC S9(04) COMP VALUE ZEROES.
       01  TD-RECORD.
           02  TD-DATE            PIC  X(10).
           02  FILLER             PIC  X(01) VALUE SPACES.
           02  TD-TIME            PIC  X(08).
           02  FILLER             PIC  X(01) VALUE SPACES.
           02  TD-TRANID          PIC  X(04).
           02  FILLER             PIC  X(01) VALUE SPACES.
           02  TD-MESSAGE         PIC  X(90) VALUE SPACES.
       01  NO-SPACE-MESSAGE       PIC  X(08) VALUE ' NOSPACE'.
       01  50702-MESSAGE.
           02  FILLER             PIC  X(16) VALUE 'GET/READ primary'.
           02  FILLER             PIC  X(16) VALUE ' key references '.
           02  FILLER             PIC  X(16) VALUE 'an internal key '.
           02  FILLER             PIC  X(16) VALUE 'on *FILE that do'.
           02  FILLER             PIC  X(16) VALUE 'es not exist:   '.
           02  FILLER             PIC  X(02) VALUE SPACES.
           02  50702-KEY          PIC  X(08) VALUE 'xxxxxxxx'.
       01  FILE-ERROR.
           02  FE-DS              PIC  X(08) VALUE SPACES.
           02  FILLER             PIC  X(07) VALUE ' error '.
           02  FILLER             PIC  X(07) VALUE 'EIBFN: '.
           02  FE-FN              PIC  X(07) VALUE SPACES.
           02  FILLER             PIC  X(10) VALUE ' EIBRESP: '.
           02  FE-RESP            PIC  9(08) VALUE ZEROES.
           02  FILLER             PIC  X(11) VALUE ' EIBRESP2: '.
           02  FE-RESP2           PIC  9(08) VALUE ZEROES.
           02  FILLER             PIC  X(12) VALUE ' Paragraph: '.
           02  FE-PARAGRAPH       PIC  X(04) VALUE SPACES.
           02  FE-NOSPACE         PIC  X(08) VALUE SPACES.
           02  FILLER REDEFINES FE-NOSPACE.
               05  FE-RCODE       PIC  X(06).
               05  FILLER         PIC  X(02).
       01  KEY-ERROR.
           02  KE-DS              PIC  X(08) VALUE SPACES.
           02  FILLER             PIC  X(07) VALUE ' error '.
           02  FILLER             PIC  X(07) VALUE 'EIBFN: '.
           02  KE-FN              PIC  X(07) VALUE SPACES.
           02  FILLER             PIC  X(10) VALUE ' EIBRESP: '.
           02  KE-RESP            PIC  9(08) VALUE ZEROES.
           02  FILLER             PIC  X(11) VALUE ' EIBRESP2: '.
           02  KE-RESP2           PIC  9(08) VALUE ZEROES.
           02  FILLER             PIC  X(12) VALUE ' Paragraph: '.
           02  KE-PARAGRAPH       PIC  X(04) VALUE SPACES.
           02  KE-NOSPACE         PIC  X(08) VALUE SPACES.
       01  WEB-ERROR.
           02  FILLER             PIC  X(14) VALUE 'WEB RECEIVE er'.
           02  FILLER             PIC  X(07) VALUE 'ror -- '.
           02  FILLER             PIC  X(10) VALUE ' EIBRESP: '.
           02  WEB-RESP           PIC  9(08) VALUE ZEROES.
           02  FILLER             PIC  X(11) VALUE ' EIBRESP2: '.
           02  WEB-RESP2          PIC  9(08) VALUE ZEROES.
           02  FILLER             PIC  X(32) VALUE SPACES.
       01  SD-RESP                PIC S9(08) COMP.
       01  SD-INDEX               PIC S9(08) COMP.
       01  SD-LENGTH              PIC S9(08) COMP.
       01  SD-SELECT              PIC  X(06) VALUE 'SELECT'.
       01  SD-UPDATE              PIC  X(06) VALUE 'UPDATE'.
       01  SD-DELETE              PIC  X(06) VALUE 'DELETE'.
       01  SD-TOKEN               PIC  X(16) VALUE SPACES.
       01  ZECS-SD.
           02  SD-TRANID          PIC  X(04) VALUE 'ZC##'.
           02  SD-TYPE            PIC  X(02) VALUE 'SD'.
           02  FILLER             PIC  X(42) VALUE SPACES.
       01  SD-DSECT.
           02  SD-TABLE        OCCURS    63 TIMES.
               05  FILLER         PIC  X(05).
               05  SD-USER-ID     PIC  X(08).
               05  SD-COMMA       PIC  X(01).
               05  SD-ACCESS      PIC  X(06).
               05  SD-CRLF        PIC  X(02).
       01  LAT-PROGRAM.
           02  LAT-TRANID         PIC  X(04) VALUE 'ZC##'.
           02  LAT-ID             PIC  X(03) VALUE 'LAT'.
           02  FILLER             PIC  X(01) VALUE SPACES.
       01  ETTL-PROGRAM.
           02  ETTL-TRANID        PIC  X(04) VALUE 'ZC##'.
           02  ETTL-ID            PIC  X(04) VALUE 'ETTL'.
       01  THE-OTHER-DC-LENGTH    PIC S9(08) COMP VALUE ZEROES.
       01  DC-TOKEN               PIC  X(16) VALUE SPACES.
       01  DC-LENGTH              PIC S9(08) COMP VALUE ZEROES.
       01  ZECS-DC.
           02  DC-TRANID          PIC  X(04) VALUE 'ZC##'.
           02  FILLER             PIC  X(02) VALUE 'DC'.
           02  FILLER             PIC  X(42) VALUE SPACES.
       01  DC-CONTROL.
           02  FILLER             PIC  X(06).
           02  DC-TYPE            PIC  X(02) VALUE SPACES.
           02  DC-CRLF            PIC  X(02).
           02  THE-OTHER-DC       PIC X(160) VALUE SPACES.
           02  FILLER             PIC  X(02).
       01  ACTIVE-SINGLE          PIC  X(02) VALUE 'A1'.
       01  ACTIVE-ACTIVE          PIC  X(02) VALUE 'AA'.
       01  ACTIVE-STANDBY         PIC  X(02) VALUE 'AS'.
       01  SESSION-TOKEN          PIC  9(18) COMP VALUE ZEROES.
       01  URL-SCHEME-NAME        PIC  X(16) VALUE SPACES.
       01  URL-SCHEME             PIC S9(08) COMP VALUE ZEROES.
       01  URL-PORT               PIC S9(08) COMP VALUE ZEROES.
       01  URL-HOST-NAME          PIC  X(80) VALUE SPACES.
       01  URL-HOST-NAME-LENGTH   PIC S9(08) COMP VALUE 80.
       01  WEB-STATUS-CODE        PIC S9(04) COMP VALUE 00.
       01  WEB-STATUS-LENGTH      PIC S9(08) COMP VALUE 24.
       01  WEB-STATUS-TEXT        PIC  X(24) VALUE SPACES.
       01  CONVERSE-LENGTH        PIC S9(08) COMP VALUE 40.
       01  CONVERSE-RESPONSE      PIC  X(40) VALUE SPACES.
       01  ZK-FCT.
           02  ZK-TRANID          PIC  X(04) VALUE 'ZC##'.
           02  FILLER             PIC  X(04) VALUE 'KEY '.
       01  ZF-FCT.
           02  ZF-TRANID          PIC  X(04) VALUE 'ZC##'.
           02  FILLER             PIC  X(04) VALUE 'FILE'.
       01  ZK-LENGTH              PIC S9(04) COMP VALUE ZEROES.
       01  ZF-LENGTH              PIC S9(04) COMP VALUE ZEROES.
       01  DELETE-LENGTH          PIC S9(04) COMP VALUE 8.
       01  ZK-RECORD.
           02  ZK-KEY             PIC X(255) VALUE LOW-VALUES.
           02  FILLER             PIC  X(01) VALUE LOW-VALUES.
           02  ZK-ZF-KEY.
               05  ZK-ZF-IDN      PIC  X(06) VALUE LOW-VALUES.
               05  ZK-ZF-NC       PIC  X(02) VALUE LOW-VALUES.
           02  ZK-SEGMENTS        PIC  X(01) VALUE SPACES.
           02  FILLER             PIC X(247) VALUE SPACES.
       01  ZF-PREFIX              PIC S9(08) VALUE 356    COMP.
       01  ZF-RECORD.
           02  ZF-KEY-16.
               05  ZF-KEY.
                 10  ZF-KEY-IDN   PIC  X(06) VALUE LOW-VALUES.
                 10  ZF-KEY-NC    PIC  X(02) VALUE LOW-VALUES.
               05  ZF-SEGMENT     PIC  9(04) VALUE ZEROES COMP.
               05  ZF-SUFFIX      PIC  9(04) VALUE ZEROES COMP.
               05  ZF-ZEROES      PIC  9(08) VALUE ZEROES COMP.
           02  ZF-ABS             PIC S9(15) VALUE ZEROES COMP-3.
           02  ZF-TTL             PIC S9(07) VALUE ZEROES COMP-3.
           02  ZF-SEGMENTS        PIC  9(04) VALUE ZEROES COMP.
           02  ZF-EXTRA           PIC  X(15).
           02  ZF-ZK-KEY          PIC  X(255).
           02  ZF-MEDIA           PIC  X(56).
           02  ZF-DATA            PIC  X(32000).
           02  FILLER             PIC  X(344).
       01  DELETE-RECORD.
           02  DELETE-KEY-16.
               05  DELETE-KEY     PIC  X(08).
               05  DELETE-SEGMENT PIC  9(04) VALUE ZEROES COMP.
               05  DELETE-SUFFIX  PIC  9(04) VALUE ZEROES COMP.
               05  DELETE-ZEROES  PIC  9(08) VALUE ZEROES COMP.
       01  CACHE-LENGTH           PIC S9(08) COMP VALUE ZEROES.
       LINKAGE SECTION.
       01  DFHCOMMAREA            PIC  X(01).
       01  CACHE-MESSAGE          PIC  X(32000).
","['Top function with no name', '1000-ACCESS-PARMS', '1000-EXIT', '1100-PARSE-URI', '1100-EXIT', '1150-CHECK-URI', '1150-EXIT', '1160-MOVE-URI', '1160-EXIT', '1200-VALIDATION', '1200-EXIT', '1210-ZCXXSD', '1210-EXIT', '1300-QUERY-STRING', '1300-EXIT', '1310-TTL', '1310-EXIT', '1312-CHECK-ETTL', '1312-EXIT', '1320-CLEAR', '1320-EXIT', '1325-CLEAR-TYPE', '1325-EXIT', '1500-AUTHENTICATE', '1500-EXIT', '1600-USER-ACCESS', '1600-EXIT', '1610-SCAN-ZCXXSD', '1610-EXIT', '2000-PROCESS-REQUEST', '2000-EXIT', '3000-READ-CACHE', '3000-EXIT', '3100-READ-PROCESS', '3100-EXIT', '3200-READ-KEY', '3200-EXIT', '3300-READ-FILE', '3300-EXIT', '3310-CHECK-TTL', '3310-EXIT', '3400-STAGE', '3400-EXIT', '3500-READ-SEGMENTS', '3500-EXIT', '3510-FREEMAIN', '3510-EXIT', '3600-SEND-RESPONSE', '3600-EXIT', '4000-GET-COUNTER', '4000-EXIT', '4100-READ-KEY', '4100-EXIT', '4110-PRIME-KEY', '4110-EXIT', '4120-WRITE-KEY', '4120-EXIT', '4130-READ-KEY', '4130-EXIT', '4200-PROCESS-FILE', '4200-EXIT', '4300-SEND-RESPONSE', '4300-EXIT', '4400-WRITE-FILE', '4400-EXIT', '4500-UPDATE-KEY', '4500-EXIT', '4600-REPLICATE', '4600-EXIT', '4700-DELETE', '4700-EXIT', '5000-READ-KEY', '5000-EXIT', '5100-DELETE-KEY', '5100-EXIT', '5200-DELETE-FILE', '5200-EXIT', '5300-SEND-RESPONSE', '5300-EXIT', '5400-REPLICATE', '5400-EXIT', '5500-DEPLICATE-DELETE', '5500-EXIT', '5600-CHECK-TTL', '5600-EXIT', '5700-SEND-ABS', '5700-EXIT', '8000-GET-URL', '8000-EXIT', '8100-WEB-OPEN', '8100-EXIT', '8200-WEB-CONVERSE', '8200-EXIT', '8300-WEB-CLOSE', '8300-EXIT', '9000-RETURN', '9000-EXIT', '9001-ACAO', '9001-EXIT', '9100-FILE-ERROR', '9100-EXIT', '9200-KEY-ERROR', '9200-EXIT', '9300-WEB-ERROR', '9300-EXIT', '9400-STATUS-400', '9400-EXIT', '9500-STATUS-409', '9500-EXIT', '9600-AUTH-ERROR', '9600-EXIT', '9700-STATUS-204', '9700-EXIT', '9800-STATUS-507', '9800-EXIT', '9900-WRITE-CSSL', '9900-EXIT', '9950-ABS', '9950-EXIT', '9999-ROLLBACK', '9999-EXIT']","Paragraph Top function with no name calls paragraph 1000-EXIT, 2000-EXIT, 2000-PROCESS-REQUEST, 1000-ACCESS-PARMS, 9000-EXIT, 9000-RETURN.
Paragraph 1000-ACCESS-PARMS calls paragraph 1300-QUERY-STRING, 1500-EXIT, 1100-PARSE-URI, 1200-VALIDATION, 9300-WEB-ERROR, 1200-EXIT, 1600-EXIT, 9400-EXIT, 9400-STATUS-400, 9000-RETURN, 1600-USER-ACCESS, 1500-AUTHENTICATE, 9000-EXIT, 1160-EXIT, 9300-EXIT, 1300-EXIT, 1150-CHECK-URI, 1150-EXIT, 1100-EXIT, 1160-MOVE-URI.
Paragraph 1150-CHECK-URI calls paragraph 9400-EXIT, 9400-STATUS-400, 9000-EXIT, 9000-RETURN.
Paragraph 1160-MOVE-URI calls paragraph 9400-EXIT, 9400-STATUS-400, 9000-EXIT, 9000-RETURN.
Paragraph 1200-VALIDATION calls paragraph 1210-EXIT, 1210-ZCXXSD.
Paragraph 1300-QUERY-STRING calls paragraph 1320-EXIT, 9400-EXIT, 9400-STATUS-400, 1310-EXIT, 1320-CLEAR, 9000-EXIT, 9000-RETURN, 1310-TTL.
Paragraph 1310-TTL calls paragraph 1312-EXIT, 1312-CHECK-ETTL.
Paragraph 1320-CLEAR calls paragraph 1325-EXIT, 1325-CLEAR-TYPE.
Paragraph 1500-AUTHENTICATE calls paragraph 9000-EXIT, 9600-EXIT, 9000-RETURN, 9600-AUTH-ERROR.
Paragraph 1600-USER-ACCESS calls paragraph 9600-EXIT, 1610-EXIT, 1610-SCAN-ZCXXSD, 9000-EXIT, 9000-RETURN, 9600-AUTH-ERROR.
Paragraph 2000-PROCESS-REQUEST calls paragraph 4200-EXIT, 3600-EXIT, 5100-EXIT, 5300-EXIT, 5100-DELETE-KEY, 5200-DELETE-FILE, 4100-EXIT, 3000-EXIT, 4300-SEND-RESPONSE, 4300-EXIT, 4200-PROCESS-FILE, 5200-EXIT, 4000-EXIT, 4100-READ-KEY, 3000-READ-CACHE, 4000-GET-COUNTER, 5000-EXIT, 3600-SEND-RESPONSE, 5000-READ-KEY, 5300-SEND-RESPONSE.
Paragraph 3000-READ-CACHE calls paragraph 3100-EXIT, 3100-READ-PROCESS.
Paragraph 3100-READ-PROCESS calls paragraph 3300-EXIT, 3200-READ-KEY, 3400-EXIT, 3300-READ-FILE, 3400-STAGE, 3200-EXIT.
Paragraph 3200-READ-KEY calls paragraph 9800-STATUS-507, 9800-EXIT, 9700-STATUS-204, 9000-EXIT, 9200-KEY-ERROR, 9000-RETURN, 9200-EXIT, 9700-EXIT.
Paragraph 3300-READ-FILE calls paragraph 9950-ABS, 9800-STATUS-507, 3310-CHECK-TTL, 9100-FILE-ERROR, 9950-EXIT, 9800-EXIT, 3310-EXIT, 9000-EXIT, 9000-RETURN, 9100-EXIT.
Paragraph 3310-CHECK-TTL calls paragraph 5100-EXIT, 5100-DELETE-KEY, 5200-DELETE-FILE, 5200-EXIT, 9700-STATUS-204, 9000-EXIT, 9000-RETURN, 9700-EXIT.
Paragraph 3400-STAGE calls paragraph 3500-EXIT, 3500-READ-SEGMENTS.
Paragraph 3500-READ-SEGMENTS calls paragraph 3510-FREEMAIN, 3510-EXIT, 9800-STATUS-507, 9100-FILE-ERROR, 9800-EXIT, 9000-EXIT, 9000-RETURN, 9100-EXIT.
Paragraph 3600-SEND-RESPONSE calls paragraph 9001-EXIT, 9001-ACAO.
Paragraph 4100-READ-KEY calls paragraph 9800-STATUS-507, 9800-EXIT, 4110-PRIME-KEY, 9000-EXIT, 9200-KEY-ERROR, 9000-RETURN, 4110-EXIT, 9200-EXIT, 4120-WRITE-KEY, 4120-EXIT.
Paragraph 4120-WRITE-KEY calls paragraph 4130-READ-KEY, 9800-STATUS-507, 9800-EXIT, 4130-EXIT, 9000-EXIT, 9200-KEY-ERROR, 9000-RETURN, 9200-EXIT.
Paragraph 4130-READ-KEY calls paragraph 9800-STATUS-507, 9500-EXIT, 9800-EXIT, 4110-PRIME-KEY, 9000-EXIT, 9200-KEY-ERROR, 9000-RETURN, 4110-EXIT, 9200-EXIT, 9500-STATUS-409.
Paragraph 4200-PROCESS-FILE calls paragraph 9950-ABS, 4500-UPDATE-KEY, 4400-WRITE-FILE, 4400-EXIT, 9950-EXIT, 4500-EXIT.
Paragraph 4300-SEND-RESPONSE calls paragraph 4600-EXIT, 4600-REPLICATE, 8000-GET-URL, 4700-EXIT, 9001-ACAO, 8000-EXIT, 9001-EXIT, 4700-DELETE.
Paragraph 4400-WRITE-FILE calls paragraph 9000-RETURN, 9800-STATUS-507, 9100-FILE-ERROR, 9999-EXIT, 9800-EXIT, 9000-EXIT, 9999-ROLLBACK, 9100-EXIT.
Paragraph 4500-UPDATE-KEY calls paragraph 9800-STATUS-507, 9800-EXIT, 9000-EXIT, 9200-KEY-ERROR, 9000-RETURN, 9200-EXIT.
Paragraph 4600-REPLICATE calls paragraph 8300-WEB-CLOSE, 8200-WEB-CONVERSE, 8300-EXIT, 8100-WEB-OPEN, 8200-EXIT, 8100-EXIT.
Paragraph 5000-READ-KEY calls paragraph 5500-EXIT, 5500-DEPLICATE-DELETE, 9700-STATUS-204, 9000-EXIT, 9000-RETURN, 9700-EXIT.
Paragraph 5300-SEND-RESPONSE calls paragraph 8000-GET-URL, 9001-ACAO, 8000-EXIT, 5400-EXIT, 9001-EXIT, 5400-REPLICATE.
Paragraph 5400-REPLICATE calls paragraph 8300-WEB-CLOSE, 8200-WEB-CONVERSE, 8300-EXIT, 8100-WEB-OPEN, 8200-EXIT, 8100-EXIT.
Paragraph 5500-DEPLICATE-DELETE calls paragraph 5600-CHECK-TTL, 5600-EXIT.
Paragraph 5600-CHECK-TTL calls paragraph 5700-EXIT, 5700-SEND-ABS, 9000-EXIT, 9000-RETURN.
Paragraph 5700-SEND-ABS calls paragraph 9001-EXIT, 9001-ACAO.
Paragraph 9100-FILE-ERROR calls paragraph 9900-EXIT, 9900-WRITE-CSSL.
Paragraph 9200-KEY-ERROR calls paragraph 9900-EXIT, 9900-WRITE-CSSL.
Paragraph 9300-WEB-ERROR calls paragraph 9900-EXIT, 9900-WRITE-CSSL.
Paragraph 9400-STATUS-400 calls paragraph 9001-EXIT, 9001-ACAO.
Paragraph 9500-STATUS-409 calls paragraph 9001-EXIT, 9001-ACAO.
Paragraph 9600-AUTH-ERROR calls paragraph 9001-EXIT, 9001-ACAO.
Paragraph 9700-STATUS-204 calls paragraph 9001-EXIT, 9001-ACAO.
Paragraph 9800-STATUS-507 calls paragraph 9001-EXIT, 9001-ACAO.
Paragraph 9900-WRITE-CSSL calls paragraph 9950-ABS, 9950-EXIT.
",1459,"This program executes as a REST service. POST   - Create entry in   Cache. GET    - Read   entry from Cache. PUT    - Update entry in   Cache. DELETE - Delete entry from Cache. The KEY store will utilize VSAM/RLS. The FIEL/DATA store will utilize either a CICS Coupling Facility (CFDT), VSAM/RLS or CICS Shared Data Table (SDT), which is determined by the RDO FILE definition.",['ZECS002'],,"['CSSL', 'EXECCICSREA', 'EXECCICSWRIT', 'ZK-FCT', 'ZF-FCT']",Error Long,1,1,1,"This COBOL program processes web requests within a CICS environment, extracting parameters, performing validations, and returning responses. It begins by accessing web request parameters and validating them, then processes the request based on type���GET, POST, PUT, or DELETE. It handles user authentication, manages caching operations, and sends appropriate HTTP status codes based on outcomes. Error handling is implemented throughout, ensuring proper responses are returned to clients, including specific codes for invalid requests or successful operations.",
126,cicsdev_cics-banking-sample-application-cbsa,cics-banking-sample-application-cbsa/src/base/cobol_src/DELACC.cbl,"       CBL CICS('SP,EDF')
       CBL SQL
       IDENTIFICATION DIVISION.
       PROGRAM-ID. DELACC.
       AUTHOR. Jon Collett.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.  IBM-370.
       OBJECT-COMPUTER.  IBM-370.
       INPUT-OUTPUT SECTION.
       DATA DIVISION.
       FILE SECTION.
       WORKING-STORAGE SECTION.
       77 SORTCODE           PIC 9(6) VALUE 987654.
       01 SYSIDERR-RETRY               PIC 999.
       01 FILE-RETRY                   PIC 999.
       01 WS-EXIT-RETRY-LOOP           PIC X VALUE ' '.
           EXEC SQL
              INCLUDE ACCDB2
           END-EXEC.
       01 HOST-ACCOUNT-ROW.
           03 HV-ACCOUNT-EYECATCHER     PIC X(4).
           03 HV-ACCOUNT-CUST-NO        PIC X(10).
           03 HV-ACCOUNT-SORTCODE       PIC X(6).
           03 HV-ACCOUNT-ACC-NO         PIC X(8).
           03 HV-ACCOUNT-ACC-TYPE       PIC X(8).
           03 HV-ACCOUNT-INT-RATE       PIC S9(4)V99 COMP-3.
           03 HV-ACCOUNT-OPENED         PIC X(10).
           03 HV-ACCOUNT-OVERDRAFT-LIM  PIC S9(9) COMP.
           03 HV-ACCOUNT-LAST-STMT      PIC X(10).
           03 HV-ACCOUNT-NEXT-STMT      PIC X(10).
           03 HV-ACCOUNT-AVAIL-BAL      PIC S9(10)V99 COMP-3.
           03 HV-ACCOUNT-ACTUAL-BAL     PIC S9(10)V99 COMP-3.
           EXEC SQL
              INCLUDE PROCDB2
           END-EXEC.
       01 HOST-PROCTRAN-ROW.
           03 HV-PROCTRAN-EYECATCHER    PIC X(4).
           03 HV-PROCTRAN-SORT-CODE     PIC X(6).
           03 HV-PROCTRAN-ACC-NUMBER    PIC X(8).
           03 HV-PROCTRAN-DATE          PIC X(10).
           03 HV-PROCTRAN-TIME          PIC X(6).
           03 HV-PROCTRAN-REF           PIC X(12).
           03 HV-PROCTRAN-TYPE          PIC X(3).
           03 HV-PROCTRAN-DESC          PIC X(40).
           03 HV-PROCTRAN-AMOUNT        PIC S9(10)V99 COMP-3.
           EXEC SQL
              INCLUDE SQLCA
           END-EXEC.
       01 SQLCODE-DISPLAY              PIC S9(8) DISPLAY
           SIGN LEADING SEPARATE.
       01 WS-CICS-WORK-AREA.
           05 WS-CICS-RESP              PIC S9(8) COMP.
           05 WS-CICS-RESP2             PIC S9(8) COMP.
           05 WS-EIBRESP-DISPLAY        PIC S9(8) DISPLAY
                                   SIGN LEADING SEPARATE.
       01 WS-APPLID                    PIC X(8).
       01 EXIT-BROWSE-LOOP             PIC X VALUE 'N'.
       01 OUTPUT-DATA.
              03 ACCOUNT-DATA.
                 05 ACCOUNT-EYE-CATCHER        PIC X(4).
                 88 ACCOUNT-EYECATCHER-VALUE        VALUE 'ACCT'.
                 05 ACCOUNT-CUST-NO            PIC 9(10).
                 05 ACCOUNT-KEY.
                    07 ACCOUNT-SORT-CODE       PIC 9(6).
                    07 ACCOUNT-NUMBER          PIC 9(8).
                 05 ACCOUNT-TYPE               PIC X(8).
                 05 ACCOUNT-INTEREST-RATE      PIC 9(4)V99.
                 05 ACCOUNT-OPENED             PIC 9(8).
                 05 ACCOUNT-OPENED-GROUP REDEFINES ACCOUNT-OPENED.
                    07 ACCOUNT-OPENED-DAY       PIC 99.
                    07 ACCOUNT-OPENED-MONTH     PIC 99.
                    07 ACCOUNT-OPENED-YEAR      PIC 9999.
                 05 ACCOUNT-OVERDRAFT-LIMIT    PIC 9(8).
                 05 ACCOUNT-LAST-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-LAST-STMT-GROUP
                    REDEFINES ACCOUNT-LAST-STMT-DATE.
                    07 ACCOUNT-LAST-STMT-DAY   PIC 99.
                    07 ACCOUNT-LAST-STMT-MONTH PIC 99.
                    07 ACCOUNT-LAST-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-NEXT-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-NEXT-STMT-GROUP
                   REDEFINES ACCOUNT-NEXT-STMT-DATE.
                    07 ACCOUNT-NEXT-STMT-DAY   PIC 99.
                    07 ACCOUNT-NEXT-STMT-MONTH PIC 99.
                    07 ACCOUNT-NEXT-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-AVAILABLE-BALANCE  PIC S9(10)V99.
                 05 ACCOUNT-ACTUAL-BALANCE     PIC S9(10)V99.
       01 PROCTRAN-AREA.
           03 PROC-TRAN-DATA.
              05 PROC-TRAN-EYE-CATCHER        PIC X(4).
              88 PROC-TRAN-VALID VALUE 'PRTR'.
              05 PROC-TRAN-LOGICAL-DELETE-AREA REDEFINES
                 PROC-TRAN-EYE-CATCHER.
                 07 PROC-TRAN-LOGICAL-DELETE-FLAG PIC X.
                 88 PROC-TRAN-LOGICALLY-DELETED VALUE X'FF'.
                 07 FILLER PIC X(3).
              05 PROC-TRAN-ID.
                 07 PROC-TRAN-SORT-CODE       PIC 9(6).
                 07 PROC-TRAN-NUMBER          PIC 9(8).
              05 PROC-TRAN-DATE               PIC 9(8).
              05 PROC-TRAN-DATE-GRP REDEFINES PROC-TRAN-DATE.
                 07 PROC-TRAN-DATE-GRP-YYYY   PIC 9999.
                 07 PROC-TRAN-DATE-GRP-MM     PIC 99.
                 07 PROC-TRAN-DATE-GRP-DD     PIC 99.
              05 PROC-TRAN-TIME               PIC 9(6).
              05 PROC-TRAN-TIME-GRP REDEFINES PROC-TRAN-TIME.
                 07 PROC-TRAN-TIME-GRP-HH     PIC 99.
                 07 PROC-TRAN-TIME-GRP-MM     PIC 99.
                 07 PROC-TRAN-TIME-GRP-SS     PIC 99.
              05 PROC-TRAN-REF                PIC 9(12).
              05 PROC-TRAN-TYPE               PIC X(3).
              88 PROC-TY-CHEQUE-ACKNOWLEDGED      VALUE 'CHA'.
              88 PROC-TY-CHEQUE-FAILURE           VALUE 'CHF'.
              88 PROC-TY-CHEQUE-PAID-IN           VALUE 'CHI'.
              88 PROC-TY-CHEQUE-PAID-OUT          VALUE 'CHO'.
              88 PROC-TY-CREDIT                   VALUE 'CRE'.
              88 PROC-TY-DEBIT                    VALUE 'DEB'.
              88 PROC-TY-WEB-CREATE-ACCOUNT       VALUE 'ICA'.
              88 PROC-TY-WEB-CREATE-CUSTOMER      VALUE 'ICC'.
              88 PROC-TY-WEB-DELETE-ACCOUNT       VALUE 'IDA'.
              88 PROC-TY-WEB-DELETE-CUSTOMER      VALUE 'IDC'.
              88 PROC-TY-BRANCH-CREATE-ACCOUNT    VALUE 'OCA'.
              88 PROC-TY-BRANCH-CREATE-CUSTOMER   VALUE 'OCC'.
              88 PROC-TY-BRANCH-DELETE-ACCOUNT    VALUE 'ODA'.
              88 PROC-TY-BRANCH-DELETE-CUSTOMER   VALUE 'ODC'.
              88 PROC-TY-CREATE-SODD              VALUE 'OCS'.
              88 PROC-TY-PAYMENT-CREDIT           VALUE 'PCR'.
              88 PROC-TY-PAYMENT-DEBIT            VALUE 'PDR'.
              88 PROC-TY-TRANSFER                 VALUE 'TFR'.
              05 PROC-TRAN-DESC               PIC X(40).
              05 PROC-TRAN-DESC-XFR REDEFINES PROC-TRAN-DESC.
                07 PROC-TRAN-DESC-XFR-HEADER PIC X(26).
                88 PROC-TRAN-DESC-XFR-FLAG
                   VALUE 'TRANSFER'.
                07 PROC-TRAN-DESC-XFR-SORTCODE
                   PIC 9(6).
                07 PROC-TRAN-DESC-XFR-ACCOUNT
                   PIC 9(8).
              05 PROC-TRAN-DESC-DELACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELACC-ACCTYPE PIC X(8).
                07 PROC-DESC-DELACC-LAST-DD PIC 99.
                07 PROC-DESC-DELACC-LAST-MM PIC 99.
                07 PROC-DESC-DELACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-DELACC-NEXT-DD PIC 99.
                07 PROC-DESC-DELACC-NEXT-MM PIC 99.
                07 PROC-DESC-DELACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-DELACC-FOOTER PIC X(6).
                88 PROC-DESC-DELACC-FLAG
                   VALUE 'DELETE'.
              05 PROC-TRAN-DESC-CREACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CREACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-CREACC-ACCTYPE PIC X(8).
                07 PROC-DESC-CREACC-LAST-DD PIC 99.
                07 PROC-DESC-CREACC-LAST-MM PIC 99.
                07 PROC-DESC-CREACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-CREACC-NEXT-DD PIC 99.
                07 PROC-DESC-CREACC-NEXT-MM PIC 99.
                07 PROC-DESC-CREACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-CREACC-FOOTER PIC X(6).
                88 PROC-DESC-CREACC-FLAG
                   VALUE 'CREATE'.
              05 PROC-TRAN-DESC-DELCUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELCUS-SORTCODE PIC 9(6).
                07 PROC-DESC-DELCUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELCUS-NAME     PIC X(14).
                07 PROC-DESC-DELCUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-DELCUS-FILLER    PIC X.
                88 PROC-DESC-DELCUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-MM    PIC 99.
                07 PROC-DESC-DELCUS-FILLER2   PIC X.
                88 PROC-DESC-DELCUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-DD    PIC 99.
              05 PROC-TRAN-DESC-CRECUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CRECUS-SORTCODE PIC 9(6).
                07 PROC-DESC-CRECUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-CRECUS-NAME     PIC X(14).
                07 PROC-DESC-CRECUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-CRECUS-FILLER    PIC X.
                88 PROC-DESC-CRECUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-MM    PIC 99.
                07 PROC-DESC-CRECUS-FILLER2   PIC X.
                88 PROC-DESC-CRECUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-DD    PIC 99.
              05 PROC-TRAN-AMOUNT             PIC S9(10)V99.
       01 PROCTRAN-RIDFLD              PIC S9(8) COMP.
       77 PROCTRAN-RETRY               PIC 999.
       01 ACCOUNT-ACT-BAL-STORE        PIC S9(10)V99 VALUE 0.
       01 RETURNED-DATA.
           03 RETURNED-EYE-CATCHER        PIC X(4).
           03 RETURNED-CUST-NO            PIC 9(10).
           03 RETURNED-KEY.
              05 RETURNED-SORT-CODE       PIC 9(6).
              05 RETURNED-NUMBER          PIC 9(8).
           03 RETURNED-TYPE               PIC X(8).
           03 RETURNED-INTEREST-RATE      PIC 9(4)V99.
           03 RETURNED-OPENED             PIC 9(8).
           03 RETURNED-OVERDRAFT-LIMIT    PIC 9(8).
           03 RETURNED-LAST-STMT-DATE     PIC 9(8).
           03 RETURNED-NEXT-STMT-DATE     PIC 9(8).
           03 RETURNED-AVAILABLE-BALANCE  PIC S9(10)V99.
           03 RETURNED-ACTUAL-BALANCE     PIC S9(10)V99.
       01 DESIRED-KEY                  PIC 9(10) BINARY.
       01 DB2-DATE-REFORMAT.
          03 DB2-DATE-REF-YR           PIC 9(4).
          03 FILLER                    PIC X.
          03 DB2-DATE-REF-MNTH         PIC 99.
          03 FILLER                    PIC X.
          03 DB2-DATE-REF-DAY          PIC 99.
       01 DATA-STORE-TYPE              PIC X.
          88 DATASTORE-TYPE-DB2           VALUE '2'.
          88 DATASTORE-TYPE-VSAM          VALUE 'V'.
       01 DB2-EXIT-LOOP                PIC X.
       01 FETCH-DATA-CNT               PIC 9(4) COMP.
       01 WS-CUST-ALT-KEY-LEN          PIC S9(4) COMP VALUE +10.
       01 WS-EIBTASKN12                PIC 9(12) VALUE 0.
       01 ACCOUNT-KEY-RID.
          03 REQUIRED-SORT-CODE        PIC 9(6)  VALUE 0.
          03 REQUIRED-ACC-NUM          PIC 9(8)  VALUE 0.
       01 MY-TCB                       PIC S9(8) BINARY.
       01 MY-TCB-STRING                PIC X(8).
       01 WS-ACC-KEY-LEN               PIC S9(4) COMP VALUE +14.
       01 WS-ACC-NUM                   PIC S9(4) COMP VALUE 0.
       01 WS-U-TIME                    PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                 PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD              PIC 99.
          03 FILLER                       PIC X.
          03 WS-ORIG-DATE-MM              PIC 99.
          03 FILLER                       PIC X.
          03 WS-ORIG-DATE-YYYY            PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-MM-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X       PIC X(4).
       01 WS-TOKEN                     PIC S9(8) BINARY.
       01 STORM-DRAIN-CONDITION        PIC X(20).
       01 ACCOUNT-CONTROL.
              03 ACCOUNT-CONTROL-RECORD.
                 05 ACCOUNT-CONTROL-EYE-CATCHER        PIC X(4).
                 88 ACCOUNT-CONTROL-EYECATCHER-V   VALUE 'CTRL'.
                 05 FILLER                     PIC 9(10).
                 05 ACCOUNT-CONTROL-KEY.
                    07 ACCOUNT-CONTROL-SORT-CODE       PIC 9(6).
                    07 ACCOUNT-CONTROL-NUMBER          PIC 9(8).
                 05 NUMBER-OF-ACCOUNTS                 PIC 9(8).
                 05 LAST-ACCOUNT-NUMBER                PIC 9(8).
                 05 ACCOUNT-CONTROL-SUCCESS-FLAG       PIC X.
                 88 ACCOUNT-CONTROL-SUCCESS VALUE 'Y'.
                 05 ACCOUNT-CONTROL-FAIL-CODE PIC X.
                 05 FILLER                     PIC 9(4)V99.
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC S9(10)V99.
                 05 FILLER                     PIC X(2).
       01 WS-TIME-DATA.
           03 WS-TIME-NOW              PIC 9(6).
           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
              05 WS-TIME-NOW-GRP-HH       PIC 99.
              05 WS-TIME-NOW-GRP-MM       PIC 99.
              05 WS-TIME-NOW-GRP-SS       PIC 99.
       01 WS-ABEND-PGM                    PIC X(8) VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 DELACC-EYE                  PIC X(4).
          03 DELACC-CUSTNO               PIC X(10).
          03 DELACC-SCODE                PIC X(6).
          03 DELACC-ACCNO                PIC 9(8).
          03 DELACC-ACC-TYPE             PIC X(8).
          03 DELACC-INT-RATE             PIC 9(4)V99.
          03 DELACC-OPENED               PIC 9(8).
          03 DELACC-OPENED-GROUP REDEFINES DELACC-OPENED.
            05 DELACC-OPENED-DAY   PIC 99.
            05 DELACC-OPENED-MONTH PIC 99.
            05 DELACC-OPENED-YEAR  PIC 9999.
          03 DELACC-OVERDRAFT            PIC 9(8).
          03 DELACC-LAST-STMT-DT         PIC 9(8).
          03 DELACC-LAST-STMT-GROUP REDEFINES DELACC-LAST-STMT-DT.
            05 DELACC-LAST-STMT-DAY   PIC 99.
            05 DELACC-LAST-STMT-MONTH PIC 99.
            05 DELACC-LAST-STMT-YEAR  PIC 9999.
          03 DELACC-NEXT-STMT-DT         PIC 9(8).
          03 DELACC-NEXT-STMT-GROUP REDEFINES DELACC-NEXT-STMT-DT.
            05 DELACC-NEXT-STMT-DAY   PIC 99.
            05 DELACC-NEXT-STMT-MONTH PIC 99.
            05 DELACC-NEXT-STMT-YEAR  PIC 9999.
          03 DELACC-AVAIL-BAL            PIC S9(10)V99.
          03 DELACC-ACTUAL-BAL           PIC S9(10)V99.
          03 DELACC-SUCCESS              PIC X.
          03 DELACC-FAIL-CD              PIC X.
          03 DELACC-DEL-SUCCESS          PIC X.
          03 DELACC-DEL-FAIL-CD          PIC X.
          03 DELACC-DEL-APPLID           PIC X(8).
          03 DELACC-DEL-PCB1             POINTER.
          03 DELACC-DEL-PCB2             POINTER.
          03 DELACC-DEL-PCB3             POINTER.
       PROCEDURE DIVISION USING DFHCOMMAREA.
       PREMIERE SECTION.
       A010.
           MOVE SORTCODE TO REQUIRED-SORT-CODE OF ACCOUNT-KEY-RID.
           PERFORM READ-ACCOUNT-DB2.
           IF DELACC-DEL-SUCCESS = 'Y'
             PERFORM DEL-ACCOUNT-DB2
             IF DELACC-DEL-SUCCESS = 'Y'
               PERFORM WRITE-PROCTRAN
             END-IF
           END-IF
           PERFORM GET-ME-OUT-OF-HERE.
       A999.
           EXIT.
       READ-ACCOUNT-DB2 SECTION.
       RAD010.
           MOVE DELACC-ACCNO
              TO HV-ACCOUNT-ACC-NO.
           MOVE SORTCODE TO HV-ACCOUNT-SORTCODE.
           EXEC SQL
              SELECT ACCOUNT_EYECATCHER,
                     ACCOUNT_CUSTOMER_NUMBER,
                     ACCOUNT_SORTCODE,
                     ACCOUNT_NUMBER,
                     ACCOUNT_TYPE,
                     ACCOUNT_INTEREST_RATE,
                     ACCOUNT_OPENED,
                     ACCOUNT_OVERDRAFT_LIMIT,
                     ACCOUNT_LAST_STATEMENT,
                     ACCOUNT_NEXT_STATEMENT,
                     ACCOUNT_AVAILABLE_BALANCE,
                     ACCOUNT_ACTUAL_BALANCE
              INTO  :HV-ACCOUNT-EYECATCHER,
                    :HV-ACCOUNT-CUST-NO,
                    :HV-ACCOUNT-SORTCODE,
                    :HV-ACCOUNT-ACC-NO,
                    :HV-ACCOUNT-ACC-TYPE,
                    :HV-ACCOUNT-INT-RATE,
                    :HV-ACCOUNT-OPENED,
                    :HV-ACCOUNT-OVERDRAFT-LIM,
                    :HV-ACCOUNT-LAST-STMT,
                    :HV-ACCOUNT-NEXT-STMT,
                    :HV-ACCOUNT-AVAIL-BAL,
                    :HV-ACCOUNT-ACTUAL-BAL
              FROM ACCOUNT
              WHERE   ACCOUNT_NUMBER = :HV-ACCOUNT-ACC-NO AND
                    ACCOUNT_SORTCODE = :HV-ACCOUNT-SORTCODE
           END-EXEC.
           IF SQLCODE NOT = 0 AND SQLCODE NOT = +100
              MOVE SQLCODE TO SQLCODE-DISPLAY
              INITIALIZE ABNDINFO-REC
              MOVE ZERO       TO ABND-RESPCODE
              MOVE ZERO       TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME  TO ABND-UTIME-KEY
              MOVE 'HRAC'     TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE SQLCODE-DISPLAY      TO ABND-SQLCODE
              STRING 'RAD010 - Issue with ACCOUNT row select, for '
                     DELIMITED BY SIZE,
                     'Account ' HV-ACCOUNT-ACC-NO
                     DELIMITED BY SIZE,
                     'and SORTCODE ' HV-ACCOUNT-SORTCODE
                     DELIMITED BY SIZE,
                     ' EIBRESP=' DELIMITED BY SIZE,
                     ABND-RESPCODE DELIMITED BY SIZE,
                     ' RESP2=' DELIMITED BY SIZE
                     INTO ABND-FREEFORM
              END-STRING
              DISPLAY 'Issue with ACCOUNT row select. SQLCODE='
                 SQLCODE-DISPLAY ' . For Account ' HV-ACCOUNT-ACC-NO
                 ' and Sortcode' HV-ACCOUNT-SORTCODE
              EXEC CICS ABEND ABCODE('HRAC')
                   NODUMP
              END-EXEC
           END-IF.
           IF SQLCODE = +100
              INITIALIZE OUTPUT-DATA
              MOVE SORTCODE TO ACCOUNT-SORT-CODE OF OUTPUT-DATA
              MOVE DELACC-ACCNO TO ACCOUNT-NUMBER OF OUTPUT-DATA
              MOVE 'N' TO DELACC-DEL-SUCCESS
              MOVE '1' TO DELACC-DEL-FAIL-CD
              GO TO RAD999
           END-IF.
           IF SQLCODE = 0
              MOVE ' ' TO DELACC-SUCCESS
              MOVE 'Y' TO DELACC-DEL-SUCCESS
              MOVE ' ' TO DELACC-DEL-FAIL-CD
           END-IF.
           MOVE HV-ACCOUNT-EYECATCHER TO
              ACCOUNT-EYE-CATCHER OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-CUST-NO TO
              ACCOUNT-CUST-NO OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-SORTCODE TO
              ACCOUNT-SORT-CODE OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-ACC-NO TO
              ACCOUNT-NUMBER OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-ACC-TYPE TO
              ACCOUNT-TYPE OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-INT-RATE TO
              ACCOUNT-INTEREST-RATE OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-OPENED TO DB2-DATE-REFORMAT.
           MOVE DB2-DATE-REF-DAY TO
              ACCOUNT-OPENED-DAY OF OUTPUT-DATA.
           MOVE DB2-DATE-REF-MNTH TO
              ACCOUNT-OPENED-MONTH OF OUTPUT-DATA.
           MOVE DB2-DATE-REF-YR TO
              ACCOUNT-OPENED-YEAR OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-OVERDRAFT-LIM TO
              ACCOUNT-OVERDRAFT-LIMIT OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-LAST-STMT TO DB2-DATE-REFORMAT.
           MOVE DB2-DATE-REF-DAY TO
              ACCOUNT-LAST-STMT-DAY OF OUTPUT-DATA.
           MOVE DB2-DATE-REF-MNTH TO
              ACCOUNT-LAST-STMT-MONTH OF OUTPUT-DATA.
           MOVE DB2-DATE-REF-YR TO
              ACCOUNT-LAST-STMT-YEAR OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-NEXT-STMT TO DB2-DATE-REFORMAT
           MOVE DB2-DATE-REF-DAY TO
              ACCOUNT-NEXT-STMT-DAY OF OUTPUT-DATA.
           MOVE DB2-DATE-REF-MNTH TO
              ACCOUNT-NEXT-STMT-MONTH OF OUTPUT-DATA.
           MOVE DB2-DATE-REF-YR TO
              ACCOUNT-NEXT-STMT-YEAR OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-AVAIL-BAL TO
              ACCOUNT-AVAILABLE-BALANCE OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-ACTUAL-BAL TO
              ACCOUNT-ACTUAL-BALANCE OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-ACTUAL-BAL TO ACCOUNT-ACT-BAL-STORE.
           MOVE ACCOUNT-EYE-CATCHER       TO DELACC-EYE.
           MOVE ACCOUNT-CUST-NO           TO DELACC-CUSTNO.
           MOVE ACCOUNT-SORT-CODE         TO DELACC-SCODE.
           MOVE ACCOUNT-NUMBER            TO DELACC-ACCNO.
           MOVE ACCOUNT-TYPE              TO DELACC-ACC-TYPE.
           MOVE ACCOUNT-INTEREST-RATE     TO DELACC-INT-RATE.
           MOVE ACCOUNT-OPENED            TO DELACC-OPENED.
           MOVE ACCOUNT-OVERDRAFT-LIMIT   TO DELACC-OVERDRAFT.
           MOVE ACCOUNT-LAST-STMT-DATE    TO DELACC-LAST-STMT-DT.
           MOVE ACCOUNT-NEXT-STMT-DATE    TO DELACC-NEXT-STMT-DT.
           MOVE ACCOUNT-AVAILABLE-BALANCE TO DELACC-AVAIL-BAL.
           MOVE ACCOUNT-ACTUAL-BALANCE    TO DELACC-ACTUAL-BAL.
           MOVE ACCOUNT-ACTUAL-BALANCE    TO ACCOUNT-ACT-BAL-STORE.
       RAD999.
           EXIT.
       DEL-ACCOUNT-DB2 SECTION.
       DADB010.
           EXEC SQL
              DELETE FROM ACCOUNT
              WHERE ACCOUNT_SORTCODE = :HV-ACCOUNT-SORTCODE AND
                    ACCOUNT_NUMBER = :HV-ACCOUNT-ACC-NO
           END-EXEC.
           IF SQLCODE NOT = 0
              MOVE ' ' TO DELACC-SUCCESS
              MOVE 'N' TO DELACC-DEL-SUCCESS
              MOVE '3' TO DELACC-DEL-FAIL-CD
           END-IF.
       DADB999.
           EXIT.
       WRITE-PROCTRAN SECTION.
       WP010.
           PERFORM WRITE-PROCTRAN-DB2.
       WP999.
           EXIT.
       WRITE-PROCTRAN-DB2 SECTION.
       WPD010.
           INITIALIZE HOST-PROCTRAN-ROW.
           INITIALIZE WS-EIBTASKN12.
           MOVE 'PRTR' TO HV-PROCTRAN-EYECATCHER.
           MOVE ACCOUNT-SORT-CODE  TO HV-PROCTRAN-SORT-CODE.
           MOVE ACCOUNT-NUMBER     TO HV-PROCTRAN-ACC-NUMBER.
           MOVE EIBTASKN           TO WS-EIBTASKN12.
           MOVE WS-EIBTASKN12      TO HV-PROCTRAN-REF.
           EXEC CICS ASKTIME
              ABSTIME(WS-U-TIME)
           END-EXEC.
           EXEC CICS FORMATTIME
                     ABSTIME(WS-U-TIME)
                     DDMMYYYY(WS-ORIG-DATE)
                     TIME(HV-PROCTRAN-TIME)
                     DATESEP('.')
           END-EXEC.
           MOVE WS-ORIG-DATE TO WS-ORIG-DATE-GRP-X.
           MOVE WS-ORIG-DATE-GRP-X TO HV-PROCTRAN-DATE.
           MOVE ACCOUNT-CUST-NO    TO PROC-DESC-DELACC-CUSTOMER
            OF PROCTRAN-AREA
           MOVE ACCOUNT-TYPE       TO PROC-DESC-DELACC-ACCTYPE
            OF PROCTRAN-AREA
           MOVE ACCOUNT-LAST-STMT-DAY
             TO PROC-DESC-DELACC-LAST-DD  OF PROCTRAN-AREA
           MOVE ACCOUNT-LAST-STMT-MONTH
             TO PROC-DESC-DELACC-LAST-MM  OF PROCTRAN-AREA
           MOVE ACCOUNT-LAST-STMT-YEAR
             TO PROC-DESC-DELACC-LAST-YYYY  OF PROCTRAN-AREA
           MOVE ACCOUNT-NEXT-STMT-DAY
             TO PROC-DESC-DELACC-NEXT-DD  OF PROCTRAN-AREA
           MOVE ACCOUNT-NEXT-STMT-MONTH
             TO PROC-DESC-DELACC-NEXT-MM  OF PROCTRAN-AREA
           MOVE ACCOUNT-NEXT-STMT-YEAR
             TO PROC-DESC-DELACC-NEXT-YYYY  OF PROCTRAN-AREA
           SET PROC-DESC-DELACC-FLAG  OF PROCTRAN-AREA TO TRUE.
           SET PROC-TY-BRANCH-DELETE-ACCOUNT  OF PROCTRAN-AREA TO TRUE.
           MOVE PROC-TRAN-DESC  OF PROCTRAN-AREA TO HV-PROCTRAN-DESC
           MOVE PROC-TRAN-TYPE  OF PROCTRAN-AREA TO HV-PROCTRAN-TYPE.
           MOVE ACCOUNT-ACT-BAL-STORE    TO HV-PROCTRAN-AMOUNT.
           EXEC SQL
              INSERT INTO PROCTRAN
                     (
                      PROCTRAN_EYECATCHER,
                      PROCTRAN_SORTCODE,
                      PROCTRAN_NUMBER,
                      PROCTRAN_DATE,
                      PROCTRAN_TIME,
                      PROCTRAN_REF,
                      PROCTRAN_TYPE,
                      PROCTRAN_DESC,
                      PROCTRAN_AMOUNT
                     )
              VALUES
                     (
                      :HV-PROCTRAN-EYECATCHER,
                      :HV-PROCTRAN-SORT-CODE,
                      :HV-PROCTRAN-ACC-NUMBER,
                      :HV-PROCTRAN-DATE,
                      :HV-PROCTRAN-TIME,
                      :HV-PROCTRAN-REF,
                      :HV-PROCTRAN-TYPE,
                      :HV-PROCTRAN-DESC,
                      :HV-PROCTRAN-AMOUNT
                     )
           END-EXEC.
           IF SQLCODE NOT = 0
              MOVE SQLCODE TO SQLCODE-DISPLAY
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HWPT'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE SQLCODE-DISPLAY    TO ABND-SQLCODE
              STRING 'WPD010 - Unable to  WRITE to PROCTRAN row '
                    DELIMITED BY SIZE,
                    'datastore with the following data:'
                    DELIMITED BY SIZE,
                    HOST-PROCTRAN-ROW DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              DISPLAY 'In DELACC (WPD010) '
              'UNABLE TO WRITE TO PROCTRAN ROW DATASTORE'
              ' SQLCODE=' SQLCODE-DISPLAY
              'WITH THE FOLLOWING DATA:' HOST-PROCTRAN-ROW
              EXEC CICS ABEND
                 ABCODE ('HWPT')
              END-EXEC
           END-IF.
       WPD999.
           EXIT.
       GET-ME-OUT-OF-HERE SECTION.
       GMOFH010.
           GOBACK.
       GMOFH999.
           EXIT.
       POPULATE-TIME-DATE SECTION.
       PTD010.
           EXEC CICS ASKTIME
              ABSTIME(WS-U-TIME)
           END-EXEC.
           EXEC CICS FORMATTIME
                     ABSTIME(WS-U-TIME)
                     DDMMYYYY(WS-ORIG-DATE)
                     TIME(WS-TIME-NOW)
                     DATESEP
           END-EXEC.
       PTD999.
           EXIT.
","       FILE SECTION.
       WORKING-STORAGE SECTION.
       77 SORTCODE           PIC 9(6) VALUE 987654.
       01 SYSIDERR-RETRY               PIC 999.
       01 FILE-RETRY                   PIC 999.
       01 WS-EXIT-RETRY-LOOP           PIC X VALUE ' '.
           EXEC SQL
              INCLUDE ACCDB2
           END-EXEC.
       01 HOST-ACCOUNT-ROW.
           03 HV-ACCOUNT-EYECATCHER     PIC X(4).
           03 HV-ACCOUNT-CUST-NO        PIC X(10).
           03 HV-ACCOUNT-SORTCODE       PIC X(6).
           03 HV-ACCOUNT-ACC-NO         PIC X(8).
           03 HV-ACCOUNT-ACC-TYPE       PIC X(8).
           03 HV-ACCOUNT-INT-RATE       PIC S9(4)V99 COMP-3.
           03 HV-ACCOUNT-OPENED         PIC X(10).
           03 HV-ACCOUNT-OVERDRAFT-LIM  PIC S9(9) COMP.
           03 HV-ACCOUNT-LAST-STMT      PIC X(10).
           03 HV-ACCOUNT-NEXT-STMT      PIC X(10).
           03 HV-ACCOUNT-AVAIL-BAL      PIC S9(10)V99 COMP-3.
           03 HV-ACCOUNT-ACTUAL-BAL     PIC S9(10)V99 COMP-3.
           EXEC SQL
              INCLUDE PROCDB2
           END-EXEC.
       01 HOST-PROCTRAN-ROW.
           03 HV-PROCTRAN-EYECATCHER    PIC X(4).
           03 HV-PROCTRAN-SORT-CODE     PIC X(6).
           03 HV-PROCTRAN-ACC-NUMBER    PIC X(8).
           03 HV-PROCTRAN-DATE          PIC X(10).
           03 HV-PROCTRAN-TIME          PIC X(6).
           03 HV-PROCTRAN-REF           PIC X(12).
           03 HV-PROCTRAN-TYPE          PIC X(3).
           03 HV-PROCTRAN-DESC          PIC X(40).
           03 HV-PROCTRAN-AMOUNT        PIC S9(10)V99 COMP-3.
           EXEC SQL
              INCLUDE SQLCA
           END-EXEC.
       01 SQLCODE-DISPLAY              PIC S9(8) DISPLAY
           SIGN LEADING SEPARATE.
       01 WS-CICS-WORK-AREA.
           05 WS-CICS-RESP              PIC S9(8) COMP.
           05 WS-CICS-RESP2             PIC S9(8) COMP.
           05 WS-EIBRESP-DISPLAY        PIC S9(8) DISPLAY
                                   SIGN LEADING SEPARATE.
       01 WS-APPLID                    PIC X(8).
       01 EXIT-BROWSE-LOOP             PIC X VALUE 'N'.
       01 OUTPUT-DATA.
              03 ACCOUNT-DATA.
                 05 ACCOUNT-EYE-CATCHER        PIC X(4).
                 88 ACCOUNT-EYECATCHER-VALUE        VALUE 'ACCT'.
                 05 ACCOUNT-CUST-NO            PIC 9(10).
                 05 ACCOUNT-KEY.
                    07 ACCOUNT-SORT-CODE       PIC 9(6).
                    07 ACCOUNT-NUMBER          PIC 9(8).
                 05 ACCOUNT-TYPE               PIC X(8).
                 05 ACCOUNT-INTEREST-RATE      PIC 9(4)V99.
                 05 ACCOUNT-OPENED             PIC 9(8).
                 05 ACCOUNT-OPENED-GROUP REDEFINES ACCOUNT-OPENED.
                    07 ACCOUNT-OPENED-DAY       PIC 99.
                    07 ACCOUNT-OPENED-MONTH     PIC 99.
                    07 ACCOUNT-OPENED-YEAR      PIC 9999.
                 05 ACCOUNT-OVERDRAFT-LIMIT    PIC 9(8).
                 05 ACCOUNT-LAST-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-LAST-STMT-GROUP
                    REDEFINES ACCOUNT-LAST-STMT-DATE.
                    07 ACCOUNT-LAST-STMT-DAY   PIC 99.
                    07 ACCOUNT-LAST-STMT-MONTH PIC 99.
                    07 ACCOUNT-LAST-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-NEXT-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-NEXT-STMT-GROUP
                   REDEFINES ACCOUNT-NEXT-STMT-DATE.
                    07 ACCOUNT-NEXT-STMT-DAY   PIC 99.
                    07 ACCOUNT-NEXT-STMT-MONTH PIC 99.
                    07 ACCOUNT-NEXT-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-AVAILABLE-BALANCE  PIC S9(10)V99.
                 05 ACCOUNT-ACTUAL-BALANCE     PIC S9(10)V99.
       01 PROCTRAN-AREA.
           03 PROC-TRAN-DATA.
              05 PROC-TRAN-EYE-CATCHER        PIC X(4).
              88 PROC-TRAN-VALID VALUE 'PRTR'.
              05 PROC-TRAN-LOGICAL-DELETE-AREA REDEFINES
                 PROC-TRAN-EYE-CATCHER.
                 07 PROC-TRAN-LOGICAL-DELETE-FLAG PIC X.
                 88 PROC-TRAN-LOGICALLY-DELETED VALUE X'FF'.
                 07 FILLER PIC X(3).
              05 PROC-TRAN-ID.
                 07 PROC-TRAN-SORT-CODE       PIC 9(6).
                 07 PROC-TRAN-NUMBER          PIC 9(8).
              05 PROC-TRAN-DATE               PIC 9(8).
              05 PROC-TRAN-DATE-GRP REDEFINES PROC-TRAN-DATE.
                 07 PROC-TRAN-DATE-GRP-YYYY   PIC 9999.
                 07 PROC-TRAN-DATE-GRP-MM     PIC 99.
                 07 PROC-TRAN-DATE-GRP-DD     PIC 99.
              05 PROC-TRAN-TIME               PIC 9(6).
              05 PROC-TRAN-TIME-GRP REDEFINES PROC-TRAN-TIME.
                 07 PROC-TRAN-TIME-GRP-HH     PIC 99.
                 07 PROC-TRAN-TIME-GRP-MM     PIC 99.
                 07 PROC-TRAN-TIME-GRP-SS     PIC 99.
              05 PROC-TRAN-REF                PIC 9(12).
              05 PROC-TRAN-TYPE               PIC X(3).
              88 PROC-TY-CHEQUE-ACKNOWLEDGED      VALUE 'CHA'.
              88 PROC-TY-CHEQUE-FAILURE           VALUE 'CHF'.
              88 PROC-TY-CHEQUE-PAID-IN           VALUE 'CHI'.
              88 PROC-TY-CHEQUE-PAID-OUT          VALUE 'CHO'.
              88 PROC-TY-CREDIT                   VALUE 'CRE'.
              88 PROC-TY-DEBIT                    VALUE 'DEB'.
              88 PROC-TY-WEB-CREATE-ACCOUNT       VALUE 'ICA'.
              88 PROC-TY-WEB-CREATE-CUSTOMER      VALUE 'ICC'.
              88 PROC-TY-WEB-DELETE-ACCOUNT       VALUE 'IDA'.
              88 PROC-TY-WEB-DELETE-CUSTOMER      VALUE 'IDC'.
              88 PROC-TY-BRANCH-CREATE-ACCOUNT    VALUE 'OCA'.
              88 PROC-TY-BRANCH-CREATE-CUSTOMER   VALUE 'OCC'.
              88 PROC-TY-BRANCH-DELETE-ACCOUNT    VALUE 'ODA'.
              88 PROC-TY-BRANCH-DELETE-CUSTOMER   VALUE 'ODC'.
              88 PROC-TY-CREATE-SODD              VALUE 'OCS'.
              88 PROC-TY-PAYMENT-CREDIT           VALUE 'PCR'.
              88 PROC-TY-PAYMENT-DEBIT            VALUE 'PDR'.
              88 PROC-TY-TRANSFER                 VALUE 'TFR'.
              05 PROC-TRAN-DESC               PIC X(40).
              05 PROC-TRAN-DESC-XFR REDEFINES PROC-TRAN-DESC.
                07 PROC-TRAN-DESC-XFR-HEADER PIC X(26).
                88 PROC-TRAN-DESC-XFR-FLAG
                   VALUE 'TRANSFER'.
                07 PROC-TRAN-DESC-XFR-SORTCODE
                   PIC 9(6).
                07 PROC-TRAN-DESC-XFR-ACCOUNT
                   PIC 9(8).
              05 PROC-TRAN-DESC-DELACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELACC-ACCTYPE PIC X(8).
                07 PROC-DESC-DELACC-LAST-DD PIC 99.
                07 PROC-DESC-DELACC-LAST-MM PIC 99.
                07 PROC-DESC-DELACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-DELACC-NEXT-DD PIC 99.
                07 PROC-DESC-DELACC-NEXT-MM PIC 99.
                07 PROC-DESC-DELACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-DELACC-FOOTER PIC X(6).
                88 PROC-DESC-DELACC-FLAG
                   VALUE 'DELETE'.
              05 PROC-TRAN-DESC-CREACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CREACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-CREACC-ACCTYPE PIC X(8).
                07 PROC-DESC-CREACC-LAST-DD PIC 99.
                07 PROC-DESC-CREACC-LAST-MM PIC 99.
                07 PROC-DESC-CREACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-CREACC-NEXT-DD PIC 99.
                07 PROC-DESC-CREACC-NEXT-MM PIC 99.
                07 PROC-DESC-CREACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-CREACC-FOOTER PIC X(6).
                88 PROC-DESC-CREACC-FLAG
                   VALUE 'CREATE'.
              05 PROC-TRAN-DESC-DELCUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELCUS-SORTCODE PIC 9(6).
                07 PROC-DESC-DELCUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELCUS-NAME     PIC X(14).
                07 PROC-DESC-DELCUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-DELCUS-FILLER    PIC X.
                88 PROC-DESC-DELCUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-MM    PIC 99.
                07 PROC-DESC-DELCUS-FILLER2   PIC X.
                88 PROC-DESC-DELCUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-DD    PIC 99.
              05 PROC-TRAN-DESC-CRECUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CRECUS-SORTCODE PIC 9(6).
                07 PROC-DESC-CRECUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-CRECUS-NAME     PIC X(14).
                07 PROC-DESC-CRECUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-CRECUS-FILLER    PIC X.
                88 PROC-DESC-CRECUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-MM    PIC 99.
                07 PROC-DESC-CRECUS-FILLER2   PIC X.
                88 PROC-DESC-CRECUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-DD    PIC 99.
              05 PROC-TRAN-AMOUNT             PIC S9(10)V99.
       01 PROCTRAN-RIDFLD              PIC S9(8) COMP.
       77 PROCTRAN-RETRY               PIC 999.
       01 ACCOUNT-ACT-BAL-STORE        PIC S9(10)V99 VALUE 0.
       01 RETURNED-DATA.
           03 RETURNED-EYE-CATCHER        PIC X(4).
           03 RETURNED-CUST-NO            PIC 9(10).
           03 RETURNED-KEY.
              05 RETURNED-SORT-CODE       PIC 9(6).
              05 RETURNED-NUMBER          PIC 9(8).
           03 RETURNED-TYPE               PIC X(8).
           03 RETURNED-INTEREST-RATE      PIC 9(4)V99.
           03 RETURNED-OPENED             PIC 9(8).
           03 RETURNED-OVERDRAFT-LIMIT    PIC 9(8).
           03 RETURNED-LAST-STMT-DATE     PIC 9(8).
           03 RETURNED-NEXT-STMT-DATE     PIC 9(8).
           03 RETURNED-AVAILABLE-BALANCE  PIC S9(10)V99.
           03 RETURNED-ACTUAL-BALANCE     PIC S9(10)V99.
       01 DESIRED-KEY                  PIC 9(10) BINARY.
       01 DB2-DATE-REFORMAT.
          03 DB2-DATE-REF-YR           PIC 9(4).
          03 FILLER                    PIC X.
          03 DB2-DATE-REF-MNTH         PIC 99.
          03 FILLER                    PIC X.
          03 DB2-DATE-REF-DAY          PIC 99.
       01 DATA-STORE-TYPE              PIC X.
          88 DATASTORE-TYPE-DB2           VALUE '2'.
          88 DATASTORE-TYPE-VSAM          VALUE 'V'.
       01 DB2-EXIT-LOOP                PIC X.
       01 FETCH-DATA-CNT               PIC 9(4) COMP.
       01 WS-CUST-ALT-KEY-LEN          PIC S9(4) COMP VALUE +10.
       01 WS-EIBTASKN12                PIC 9(12) VALUE 0.
       01 ACCOUNT-KEY-RID.
          03 REQUIRED-SORT-CODE        PIC 9(6)  VALUE 0.
          03 REQUIRED-ACC-NUM          PIC 9(8)  VALUE 0.
       01 MY-TCB                       PIC S9(8) BINARY.
       01 MY-TCB-STRING                PIC X(8).
       01 WS-ACC-KEY-LEN               PIC S9(4) COMP VALUE +14.
       01 WS-ACC-NUM                   PIC S9(4) COMP VALUE 0.
       01 WS-U-TIME                    PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                 PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD              PIC 99.
          03 FILLER                       PIC X.
          03 WS-ORIG-DATE-MM              PIC 99.
          03 FILLER                       PIC X.
          03 WS-ORIG-DATE-YYYY            PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-MM-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X       PIC X(4).
       01 WS-TOKEN                     PIC S9(8) BINARY.
       01 STORM-DRAIN-CONDITION        PIC X(20).
       01 ACCOUNT-CONTROL.
              03 ACCOUNT-CONTROL-RECORD.
                 05 ACCOUNT-CONTROL-EYE-CATCHER        PIC X(4).
                 88 ACCOUNT-CONTROL-EYECATCHER-V   VALUE 'CTRL'.
                 05 FILLER                     PIC 9(10).
                 05 ACCOUNT-CONTROL-KEY.
                    07 ACCOUNT-CONTROL-SORT-CODE       PIC 9(6).
                    07 ACCOUNT-CONTROL-NUMBER          PIC 9(8).
                 05 NUMBER-OF-ACCOUNTS                 PIC 9(8).
                 05 LAST-ACCOUNT-NUMBER                PIC 9(8).
                 05 ACCOUNT-CONTROL-SUCCESS-FLAG       PIC X.
                 88 ACCOUNT-CONTROL-SUCCESS VALUE 'Y'.
                 05 ACCOUNT-CONTROL-FAIL-CODE PIC X.
                 05 FILLER                     PIC 9(4)V99.
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC S9(10)V99.
                 05 FILLER                     PIC X(2).
       01 WS-TIME-DATA.
           03 WS-TIME-NOW              PIC 9(6).
           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
              05 WS-TIME-NOW-GRP-HH       PIC 99.
              05 WS-TIME-NOW-GRP-MM       PIC 99.
              05 WS-TIME-NOW-GRP-SS       PIC 99.
       01 WS-ABEND-PGM                    PIC X(8) VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 DELACC-EYE                  PIC X(4).
          03 DELACC-CUSTNO               PIC X(10).
          03 DELACC-SCODE                PIC X(6).
          03 DELACC-ACCNO                PIC 9(8).
          03 DELACC-ACC-TYPE             PIC X(8).
          03 DELACC-INT-RATE             PIC 9(4)V99.
          03 DELACC-OPENED               PIC 9(8).
          03 DELACC-OPENED-GROUP REDEFINES DELACC-OPENED.
            05 DELACC-OPENED-DAY   PIC 99.
            05 DELACC-OPENED-MONTH PIC 99.
            05 DELACC-OPENED-YEAR  PIC 9999.
          03 DELACC-OVERDRAFT            PIC 9(8).
          03 DELACC-LAST-STMT-DT         PIC 9(8).
          03 DELACC-LAST-STMT-GROUP REDEFINES DELACC-LAST-STMT-DT.
            05 DELACC-LAST-STMT-DAY   PIC 99.
            05 DELACC-LAST-STMT-MONTH PIC 99.
            05 DELACC-LAST-STMT-YEAR  PIC 9999.
          03 DELACC-NEXT-STMT-DT         PIC 9(8).
          03 DELACC-NEXT-STMT-GROUP REDEFINES DELACC-NEXT-STMT-DT.
            05 DELACC-NEXT-STMT-DAY   PIC 99.
            05 DELACC-NEXT-STMT-MONTH PIC 99.
            05 DELACC-NEXT-STMT-YEAR  PIC 9999.
          03 DELACC-AVAIL-BAL            PIC S9(10)V99.
          03 DELACC-ACTUAL-BAL           PIC S9(10)V99.
          03 DELACC-SUCCESS              PIC X.
          03 DELACC-FAIL-CD              PIC X.
          03 DELACC-DEL-SUCCESS          PIC X.
          03 DELACC-DEL-FAIL-CD          PIC X.
          03 DELACC-DEL-APPLID           PIC X(8).
          03 DELACC-DEL-PCB1             POINTER.
          03 DELACC-DEL-PCB2             POINTER.
          03 DELACC-DEL-PCB3             POINTER.
","['PREMIERE', 'READ-ACCOUNT-DB2', 'DEL-ACCOUNT-DB2', 'WRITE-PROCTRAN', 'WRITE-PROCTRAN-DB2', 'GET-ME-OUT-OF-HERE', 'POPULATE-TIME-DATE', 'A010', 'A999', 'RAD010', 'RAD999', 'DADB010', 'DADB999', 'WP010', 'WP999', 'WPD010', 'WPD999', 'GMOFH010', 'GMOFH999', 'PTD010', 'PTD999']","Paragraph PREMIERE calls paragraph WRITE-PROCTRAN, GET-ME-OUT-OF-HERE, READ-ACCOUNT-DB2, DEL-ACCOUNT-DB2.
Paragraph READ-ACCOUNT-DB2 calls paragraph POPULATE-TIME-DATE, RAD999.
Paragraph WRITE-PROCTRAN calls paragraph WRITE-PROCTRAN-DB2.
Paragraph WRITE-PROCTRAN-DB2 calls paragraph POPULATE-TIME-DATE.
",627,"This program takes an incoming account number it then accesses the account datastore and retrieves the associated account record matching on the customer number & the account_type and then deletes it. If no matching customer_number and account_type combination can found it will return an error flag and the visual1sation layer should process this accordingly. Should there be any issues, the program will abend. It is assumed that the incoming customer number will be valid.",['WS-ABEND-PGM'],,,Error Long,1,1,0.75,"This COBOL program processes and sorts account data, beginning with the movement of the SORTCODE to the REQUIRED-SORT-CODE and reading from the ACCOUNT-DB2. It populates the OUTPUT-DATA and checks for successful deletion of accounts, updating relevant flags. The WRITE-PROCTRAN section handles writing to the PROCTRAN table, along with error management. It leverages the POPULATE-TIME-DATE to capture current time. Finally, the program concludes with clean exit routines.",
127,cicsdev_cics-banking-sample-application-cbsa,cics-banking-sample-application-cbsa/src/base/cobol_src/BNK1UAC.cbl,"       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)
       CBL CICS('SP,EDF')
       IDENTIFICATION DIVISION.
       PROGRAM-ID. BNK1UAC.
       AUTHOR. Jon Collett.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.  IBM-370.
       OBJECT-COMPUTER.  IBM-370.
       INPUT-OUTPUT SECTION.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01 WS-CICS-WORK-AREA.
          03 WS-CICS-RESP              PIC S9(8) COMP VALUE 0.
          03 WS-CICS-RESP2             PIC S9(8) COMP VALUE 0.
       01 WS-FAIL-INFO.
          03 FILLER                    PIC X(9) VALUE 'BNK1UAC '.
          03 WS-CICS-FAIL-MSG          PIC X(70) VALUE ' '.
          03 FILLER                    PIC X(6)  VALUE ' RESP='.
          03 WS-CICS-RESP-DISP         PIC 9(10) VALUE 0.
          03 FILLER                    PIC X(7)  VALUE ' RESP2='.
          03 WS-CICS-RESP2-DISP        PIC 9(10) VALUE 0.
          03 FILLER                    PIC X(15)
                                          VALUE ' ABENDING TASK.'.
       01 SWITCHES.
           03 VALID-DATA-SW            PIC X VALUE 'Y'.
              88 VALID-DATA               VALUE 'Y'.
       01 FLAGS.
           03 SEND-FLAG                PIC X.
              88 SEND-ERASE               VALUE '1'.
              88 SEND-DATAONLY            VALUE '2'.
              88 SEND-DATAONLY-ALARM      VALUE '3'.
       01 ACTION-ALPHA.
           03 ACTION-NUM               PIC 9.
       01 END-OF-SESSION-MESSAGE       PIC X(13) VALUE 'Session Ended'.
       01 RESPONSE-CODE                PIC S9(8) COMP.
       01 COMMUNICATION-AREA           PIC X.
       01 AMTI9                        PIC 9(12).
       01 WS-STUFF1.
           03 WS-COMM-ACT-BAL-UNSIGN   PIC 9(12).
       01 WS-STUFF2 REDEFINES WS-STUFF1.
           03 WS-COMM-ACT-BAL-X        PIC X(12).
       01 WS-STUFF3.
           03 WS-COMM-AMT-UNSIGN          PIC 9(12).
       01 WS-STUFF4 REDEFINES WS-STUFF3.
           03 WS-COMM-AMT-X               PIC X(12).
       01 WS-STUFF5.
            03 WS-COMM-AV-BAL-UNSIGN      PIC 9(12).
       01 WS-STUFF6 REDEFINES WS-STUFF5.
           03 WS-COMM-AV-BAL-X            PIC X(12).
       01 WS-LSTMTDDI                  PIC 99.
       01 WS-LSTMTMMI                  PIC 99.
       01 WS-LSTMTYYI                  PIC 9999.
       01 WS-NSTMTDDI                  PIC 99.
       01 WS-NSTMTMMI                  PIC 99.
       01 WS-NSTMTYYI                  PIC 9999.
       01 WS-DATE-SPLIT.
           03 WS-DATE-SPLIT-DD         PIC 99.
           03 WS-DATE-SPLIT-MM         PIC 99.
           03 WS-DATE-SPLIT-YY         PIC 9999.
       01 WS-CONVERSION.
           03 WS-CONVERT-PICX          PIC X(14).
           03 WS-CONVERT-SPLIT REDEFINES WS-CONVERT-PICX.
              05 WS-CONVERT-SIGN          PIC X.
              05 WS-CONVERT-DEC           PIC 9(10).
              05 WS-CONVERT-POINT         PIC X.
              05 WS-CONVERT-REMAIN        PIC 99.
       01 WS-CONVERTED-VAL1            PIC S9(10)V99 VALUE 0.
       01 WS-CONVERTED-VAL2            PIC S9(10)V99 VALUE 0.
       01 WS-CONVERTED-VAL3            PIC S9(10)V99 VALUE 0.
       01 WS-CONVERTED-VAL4            PIC S9(10)V99 VALUE 0.
       01 INT-RT-CONVERT.
          03 INT-RT-X                  PIC X(6).
          03 INT-RT-GROUP REDEFINES INT-RT-X.
             05 INT-RT-9                 PIC 9(4)V99.
       01 WS-COMM-AREA.
          03 WS-COMM-EYE               PIC X(4).
          03 WS-COMM-CUSTNO            PIC X(10).
          03 WS-COMM-SCODE             PIC X(6).
          03 WS-COMM-ACCNO             PIC 9(8).
          03 WS-COMM-ACC-TYPE          PIC X(8).
          03 WS-COMM-INT-RATE          PIC 9(4)V99.
          03 WS-COMM-OPENED            PIC 9(8).
          03 WS-COMM-OVERDRAFT         PIC 9(8).
          03 WS-COMM-LAST-STMT-DT      PIC 9(8).
          03 WS-COMM-NEXT-STMT-DT      PIC 9(8).
          03 WS-COMM-AVAIL-BAL         PIC S9(10)V99.
          03 WS-COMM-ACTUAL-BAL        PIC S9(10)V99.
          03 WS-COMM-SUCCESS           PIC X.
       01 COMPANY-NAME-FULL            PIC X(32).
       01 INTRTI-COMP-1 USAGE COMP-1.
       01 INTRT-PIC9                   PIC 9999.99.
       01 WS-NUM-COUNT-POINT           PIC S9(8) BINARY.
       01 WS-NUM-COUNT-TOTAL           PIC S9(8) BINARY.
       01 AVAILABLE-BALANCE-DISPLAY    PIC +9(10).99.
       01 ACTUAL-BALANCE-DISPLAY       PIC +9(10).99.
       01 WS-U-TIME                    PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                 PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD              PIC 99.
          03 FILLER                       PIC X.
          03 WS-ORIG-DATE-MM              PIC 99.
          03 FILLER                       PIC X.
          03 WS-ORIG-DATE-YYYY            PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-MM-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X       PIC X(4).
       01 WS-TIME-DATA.
           03 WS-TIME-NOW              PIC 9(6).
           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
              05 WS-TIME-NOW-GRP-HH       PIC 99.
              05 WS-TIME-NOW-GRP-MM       PIC 99.
              05 WS-TIME-NOW-GRP-SS       PIC 99.
       01 WS-ABEND-PGM                 PIC X(8) VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 COMM-EYE                  PIC X(4).
          03 COMM-CUSTNO               PIC X(10).
          03 COMM-SCODE                PIC X(6).
          03 COMM-ACCNO                PIC 9(8).
          03 COMM-ACC-TYPE             PIC X(8).
          03 COMM-INT-RATE             PIC 9(4)V99.
          03 COMM-OPENED               PIC 9(8).
          03 COMM-OVERDRAFT            PIC 9(8).
          03 COMM-LAST-STMT-DT         PIC 9(8).
          03 COMM-NEXT-STMT-DT         PIC 9(8).
          03 COMM-AVAIL-BAL            PIC S9(10)V99.
          03 COMM-ACTUAL-BAL           PIC S9(10)V99.
          03 COMM-SUCCESS              PIC X.
          03 COMM-PCB1-POINTER         POINTER.
       PROCEDURE DIVISION.
       PREMIERE SECTION.
       A010.
           EVALUATE TRUE
              WHEN EIBCALEN = ZERO
                 MOVE LOW-VALUE TO BNK1UAO
                 MOVE -1 TO ACCNOL
                 SET SEND-ERASE TO TRUE
                 INITIALIZE WS-COMM-AREA
                 PERFORM SEND-MAP
              WHEN EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
                 CONTINUE
              WHEN EIBAID = DFHPF3
                 EXEC CICS RETURN
                    TRANSID('OMEN')
                    IMMEDIATE
                    RESP(WS-CICS-RESP)
                    RESP2(WS-CICS-RESP2)
                 END-EXEC
              WHEN EIBAID = DFHAID OR DFHPF12
                 PERFORM SEND-TERMINATION-MSG
                 EXEC CICS
                    RETURN
                 END-EXEC
              WHEN EIBAID = DFHCLEAR
                EXEC CICS SEND CONTROL
                   ERASE
                   FREEKB
                END-EXEC
                EXEC CICS RETURN
                END-EXEC
              WHEN EIBAID = DFHENTER
                 PERFORM PROCESS-MAP
              WHEN EIBAID = DFHPF5
                 PERFORM PROCESS-MAP
              WHEN OTHER
                 MOVE LOW-VALUES TO BNK1UAO
                 MOVE 'Invalid key pressed.' TO MESSAGEO
                 MOVE -1 TO ACCNOL
                 SET SEND-DATAONLY-ALARM TO TRUE
                 PERFORM SEND-MAP
           END-EVALUATE.
           IF EIBCALEN NOT = ZERO
              MOVE COMM-EYE            TO WS-COMM-EYE
              MOVE COMM-CUSTNO         TO WS-COMM-CUSTNO
              MOVE COMM-SCODE          TO WS-COMM-SCODE
              MOVE COMM-ACCNO          TO WS-COMM-ACCNO
              MOVE COMM-ACC-TYPE       TO WS-COMM-ACC-TYPE
              MOVE COMM-INT-RATE       TO WS-COMM-INT-RATE
              MOVE COMM-OPENED         TO WS-COMM-OPENED
              MOVE COMM-OVERDRAFT      TO WS-COMM-OVERDRAFT
              MOVE COMM-LAST-STMT-DT   TO WS-COMM-LAST-STMT-DT
              MOVE COMM-NEXT-STMT-DT   TO WS-COMM-NEXT-STMT-DT
              MOVE COMM-AVAIL-BAL      TO WS-COMM-AVAIL-BAL
              MOVE COMM-ACTUAL-BAL     TO WS-COMM-ACTUAL-BAL
           END-IF.
           EXEC CICS
              RETURN TRANSID('OUAC')
              COMMAREA(WS-COMM-AREA)
              LENGTH(99)
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'A010 - RETURN TRANSID(OUAC) FAIL.'
                    DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1UAC - A010 - RETURN TRANSID(OUAC) FAIL' TO
                 WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM ABEND-THIS-TASK
           END-IF.
       A999.
           EXIT.
       PROCESS-MAP SECTION.
       PM010.
           PERFORM RECEIVE-MAP.
           MOVE 'Y' TO VALID-DATA-SW
           IF EIBAID = DFHENTER
              PERFORM EDIT-DATA
              IF VALID-DATA-SW = 'Y'
                 PERFORM INQ-ACC-DATA
              END-IF
           END-IF.
           IF EIBAID = DFHPF5
              PERFORM VALIDATE-DATA
              IF VALID-DATA-SW = 'Y'
                 PERFORM UPD-ACC-DATA
              END-IF
           END-IF.
           SET SEND-DATAONLY-ALARM TO TRUE.
           PERFORM SEND-MAP.
       PM999.
           EXIT.
       RECEIVE-MAP SECTION.
       RM010.
           EXEC CICS
              RECEIVE MAP('BNK1UA')
              MAPSET('BNK1UAM')
              INTO(BNK1UAI)
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'RM010 - RECEIVE MAP FAIL.'
                    DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNKUAC - RM010 - RECEIVE MAP FAIL ' TO
                 WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM ABEND-THIS-TASK
           END-IF.
       RM999.
           EXIT.
       EDIT-DATA SECTION.
       ED010.
           IF ACCNOI NOT NUMERIC
              MOVE 'Please enter an account number.   ' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
           END-IF.
       ED999.
           EXIT.
       VALIDATE-DATA SECTION.
       VD010.
           IF ACTYPEI NOT = 'CURRENT ' AND
           ACTYPEI NOT = 'SAVING  ' AND
           ACTYPEI NOT = 'LOAN    ' AND
           ACTYPEI NOT = 'MORTGAGE' AND
           ACTYPEI NOT = 'ISA     '
              MOVE SPACES TO MESSAGEO
              STRING 'Account Type must be CURRENT, SAVING, LOAN, '
                 'MORTGAGE or ISA' DELIMITED BY SIZE,
                 '. Then press PF5.' DELIMITED BY SIZE
              INTO MESSAGEO
              MOVE -1 to ACTYPEL
              MOVE 'N' TO VALID-DATA-SW
           END-IF.
           IF INTRTL = ZERO
              MOVE SPACES TO MESSAGEO
              STRING 'Please supply a numeric interest rate '
                 'then press PF5.' DELIMITED BY SIZE
                 INTO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO INTRTL
              GO TO VD999
           END-IF.
           IF INTRTI(1:INTRTL) IS NOT NUMERIC
              MOVE ZERO TO WS-NUM-COUNT-TOTAL
              INSPECT INTRTI(1:INTRTL) TALLYING
                 WS-NUM-COUNT-TOTAL for ALL '0'
                 WS-NUM-COUNT-TOTAL for ALL '1'
                 WS-NUM-COUNT-TOTAL for ALL '2'
                 WS-NUM-COUNT-TOTAL for ALL '3'
                 WS-NUM-COUNT-TOTAL for ALL '4'
                 WS-NUM-COUNT-TOTAL for ALL '5'
                 WS-NUM-COUNT-TOTAL for ALL '6'
                 WS-NUM-COUNT-TOTAL for ALL '7'
                 WS-NUM-COUNT-TOTAL for ALL '8'
                 WS-NUM-COUNT-TOTAL for ALL '9'
                 WS-NUM-COUNT-TOTAL for ALL '.'
                 WS-NUM-COUNT-TOTAL for ALL '-'
                 WS-NUM-COUNT-TOTAL for ALL '+'
                 WS-NUM-COUNT-TOTAL for ALL ' '
              IF WS-NUM-COUNT-TOTAL < INTRTL
                 MOVE SPACES TO MESSAGEO
                 STRING 'Please supply a numeric interest rate'
                      DELIMITED BY SIZE,
                 INTO MESSAGEO
                 MOVE 'N' TO VALID-DATA-SW
                 MOVE -1 TO INTRTL
                 GO TO VD999
              END-IF
              MOVE ZERO TO WS-NUM-COUNT-POINT
              INSPECT INTRTI(1:INTRTL) TALLYING
                 WS-NUM-COUNT-POINT FOR ALL '.'
              IF WS-NUM-COUNT-POINT > 1
                 STRING 'Use one decimal point for interest rate '
                    DELIMITED BY SIZE,
                    'only' DELIMITED BY SIZE,
                 INTO MESSAGEO
                 MOVE 'N' TO VALID-DATA-SW
                 MOVE -1 TO INTRTL
                 GO TO VD999
              END-If
              IF WS-NUM-COUNT-POINT = 1
                 MOVE ZERO TO WS-NUM-COUNT-TOTAL
                 INSPECT INTRTI(1:INTRTL) TALLYING
                    WS-NUM-COUNT-TOTAL FOR CHARACTERS AFTER '.'
                 IF WS-NUM-COUNT-TOTAL > 2
                    MOVE ZERO TO WS-NUM-COUNT-TOTAL
                       WS-NUM-COUNT-POINT
                    INSPECT INTRTI(1:INTRTL) TALLYING
                       WS-NUM-COUNT-POINT FOR CHARACTERS BEFORE '.'
                    ADD 2 TO WS-NUM-COUNT-POINT
                       GIVING WS-NUM-COUNT-POINT
                    INSPECT INTRTI(WS-NUM-COUNT-POINT:INTRTL) TALLYING
                       WS-NUM-COUNT-TOTAL for ALL '0'
                       WS-NUM-COUNT-TOTAL for ALL '1'
                       WS-NUM-COUNT-TOTAL for ALL '2'
                       WS-NUM-COUNT-TOTAL for ALL '3'
                       WS-NUM-COUNT-TOTAL for ALL '4'
                       WS-NUM-COUNT-TOTAL for ALL '5'
                       WS-NUM-COUNT-TOTAL for ALL '6'
                       WS-NUM-COUNT-TOTAL for ALL '7'
                       WS-NUM-COUNT-TOTAL for ALL '8'
                       WS-NUM-COUNT-TOTAL for ALL '9'
                       WS-NUM-COUNT-TOTAL for ALL '-'
                       WS-NUM-COUNT-TOTAL for ALL '+'
                       AFTER '.'
                    IF WS-NUM-COUNT-TOTAL > 2
                       MOVE SPACES TO MESSAGEO
                       STRING
                          'Only up to two decimal places '
                           DELIMITED BY SIZE,
                          'are supported' DELIMITED BY SIZE,
                       INTO MESSAGEO
                       MOVE 'N' TO VALID-DATA-SW
                       MOVE -1 TO INTRTL
                       GO TO VD999
                    END-IF
                 END-IF
              END-IF
           END-IF.
           COMPUTE INTRTI-COMP-1 = FUNCTION NUMVAL(INTRTI).
           IF INTRTI-COMP-1 < 0
              MOVE SPACES TO MESSAGEO
              STRING 'Please supply a zero or positive interest rate'
                 DELIMITED BY SIZE,
                 INTO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO INTRTL
              GO TO VD999
           END-IF.
           IF INTRTI-COMP-1 > 9999.99
              MOVE SPACES TO MESSAGEO
              STRING 'Please supply an interest rate less than '
                     DELIMITED BY SIZE,
                     '9999.99%' DELIMITED BY SIZE
              INTO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO INTRTL
              GO TO VD999
           END-IF.
           IF (ACTYPEI = 'LOAN    ' AND INTRTI = '0000.00') OR
           (ACTYPEI = 'MORTGAGE' AND INTRTI = '0000.00')
              MOVE SPACES TO MESSAGEO
              STRING
              'Interest rate cannot be 0 with this account type.'
              ' Correct and press PF5.' delimited by size into
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1  TO INTRTL
              GO TO VD999
           END-IF.
           IF(OVERDRL = ZERO OR OVERDRI(1:OVERDRL) IS NOT NUMERIC)
               MOVE 'Overdraft must be numeric. Correct and press PF5.'
                  TO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1  TO OVERDRL
              GO TO VD999
           END-IF.
           IF LSTMTDDI NOT NUMERIC OR
           LSTMTMMI NOT NUMERIC OR
           LSTMTYYI NOT NUMERIC
              MOVE 'Last statement date must be numeric      ' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              GO TO VD999
           END-IF.
           IF NSTMTDDI NOT NUMERIC OR
           NSTMTMMI NOT NUMERIC OR
           NSTMTYYI NOT NUMERIC
              MOVE 'Next statement date must be numeric      ' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              GO TO VD999
           END-IF.
           MOVE LSTMTDDI TO WS-LSTMTDDI.
           MOVE LSTMTMMI TO WS-LSTMTMMI.
           MOVE LSTMTYYI TO WS-LSTMTYYI.
           IF WS-LSTMTDDI > 31 OR
           WS-LSTMTDDI = 0 OR
           WS-LSTMTMMI > 12 OR
           WS-LSTMTMMI = 0
              MOVE 'Incorrect date for LAST STATEMENT.      '
                 TO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
           END-IF.
           IF (WS-LSTMTDDI = 31 AND WS-LSTMTMMI = 9) OR
           (WS-LSTMTDDI = 31 AND WS-LSTMTMMI = 4) OR
           (WS-LSTMTDDI = 31 AND WS-LSTMTMMI = 6) OR
           (WS-LSTMTDDI = 31 AND WS-LSTMTMMI = 11) OR
           (WS-LSTMTDDI > 29 AND WS-LSTMTMMI = 2)
               MOVE 'Incorrect date for LAST STATEMENT.      '
                  TO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
           END-IF.
           MOVE NSTMTDDI TO WS-NSTMTDDI.
           MOVE NSTMTMMI TO WS-NSTMTMMI.
           MOVE NSTMTYYI TO WS-NSTMTYYI.
           IF (WS-NSTMTDDI = 31 AND WS-NSTMTMMI = 9) OR
           (WS-NSTMTDDI = 31 AND WS-NSTMTMMI = 4) OR
           (WS-NSTMTDDI = 31 AND WS-NSTMTMMI = 6) OR
           (WS-NSTMTDDI = 31 AND WS-NSTMTMMI = 11) OR
           (WS-NSTMTDDI > 29 AND WS-NSTMTMMI = 2)
              MOVE 'Incorrect date for NEXT STATEMENT.      '
                 TO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
           END-IF.
           IF (WS-NSTMTDDI = 31 AND WS-NSTMTMMI = 9) OR
           (WS-NSTMTDDI = 31 AND WS-NSTMTMMI = 4) OR
           (WS-NSTMTDDI = 31 AND WS-NSTMTMMI = 6) OR
           (WS-NSTMTDDI = 31 AND WS-NSTMTMMI = 11) OR
           (WS-NSTMTDDI > 29 AND WS-NSTMTMMI = 2)
               MOVE 'Incorrect date for NEXT STATEMENT.      '
                  TO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
           END-IF.
       VD999.
           EXIT.
       INQ-ACC-DATA SECTION.
       IAD010.
           INITIALIZE DFHCOMMAREA.
           MOVE ACCNOI TO COMM-ACCNO.
           SET COMM-PCB1-POINTER TO NULL.
           EXEC CICS LINK
              PROGRAM('INQACC')
              COMMAREA(DFHCOMMAREA)
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
              SYNCONRETURN
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'IAD010  - LINK INQACC FAIL.'
                    DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1UAC - IAD010 - LINK INQACC  FAIL      '
                 TO WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM ABEND-THIS-TASK
           END-IF.
           IF COMM-ACC-TYPE = SPACES AND
           COMM-LAST-STMT-DT = ZERO
              MOVE 'N' TO VALID-DATA-SW
              MOVE SPACES TO MESSAGEO
              MOVE 'This account number could not be found' TO
                 MESSAGEO
              MOVE -1 TO ACCNOL
           ELSE
              MOVE SPACES TO MESSAGEO
              MOVE 'Please amend fields and hit <pf5> to apply changes'
                 TO MESSAGEO
              MOVE COMM-ACCNO       TO ACCNO2O
              MOVE COMM-CUSTNO      TO CUSTNOO
              MOVE COMM-SCODE       TO SORTCO
              MOVE COMM-ACC-TYPE    TO ACTYPEO
              MOVE COMM-INT-RATE    TO INTRT-PIC9
              MOVE INTRT-PIC9       TO INTRTO
              MOVE COMM-OPENED      TO WS-DATE-SPLIT
              MOVE WS-DATE-SPLIT-DD TO OPENDDO
              MOVE WS-DATE-SPLIT-MM TO OPENMMO
              MOVE WS-DATE-SPLIT-YY TO OPENYYO
              MOVE COMM-LAST-STMT-DT TO WS-DATE-SPLIT
              MOVE WS-DATE-SPLIT-DD TO LSTMTDDO
              MOVE WS-DATE-SPLIT-MM TO LSTMTMMO
              MOVE WS-DATE-SPLIT-YY TO LSTMTYYO
              MOVE COMM-NEXT-STMT-DT TO WS-DATE-SPLIT
              MOVE WS-DATE-SPLIT-DD TO NSTMTDDO
              MOVE WS-DATE-SPLIT-MM TO NSTMTMMO
              MOVE WS-DATE-SPLIT-YY TO NSTMTYYO
              MOVE COMM-OVERDRAFT   TO OVERDRO
              MOVE COMM-AVAIL-BAL   TO AVAILABLE-BALANCE-DISPLAY
              MOVE COMM-ACTUAL-BAL  TO ACTUAL-BALANCE-DISPLAY
              MOVE AVAILABLE-BALANCE-DISPLAY TO AVBALO
              MOVE ACTUAL-BALANCE-DISPLAY TO ACTBALO
              MOVE -1 TO ACCNOL
           END-IF.
       IAD999.
           EXIT.
       UPD-ACC-DATA SECTION.
       UAD010.
           INITIALIZE DFHCOMMAREA.
           MOVE ACCNOI        TO COMM-ACCNO.
           IF ACCNOI = 99999999
             MOVE ACCNO2I        TO COMM-ACCNO
           END-IF
           MOVE CUSTNOI       TO COMM-CUSTNO.
           MOVE SORTCI        TO COMM-SCODE.
           MOVE ACTYPEI       TO COMM-ACC-TYPE.
           COMPUTE INTRTI-COMP-1 = FUNCTION NUMVAL(INTRTI).
           MOVE INTRTI-COMP-1 TO INT-RT-9.
           MOVE INT-RT-9      TO COMM-INT-RATE.
           MOVE OPENDDI       TO WS-DATE-SPLIT-DD.
           MOVE OPENMMI       TO  WS-DATE-SPLIT-MM.
           MOVE OPENYYI       TO WS-DATE-SPLIT-YY.
           MOVE WS-DATE-SPLIT TO COMM-OPENED.
           COMPUTE COMM-OVERDRAFT = FUNCTION NUMVAL(OVERDRI(1:OVERDRL)).
           MOVE LSTMTDDI      TO WS-DATE-SPLIT-DD.
           MOVE LSTMTMMI      TO WS-DATE-SPLIT-MM.
           MOVE LSTMTYYI      TO WS-DATE-SPLIT-YY.
           MOVE WS-DATE-SPLIT TO COMM-LAST-STMT-DT.
           MOVE NSTMTDDI      TO WS-DATE-SPLIT-DD.
           MOVE NSTMTMMI      TO WS-DATE-SPLIT-MM.
           MOVE NSTMTYYI      TO WS-DATE-SPLIT-YY.
           MOVE WS-DATE-SPLIT TO COMM-NEXT-STMT-DT.
           MOVE 0 TO WS-CONVERTED-VAL1.
           MOVE 0 TO WS-CONVERTED-VAL2.
           MOVE 0 TO WS-CONVERTED-VAL3.
           MOVE 0 TO WS-CONVERTED-VAL4.
           MOVE AVBALI        TO WS-CONVERT-PICX.
           COMPUTE WS-CONVERTED-VAL1 = WS-CONVERT-REMAIN / 100.
           COMPUTE WS-CONVERTED-VAL2 = WS-CONVERT-DEC.
           COMPUTE WS-CONVERTED-VAL3 = WS-CONVERTED-VAL1 +
                                           WS-CONVERTED-VAL2.
           IF WS-CONVERT-SIGN = '-'
              COMPUTE WS-CONVERTED-VAL4 = 0 - WS-CONVERTED-VAL3
           ELSE
              COMPUTE WS-CONVERTED-VAL4 = 0 + WS-CONVERTED-VAL3
           END-IF.
           MOVE WS-CONVERTED-VAL4 TO COMM-AVAIL-BAL.
           MOVE ACTBALI        TO WS-CONVERT-PICX.
           COMPUTE WS-CONVERTED-VAL1 = WS-CONVERT-REMAIN / 100.
           COMPUTE WS-CONVERTED-VAL2 = WS-CONVERT-DEC.
           COMPUTE WS-CONVERTED-VAL3 = WS-CONVERTED-VAL1 +
                                           WS-CONVERTED-VAL2.
           IF WS-CONVERT-SIGN = '-'
              COMPUTE WS-CONVERTED-VAL4 = 0 - WS-CONVERTED-VAL3
           ELSE
              COMPUTE WS-CONVERTED-VAL4 = 0 + WS-CONVERTED-VAL3
           END-IF.
           MOVE WS-CONVERTED-VAL4 TO COMM-ACTUAL-BAL.
           MOVE ' '           TO COMM-SUCCESS.
           EXEC CICS LINK
              PROGRAM('UPDACC')
              COMMAREA(DFHCOMMAREA)
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
              SYNCONRETURN
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'UAD010  - LINK UPDACC FAIL.'
                    DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1UAC - UAD010 - LINK UPDACC  FAIL      '
                 TO WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM ABEND-THIS-TASK
           END-IF.
           IF COMM-SUCCESS = 'N'
              MOVE 'N' TO VALID-DATA-SW
              MOVE SPACES TO MESSAGEO
              MOVE 'Update unsuccessful, try again later.    ' TO
                 MESSAGEO
           ELSE
              MOVE SPACES TO MESSAGEO
              MOVE 'Account update successfully applied.     '
                 TO MESSAGEO
              MOVE COMM-ACCNO       TO ACCNO2O
              MOVE COMM-CUSTNO      TO CUSTNOO
              MOVE COMM-SCODE       TO SORTCO
              MOVE COMM-ACC-TYPE    TO ACTYPEO
              MOVE COMM-INT-RATE    TO INTRT-PIC9
              MOVE INTRT-PIC9       TO INTRTO
              MOVE COMM-OPENED      TO WS-DATE-SPLIT
              MOVE WS-DATE-SPLIT-DD TO OPENDDO
              MOVE WS-DATE-SPLIT-MM TO OPENMMO
              MOVE WS-DATE-SPLIT-YY TO OPENYYO
              MOVE COMM-LAST-STMT-DT TO WS-DATE-SPLIT
              MOVE WS-DATE-SPLIT-DD TO LSTMTDDO
              MOVE WS-DATE-SPLIT-MM TO LSTMTMMO
              MOVE WS-DATE-SPLIT-YY TO LSTMTYYO
              MOVE COMM-NEXT-STMT-DT TO WS-DATE-SPLIT
              MOVE WS-DATE-SPLIT-DD TO NSTMTDDO
              MOVE WS-DATE-SPLIT-MM TO NSTMTMMO
              MOVE WS-DATE-SPLIT-YY TO NSTMTYYO
              MOVE COMM-OVERDRAFT   TO OVERDRO
              MOVE COMM-AVAIL-BAL   TO AVAILABLE-BALANCE-DISPLAY
              MOVE COMM-ACTUAL-BAL  TO ACTUAL-BALANCE-DISPLAY
              MOVE AVAILABLE-BALANCE-DISPLAY TO AVBALO
              MOVE ACTUAL-BALANCE-DISPLAY TO ACTBALO
           END-IF.
       UAD999.
           EXIT.
       SEND-MAP SECTION.
       SM010.
           IF SEND-ERASE
              EXEC CICS SEND MAP('BNK1UA')
                 MAPSET('BNK1UAM')
                 FROM(BNK1UAO)
                 ERASE
                 CURSOR
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'SM010 - SEND MAP ERASE FAIL.'
                       DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNK1UAC - SM010 - SEND MAP ERASE FAIL '
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
              GO TO SM999
           END-IF.
           IF SEND-DATAONLY
              EXEC CICS SEND MAP('BNK1UA')
                 MAPSET('BNK1UAM')
                 FROM(BNK1UAO)
                 DATAONLY
                 CURSOR
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'SM010 - SEND MAP DATAONLY FAIL.'
                       DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNK1UAC - SM010 - SEND MAP DATAONLY FAIL '
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
              GO TO SM999
           END-IF.
           IF SEND-DATAONLY-ALARM
              EXEC CICS SEND MAP('BNK1UA')
                 MAPSET('BNK1UAM')
                 FROM(BNK1UAO)
                 DATAONLY
                 ALARM
                 CURSOR
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'SM010 - SEND MAP DATAONLY ALARM FAIL.'
                       DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNK1UAC - SM010 - SEND MAP DATAONLY ALARM FAIL '
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
           END-IF.
       SM999.
           EXIT.
       SEND-TERMINATION-MSG SECTION.
       STM010.
           EXEC CICS SEND TEXT
              FROM(END-OF-SESSION-MESSAGE)
              ERASE
              FREEKB
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'STM010 - SEND TEXT FAIL.'
                    DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1UAC - STM010 - SEND TEXT FAIL'
                 TO WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM ABEND-THIS-TASK
           END-IF.
       STM999.
           EXIT.
       ABEND-THIS-TASK SECTION.
       ATT010.
           DISPLAY WS-FAIL-INFO.
           EXEC CICS ABEND
              ABCODE('HBNK')
              NODUMP
           END-EXEC.
       ATT999.
           EXIT.
       POPULATE-TIME-DATE SECTION.
       PTD010.
           EXEC CICS ASKTIME
              ABSTIME(WS-U-TIME)
           END-EXEC.
           EXEC CICS FORMATTIME
                     ABSTIME(WS-U-TIME)
                     DDMMYYYY(WS-ORIG-DATE)
                     TIME(WS-TIME-NOW)
                     DATESEP
           END-EXEC.
       PTD999.
           EXIT.
","       WORKING-STORAGE SECTION.
       01 WS-CICS-WORK-AREA.
          03 WS-CICS-RESP              PIC S9(8) COMP VALUE 0.
          03 WS-CICS-RESP2             PIC S9(8) COMP VALUE 0.
       01 WS-FAIL-INFO.
          03 FILLER                    PIC X(9) VALUE 'BNK1UAC '.
          03 WS-CICS-FAIL-MSG          PIC X(70) VALUE ' '.
          03 FILLER                    PIC X(6)  VALUE ' RESP='.
          03 WS-CICS-RESP-DISP         PIC 9(10) VALUE 0.
          03 FILLER                    PIC X(7)  VALUE ' RESP2='.
          03 WS-CICS-RESP2-DISP        PIC 9(10) VALUE 0.
          03 FILLER                    PIC X(15)
                                          VALUE ' ABENDING TASK.'.
       01 SWITCHES.
           03 VALID-DATA-SW            PIC X VALUE 'Y'.
              88 VALID-DATA               VALUE 'Y'.
       01 FLAGS.
           03 SEND-FLAG                PIC X.
              88 SEND-ERASE               VALUE '1'.
              88 SEND-DATAONLY            VALUE '2'.
              88 SEND-DATAONLY-ALARM      VALUE '3'.
       01 ACTION-ALPHA.
           03 ACTION-NUM               PIC 9.
       01 END-OF-SESSION-MESSAGE       PIC X(13) VALUE 'Session Ended'.
       01 RESPONSE-CODE                PIC S9(8) COMP.
       01 COMMUNICATION-AREA           PIC X.
       01 AMTI9                        PIC 9(12).
       01 WS-STUFF1.
           03 WS-COMM-ACT-BAL-UNSIGN   PIC 9(12).
       01 WS-STUFF2 REDEFINES WS-STUFF1.
           03 WS-COMM-ACT-BAL-X        PIC X(12).
       01 WS-STUFF3.
           03 WS-COMM-AMT-UNSIGN          PIC 9(12).
       01 WS-STUFF4 REDEFINES WS-STUFF3.
           03 WS-COMM-AMT-X               PIC X(12).
       01 WS-STUFF5.
            03 WS-COMM-AV-BAL-UNSIGN      PIC 9(12).
       01 WS-STUFF6 REDEFINES WS-STUFF5.
           03 WS-COMM-AV-BAL-X            PIC X(12).
       01 WS-LSTMTDDI                  PIC 99.
       01 WS-LSTMTMMI                  PIC 99.
       01 WS-LSTMTYYI                  PIC 9999.
       01 WS-NSTMTDDI                  PIC 99.
       01 WS-NSTMTMMI                  PIC 99.
       01 WS-NSTMTYYI                  PIC 9999.
       01 WS-DATE-SPLIT.
           03 WS-DATE-SPLIT-DD         PIC 99.
           03 WS-DATE-SPLIT-MM         PIC 99.
           03 WS-DATE-SPLIT-YY         PIC 9999.
       01 WS-CONVERSION.
           03 WS-CONVERT-PICX          PIC X(14).
           03 WS-CONVERT-SPLIT REDEFINES WS-CONVERT-PICX.
              05 WS-CONVERT-SIGN          PIC X.
              05 WS-CONVERT-DEC           PIC 9(10).
              05 WS-CONVERT-POINT         PIC X.
              05 WS-CONVERT-REMAIN        PIC 99.
       01 WS-CONVERTED-VAL1            PIC S9(10)V99 VALUE 0.
       01 WS-CONVERTED-VAL2            PIC S9(10)V99 VALUE 0.
       01 WS-CONVERTED-VAL3            PIC S9(10)V99 VALUE 0.
       01 WS-CONVERTED-VAL4            PIC S9(10)V99 VALUE 0.
       01 INT-RT-CONVERT.
          03 INT-RT-X                  PIC X(6).
          03 INT-RT-GROUP REDEFINES INT-RT-X.
             05 INT-RT-9                 PIC 9(4)V99.
       01 WS-COMM-AREA.
          03 WS-COMM-EYE               PIC X(4).
          03 WS-COMM-CUSTNO            PIC X(10).
          03 WS-COMM-SCODE             PIC X(6).
          03 WS-COMM-ACCNO             PIC 9(8).
          03 WS-COMM-ACC-TYPE          PIC X(8).
          03 WS-COMM-INT-RATE          PIC 9(4)V99.
          03 WS-COMM-OPENED            PIC 9(8).
          03 WS-COMM-OVERDRAFT         PIC 9(8).
          03 WS-COMM-LAST-STMT-DT      PIC 9(8).
          03 WS-COMM-NEXT-STMT-DT      PIC 9(8).
          03 WS-COMM-AVAIL-BAL         PIC S9(10)V99.
          03 WS-COMM-ACTUAL-BAL        PIC S9(10)V99.
          03 WS-COMM-SUCCESS           PIC X.
       01 COMPANY-NAME-FULL            PIC X(32).
       01 INTRTI-COMP-1 USAGE COMP-1.
       01 INTRT-PIC9                   PIC 9999.99.
       01 WS-NUM-COUNT-POINT           PIC S9(8) BINARY.
       01 WS-NUM-COUNT-TOTAL           PIC S9(8) BINARY.
       01 AVAILABLE-BALANCE-DISPLAY    PIC +9(10).99.
       01 ACTUAL-BALANCE-DISPLAY       PIC +9(10).99.
       01 WS-U-TIME                    PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                 PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD              PIC 99.
          03 FILLER                       PIC X.
          03 WS-ORIG-DATE-MM              PIC 99.
          03 FILLER                       PIC X.
          03 WS-ORIG-DATE-YYYY            PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-MM-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X       PIC X(4).
       01 WS-TIME-DATA.
           03 WS-TIME-NOW              PIC 9(6).
           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
              05 WS-TIME-NOW-GRP-HH       PIC 99.
              05 WS-TIME-NOW-GRP-MM       PIC 99.
              05 WS-TIME-NOW-GRP-SS       PIC 99.
       01 WS-ABEND-PGM                 PIC X(8) VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 COMM-EYE                  PIC X(4).
          03 COMM-CUSTNO               PIC X(10).
          03 COMM-SCODE                PIC X(6).
          03 COMM-ACCNO                PIC 9(8).
          03 COMM-ACC-TYPE             PIC X(8).
          03 COMM-INT-RATE             PIC 9(4)V99.
          03 COMM-OPENED               PIC 9(8).
          03 COMM-OVERDRAFT            PIC 9(8).
          03 COMM-LAST-STMT-DT         PIC 9(8).
          03 COMM-NEXT-STMT-DT         PIC 9(8).
          03 COMM-AVAIL-BAL            PIC S9(10)V99.
          03 COMM-ACTUAL-BAL           PIC S9(10)V99.
          03 COMM-SUCCESS              PIC X.
          03 COMM-PCB1-POINTER         POINTER.
","['PREMIERE', 'PROCESS-MAP', 'RECEIVE-MAP', 'EDIT-DATA', 'VALIDATE-DATA', 'INQ-ACC-DATA', 'UPD-ACC-DATA', 'SEND-MAP', 'SEND-TERMINATION-MSG', 'ABEND-THIS-TASK', 'POPULATE-TIME-DATE', 'A010', 'A999', 'PM010', 'PM999', 'RM010', 'RM999', 'ED010', 'ED999', 'VD010', 'VD999', 'IAD010', 'IAD999', 'UAD010', 'UAD999', 'SM010', 'SM999', 'STM010', 'STM999', 'ATT010', 'ATT999', 'PTD010', 'PTD999']","Paragraph PREMIERE calls paragraph SEND-MAP, SEND-TERMINATION-MSG, ABEND-THIS-TASK, POPULATE-TIME-DATE, PROCESS-MAP.
Paragraph PROCESS-MAP calls paragraph VALIDATE-DATA, UPD-ACC-DATA, EDIT-DATA, SEND-MAP, INQ-ACC-DATA, RECEIVE-MAP.
Paragraph RECEIVE-MAP calls paragraph POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph VALIDATE-DATA calls paragraph VD999.
Paragraph INQ-ACC-DATA calls paragraph POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph UPD-ACC-DATA calls paragraph POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph SEND-MAP calls paragraph POPULATE-TIME-DATE, ABEND-THIS-TASK, SM999.
Paragraph SEND-TERMINATION-MSG calls paragraph POPULATE-TIME-DATE, ABEND-THIS-TASK.
",989,This is the Update Account program in the BANKING application BMS suite.,['WS-ABEND-PGM'],,,Error Long,1,1,1,"This COBOL program manages financial transactions by processing inputs, validating account data, and updating account information. It begins with transaction evaluation, directing flow to various functions including sending maps and termination messages, handling errors via an abend task, and populating date/time. Key processes include receiving and inquiring account data, with validations on account numbers and types. The interconnected sections ensure each aspect of transaction handling is executed smoothly while appropriately managing errors and updates.",
128,cicsdev_cics-banking-sample-application-cbsa,cics-banking-sample-application-cbsa/src/base/cobol_src/BNK1CCS.cbl,"       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)
       CBL CICS('SP,EDF')
       IDENTIFICATION DIVISION.
       PROGRAM-ID. BNK1CCS.
       AUTHOR. Jon Collett.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.  IBM-370.
       OBJECT-COMPUTER.  IBM-370.
       INPUT-OUTPUT SECTION.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01 WS-UCTRANS                  PIC S9(8) COMP VALUE 0.
       01 STORED-UCTRANS              PIC S9(8) COMP VALUE 0.
       01 WS-CICS-WORK-AREA.
          03 WS-CICS-RESP             PIC S9(8) COMP VALUE 0.
          03 WS-CICS-RESP2            PIC S9(8) COMP VALUE 0.
       01 WS-FAIL-INFO.
          03 FILLER                   PIC X(9)  VALUE 'BNK1CCS  '.
          03 WS-CICS-FAIL-MSG         PIC X(70) VALUE ' '.
          03 FILLER                   PIC X(6)  VALUE ' RESP='.
          03 WS-CICS-RESP-DISP        PIC 9(10) VALUE 0.
          03 FILLER                   PIC X(7)  VALUE ' RESP2='.
          03 WS-CICS-RESP2-DISP       PIC 9(10) VALUE 0.
          03 FILLER                   PIC X(15) VALUE ' ABENDING TASK.'.
       01 SWITCHES.
           03 VALID-DATA-SW           PIC X VALUE 'Y'.
              88 VALID-DATA           VALUE 'Y'.
       01 FLAGS.
           03 SEND-FLAG               PIC X.
              88 SEND-ERASE           VALUE '1'.
              88 SEND-DATAONLY        VALUE '2'.
              88 SEND-DATAONLY-ALARM  VALUE '3'.
       01 ACTION-ALPHA.
           03 ACTION-NUM              PIC 9.
       01 END-OF-SESSION-MESSAGE      PIC X(13) VALUE 'Session Ended'.
       01 RESPONSE-CODE               PIC S9(8) COMP.
       01 COMMUNICATION-AREA          PIC X.
       01 COMM-DOB-SPLIT.
          03 COMM-DOB-SPLIT-DD         PIC 99.
          03 COMM-DOB-SPLIT-MM         PIC 99.
          03 COMM-DOB-SPLIT-YYYY       PIC 9999.
       01 COMM-ADDR-SPLIT.
          03 COMM-ADDR-SPLIT1         PIC X(60).
          03 COMM-ADDR-SPLIT2         PIC X(60).
          03 COMM-ADDR-SPLIT3         PIC X(40).
       01 WS-COMM-AREA.
          03 WS-COMM-DATA               PIC X.
          03 WS-COMM-TERM               PIC S9(8) COMP.
       01 DATE-REFORMED.
          03 DOBDDI-CHAR               PIC XX.
          03 DOBDDI-REFORM REDEFINES DOBDDI-CHAR.
             05 DOBDDI-NUM             PIC 99.
          03 DOBMMI-CHAR               PIC XX.
          03 DOBMMI-REFORM REDEFINES DOBMMI-CHAR.
             05 DOBMMI-NUM             PIC 99.
          03 DOBYYI-CHAR               PIC XX.
          03 DOBYYI-REFORM REDEFINES DOBYYI-CHAR.
             05 DOBYYI-NUM             PIC 99.
       01 WS-ABCODE PIC XXXX.
       01 WS-ADDR-SPLIT.
          03 WS-ADDR-SPLIT1            PIC X(60).
          03 WS-ADDR-SPLIT2            PIC X(60).
          03 WS-ADDR-SPLIT3            PIC X(40).
       01 SUBPGM-PARMS.
          03 SUBPGM-EYECATCHER                 PIC X(4).
          03 SUBPGM-KEY.
             05 SUBPGM-SORTCODE                PIC 9(6) DISPLAY.
             05 SUBPGM-NUMBER                  PIC 9(10) DISPLAY.
          03 SUBPGM-NAME                       PIC X(60).
          03 SUBPGM-ADDRESS                    PIC X(160).
          03 SUBPGM-DATE-OF-BIRTH              PIC 9(8).
          03 SUBPGM-DOB-GROUP REDEFINES SUBPGM-DATE-OF-BIRTH.
             05 SUBPGM-BIRTH-DAY               PIC 99.
             05 SUBPGM-BIRTH-MONTH             PIC 99.
             05 SUBPGM-BIRTH-YEAR              PIC 9999.
          03 SUBPGM-CREDIT-SCORE               PIC 999.
          03 SUBPGM-CS-REVIEW-DATE             PIC 9(8).
          03 SUBPGM-SUCCESS                    PIC X.
          03 SUBPGM-FAIL-CODE                  PIC X.
       01 COMPANY-NAME-FULL PIC X(32).
       01 CURSOR-POSITION PIC S9(4) BINARY.
       01 WS-U-TIME                      PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                   PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD             PIC 99.
          03 FILLER                      PIC X.
          03 WS-ORIG-DATE-MM             PIC 99.
          03 FILLER                      PIC X.
          03 WS-ORIG-DATE-YYYY           PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X           PIC XX.
          03 FILLER                      PIC X VALUE '.'.
          03 WS-ORIG-DATE-MM-X           PIC XX.
          03 FILLER                      PIC X VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X         PIC X(4).
       01 WS-TIME-DATA.
           03 WS-TIME-NOW                  PIC 9(6).
           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
              05 WS-TIME-NOW-GRP-HH     PIC 99.
              05 WS-TIME-NOW-GRP-MM     PIC 99.
              05 WS-TIME-NOW-GRP-SS     PIC 99.
       01 WS-ABEND-PGM                  PIC X(8) VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 DFHCOMMAREA-DATA                  PIC X(5).
       PROCEDURE DIVISION.
       PREMIERE SECTION.
       A010.
           EXEC CICS HANDLE ABEND
              LABEL(HANDLE-ABEND)
           END-EXEC.
           EVALUATE TRUE
              WHEN EIBCALEN = ZERO
                 MOVE LOW-VALUE TO BNK1CCO
                 MOVE SPACES TO CUSTTITO
                 MOVE SPACES TO CHRISTNO
                 MOVE SPACES TO CUSTINSO
                 MOVE SPACES TO CUSTSNO
                 MOVE SPACES TO CUSTAD1O
                 MOVE SPACES TO CUSTAD2O
                 MOVE SPACES TO CUSTAD3O
                 MOVE -1 TO CUSTTITL
                 SET SEND-ERASE TO TRUE
                 MOVE SPACES TO MESSAGEO
                 PERFORM STORE-TERM-DEF
                 PERFORM SEND-MAP
                 MOVE ' '            TO WS-COMM-AREA
                 MOVE STORED-UCTRANS TO WS-COMM-TERM
              WHEN EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
                 CONTINUE
              WHEN EIBAID = DFHPF3
                 PERFORM RESTORE-TERM-DEF
                 EXEC CICS RETURN
                    TRANSID('OMEN')
                    IMMEDIATE
                    RESP(WS-CICS-RESP)
                    RESP2(WS-CICS-RESP2)
                 END-EXEC
              WHEN EIBAID = DFHPF12
                 PERFORM SEND-TERMINATION-MSG
                 PERFORM RESTORE-TERM-DEF
                 EXEC CICS
                    RETURN
                 END-EXEC
              WHEN EIBAID = DFHCLEAR
                 EXEC CICS SEND MAP('BNK1CCM')
                           MAPONLY
                           ERASE
                           FREEKB
                 END-EXEC
                 PERFORM RESTORE-TERM-DEF
                 EXEC CICS RETURN TRANSID('OCCS')
                           COMMAREA(WS-COMM-AREA)
                 END-EXEC
              WHEN EIBAID = DFHENTER
                 PERFORM PROCESS-MAP
              WHEN OTHER
                 MOVE DFHCOMMAREA TO WS-COMM-AREA
                 MOVE LOW-VALUES TO BNK1CCO
                 MOVE SPACES TO MESSAGEO
                 MOVE 'Invalid key pressed.' TO MESSAGEO
                 SET SEND-DATAONLY-ALARM TO TRUE
                 PERFORM SEND-MAP
           END-EVALUATE.
           EXEC CICS
              RETURN TRANSID('OCCS')
              COMMAREA(WS-COMM-AREA)
              LENGTH(248)
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'A010 -RETURN TRANSID(OCCS) FAIL'
                    DELIMITED BY SIZE,
                    'EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1CCS - A010 - RETURN TRANSID(OCCS) FAIL' TO
                 WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM RESTORE-TERM-DEF
              PERFORM ABEND-THIS-TASK
           END-IF.
       A999.
           EXIT.
       PROCESS-MAP SECTION.
       PM010.
           MOVE DFHCOMMAREA TO WS-COMM-AREA.
           PERFORM RECEIVE-MAP.
           PERFORM EDIT-DATA.
           IF VALID-DATA
              PERFORM CRE-CUST-DATA
           END-IF.
           SET SEND-DATAONLY-ALARM TO TRUE.
           PERFORM SEND-MAP.
       PM999.
           EXIT.
       RECEIVE-MAP SECTION.
       RM010.
           EXEC CICS INQUIRE
                TERMINAL(EIBTRMID)
                UCTRANST(WS-UCTRANS)
                RESP(WS-CICS-RESP)
                RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-UCTRANS = DFHVALUE(UCTRAN) OR
           WS-UCTRANS = DFHVALUE(TRANIDONLY)
              MOVE DFHVALUE(NOUCTRAN) TO WS-UCTRANS
              EXEC CICS SET TERMINAL(EIBTRMID)
                 UCTRANST(WS-UCTRANS)
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'RM010 -RM010 (1) - SET TERMINAL '
                      DELIMITED BY SIZE,
                       'EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNK1CCS - RM010 (1) - SET TERMINAL UC FAIL ' TO
                    WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM RESTORE-TERM-DEF
                 PERFORM ABEND-THIS-TASK
              END-IF
           END-IF.
           MOVE LOW-VALUES TO BNK1CCI.
           MOVE SPACES TO CUSTTITI.
           MOVE SPACES TO CHRISTNI.
           MOVE SPACES TO CUSTINSI.
           MOVE SPACES TO CUSTSNI.
           MOVE SPACES TO CUSTAD1I.
           MOVE SPACES TO CUSTAD2I.
           MOVE SPACES TO CUSTAD3I.
           MOVE 0 TO DOBDDI.
           MOVE 0 TO DOBMMI.
           MOVE 0 TO DOBYYI.
           MOVE 0 TO SORTCI.
           MOVE 0 TO CUSTNO2I.
           MOVE 0 TO CREDSCI.
           MOVE 0 TO SCRDTDDI.
           MOVE 0 TO SCRDTMMI.
           MOVE 0 TO SCRDTYYI.
           MOVE SPACES TO MESSAGEI.
           EXEC CICS
              RECEIVE MAP('BNK1CC')
              MAPSET('BNK1CCM')
              INTO(BNK1CCI)
              TERMINAL
              ASIS
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'RM010 - RM010 (2) - RECEIVE MAP FAIL '
                   DELIMITED BY SIZE,
                    'EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1CCS - RM010 (2) - RECEIVE MAP FAIL ' TO
                 WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM RESTORE-TERM-DEF
              PERFORM ABEND-THIS-TASK
           END-IF.
       RM999.
           EXIT.
       EDIT-DATA SECTION.
       ED010.
           IF CUSTNO2L > 0
              MOVE 'Please clear screen before creating new user'
                 TO MESSAGEO
              MOVE -1  TO CUSTTITL
              MOVE 'N' TO VALID-DATA-SW
              GO TO ED999
           END-IF
           IF CUSTTITL < 1 OR CUSTTITI = SPACES
           OR CUSTTITI = LOW-VALUES
              MOVE SPACES TO MESSAGEO
              STRING 'Valid titles are: Mr,Mrs,Miss,Ms,Dr,Professor,'
                    DELIMITED BY SIZE,
                     'Drs,Lord,Sir,Lady' DELIMITED BY SIZE
              INTO MESSAGEO
              MOVE -1 TO CUSTTITL
              MOVE 'N' TO VALID-DATA-SW
              GO TO ED999
           END-IF.
           MOVE SPACES TO MESSAGEO.
           IF CUSTTITL > 0
              EVALUATE CUSTTITI
                 WHEN 'MR________'
                    MOVE 'Mr' TO CUSTTITI
                    CONTINUE
                 WHEN 'Mr________'
                    MOVE 'Mr' TO CUSTTITI
                    CONTINUE
                 WHEN 'MR        '
                    MOVE 'Mr' TO CUSTTITI
                    CONTINUE
                 WHEN 'Mr         '
                    CONTINUE
                 WHEN 'mr________'
                    MOVE 'Mr' TO CUSTTITI
                    CONTINUE
                 WHEN 'MRS_______'
                    MOVE 'Mrs' TO CUSTTITI
                    CONTINUE
                 WHEN 'Mrs_______'
                    MOVE 'Mrs' TO CUSTTITI
                    CONTINUE
                 WHEN 'MRS       '
                    MOVE 'Mrs' TO CUSTTITI
                    CONTINUE
                 WHEN 'Mrs       '
                    CONTINUE
                 WHEN 'mrs_______'
                    MOVE 'Mrs' TO CUSTTITI
                    CONTINUE
                 WHEN 'MISS______'
                    MOVE 'Miss' TO CUSTTITI
                    CONTINUE
                 WHEN 'Miss______'
                    MOVE 'Miss' TO CUSTTITI
                    CONTINUE
                 WHEN 'MISS      '
                    MOVE 'Miss' TO CUSTTITI
                    CONTINUE
                 WHEN 'Miss      '
                    MOVE 'Miss' TO CUSTTITI
                    CONTINUE
                 WHEN 'miss______'
                    MOVE 'Miss' TO CUSTTITI
                    CONTINUE
                 WHEN 'MS________'
                    MOVE 'Ms' TO CUSTTITI
                    CONTINUE
                 WHEN 'Ms________'
                    MOVE 'Ms' TO CUSTTITI
                    CONTINUE
                 WHEN 'ms________'
                    MOVE 'Ms' TO CUSTTITI
                    CONTINUE
                 WHEN 'MS        '
                    MOVE 'Ms' TO CUSTTITI
                    CONTINUE
                 WHEN 'Ms        '
                    MOVE 'Ms' TO CUSTTITI
                    CONTINUE
                 WHEN 'ms        '
                    MOVE 'Ms' TO CUSTTITI
                    CONTINUE
                 WHEN 'DR________'
                    MOVE 'Dr' TO CUSTTITI
                    CONTINUE
                 WHEN 'Dr________'
                    MOVE 'Dr' TO CUSTTITI
                    CONTINUE
                 WHEN 'DR        '
                    MOVE 'Dr' TO CUSTTITI
                    CONTINUE
                 WHEN 'Dr        '
                    MOVE 'Dr' TO CUSTTITI
                    CONTINUE
                 WHEN 'dr        '
                    MOVE 'Dr' TO CUSTTITI
                    CONTINUE
                 WHEN 'dr________'
                    MOVE 'Dr' TO CUSTTITI
                    CONTINUE
                 WHEN 'DRS_______'
                    MOVE 'Drs' TO CUSTTITI
                    CONTINUE
                 WHEN 'Drs_______'
                    MOVE 'Drs' TO CUSTTITI
                    CONTINUE
                 WHEN 'DRS       '
                    MOVE 'Drs' TO CUSTTITI
                    CONTINUE
                 WHEN 'Drs       '
                    MOVE 'Drs' TO CUSTTITI
                    CONTINUE
                 WHEN 'drs       '
                    MOVE 'Drs' TO CUSTTITI
                    CONTINUE
                 WHEN 'drs_______'
                    MOVE 'Drs' TO CUSTTITI
                    CONTINUE
                 WHEN 'PROFESSOR_'
                    MOVE 'Professor' TO CUSTTITI
                    CONTINUE
                 WHEN 'Professor_'
                    MOVE 'Professor' TO CUSTTITI
                    CONTINUE
                 WHEN 'PROFESSOR '
                    MOVE 'Professor' TO CUSTTITI
                    CONTINUE
                 WHEN 'Professor '
                    MOVE 'Professor' TO CUSTTITI
                    CONTINUE
                 WHEN 'LORD______'
                    MOVE 'Lord' TO CUSTTITI
                    CONTINUE
                 WHEN 'Lord______'
                    MOVE 'Lord' TO CUSTTITI
                    CONTINUE
                 WHEN 'LORD      '
                    MOVE 'Lord' TO CUSTTITI
                    CONTINUE
                 WHEN 'Lord      '
                    MOVE 'Lord' TO CUSTTITI
                    CONTINUE
                 WHEN 'lord      '
                    MOVE 'Lord' TO CUSTTITI
                    CONTINUE
                 WHEN 'lord______'
                    MOVE 'Lord' TO CUSTTITI
                    CONTINUE
                 WHEN 'LADY______'
                    MOVE 'Lady' TO CUSTTITI
                    CONTINUE
                 WHEN 'Lady______'
                    MOVE 'Lady' TO CUSTTITI
                    CONTINUE
                 WHEN 'LADY      '
                    MOVE 'Lady' TO CUSTTITI
                    CONTINUE
                 WHEN 'Lady      '
                    MOVE 'Lady' TO CUSTTITI
                    CONTINUE
                 WHEN 'lady      '
                    MOVE 'Lady' TO CUSTTITI
                    CONTINUE
                 WHEN 'lady______'
                    MOVE 'Lady' TO CUSTTITI
                    CONTINUE
                 WHEN 'SIR_______'
                    MOVE 'Sir' TO CUSTTITI
                    CONTINUE
                 WHEN 'Sir_______'
                    MOVE 'Sir' TO CUSTTITI
                    CONTINUE
                 WHEN 'SIR       '
                    MOVE 'Sir' TO CUSTTITI
                    CONTINUE
                 WHEN 'Sir       '
                    MOVE 'Sir' TO CUSTTITI
                    CONTINUE
                 WHEN 'sir       '
                    MOVE 'Sir' TO CUSTTITI
                    CONTINUE
                 WHEN 'sir_______'
                    MOVE 'Sir' TO CUSTTITI
                    CONTINUE
                 WHEN OTHER
                    MOVE SPACES TO MESSAGEO
                    STRING 'Valid titles are: Mr,Mrs,Miss,Ms,Dr,Drs,'
                       DELIMITED BY SIZE,
                       'Professor,Lord,Sir,Lady' DELIMITED BY SIZE
                       INTO MESSAGEO
                    MOVE 'N' TO VALID-DATA-SW
                    MOVE -1 TO CUSTTITL
                    GO TO ED999
              END-EVALUATE
           END-IF.
           IF CHRISTNL < 1 OR CHRISTNI = '____________________'
              OR CHRISTNI = SPACES
              MOVE SPACES TO MESSAGEO
              MOVE 'Please supply a valid First Name  ' TO
                 MESSAGEO
              MOVE -1 TO CHRISTNL
              MOVE 'N' TO VALID-DATA-SW
              GO TO ED999
           END-IF.
           IF CUSTSNL < 1 OR CUSTSNI = '____________________'
              OR CUSTSNI = SPACES
              MOVE SPACES TO MESSAGEO
              MOVE 'Please supply a valid Surname ' TO
                 MESSAGEO
              MOVE -1 TO CUSTSNL
              MOVE 'N' TO VALID-DATA-SW
              GO TO ED999
           END-IF.
           IF CUSTAD1I(1:1)= '_'  OR CUSTAD1L < 1
              OR CUSTAD1I = SPACES
              MOVE SPACES TO MESSAGEO
              MOVE 'Please supply a valid Address Line 1 ' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO CUSTAD1L
              GO TO ED999
           END-IF.
           IF DOBDDL < 1 OR DOBDDI = '__'
              MOVE SPACES TO MESSAGEO
              MOVE 'Please supply a valid Date of Birth DD' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO DOBDDL
              GO TO ED999
           END-IF.
           IF DOBMML < 1 OR DOBMMI = '__'
              MOVE SPACES TO MESSAGEO
              MOVE 'Please supply a valid Date of Birth MM' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO DOBMML
              GO TO ED999
           END-IF.
           IF DOBYYL < 4 OR DOBYYI = '____'
              MOVE SPACES TO MESSAGEO
              MOVE 'Please supply a valid Date of Birth YYYY' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO DOBYYL
              GO TO ED999
           END-IF.
           IF DOBDDI NOT NUMERIC
              MOVE SPACES TO MESSAGEO
              MOVE 'Non numeric Date of Birth DD entered      ' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO DOBDDL
              GO TO ED999
           END-IF.
           IF DOBMMI NOT NUMERIC
              MOVE SPACES TO MESSAGEO
              MOVE 'Non numeric Date of Birth MM entered      ' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO DOBMML
              GO TO ED999
           END-IF.
           IF DOBYYI NOT NUMERIC
              MOVE SPACES TO MESSAGEO
              MOVE 'Non numeric Date of Birth YYYY entered  ' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO DOBYYL
              GO TO ED999
           END-IF.
           MOVE DOBDDI TO DOBDDI-CHAR.
           IF DOBDDI-NUM < 01 OR DOBDDI-NUM > 31
              MOVE SPACES TO MESSAGEO
              MOVE 'Please supply a valid Date of Birth (DD)    ' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO DOBDDL
              GO TO ED999
           END-IF.
           MOVE DOBMMI TO DOBMMI-CHAR.
           IF DOBMMI-NUM < 01 OR DOBMMI-NUM > 12
              MOVE SPACES TO MESSAGEO
              MOVE 'Please supply a valid Date of Birth (MM)    ' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO DOBMML
              GO TO ED999
           END-IF.
           IF CUSTTITL < 1 OR CHRISTNL < 1 OR CUSTSNL < 1
           OR CUSTAD1L < 1 OR DOBDDL < 1 OR DOBMML < 1
           OR DOBYYL < 1
              MOVE SPACES TO MESSAGEO
              MOVE 'Missing expected data.               ' TO
                 MESSAGEO
              EVALUATE TRUE
                 WHEN CUSTTITL < 1
                    MOVE -1 TO CUSTTITL
                 WHEN CHRISTNL < 1
                    MOVE -1 TO CHRISTNL
                 WHEN CUSTSNL < 1
                    MOVE -1 TO CUSTSNL
                 WHEN CUSTAD1L < 1
                    MOVE -1 TO CUSTAD1L
                 WHEN DOBDDL < 1
                    MOVE -1 TO DOBDDL
                 WHEN DOBMML < 1
                    MOVE -1 TO DOBMML
                 WHEN DOBYYL < 1
                    MOVE -1 TO DOBYYL
              END-EVALUATE
              MOVE 'N' TO VALID-DATA-SW
              GO TO ED999
           END-IF.
       ED999.
           EXIT.
       CRE-CUST-DATA SECTION.
       CCD010.
           INITIALIZE SUBPGM-PARMS.
           MOVE 'CUST' TO SUBPGM-EYECATCHER.
           MOVE 'N' TO SUBPGM-SUCCESS.
           INSPECT CUSTTITI REPLACING ALL '_' BY ' '.
           INSPECT CHRISTNI REPLACING ALL '_' BY ' '.
           INSPECT CUSTINSI REPLACING ALL '_' BY ' '.
           INSPECT CUSTSNI  REPLACING ALL '_' BY ' '.
           STRING CUSTTITI DELIMITED BY SPACE,
                  ' ' DELIMITED BY SIZE,
                  CHRISTNI DELIMITED BY SPACE,
                  ' ' DELIMITED BY SIZE,
                  CUSTINSI  DELIMITED BY SPACE,
                  ' ' DELIMITED BY SIZE,
                  CUSTSNI   DELIMITED BY SIZE
           INTO SUBPGM-NAME.
           INSPECT CUSTAD1I REPLACING ALL '_' BY ' '.
           INSPECT CUSTAD2I REPLACING ALL '_' BY ' '.
           INSPECT CUSTAD3I REPLACING ALL '_' BY ' '.
           STRING CUSTAD1I   DELIMITED BY SIZE,
                  CUSTAD2I   DELIMITED BY SIZE,
                  CUSTAD3I   DELIMITED BY SIZE
                  INTO SUBPGM-ADDRESS.
           MOVE DOBDDI TO SUBPGM-BIRTH-DAY.
           MOVE DOBMMI TO SUBPGM-BIRTH-MONTH.
           MOVE DOBYYI TO SUBPGM-BIRTH-YEAR.
           EXEC CICS LINK
              PROGRAM('CRECUST')
              COMMAREA(SUBPGM-PARMS)
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
              SYNCONRETURN
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'CCD010 - LINK CRECUST FAIL  '
                   DELIMITED BY SIZE,
                    'EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1CCS - CCD010 - LINK CRECUST FAIL     '
                 TO WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM RESTORE-TERM-DEF
              PERFORM ABEND-THIS-TASK
           END-IF.
           IF SUBPGM-SUCCESS = 'N'
              MOVE SPACES TO MESSAGEO
              MOVE 'Sorry but unable to create Customer record '
                TO MESSAGEO
              IF SUBPGM-FAIL-CODE = 'O'
                MOVE 'Sorry, customer is too old. Please check D.O.B.'
                  to messageo
              END-IF
              IF SUBPGM-FAIL-CODE = 'Y'
                MOVE 'Sorry, customer D.O.B. is in the future.'
                  to messageo
              END-IF
              IF SUBPGM-FAIL-CODE = 'Z'
                MOVE 'Sorry, customer D.O.B. is invalid.'
                  to messageo
              END-IF
              MOVE 'N' TO VALID-DATA-SW
           END-IF.
           IF SUBPGM-SUCCESS = 'Y'
              MOVE SPACES TO MESSAGEO
              MOVE
                'The Customer record has been successfully created'
                TO MESSAGEO
              MOVE SUBPGM-SORTCODE    TO SORTCO
              MOVE SUBPGM-NUMBER      TO CUSTNO2O
           END-IF.
           MOVE SUBPGM-BIRTH-YEAR     TO DOBYYO.
           MOVE SUBPGM-BIRTH-MONTH    TO DOBMMO.
           MOVE SUBPGM-BIRTH-DAY      TO DOBDDO.
           MOVE SUBPGM-ADDRESS        TO WS-ADDR-SPLIT.
           MOVE WS-ADDR-SPLIT1        TO CUSTAD1O.
           MOVE WS-ADDR-SPLIT2        TO CUSTAD2O.
           MOVE WS-ADDR-SPLIT3        TO CUSTAD3O.
           MOVE SUBPGM-CREDIT-SCORE   TO CREDSCO.
           MOVE SUBPGM-CS-REVIEW-DATE(1:2)
                                      TO SCRDTDDO.
           MOVE SUBPGM-CS-REVIEW-DATE(3:2)
                                      TO SCRDTMMO.
           MOVE SUBPGM-CS-REVIEW-DATE(5:4)
                                      TO SCRDTYYO.
       CCD999.
           EXIT.
       STORE-TERM-DEF SECTION.
       STD010.
           EXEC CICS INQUIRE
                TERMINAL(EIBTRMID)
                UCTRANST(WS-UCTRANS)
                RESP(WS-CICS-RESP)
                RESP2(WS-CICS-RESP2)
           END-EXEC.
           MOVE WS-UCTRANS TO STORED-UCTRANS.
           IF WS-UCTRANS = DFHVALUE(UCTRAN) OR
           WS-UCTRANS = DFHVALUE(TRANIDONLY)
              MOVE DFHVALUE(NOUCTRAN) TO WS-UCTRANS
              EXEC CICS SET TERMINAL(EIBTRMID)
                 UCTRANST(WS-UCTRANS)
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'STD010 - SET TERMINAL UC FAIL '
                      DELIMITED BY SIZE,
                       'EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNK1CCS - STD010 - SET TERMINAL UC FAIL ' TO
                    WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM RESTORE-TERM-DEF
                 PERFORM ABEND-THIS-TASK
              END-IF
           END-IF.
       STD999.
           EXIT.
       RESTORE-TERM-DEF SECTION.
       RTD010.
           MOVE DFHCOMMAREA TO WS-COMM-AREA.
           MOVE WS-COMM-TERM TO WS-UCTRANS.
           EXEC CICS SET TERMINAL(EIBTRMID)
               UCTRANST(WS-UCTRANS)
               RESP(WS-CICS-RESP)
               RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'RTD010 - SET TERMINAL UC FAIL '
                    DELIMITED BY SIZE,
                    'EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1CCS - RTD010 - SET TERMINAL UC FAIL '
                 TO WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM ABEND-THIS-TASK
           END-IF.
       RTD999.
           EXIT.
       SEND-MAP SECTION.
       SM010.
           IF SEND-ERASE
              EXEC CICS SEND MAP('BNK1CC')
                  MAPSET('BNK1CCM')
                  FROM(BNK1CCO)
                  ERASE
                  CURSOR
                  RESP(WS-CICS-RESP)
                  RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'SM010 - SEND MAP ERASE FAIL '
                       DELIMITED BY SIZE,
                       'EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNK1CCS - SM010 - SEND MAP ERASE FAIL '
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM RESTORE-TERM-DEF
                 PERFORM ABEND-THIS-TASK
              END-IF
              GO TO SM999
           END-IF.
           IF SEND-DATAONLY
              EXEC CICS SEND MAP('BNK1CC')
                 MAPSET('BNK1CCM')
                 FROM(BNK1CCO)
                 DATAONLY
                 CURSOR
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'SM010 - SEND MAP DATAONLY FAIL '
                       DELIMITED BY SIZE,
                       'EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNK1CCS - SM010 - SEND MAP DATAONLY FAIL '
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM RESTORE-TERM-DEF
                 PERFORM ABEND-THIS-TASK
              END-IF
              GO TO SM999
           END-IF.
           IF SEND-DATAONLY-ALARM
              EXEC CICS SEND MAP('BNK1CC')
                 MAPSET('BNK1CCM')
                 FROM(BNK1CCO)
                 ALARM
                 DATAONLY
                 CURSOR
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'SM010 - SEND MAP DATAONLY ALARM FAIL '
                       DELIMITED BY SIZE,
                       'EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNK1CCS - SM010 - SEND MAP DATAONLY ALARM FAIL '
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM RESTORE-TERM-DEF
                 PERFORM ABEND-THIS-TASK
              END-IF
           END-IF.
       SM999.
           EXIT.
       SEND-TERMINATION-MSG SECTION.
       STM010.
           EXEC CICS SEND TEXT
              FROM(END-OF-SESSION-MESSAGE)
              ERASE
              FREEKB
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'STM010 - SEND TEXT FAIL'
                    DELIMITED BY SIZE,
                    'EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1CCS - STM010 - SEND TEXT FAIL'
                 TO WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM RESTORE-TERM-DEF
              PERFORM ABEND-THIS-TASK
           END-IF.
       STM999.
           EXIT.
       ABEND-THIS-TASK SECTION.
       ATT010.
           MOVE DFHCOMMAREA  TO WS-COMM-AREA.
           MOVE WS-COMM-TERM TO WS-UCTRANS.
           EXEC CICS SET TERMINAL(EIBTRMID)
               UCTRANST(WS-UCTRANS)
               RESP(WS-CICS-RESP)
               RESP2(WS-CICS-RESP2)
           END-EXEC.
           DISPLAY WS-FAIL-INFO.
           EXEC CICS ABEND
              ABCODE('HBNK')
              NODUMP
              CANCEL
           END-EXEC.
       ATT999.
           EXIT.
       POPULATE-TIME-DATE SECTION.
       PTD10.
           EXEC CICS ASKTIME
              ABSTIME(WS-U-TIME)
           END-EXEC.
           EXEC CICS FORMATTIME
                     ABSTIME(WS-U-TIME)
                     DDMMYYYY(WS-ORIG-DATE)
                     TIME(WS-TIME-NOW)
                     DATESEP
           END-EXEC.
       PTD999.
           EXIT.
       HANDLE-ABEND SECTION.
       HA010.
           PERFORM RESTORE-TERM-DEF.
           EXEC CICS ASSIGN ABCODE(WS-ABCODE)
           END-EXEC.
           EXEC CICS HANDLE ABEND CANCEL
           END-EXEC.
           EXEC CICS ABEND ABCODE(WS-ABCODE)
              NODUMP
           END-EXEC.
       HA999.
           EXIT.
","       WORKING-STORAGE SECTION.
       01 WS-UCTRANS                  PIC S9(8) COMP VALUE 0.
       01 STORED-UCTRANS              PIC S9(8) COMP VALUE 0.
       01 WS-CICS-WORK-AREA.
          03 WS-CICS-RESP             PIC S9(8) COMP VALUE 0.
          03 WS-CICS-RESP2            PIC S9(8) COMP VALUE 0.
       01 WS-FAIL-INFO.
          03 FILLER                   PIC X(9)  VALUE 'BNK1CCS  '.
          03 WS-CICS-FAIL-MSG         PIC X(70) VALUE ' '.
          03 FILLER                   PIC X(6)  VALUE ' RESP='.
          03 WS-CICS-RESP-DISP        PIC 9(10) VALUE 0.
          03 FILLER                   PIC X(7)  VALUE ' RESP2='.
          03 WS-CICS-RESP2-DISP       PIC 9(10) VALUE 0.
          03 FILLER                   PIC X(15) VALUE ' ABENDING TASK.'.
       01 SWITCHES.
           03 VALID-DATA-SW           PIC X VALUE 'Y'.
              88 VALID-DATA           VALUE 'Y'.
       01 FLAGS.
           03 SEND-FLAG               PIC X.
              88 SEND-ERASE           VALUE '1'.
              88 SEND-DATAONLY        VALUE '2'.
              88 SEND-DATAONLY-ALARM  VALUE '3'.
       01 ACTION-ALPHA.
           03 ACTION-NUM              PIC 9.
       01 END-OF-SESSION-MESSAGE      PIC X(13) VALUE 'Session Ended'.
       01 RESPONSE-CODE               PIC S9(8) COMP.
       01 COMMUNICATION-AREA          PIC X.
       01 COMM-DOB-SPLIT.
          03 COMM-DOB-SPLIT-DD         PIC 99.
          03 COMM-DOB-SPLIT-MM         PIC 99.
          03 COMM-DOB-SPLIT-YYYY       PIC 9999.
       01 COMM-ADDR-SPLIT.
          03 COMM-ADDR-SPLIT1         PIC X(60).
          03 COMM-ADDR-SPLIT2         PIC X(60).
          03 COMM-ADDR-SPLIT3         PIC X(40).
       01 WS-COMM-AREA.
          03 WS-COMM-DATA               PIC X.
          03 WS-COMM-TERM               PIC S9(8) COMP.
       01 DATE-REFORMED.
          03 DOBDDI-CHAR               PIC XX.
          03 DOBDDI-REFORM REDEFINES DOBDDI-CHAR.
             05 DOBDDI-NUM             PIC 99.
          03 DOBMMI-CHAR               PIC XX.
          03 DOBMMI-REFORM REDEFINES DOBMMI-CHAR.
             05 DOBMMI-NUM             PIC 99.
          03 DOBYYI-CHAR               PIC XX.
          03 DOBYYI-REFORM REDEFINES DOBYYI-CHAR.
             05 DOBYYI-NUM             PIC 99.
       01 WS-ABCODE PIC XXXX.
       01 WS-ADDR-SPLIT.
          03 WS-ADDR-SPLIT1            PIC X(60).
          03 WS-ADDR-SPLIT2            PIC X(60).
          03 WS-ADDR-SPLIT3            PIC X(40).
       01 SUBPGM-PARMS.
          03 SUBPGM-EYECATCHER                 PIC X(4).
          03 SUBPGM-KEY.
             05 SUBPGM-SORTCODE                PIC 9(6) DISPLAY.
             05 SUBPGM-NUMBER                  PIC 9(10) DISPLAY.
          03 SUBPGM-NAME                       PIC X(60).
          03 SUBPGM-ADDRESS                    PIC X(160).
          03 SUBPGM-DATE-OF-BIRTH              PIC 9(8).
          03 SUBPGM-DOB-GROUP REDEFINES SUBPGM-DATE-OF-BIRTH.
             05 SUBPGM-BIRTH-DAY               PIC 99.
             05 SUBPGM-BIRTH-MONTH             PIC 99.
             05 SUBPGM-BIRTH-YEAR              PIC 9999.
          03 SUBPGM-CREDIT-SCORE               PIC 999.
          03 SUBPGM-CS-REVIEW-DATE             PIC 9(8).
          03 SUBPGM-SUCCESS                    PIC X.
          03 SUBPGM-FAIL-CODE                  PIC X.
       01 COMPANY-NAME-FULL PIC X(32).
       01 CURSOR-POSITION PIC S9(4) BINARY.
       01 WS-U-TIME                      PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                   PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD             PIC 99.
          03 FILLER                      PIC X.
          03 WS-ORIG-DATE-MM             PIC 99.
          03 FILLER                      PIC X.
          03 WS-ORIG-DATE-YYYY           PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X           PIC XX.
          03 FILLER                      PIC X VALUE '.'.
          03 WS-ORIG-DATE-MM-X           PIC XX.
          03 FILLER                      PIC X VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X         PIC X(4).
       01 WS-TIME-DATA.
           03 WS-TIME-NOW                  PIC 9(6).
           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
              05 WS-TIME-NOW-GRP-HH     PIC 99.
              05 WS-TIME-NOW-GRP-MM     PIC 99.
              05 WS-TIME-NOW-GRP-SS     PIC 99.
       01 WS-ABEND-PGM                  PIC X(8) VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 DFHCOMMAREA-DATA                  PIC X(5).
","['PREMIERE', 'PROCESS-MAP', 'RECEIVE-MAP', 'EDIT-DATA', 'CRE-CUST-DATA', 'STORE-TERM-DEF', 'RESTORE-TERM-DEF', 'SEND-MAP', 'SEND-TERMINATION-MSG', 'ABEND-THIS-TASK', 'POPULATE-TIME-DATE', 'HANDLE-ABEND', 'A010', 'A999', 'PM010', 'PM999', 'RM010', 'RM999', 'ED010', 'ED999', 'CCD010', 'CCD999', 'STD010', 'STD999', 'RTD010', 'RTD999', 'SM010', 'SM999', 'STM010', 'STM999', 'ATT010', 'ATT999', 'PTD10', 'PTD999', 'HA010', 'HA999']","Paragraph PREMIERE calls paragraph STORE-TERM-DEF, SEND-MAP, RESTORE-TERM-DEF, SEND-TERMINATION-MSG, ABEND-THIS-TASK, POPULATE-TIME-DATE, PROCESS-MAP.
Paragraph PROCESS-MAP calls paragraph EDIT-DATA, RECEIVE-MAP, CRE-CUST-DATA, SEND-MAP.
Paragraph RECEIVE-MAP calls paragraph RESTORE-TERM-DEF, POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph EDIT-DATA calls paragraph ED999.
Paragraph CRE-CUST-DATA calls paragraph RESTORE-TERM-DEF, POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph STORE-TERM-DEF calls paragraph RESTORE-TERM-DEF, POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph RESTORE-TERM-DEF calls paragraph POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph SEND-MAP calls paragraph RESTORE-TERM-DEF, POPULATE-TIME-DATE, ABEND-THIS-TASK, SM999.
Paragraph SEND-TERMINATION-MSG calls paragraph RESTORE-TERM-DEF, POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph HANDLE-ABEND calls paragraph RESTORE-TERM-DEF.
",1173,This is the Create Customer program in the BANKING application BMS suite.,['WS-ABEND-PGM'],,,Error Long,1,1,1,"The COBOL code manages customer record creation while ensuring error handling and data validation using CICS. It begins with PREMIERE, processing terminal information and executing sequences through PROCESS-MAP, which involves receiving and validating data, creating records, and sending responses. Error handling and terminal restoration are managed within RESTORE-TERM-DEF and STORE-TERM-DEF. The program concludes with mechanisms for abnormal termination through HANDLE-ABEND and related procedures, ensuring accurate tracking of transaction statuses throughout.",
129,cicsdev_cics-banking-sample-application-cbsa,cics-banking-sample-application-cbsa/src/base/cobol_src/XFRFUN.cbl,,"       WORKING-STORAGE SECTION.
       77 SORTCODE           PIC 9(6) VALUE 987654.
           EXEC SQL
             INCLUDE ACCDB2
           END-EXEC.
       01 HOST-ACCOUNT-ROW.
          03 HV-ACCOUNT-EYECATCHER      PIC X(4).
          03 HV-ACCOUNT-CUST-NO         PIC X(10).
          03 HV-ACCOUNT-KEY.
             05 HV-ACCOUNT-SORTCODE     PIC X(6).
             05 HV-ACCOUNT-ACC-NO       PIC X(8).
          03 HV-ACCOUNT-ACC-TYPE        PIC X(8).
          03 HV-ACCOUNT-INT-RATE        PIC S9(4)V99 COMP-3.
          03 HV-ACCOUNT-OPENED          PIC X(10).
          03 HV-ACCOUNT-OVERDRAFT-LIM   PIC S9(9) COMP.
          03 HV-ACCOUNT-LAST-STMT       PIC X(10).
          03 HV-ACCOUNT-NEXT-STMT       PIC X(10).
          03 HV-ACCOUNT-AVAIL-BAL       PIC S9(10)V99 COMP-3.
          03 HV-ACCOUNT-ACTUAL-BAL      PIC S9(10)V99 COMP-3.
          EXEC SQL
             INCLUDE PROCDB2
          END-EXEC.
       01 HOST-PROCTRAN-ROW.
          03 HV-PROCTRAN-EYECATCHER     PIC X(4).
          03 HV-PROCTRAN-SORT-CODE      PIC X(6).
          03 HV-PROCTRAN-ACC-NUMBER     PIC X(8).
          03 HV-PROCTRAN-DATE           PIC X(10).
          03 HV-PROCTRAN-TIME           PIC X(6).
          03 HV-PROCTRAN-REF            PIC X(12).
          03 HV-PROCTRAN-TYPE           PIC X(3).
          03 HV-PROCTRAN-DESC           PIC X(40).
          03 HV-PROCTRAN-AMOUNT         PIC S9(10)V99 COMP-3.
       EXEC SQL
          INCLUDE SQLCA
       END-EXEC.
       01 WS-CICS-WORK-AREA.
          05 WS-CICS-RESP               PIC S9(8) COMP.
          05 WS-CICS-RESP2              PIC S9(8) COMP.
       LOCAL-STORAGE SECTION.
       01 SYSIDERR-RETRY                PIC 999.
       01 FILE-RETRY                    PIC 999.
       01 WS-EXIT-RETRY-LOOP            PIC X         VALUE ' '.
       01 DB2-DEADLOCK-RETRY            PIC 999.
       01 DB2-DATE-REFORMAT.
          03 DB2-DATE-REF-YR            PIC 9(4).
          03 FILLER                     PIC X.
          03 DB2-DATE-REF-MNTH          PIC 99.
          03 FILLER                     PIC X.
          03 DB2-DATE-REF-DAY           PIC 99.
       01 WS-ACC-DATA.
              03 ACCOUNT-DATA.
                 05 ACCOUNT-EYE-CATCHER        PIC X(4).
                 88 ACCOUNT-EYECATCHER-VALUE        VALUE 'ACCT'.
                 05 ACCOUNT-CUST-NO            PIC 9(10).
                 05 ACCOUNT-KEY.
                    07 ACCOUNT-SORT-CODE       PIC 9(6).
                    07 ACCOUNT-NUMBER          PIC 9(8).
                 05 ACCOUNT-TYPE               PIC X(8).
                 05 ACCOUNT-INTEREST-RATE      PIC 9(4)V99.
                 05 ACCOUNT-OPENED             PIC 9(8).
                 05 ACCOUNT-OPENED-GROUP REDEFINES ACCOUNT-OPENED.
                    07 ACCOUNT-OPENED-DAY       PIC 99.
                    07 ACCOUNT-OPENED-MONTH     PIC 99.
                    07 ACCOUNT-OPENED-YEAR      PIC 9999.
                 05 ACCOUNT-OVERDRAFT-LIMIT    PIC 9(8).
                 05 ACCOUNT-LAST-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-LAST-STMT-GROUP
                    REDEFINES ACCOUNT-LAST-STMT-DATE.
                    07 ACCOUNT-LAST-STMT-DAY   PIC 99.
                    07 ACCOUNT-LAST-STMT-MONTH PIC 99.
                    07 ACCOUNT-LAST-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-NEXT-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-NEXT-STMT-GROUP
                   REDEFINES ACCOUNT-NEXT-STMT-DATE.
                    07 ACCOUNT-NEXT-STMT-DAY   PIC 99.
                    07 ACCOUNT-NEXT-STMT-MONTH PIC 99.
                    07 ACCOUNT-NEXT-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-AVAILABLE-BALANCE  PIC S9(10)V99.
                 05 ACCOUNT-ACTUAL-BALANCE     PIC S9(10)V99.
       01 WS-ACC-DATA2.
              03 ACCOUNT2-DATA.
                 05 ACCOUNT2-EYE-CATCHER        PIC X(4).
                 88 ACCOUNT2-EYECATCHER-VALUE        VALUE 'ACCT'.
                 05 ACCOUNT2-CUST-NO            PIC 9(10).
                 05 ACCOUNT2-KEY.
                    07 ACCOUNT2-SORT-CODE       PIC 9(6).
                    07 ACCOUNT2-NUMBER          PIC 9(8).
                 05 ACCOUNT2-TYPE               PIC X(8).
                 05 ACCOUNT2-INTEREST-RATE      PIC 9(4)V99.
                 05 ACCOUNT2-OPENED             PIC 9(8).
                 05 ACCOUNT2-OPENED-GROUP REDEFINES ACCOUNT2-OPENED.
                    07 ACCOUNT2-OPENED-DAY       PIC 99.
                    07 ACCOUNT2-OPENED-MONTH     PIC 99.
                    07 ACCOUNT2-OPENED-YEAR      PIC 9999.
                 05 ACCOUNT2-OVERDRAFT-LIMIT    PIC 9(8).
                 05 ACCOUNT2-LAST-STMT-DATE     PIC 9(8).
                 05 ACCOUNT2-LAST-STMT-GROUP
                    REDEFINES ACCOUNT2-LAST-STMT-DATE.
                    07 ACCOUNT2-LAST-STMT-DAY   PIC 99.
                    07 ACCOUNT2-LAST-STMT-MONTH PIC 99.
                    07 ACCOUNT2-LAST-STMT-YEAR  PIC 9999.
                 05 ACCOUNT2-NEXT-STMT-DATE     PIC 9(8).
                 05 ACCOUNT2-NEXT-STMT-GROUP
                   REDEFINES ACCOUNT2-NEXT-STMT-DATE.
                    07 ACCOUNT2-NEXT-STMT-DAY   PIC 99.
                    07 ACCOUNT2-NEXT-STMT-MONTH PIC 99.
                    07 ACCOUNT2-NEXT-STMT-YEAR  PIC 9999.
                 05 ACCOUNT2-AVAILABLE-BALANCE  PIC S9(10)V99.
                 05 ACCOUNT2-ACTUAL-BALANCE     PIC S9(10)V99.
       01 WS-EIBTASKN12                 PIC 9(12)     VALUE 0.
       01 WS-SQLCODE-DISP               PIC 9(9)      VALUE 0.
       01 DESIRED-ACC-KEY.
          03 DESIRED-SORT-CODE          PIC 9(6).
          03 DESIRED-ACC-NO             PIC 9(8).
       01 NEW-ACCOUNT-AVAILABLE-BALANCE PIC S9(10)V99 VALUE 0.
       01 NEW-ACCOUNT-ACTUAL-BALANCE    PIC S9(10)V99 VALUE 0.
       01 WS-ACC-REC-LEN                PIC S9(4) COMP
                                                      VALUE 0.
       01 NEW-ACCOUNT-AVAILABLE-BALANCE2
                                        PIC S9(10)V99 VALUE 0.
       01 NEW-ACCOUNT-ACTUAL-BALANCE2   PIC S9(10)V99 VALUE 0.
       01 WS-ACC-REC-LEN2               PIC S9(4) COMP
                                                      VALUE 0.
       01 WS-U-TIME                     PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                  PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD            PIC 99.
          03 FILLER                     PIC X.
          03 WS-ORIG-DATE-MM            PIC 99.
          03 FILLER                     PIC X.
          03 WS-ORIG-DATE-YYYY          PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X          PIC XX.
          03 FILLER                     PIC X         VALUE '.'.
          03 WS-ORIG-DATE-MM-X          PIC XX.
          03 FILLER                     PIC X         VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X        PIC X(4).
       01 REJ-REASON                    PIC XX        VALUE SPACES.
       01 PROCTRAN-AREA.
           03 PROC-TRAN-DATA.
              05 PROC-TRAN-EYE-CATCHER        PIC X(4).
              88 PROC-TRAN-VALID VALUE 'PRTR'.
              05 PROC-TRAN-LOGICAL-DELETE-AREA REDEFINES
                 PROC-TRAN-EYE-CATCHER.
                 07 PROC-TRAN-LOGICAL-DELETE-FLAG PIC X.
                 88 PROC-TRAN-LOGICALLY-DELETED VALUE X'FF'.
                 07 FILLER PIC X(3).
              05 PROC-TRAN-ID.
                 07 PROC-TRAN-SORT-CODE       PIC 9(6).
                 07 PROC-TRAN-NUMBER          PIC 9(8).
              05 PROC-TRAN-DATE               PIC 9(8).
              05 PROC-TRAN-DATE-GRP REDEFINES PROC-TRAN-DATE.
                 07 PROC-TRAN-DATE-GRP-YYYY   PIC 9999.
                 07 PROC-TRAN-DATE-GRP-MM     PIC 99.
                 07 PROC-TRAN-DATE-GRP-DD     PIC 99.
              05 PROC-TRAN-TIME               PIC 9(6).
              05 PROC-TRAN-TIME-GRP REDEFINES PROC-TRAN-TIME.
                 07 PROC-TRAN-TIME-GRP-HH     PIC 99.
                 07 PROC-TRAN-TIME-GRP-MM     PIC 99.
                 07 PROC-TRAN-TIME-GRP-SS     PIC 99.
              05 PROC-TRAN-REF                PIC 9(12).
              05 PROC-TRAN-TYPE               PIC X(3).
              88 PROC-TY-CHEQUE-ACKNOWLEDGED      VALUE 'CHA'.
              88 PROC-TY-CHEQUE-FAILURE           VALUE 'CHF'.
              88 PROC-TY-CHEQUE-PAID-IN           VALUE 'CHI'.
              88 PROC-TY-CHEQUE-PAID-OUT          VALUE 'CHO'.
              88 PROC-TY-CREDIT                   VALUE 'CRE'.
              88 PROC-TY-DEBIT                    VALUE 'DEB'.
              88 PROC-TY-WEB-CREATE-ACCOUNT       VALUE 'ICA'.
              88 PROC-TY-WEB-CREATE-CUSTOMER      VALUE 'ICC'.
              88 PROC-TY-WEB-DELETE-ACCOUNT       VALUE 'IDA'.
              88 PROC-TY-WEB-DELETE-CUSTOMER      VALUE 'IDC'.
              88 PROC-TY-BRANCH-CREATE-ACCOUNT    VALUE 'OCA'.
              88 PROC-TY-BRANCH-CREATE-CUSTOMER   VALUE 'OCC'.
              88 PROC-TY-BRANCH-DELETE-ACCOUNT    VALUE 'ODA'.
              88 PROC-TY-BRANCH-DELETE-CUSTOMER   VALUE 'ODC'.
              88 PROC-TY-CREATE-SODD              VALUE 'OCS'.
              88 PROC-TY-PAYMENT-CREDIT           VALUE 'PCR'.
              88 PROC-TY-PAYMENT-DEBIT            VALUE 'PDR'.
              88 PROC-TY-TRANSFER                 VALUE 'TFR'.
              05 PROC-TRAN-DESC               PIC X(40).
              05 PROC-TRAN-DESC-XFR REDEFINES PROC-TRAN-DESC.
                07 PROC-TRAN-DESC-XFR-HEADER PIC X(26).
                88 PROC-TRAN-DESC-XFR-FLAG
                   VALUE 'TRANSFER'.
                07 PROC-TRAN-DESC-XFR-SORTCODE
                   PIC 9(6).
                07 PROC-TRAN-DESC-XFR-ACCOUNT
                   PIC 9(8).
              05 PROC-TRAN-DESC-DELACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELACC-ACCTYPE PIC X(8).
                07 PROC-DESC-DELACC-LAST-DD PIC 99.
                07 PROC-DESC-DELACC-LAST-MM PIC 99.
                07 PROC-DESC-DELACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-DELACC-NEXT-DD PIC 99.
                07 PROC-DESC-DELACC-NEXT-MM PIC 99.
                07 PROC-DESC-DELACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-DELACC-FOOTER PIC X(6).
                88 PROC-DESC-DELACC-FLAG
                   VALUE 'DELETE'.
              05 PROC-TRAN-DESC-CREACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CREACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-CREACC-ACCTYPE PIC X(8).
                07 PROC-DESC-CREACC-LAST-DD PIC 99.
                07 PROC-DESC-CREACC-LAST-MM PIC 99.
                07 PROC-DESC-CREACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-CREACC-NEXT-DD PIC 99.
                07 PROC-DESC-CREACC-NEXT-MM PIC 99.
                07 PROC-DESC-CREACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-CREACC-FOOTER PIC X(6).
                88 PROC-DESC-CREACC-FLAG
                   VALUE 'CREATE'.
              05 PROC-TRAN-DESC-DELCUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELCUS-SORTCODE PIC 9(6).
                07 PROC-DESC-DELCUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELCUS-NAME     PIC X(14).
                07 PROC-DESC-DELCUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-DELCUS-FILLER    PIC X.
                88 PROC-DESC-DELCUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-MM    PIC 99.
                07 PROC-DESC-DELCUS-FILLER2   PIC X.
                88 PROC-DESC-DELCUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-DD    PIC 99.
              05 PROC-TRAN-DESC-CRECUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CRECUS-SORTCODE PIC 9(6).
                07 PROC-DESC-CRECUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-CRECUS-NAME     PIC X(14).
                07 PROC-DESC-CRECUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-CRECUS-FILLER    PIC X.
                88 PROC-DESC-CRECUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-MM    PIC 99.
                07 PROC-DESC-CRECUS-FILLER2   PIC X.
                88 PROC-DESC-CRECUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-DD    PIC 99.
              05 PROC-TRAN-AMOUNT             PIC S9(10)V99.
       01 REJTRAN-RIDFLD                PIC S9(8) COMP.
       01 PROCTRAN-RIDFLD               PIC S9(8) COMP.
       01 WS-REJ-REAS.
          03 WS-REASON-TEXT             PIC X(26)     VALUE SPACES.
          03 WS-TO-ACC                  PIC 9(14) DISPLAY
                                                      VALUE 0.
       01 WS-PROC-REAS.
          03 WS-PROC-TEXT               PIC X(26)     VALUE SPACES.
          03 WS-PROC-TO                 PIC 9(14) DISPLAY
                                                      VALUE 0.
       01 WS-TESTING-DB-NAME.
          03 WS-TESTING-TYPE            PIC X(9)      VALUE 'STTESTER.'.
          03 WS-TESTING-TABLE-NAME      PIC X(4)      VALUE 'PLOP'.
       01 WS-SQLCODE1                   PIC 9(15).
       EXEC SQL INCLUDE SQLDA END-EXEC.
       01 STMTBUF.
          49 STMTLEN                    PIC S9(4) COMP
                                                      VALUE +78.
          49 STMTTXT                    PIC X(78).
       01 STMTBUF2.
          49 STMTLEN2                   PIC S9(4) COMP
                                                      VALUE +81.
          49 STMTTXT2                   PIC X(81).
       01 DISP-LOT.
          03 DISP-SIGN                  PIC X.
          03 DISP-SQLCD                 PIC 9999.
       01 WS-WANTED.
          03 VAR-LEN                    PIC S9(4) COMP
                                                      VALUE +78.
          03 VAR-TXT                    PIC X(78).
       01 WS-WANTED2.
          03 VAR-LEN2                   PIC S9(4) COMP
                                                      VALUE +81.
          03 VAR-TXT2                   PIC X(81).
       01 WS-INPUT-TAB-NAME             PIC X(4).
       01 WS-INPUT-TAB-NAME2            PIC X(7).
       01 WS-PASSED-DATA.
          02 WS-TEST-KEY                PIC X(4).
          02 WS-SORT-CODE               PIC 9(6).
          02 WS-CUSTOMER-RANGE.
             07 WS-CUSTOMER-RANGE-TOP   PIC X.
             07 WS-CUSTOMER-RANGE-MIDDLE
                                        PIC X.
             07 WS-CUSTOMER-RANGE-BOTTOM
                                        PIC X.
       01 MY-ABEND-CODE                 PIC XXXX.
       01 WS-STORM-DRAIN                PIC X         VALUE 'N'.
       01 STORM-DRAIN-CONDITION         PIC X(20).
       01 SQLCODE-DISPLAY               PIC S9(8) DISPLAY
             SIGN LEADING SEPARATE.
       01 NUMERIC-AMOUNT-DISPLAY        PIC +9(10).99.
       01 WS-TIME-DATA.
          03 WS-TIME-NOW                PIC 9(6).
          03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
             05 WS-TIME-NOW-GRP-HH      PIC 99.
             05 WS-TIME-NOW-GRP-MM      PIC 99.
             05 WS-TIME-NOW-GRP-SS      PIC 99.
       01 WS-ABEND-PGM                  PIC X(8)      VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 COMM-FACCNO               PIC 9(8).
          03 COMM-FSCODE               PIC 9(6).
          03 COMM-TACCNO               PIC 9(8).
          03 COMM-TSCODE               PIC 9(6).
          03 COMM-AMT                  PIC S9(10)V99.
          03 COMM-FAVBAL               PIC S9(10)V99.
          03 COMM-FACTBAL              PIC S9(10)V99.
          03 COMM-TAVBAL               PIC S9(10)V99.
          03 COMM-TACTBAL              PIC S9(10)V99.
          03 COMM-FAIL-CODE            PIC X.
          03 COMM-SUCCESS              PIC X.
","['PREMIERE', 'UPDATE-ACCOUNT-DB2', 'UPDATE-ACCOUNT-DB2-FROM', 'UPDATE-ACCOUNT-DB2-TO', 'WRITE-TO-PROCTRAN', 'WRITE-TO-PROCTRAN-DB2', 'GET-ME-OUT-OF-HERE', 'CHECK-FOR-STORM-DRAIN-DB2', 'ABEND-HANDLING', 'POPULATE-TIME-DATE', 'A010', 'A999', 'UAD010', 'UAD999', 'UADF010', 'UADF999', 'UADT010', 'UADT999', 'WTP010', 'WTP999', 'WTPD010', 'WTPD999', 'GMOOH010', 'GMOOH999', 'CFSDD010', 'CFSDD999', 'AH010', 'AH999', 'PTD010', 'PTD999']","Paragraph PREMIERE calls paragraph GET-ME-OUT-OF-HERE, UPDATE-ACCOUNT-DB2.
Paragraph UPDATE-ACCOUNT-DB2 calls paragraph WRITE-TO-PROCTRAN, POPULATE-TIME-DATE, UAD999, UPDATE-ACCOUNT-DB2-FROM, UPDATE-ACCOUNT-DB2-TO.
Paragraph UPDATE-ACCOUNT-DB2-FROM calls paragraph UADF999, CHECK-FOR-STORM-DRAIN-DB2.
Paragraph UPDATE-ACCOUNT-DB2-TO calls paragraph UADT999, POPULATE-TIME-DATE, UPDATE-ACCOUNT-DB2, CHECK-FOR-STORM-DRAIN-DB2.
Paragraph WRITE-TO-PROCTRAN calls paragraph WRITE-TO-PROCTRAN-DB2.
Paragraph WRITE-TO-PROCTRAN-DB2 calls paragraph POPULATE-TIME-DATE, CHECK-FOR-STORM-DRAIN-DB2.
Paragraph ABEND-HANDLING calls paragraph POPULATE-TIME-DATE.
",1395,"This program gets called when someone initiates a transfer of funds (perhaps) over the counter or via a web application. This program takes an incoming sortcode/account number (key) from the account where the money is transfered from and a sortcode/acount number (key) combination for the account where the money is being transferred to. Additionally, there will also be an incoming amount. This program needs to be able to cope with the data in any format. No checking is made on overdraft limits. If the transfer can be made successfully after looking up the account information then the account information will be updated and the PROCTRAN (Processed Transaction) datastore will be updated to record the successful transaction. If the transaction is a success, then the available balance and the actual balance for the account being debited and the account being credited will be returned. If the update to either the ACCOUNT or PROCTRAN datastore is unsuccessful, then the transaction is deemed to have failed. Should there be some kind of datastore failure or other unpredictable failure we should report it, back out any updates already made and abend the transaction.",['WS-ABEND-PGM'],,,Error Long,0.5,0.74,1,"The COBOL program manages account information and performs database operations. It begins by checking input amounts and updating DB2 accounts. Through interconnected paragraphs, it updates account details, writes to the PROCTRAN table, and handles storm drain checks and errors. Cleanup operations conclude the account updates. Abnormal terminations are addressed with specific handling routines, ensuring robust error management. Ultimately, it populates time and date variables for accurate transaction timestamps before gracefully exiting the program.",
130,cicsdev_cics-banking-sample-application-cbsa,cics-banking-sample-application-cbsa/src/base/cobol_src/DELCUS.cbl,"       CBL CICS('SP,EDF')
       CBL SQL
       IDENTIFICATION DIVISION.
       PROGRAM-ID. DELCUS.
       AUTHOR. Jon Collett.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.  IBM-370.
       OBJECT-COMPUTER.  IBM-370.
       INPUT-OUTPUT SECTION.
       DATA DIVISION.
       FILE SECTION.
       WORKING-STORAGE SECTION.
       77 SORTCODE           PIC 9(6) VALUE 987654.
       01 SYSIDERR-RETRY               PIC 999.
       01 FILE-RETRY                   PIC 999.
       01 WS-EXIT-RETRY-LOOP           PIC X VALUE ' '.
           EXEC SQL
              INCLUDE PROCDB2
           END-EXEC.
       01 HOST-PROCTRAN-ROW.
           03 HV-PROCTRAN-EYECATCHER   PIC X(4).
           03 HV-PROCTRAN-SORT-CODE    PIC X(6).
           03 HV-PROCTRAN-ACC-NUMBER   PIC X(8).
           03 HV-PROCTRAN-DATE         PIC X(10).
           03 HV-PROCTRAN-TIME         PIC X(6).
           03 HV-PROCTRAN-REF          PIC X(12).
           03 HV-PROCTRAN-TYPE         PIC X(3).
           03 HV-PROCTRAN-DESC         PIC X(40).
           03 HV-PROCTRAN-AMOUNT       PIC S9(10)V99 COMP-3.
       EXEC SQL
          INCLUDE SQLCA
       END-EXEC.
       01 WS-CICS-WORK-AREA.
           05 WS-CICS-RESP             PIC S9(8) COMP.
           05 WS-CICS-RESP2            PIC S9(8) COMP.
       01 EXIT-BROWSE-LOOP             PIC X VALUE 'N'.
       01 OUTPUT-DATA.
              03 ACCOUNT-DATA.
                 05 ACCOUNT-EYE-CATCHER        PIC X(4).
                 88 ACCOUNT-EYECATCHER-VALUE        VALUE 'ACCT'.
                 05 ACCOUNT-CUST-NO            PIC 9(10).
                 05 ACCOUNT-KEY.
                    07 ACCOUNT-SORT-CODE       PIC 9(6).
                    07 ACCOUNT-NUMBER          PIC 9(8).
                 05 ACCOUNT-TYPE               PIC X(8).
                 05 ACCOUNT-INTEREST-RATE      PIC 9(4)V99.
                 05 ACCOUNT-OPENED             PIC 9(8).
                 05 ACCOUNT-OPENED-GROUP REDEFINES ACCOUNT-OPENED.
                    07 ACCOUNT-OPENED-DAY       PIC 99.
                    07 ACCOUNT-OPENED-MONTH     PIC 99.
                    07 ACCOUNT-OPENED-YEAR      PIC 9999.
                 05 ACCOUNT-OVERDRAFT-LIMIT    PIC 9(8).
                 05 ACCOUNT-LAST-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-LAST-STMT-GROUP
                    REDEFINES ACCOUNT-LAST-STMT-DATE.
                    07 ACCOUNT-LAST-STMT-DAY   PIC 99.
                    07 ACCOUNT-LAST-STMT-MONTH PIC 99.
                    07 ACCOUNT-LAST-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-NEXT-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-NEXT-STMT-GROUP
                   REDEFINES ACCOUNT-NEXT-STMT-DATE.
                    07 ACCOUNT-NEXT-STMT-DAY   PIC 99.
                    07 ACCOUNT-NEXT-STMT-MONTH PIC 99.
                    07 ACCOUNT-NEXT-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-AVAILABLE-BALANCE  PIC S9(10)V99.
                 05 ACCOUNT-ACTUAL-BALANCE     PIC S9(10)V99.
       01 OUTPUT-CUST-DATA.
           03 CUSTOMER-RECORD.
              05 CUSTOMER-EYECATCHER                 PIC X(4).
                 88 CUSTOMER-EYECATCHER-VALUE        VALUE 'CUST'.
              05 CUSTOMER-KEY.
                 07 CUSTOMER-SORTCODE                PIC 9(6) DISPLAY.
                 07 CUSTOMER-NUMBER                  PIC 9(10) DISPLAY.
              05 CUSTOMER-NAME                       PIC X(60).
              05 CUSTOMER-ADDRESS                    PIC X(160).
              05 CUSTOMER-DATE-OF-BIRTH              PIC 9(8).
              05 CUSTOMER-DOB-GROUP REDEFINES CUSTOMER-DATE-OF-BIRTH.
                 07 CUSTOMER-BIRTH-DAY               PIC 99.
                 07 CUSTOMER-BIRTH-MONTH             PIC 99.
                 07 CUSTOMER-BIRTH-YEAR              PIC 9999.
              05 CUSTOMER-CREDIT-SCORE               PIC 999.
              05 CUSTOMER-CS-REVIEW-DATE             PIC 9(8).
              05 CUSTOMER-CS-GROUP
                 REDEFINES CUSTOMER-CS-REVIEW-DATE.
                 07 CUSTOMER-CS-REVIEW-DAY           PIC 99.
                 07 CUSTOMER-CS-REVIEW-MONTH         PIC 99.
                 07 CUSTOMER-CS-REVIEW-YEAR          PIC 9999.
       01 PROCTRAN-AREA.
           03 PROC-TRAN-DATA.
              05 PROC-TRAN-EYE-CATCHER        PIC X(4).
              88 PROC-TRAN-VALID VALUE 'PRTR'.
              05 PROC-TRAN-LOGICAL-DELETE-AREA REDEFINES
                 PROC-TRAN-EYE-CATCHER.
                 07 PROC-TRAN-LOGICAL-DELETE-FLAG PIC X.
                 88 PROC-TRAN-LOGICALLY-DELETED VALUE X'FF'.
                 07 FILLER PIC X(3).
              05 PROC-TRAN-ID.
                 07 PROC-TRAN-SORT-CODE       PIC 9(6).
                 07 PROC-TRAN-NUMBER          PIC 9(8).
              05 PROC-TRAN-DATE               PIC 9(8).
              05 PROC-TRAN-DATE-GRP REDEFINES PROC-TRAN-DATE.
                 07 PROC-TRAN-DATE-GRP-YYYY   PIC 9999.
                 07 PROC-TRAN-DATE-GRP-MM     PIC 99.
                 07 PROC-TRAN-DATE-GRP-DD     PIC 99.
              05 PROC-TRAN-TIME               PIC 9(6).
              05 PROC-TRAN-TIME-GRP REDEFINES PROC-TRAN-TIME.
                 07 PROC-TRAN-TIME-GRP-HH     PIC 99.
                 07 PROC-TRAN-TIME-GRP-MM     PIC 99.
                 07 PROC-TRAN-TIME-GRP-SS     PIC 99.
              05 PROC-TRAN-REF                PIC 9(12).
              05 PROC-TRAN-TYPE               PIC X(3).
              88 PROC-TY-CHEQUE-ACKNOWLEDGED      VALUE 'CHA'.
              88 PROC-TY-CHEQUE-FAILURE           VALUE 'CHF'.
              88 PROC-TY-CHEQUE-PAID-IN           VALUE 'CHI'.
              88 PROC-TY-CHEQUE-PAID-OUT          VALUE 'CHO'.
              88 PROC-TY-CREDIT                   VALUE 'CRE'.
              88 PROC-TY-DEBIT                    VALUE 'DEB'.
              88 PROC-TY-WEB-CREATE-ACCOUNT       VALUE 'ICA'.
              88 PROC-TY-WEB-CREATE-CUSTOMER      VALUE 'ICC'.
              88 PROC-TY-WEB-DELETE-ACCOUNT       VALUE 'IDA'.
              88 PROC-TY-WEB-DELETE-CUSTOMER      VALUE 'IDC'.
              88 PROC-TY-BRANCH-CREATE-ACCOUNT    VALUE 'OCA'.
              88 PROC-TY-BRANCH-CREATE-CUSTOMER   VALUE 'OCC'.
              88 PROC-TY-BRANCH-DELETE-ACCOUNT    VALUE 'ODA'.
              88 PROC-TY-BRANCH-DELETE-CUSTOMER   VALUE 'ODC'.
              88 PROC-TY-CREATE-SODD              VALUE 'OCS'.
              88 PROC-TY-PAYMENT-CREDIT           VALUE 'PCR'.
              88 PROC-TY-PAYMENT-DEBIT            VALUE 'PDR'.
              88 PROC-TY-TRANSFER                 VALUE 'TFR'.
              05 PROC-TRAN-DESC               PIC X(40).
              05 PROC-TRAN-DESC-XFR REDEFINES PROC-TRAN-DESC.
                07 PROC-TRAN-DESC-XFR-HEADER PIC X(26).
                88 PROC-TRAN-DESC-XFR-FLAG
                   VALUE 'TRANSFER'.
                07 PROC-TRAN-DESC-XFR-SORTCODE
                   PIC 9(6).
                07 PROC-TRAN-DESC-XFR-ACCOUNT
                   PIC 9(8).
              05 PROC-TRAN-DESC-DELACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELACC-ACCTYPE PIC X(8).
                07 PROC-DESC-DELACC-LAST-DD PIC 99.
                07 PROC-DESC-DELACC-LAST-MM PIC 99.
                07 PROC-DESC-DELACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-DELACC-NEXT-DD PIC 99.
                07 PROC-DESC-DELACC-NEXT-MM PIC 99.
                07 PROC-DESC-DELACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-DELACC-FOOTER PIC X(6).
                88 PROC-DESC-DELACC-FLAG
                   VALUE 'DELETE'.
              05 PROC-TRAN-DESC-CREACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CREACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-CREACC-ACCTYPE PIC X(8).
                07 PROC-DESC-CREACC-LAST-DD PIC 99.
                07 PROC-DESC-CREACC-LAST-MM PIC 99.
                07 PROC-DESC-CREACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-CREACC-NEXT-DD PIC 99.
                07 PROC-DESC-CREACC-NEXT-MM PIC 99.
                07 PROC-DESC-CREACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-CREACC-FOOTER PIC X(6).
                88 PROC-DESC-CREACC-FLAG
                   VALUE 'CREATE'.
              05 PROC-TRAN-DESC-DELCUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELCUS-SORTCODE PIC 9(6).
                07 PROC-DESC-DELCUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELCUS-NAME     PIC X(14).
                07 PROC-DESC-DELCUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-DELCUS-FILLER    PIC X.
                88 PROC-DESC-DELCUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-MM    PIC 99.
                07 PROC-DESC-DELCUS-FILLER2   PIC X.
                88 PROC-DESC-DELCUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-DD    PIC 99.
              05 PROC-TRAN-DESC-CRECUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CRECUS-SORTCODE PIC 9(6).
                07 PROC-DESC-CRECUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-CRECUS-NAME     PIC X(14).
                07 PROC-DESC-CRECUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-CRECUS-FILLER    PIC X.
                88 PROC-DESC-CRECUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-MM    PIC 99.
                07 PROC-DESC-CRECUS-FILLER2   PIC X.
                88 PROC-DESC-CRECUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-DD    PIC 99.
              05 PROC-TRAN-AMOUNT             PIC S9(10)V99.
       01 PROCTRAN-RIDFLD                 PIC S9(8) COMP.
       77 PROCTRAN-RETRY                  PIC 999.
       01 ACCOUNT-ACT-BAL-STORE           PIC S9(10)V99 VALUE 0.
       01 RETURNED-DATA.
           03 RETURNED-EYE-CATCHER        PIC X(4).
           03 RETURNED-CUST-NO            PIC 9(10).
           03 RETURNED-KEY.
              05 RETURNED-SORT-CODE       PIC 9(6).
              05 RETURNED-NUMBER          PIC 9(8).
           03 RETURNED-TYPE               PIC X(8).
           03 RETURNED-INTEREST-RATE      PIC 9(4)V99.
           03 RETURNED-OPENED             PIC 9(8).
           03 RETURNED-OVERDRAFT-LIMIT    PIC 9(8).
           03 RETURNED-LAST-STMT-DATE     PIC 9(8).
           03 RETURNED-NEXT-STMT-DATE     PIC 9(8).
           03 RETURNED-AVAILABLE-BALANCE  PIC S9(10)V99.
           03 RETURNED-ACTUAL-BALANCE     PIC S9(10)V99.
       01 ACCTCUST-DESIRED-KEY PIC 9(10) BINARY.
       01 DB2-DATE-REFORMAT.
          03 DB2-DATE-REF-YR           PIC 9(4).
          03 FILLER                    PIC X.
          03 DB2-DATE-REF-MNTH         PIC 99.
          03 FILLER                    PIC X.
          03 DB2-DATE-REF-DAY          PIC 99.
       01 DB2-EXIT-LOOP                PIC X.
       01 FETCH-DATA-CNT               PIC 9(4) COMP.
       01 WS-CUST-ALT-KEY-LEN          PIC S9(4) COMP VALUE +10.
       01 WS-EIBTASKN12                PIC 9(12) VALUE 0.
       01 WS-CNT                       PIC S9(4) COMP VALUE 0.
       01 CUSTOMER-KY.
          03 REQUIRED-SORT-CODE        PIC 9(6)  VALUE 0.
       01 WS-ACC-KEY-LEN               PIC S9(4) COMP VALUE +14.
       01 WS-ACC-NUM                   PIC S9(4) COMP VALUE 0.
       01 WS-CUST-KEY-LEN              PIC S9(4) COMP VALUE +16.
       01 WS-CUST-NUM                  PIC S9(4) COMP VALUE 0.
       01 DESIRED-KEY-ACCTCUST.
           03 DESIRED-KEY-CUSTOMER-ACCTCUST   PIC 9(10).
           03 DESIRED-KEY-SORTCODE-ACCTCUST   PIC 9(6).
       01 DESIRED-KEY.
           03 DESIRED-KEY-SORTCODE     PIC 9(6).
           03 DESIRED-KEY-CUSTOMER     PIC 9(10).
       01 WS-U-TIME                    PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                 PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD              PIC 99.
          03 FILLER                       PIC X.
          03 WS-ORIG-DATE-MM              PIC 99.
          03 FILLER                       PIC X.
          03 WS-ORIG-DATE-YYYY            PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X          PIC XX.
          03 FILLER                     PIC X VALUE '.'.
          03 WS-ORIG-DATE-MM-X          PIC XX.
          03 FILLER                     PIC X VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X        PIC X(4).
       01 REMIX-STMT-DATE              PIC 9(8).
       01 WS-APPLID                    PIC X(8).
       01 VAR-REMIX.
          03 REMIX-SCODE               PIC 9(6).
          03 REMIX-CHAR REDEFINES REMIX-SCODE.
             05 REMIX-SCODE-CHAR           PIC X(6).
       01 WS-STOREDC-CUSTOMER.
          03 WS-STOREDC-EYECATCHER           PIC X(4).
          03 WS-STOREDC-SORTCODE             PIC 9(6).
          03 WS-STOREDC-NUMBER               PIC 9(10).
          03 WS-STOREDC-NAME                 PIC X(60).
          03 WS-STOREDC-ADDRESS              PIC X(160).
          03 WS-STOREDC-DATE-OF-BIRTH        PIC X(10).
          03 WS-STOREDC-CREDIT-SCORE         PIC 9(3).
          03 WS-STOREDC-CS-REVIEW-DATE       PIC X(10).
       01 WS-NONE-LEFT                 PIC X VALUE 'N'.
       01 WS-EXIT-FETCH                PIC X VALUE 'N'.
       01 SQLCODE-DISPLAY              PIC S9(8) DISPLAY
                                         SIGN LEADING SEPARATE.
       01 DELACC-COMMAREA.
          03 DELACC-COMM-EYE           PIC X(4).
          03 DELACC-COMM-CUSTNO        PIC X(10).
          03 DELACC-COMM-SCODE         PIC X(6).
          03 DELACC-COMM-ACCNO         PIC 9(8).
          03 DELACC-COMM-ACC-TYPE      PIC X(8).
          03 DELACC-COMM-INT-RATE      PIC 9(4)V99.
          03 DELACC-COMM-OPENED        PIC 9(8).
          03 DELACC-COMM-OVERDRAFT     PIC 9(8).
          03 DELACC-COMM-LAST-STMT-DT  PIC 9(8).
          03 DELACC-COMM-NEXT-STMT-DT  PIC 9(8).
          03 DELACC-COMM-AVAIL-BAL     PIC S9(10)V99.
          03 DELACC-COMM-ACTUAL-BAL    PIC S9(10)V99.
          03 DELACC-COMM-SUCCESS       PIC X.
          03 DELACC-COMM-FAIL-CD       PIC X.
          03 DELACC-COMM-DEL-SUCCESS   PIC X.
          03 DELACC-COMM-DEL-FAIL-CD   PIC X.
          03 DELACC-COMM-APPLID        PIC X(8).
          03 DELACC-COMM-PCB1          POINTER.
          03 DELACC-COMM-PCB2          POINTER.
       01 WS-TOKEN                     PIC S9(8) BINARY.
       01 WS-INDEX                     PIC S9(8) BINARY.
       01 INQACCCU-PROGRAM         PIC X(8) VALUE 'INQACCCU'.
       01 INQACCCU-COMMAREA.
          03 NUMBER-OF-ACCOUNTS        PIC S9(8) BINARY.
          03 CUSTOMER-NUMBER           PIC 9(10).
          03 COMM-SUCCESS              PIC X.
          03 COMM-FAIL-CODE            PIC X.
          03 CUSTOMER-FOUND            PIC X.
          03 COMM-PCB-POINTER          POINTER.
          03 ACCOUNT-DETAILS OCCURS 1 TO 20 DEPENDING ON
              NUMBER-OF-ACCOUNTS.
            05 COMM-EYE                  PIC X(4).
            05 COMM-CUSTNO               PIC X(10).
            05 COMM-SCODE                PIC X(6).
            05 COMM-ACCNO                PIC 9(8).
            05 COMM-ACC-TYPE             PIC X(8).
            05 COMM-INT-RATE             PIC 9(4)V99.
            05 COMM-OPENED               PIC 9(8).
            05 COMM-OPENED-GROUP REDEFINES COMM-OPENED.
              07 COMM-OPENED-DAY PIC 99.
              07 COMM-OPENED-MONTH PIC 99.
              07 COMM-OPENED-YEAR PIC 9999.
            05 COMM-OVERDRAFT            PIC 9(8).
            05 COMM-LAST-STMT-DT         PIC 9(8).
            05 COMM-LAST-STMT-GROUP REDEFINES COMM-LAST-STMT-DT.
              07 COMM-LAST-STMT-DAY PIC 99.
              07 COMM-LAST-STMT-MONTH PIC 99.
              07 COMM-LAST-STMT-YEAR PIC 9999.
            05 COMM-NEXT-STMT-DT         PIC 9(8).
            05 COMM-NEXT-STMT-GROUP REDEFINES COMM-NEXT-STMT-DT.
              07 COMM-NEXT-STMT-DAY PIC 99.
              07 COMM-NEXT-STMT-MONTH PIC 99.
              07 COMM-NEXT-STMT-YEAR PIC 9999.
            05 COMM-AVAIL-BAL            PIC S9(10)V99.
            05 COMM-ACTUAL-BAL           PIC S9(10)V99.
       01 STORM-DRAIN-CONDITION       PIC X(20).
       01 INQCUST-PROGRAM          PIC X(8) VALUE 'INQCUST '.
       01 INQCUST-COMMAREA.
          03 INQCUST-EYE                  PIC X(4).
          03 INQCUST-SCODE                PIC X(6).
          03 INQCUST-CUSTNO               PIC 9(10).
          03 INQCUST-NAME                 PIC X(60).
          03 INQCUST-ADDR                 PIC X(160).
          03 INQCUST-DOB.
            05 INQCUST-DOB-DD             PIC 99.
            05 INQCUST-DOB-MM             PIC 99.
            05 INQCUST-DOB-YYYY           PIC 9999.
          03 INQCUST-CREDIT-SCORE         PIC 999.
          03 INQCUST-CS-REVIEW-DT.
            05 INQCUST-CS-REVIEW-DD       PIC 99.
            05 INQCUST-CS-REVIEW-MM       PIC 99.
            05 INQCUST-CS-REVIEW-YYYY     PIC 9999.
          03 INQCUST-INQ-SUCCESS          PIC X.
          03 INQCUST-INQ-FAIL-CD          PIC X.
          03 INQCUST-PCB-POINTER          POINTER.
       01 WS-TIME-DATA.
           03 WS-TIME-NOW                  PIC 9(6).
           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
              05 WS-TIME-NOW-GRP-HH     PIC 99.
              05 WS-TIME-NOW-GRP-MM     PIC 99.
              05 WS-TIME-NOW-GRP-SS     PIC 99.
       01 WS-ABEND-PGM                  PIC X(8) VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 COMM-EYE                  PIC X(4).
          03 COMM-SCODE                PIC X(6).
          03 COMM-CUSTNO               PIC X(10).
          03 COMM-NAME                 PIC X(60).
          03 COMM-ADDR                 PIC X(160).
          03 COMM-DOB                  PIC 9(8).
          03 COMM-DOB-GROUP REDEFINES COMM-DOB.
             05 COMM-BIRTH-DAY               PIC 99.
             05 COMM-BIRTH-MONTH             PIC 99.
             05 COMM-BIRTH-YEAR              PIC 9999.
          03 COMM-CREDIT-SCORE         PIC 9(3).
          03 COMM-CS-REVIEW-DATE       PIC 9(8).
          03 COMM-CS-REVIEW-GROUP REDEFINES COMM-CS-REVIEW-DATE.
             05 COMM-CS-REVIEW-DD            PIC 99.
             05 COMM-CS-REVIEW-MM            PIC 99.
             05 COMM-CS-REVIEW-YYYY          PIC 9999.
          03 COMM-DEL-SUCCESS          PIC X.
          03 COMM-DEL-FAIL-CD          PIC X.
       PROCEDURE DIVISION USING DFHCOMMAREA.
       PREMIERE SECTION.
       A010.
           MOVE SORTCODE TO REQUIRED-SORT-CODE
                            REQUIRED-SORT-CODE OF CUSTOMER-KY
                            DESIRED-KEY-SORTCODE.
           MOVE COMM-CUSTNO OF DFHCOMMAREA
             TO DESIRED-KEY-CUSTOMER.
           INITIALIZE INQCUST-COMMAREA.
           MOVE COMM-CUSTNO OF DFHCOMMAREA TO
              INQCUST-CUSTNO.
           EXEC CICS LINK PROGRAM(INQCUST-PROGRAM)
                     COMMAREA(INQCUST-COMMAREA)
           END-EXEC.
           IF INQCUST-INQ-SUCCESS = 'N'
             MOVE 'N' TO COMM-DEL-SUCCESS
             MOVE INQCUST-INQ-FAIL-CD TO COMM-DEL-FAIL-CD
             EXEC CICS RETURN
             END-EXEC
           END-IF.
           PERFORM GET-ACCOUNTS
           IF NUMBER-OF-ACCOUNTS > 0
             PERFORM DELETE-ACCOUNTS
           END-IF
           PERFORM DEL-CUST-VSAM
           MOVE 'Y' TO COMM-DEL-SUCCESS.
           MOVE ' ' TO COMM-DEL-FAIL-CD.
           PERFORM GET-ME-OUT-OF-HERE.
       A999.
           EXIT.
       DELETE-ACCOUNTS SECTION.
       DA010.
           PERFORM VARYING WS-INDEX FROM 1 BY 1
           UNTIL WS-INDEX > NUMBER-OF-ACCOUNTS
              INITIALIZE DELACC-COMMAREA
              MOVE WS-APPLID TO DELACC-COMM-APPLID
              MOVE COMM-ACCNO(WS-INDEX) TO DELACC-COMM-ACCNO
              EXEC CICS LINK PROGRAM('DELACC  ')
                       COMMAREA(DELACC-COMMAREA)
              END-EXEC
           END-PERFORM.
       DA999.
           EXIT.
       GET-ACCOUNTS SECTION.
       GAC010.
           MOVE COMM-CUSTNO OF DFHCOMMAREA
              TO CUSTOMER-NUMBER OF INQACCCU-COMMAREA.
           MOVE 20 TO NUMBER-OF-ACCOUNTS IN INQACCCU-COMMAREA.
           SET COMM-PCB-POINTER OF INQACCCU-COMMAREA
              TO DELACC-COMM-PCB1
           EXEC CICS LINK PROGRAM('INQACCCU')
                     COMMAREA(INQACCCU-COMMAREA)
                     SYNCONRETURN
           END-EXEC.
       GAC999.
           EXIT.
       DEL-CUST-VSAM SECTION.
       DCV010.
           INITIALIZE OUTPUT-CUST-DATA.
           EXEC CICS READ FILE('CUSTOMER')
                RIDFLD(DESIRED-KEY)
                INTO(OUTPUT-CUST-DATA)
                UPDATE
                TOKEN(WS-TOKEN)
                RESP(WS-CICS-RESP)
                RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP = DFHRESP(SYSIDERR)
              PERFORM VARYING SYSIDERR-RETRY FROM 1 BY 1
              UNTIL SYSIDERR-RETRY > 100
              OR WS-CICS-RESP = DFHRESP(NORMAL)
              OR WS-CICS-RESP IS NOT EQUAL TO DFHRESP(SYSIDERR)
                 EXEC CICS DELAY FOR SECONDS(3)
                 END-EXEC
                 EXEC CICS READ FILE('CUSTOMER')
                    RIDFLD(DESIRED-KEY)
                    INTO(OUTPUT-CUST-DATA)
                    UPDATE
                    TOKEN(WS-TOKEN)
                    RESP(WS-CICS-RESP)
                    RESP2(WS-CICS-RESP2)
                 END-EXEC
              END-PERFORM
           END-IF
           IF WS-CICS-RESP = DFHRESP(NOTFND)
              GO TO DCV999
           END-IF
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'WPV6'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS    TO ABND-SQLCODE
              STRING 'DCV010 - Unable to READ CUSTOMER VSAM rec '
                    DELIMITED BY SIZE,
                    'for key:' DESIRED-KEY DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              DISPLAY 'In DELCUS (DCV010) '
              'UNABLE TO READ CUSTOMER VSAM REC'
              ' RESP CODE=' WS-CICS-RESP, ' RESP2=' WS-CICS-RESP2
              'FOR KEY=' DESIRED-KEY
              EXEC CICS ABEND
                 ABCODE ('WPV6')
              END-EXEC
           END-IF.
           MOVE CUSTOMER-EYECATCHER TO WS-STOREDC-EYECATCHER
                                        COMM-EYE IN DFHCOMMAREA.
           MOVE CUSTOMER-SORTCODE   TO WS-STOREDC-SORTCODE
                                       COMM-SCODE IN DFHCOMMAREA.
           MOVE CUSTOMER-NUMBER OF CUSTOMER-RECORD
              TO WS-STOREDC-NUMBER COMM-CUSTNO IN DFHCOMMAREA.
           MOVE CUSTOMER-NAME       TO WS-STOREDC-NAME
                                       COMM-NAME IN DFHCOMMAREA.
           MOVE CUSTOMER-ADDRESS    TO WS-STOREDC-ADDRESS
                                       COMM-ADDR IN DFHCOMMAREA.
           MOVE CUSTOMER-DATE-OF-BIRTH(1:2)
              TO WS-STOREDC-DATE-OF-BIRTH(1:2)
                 COMM-BIRTH-DAY IN DFHCOMMAREA.
           MOVE '/'                 TO WS-STOREDC-DATE-OF-BIRTH(3:1).
           MOVE CUSTOMER-DATE-OF-BIRTH(3:2)
              TO WS-STOREDC-DATE-OF-BIRTH(4:2)
                 COMM-BIRTH-MONTH IN DFHCOMMAREA.
           MOVE '/'                 TO WS-STOREDC-DATE-OF-BIRTH(6:1).
           MOVE CUSTOMER-DATE-OF-BIRTH(5:4)
              TO WS-STOREDC-DATE-OF-BIRTH(7:4)
                 COMM-BIRTH-YEAR IN DFHCOMMAREA.
           MOVE CUSTOMER-CREDIT-SCORE TO WS-STOREDC-CREDIT-SCORE
                                         COMM-CREDIT-SCORE.
           MOVE CUSTOMER-CS-REVIEW-DATE(1:2)
             TO WS-STOREDC-CS-REVIEW-DATE(1:2)
                COMM-CS-REVIEW-DD IN DFHCOMMAREA.
           MOVE '/'                 TO WS-STOREDC-CS-REVIEW-DATE(3:1).
           MOVE CUSTOMER-CS-REVIEW-DATE(3:2)
             TO WS-STOREDC-CS-REVIEW-DATE(4:2)
                COMM-CS-REVIEW-MM IN DFHCOMMAREA.
           MOVE '/'                 TO WS-STOREDC-CS-REVIEW-DATE(6:1).
           MOVE CUSTOMER-CS-REVIEW-DATE(5:4)
             TO WS-STOREDC-CS-REVIEW-DATE(7:4)
                COMM-CS-REVIEW-YYYY IN DFHCOMMAREA.
           EXEC CICS
              DELETE FILE ('CUSTOMER')
              TOKEN(WS-TOKEN)
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP = DFHRESP(SYSIDERR)
              PERFORM VARYING SYSIDERR-RETRY FROM 1 BY 1
              UNTIL SYSIDERR-RETRY > 100
              OR WS-CICS-RESP = DFHRESP(NORMAL)
              OR WS-CICS-RESP IS NOT EQUAL TO DFHRESP(SYSIDERR)
                 EXEC CICS DELAY FOR SECONDS(3)
                 END-EXEC
                 EXEC CICS DELETE FILE ('CUSTOMER')
                    TOKEN(WS-TOKEN)
                    RESP(WS-CICS-RESP)
                    RESP2(WS-CICS-RESP2)
                 END-EXEC
              END-PERFORM
           END-IF
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'WPV7'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS    TO ABND-SQLCODE
              STRING 'DCV010(2) - Unbale to DELETE CUSTOMER VSAM rec '
                    DELIMITED BY SIZE,
                    'for key:' DESIRED-KEY DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              DISPLAY 'In DELCUS (DCV010) '
              'UNABLE TO DELETE CUSTOMER VSAM REC'
              ' RESP CODE=' WS-CICS-RESP, ' RESP2=' WS-CICS-RESP2
              'FOR KEY=' DESIRED-KEY
              EXEC CICS ABEND
                 ABCODE ('WPV7')
              END-EXEC
           END-IF.
           PERFORM WRITE-PROCTRAN-CUST.
       DCV999.
           EXIT.
       WRITE-PROCTRAN-CUST SECTION.
       WPC010.
              PERFORM WRITE-PROCTRAN-CUST-DB2.
       WPC999.
           EXIT.
       WRITE-PROCTRAN-CUST-DB2 SECTION.
       WPCD010.
           INITIALIZE HOST-PROCTRAN-ROW.
           INITIALIZE WS-EIBTASKN12.
           MOVE 'PRTR' TO HV-PROCTRAN-EYECATCHER.
           MOVE WS-STOREDC-SORTCODE
              TO HV-PROCTRAN-SORT-CODE.
           MOVE ZEROS TO HV-PROCTRAN-ACC-NUMBER.
           MOVE EIBTASKN TO WS-EIBTASKN12.
           MOVE WS-EIBTASKN12 TO HV-PROCTRAN-REF.
           EXEC CICS ASKTIME
              ABSTIME(WS-U-TIME)
           END-EXEC.
           EXEC CICS FORMATTIME
                     ABSTIME(WS-U-TIME)
                     DDMMYYYY(WS-ORIG-DATE)
                     TIME(HV-PROCTRAN-TIME)
                     DATESEP('.')
           END-EXEC.
           MOVE WS-ORIG-DATE TO WS-ORIG-DATE-GRP-X.
           MOVE WS-ORIG-DATE-GRP-X TO HV-PROCTRAN-DATE.
           MOVE WS-STOREDC-SORTCODE      TO HV-PROCTRAN-DESC(1:6).
           MOVE WS-STOREDC-NUMBER        TO HV-PROCTRAN-DESC(7:10).
           MOVE WS-STOREDC-NAME          TO HV-PROCTRAN-DESC(17:14).
           MOVE WS-STOREDC-DATE-OF-BIRTH TO HV-PROCTRAN-DESC(31:10).
           MOVE 'ODC'         TO HV-PROCTRAN-TYPE.
           MOVE ZEROS         TO HV-PROCTRAN-AMOUNT.
           EXEC SQL
              INSERT INTO PROCTRAN
                     (
                      PROCTRAN_EYECATCHER,
                      PROCTRAN_SORTCODE,
                      PROCTRAN_NUMBER,
                      PROCTRAN_DATE,
                      PROCTRAN_TIME,
                      PROCTRAN_REF,
                      PROCTRAN_TYPE,
                      PROCTRAN_DESC,
                      PROCTRAN_AMOUNT
                     )
              VALUES
                     (
                      :HV-PROCTRAN-EYECATCHER,
                      :HV-PROCTRAN-SORT-CODE,
                      :HV-PROCTRAN-ACC-NUMBER,
                      :HV-PROCTRAN-DATE,
                      :HV-PROCTRAN-TIME,
                      :HV-PROCTRAN-REF,
                      :HV-PROCTRAN-TYPE,
                      :HV-PROCTRAN-DESC,
                      :HV-PROCTRAN-AMOUNT
                     )
           END-EXEC.
           IF SQLCODE NOT = 0
              MOVE SQLCODE TO SQLCODE-DISPLAY
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HWPT'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE SQLCODE-DISPLAY   TO ABND-SQLCODE
              STRING 'WPCD010 - Unable to WRITE to PROCTRAN DB2 '
                    DELIMITED BY SIZE,
                    'datastore with the following data:'
                    DELIMITED BY SIZE,
                    HOST-PROCTRAN-ROW DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              DISPLAY 'In DELCUS(WPCD010) '
              'UNABLE TO WRITE TO PROCTRAN DB2 DATASTORE'
              ' SQLCODE=' SQLCODE-DISPLAY
              'WITH THE FOLLOWING DATA:' HOST-PROCTRAN-ROW
              EXEC CICS ABEND
                 ABCODE('HWPT')
                 NODUMP
              END-EXEC
           END-IF.
       WPCD999.
           EXIT.
       GET-ME-OUT-OF-HERE SECTION.
       GMOFH010.
           GOBACK.
       GMOFH999.
           EXIT.
       POPULATE-TIME-DATE SECTION.
       PTD010.
           EXEC CICS ASKTIME
              ABSTIME(WS-U-TIME)
           END-EXEC.
           EXEC CICS FORMATTIME
                     ABSTIME(WS-U-TIME)
                     DDMMYYYY(WS-ORIG-DATE)
                     TIME(WS-TIME-NOW)
                     DATESEP
           END-EXEC.
       PTD999.
           EXIT.
","       FILE SECTION.
       WORKING-STORAGE SECTION.
       77 SORTCODE           PIC 9(6) VALUE 987654.
       01 SYSIDERR-RETRY               PIC 999.
       01 FILE-RETRY                   PIC 999.
       01 WS-EXIT-RETRY-LOOP           PIC X VALUE ' '.
           EXEC SQL
              INCLUDE PROCDB2
           END-EXEC.
       01 HOST-PROCTRAN-ROW.
           03 HV-PROCTRAN-EYECATCHER   PIC X(4).
           03 HV-PROCTRAN-SORT-CODE    PIC X(6).
           03 HV-PROCTRAN-ACC-NUMBER   PIC X(8).
           03 HV-PROCTRAN-DATE         PIC X(10).
           03 HV-PROCTRAN-TIME         PIC X(6).
           03 HV-PROCTRAN-REF          PIC X(12).
           03 HV-PROCTRAN-TYPE         PIC X(3).
           03 HV-PROCTRAN-DESC         PIC X(40).
           03 HV-PROCTRAN-AMOUNT       PIC S9(10)V99 COMP-3.
       EXEC SQL
          INCLUDE SQLCA
       END-EXEC.
       01 WS-CICS-WORK-AREA.
           05 WS-CICS-RESP             PIC S9(8) COMP.
           05 WS-CICS-RESP2            PIC S9(8) COMP.
       01 EXIT-BROWSE-LOOP             PIC X VALUE 'N'.
       01 OUTPUT-DATA.
              03 ACCOUNT-DATA.
                 05 ACCOUNT-EYE-CATCHER        PIC X(4).
                 88 ACCOUNT-EYECATCHER-VALUE        VALUE 'ACCT'.
                 05 ACCOUNT-CUST-NO            PIC 9(10).
                 05 ACCOUNT-KEY.
                    07 ACCOUNT-SORT-CODE       PIC 9(6).
                    07 ACCOUNT-NUMBER          PIC 9(8).
                 05 ACCOUNT-TYPE               PIC X(8).
                 05 ACCOUNT-INTEREST-RATE      PIC 9(4)V99.
                 05 ACCOUNT-OPENED             PIC 9(8).
                 05 ACCOUNT-OPENED-GROUP REDEFINES ACCOUNT-OPENED.
                    07 ACCOUNT-OPENED-DAY       PIC 99.
                    07 ACCOUNT-OPENED-MONTH     PIC 99.
                    07 ACCOUNT-OPENED-YEAR      PIC 9999.
                 05 ACCOUNT-OVERDRAFT-LIMIT    PIC 9(8).
                 05 ACCOUNT-LAST-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-LAST-STMT-GROUP
                    REDEFINES ACCOUNT-LAST-STMT-DATE.
                    07 ACCOUNT-LAST-STMT-DAY   PIC 99.
                    07 ACCOUNT-LAST-STMT-MONTH PIC 99.
                    07 ACCOUNT-LAST-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-NEXT-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-NEXT-STMT-GROUP
                   REDEFINES ACCOUNT-NEXT-STMT-DATE.
                    07 ACCOUNT-NEXT-STMT-DAY   PIC 99.
                    07 ACCOUNT-NEXT-STMT-MONTH PIC 99.
                    07 ACCOUNT-NEXT-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-AVAILABLE-BALANCE  PIC S9(10)V99.
                 05 ACCOUNT-ACTUAL-BALANCE     PIC S9(10)V99.
       01 OUTPUT-CUST-DATA.
           03 CUSTOMER-RECORD.
              05 CUSTOMER-EYECATCHER                 PIC X(4).
                 88 CUSTOMER-EYECATCHER-VALUE        VALUE 'CUST'.
              05 CUSTOMER-KEY.
                 07 CUSTOMER-SORTCODE                PIC 9(6) DISPLAY.
                 07 CUSTOMER-NUMBER                  PIC 9(10) DISPLAY.
              05 CUSTOMER-NAME                       PIC X(60).
              05 CUSTOMER-ADDRESS                    PIC X(160).
              05 CUSTOMER-DATE-OF-BIRTH              PIC 9(8).
              05 CUSTOMER-DOB-GROUP REDEFINES CUSTOMER-DATE-OF-BIRTH.
                 07 CUSTOMER-BIRTH-DAY               PIC 99.
                 07 CUSTOMER-BIRTH-MONTH             PIC 99.
                 07 CUSTOMER-BIRTH-YEAR              PIC 9999.
              05 CUSTOMER-CREDIT-SCORE               PIC 999.
              05 CUSTOMER-CS-REVIEW-DATE             PIC 9(8).
              05 CUSTOMER-CS-GROUP
                 REDEFINES CUSTOMER-CS-REVIEW-DATE.
                 07 CUSTOMER-CS-REVIEW-DAY           PIC 99.
                 07 CUSTOMER-CS-REVIEW-MONTH         PIC 99.
                 07 CUSTOMER-CS-REVIEW-YEAR          PIC 9999.
       01 PROCTRAN-AREA.
           03 PROC-TRAN-DATA.
              05 PROC-TRAN-EYE-CATCHER        PIC X(4).
              88 PROC-TRAN-VALID VALUE 'PRTR'.
              05 PROC-TRAN-LOGICAL-DELETE-AREA REDEFINES
                 PROC-TRAN-EYE-CATCHER.
                 07 PROC-TRAN-LOGICAL-DELETE-FLAG PIC X.
                 88 PROC-TRAN-LOGICALLY-DELETED VALUE X'FF'.
                 07 FILLER PIC X(3).
              05 PROC-TRAN-ID.
                 07 PROC-TRAN-SORT-CODE       PIC 9(6).
                 07 PROC-TRAN-NUMBER          PIC 9(8).
              05 PROC-TRAN-DATE               PIC 9(8).
              05 PROC-TRAN-DATE-GRP REDEFINES PROC-TRAN-DATE.
                 07 PROC-TRAN-DATE-GRP-YYYY   PIC 9999.
                 07 PROC-TRAN-DATE-GRP-MM     PIC 99.
                 07 PROC-TRAN-DATE-GRP-DD     PIC 99.
              05 PROC-TRAN-TIME               PIC 9(6).
              05 PROC-TRAN-TIME-GRP REDEFINES PROC-TRAN-TIME.
                 07 PROC-TRAN-TIME-GRP-HH     PIC 99.
                 07 PROC-TRAN-TIME-GRP-MM     PIC 99.
                 07 PROC-TRAN-TIME-GRP-SS     PIC 99.
              05 PROC-TRAN-REF                PIC 9(12).
              05 PROC-TRAN-TYPE               PIC X(3).
              88 PROC-TY-CHEQUE-ACKNOWLEDGED      VALUE 'CHA'.
              88 PROC-TY-CHEQUE-FAILURE           VALUE 'CHF'.
              88 PROC-TY-CHEQUE-PAID-IN           VALUE 'CHI'.
              88 PROC-TY-CHEQUE-PAID-OUT          VALUE 'CHO'.
              88 PROC-TY-CREDIT                   VALUE 'CRE'.
              88 PROC-TY-DEBIT                    VALUE 'DEB'.
              88 PROC-TY-WEB-CREATE-ACCOUNT       VALUE 'ICA'.
              88 PROC-TY-WEB-CREATE-CUSTOMER      VALUE 'ICC'.
              88 PROC-TY-WEB-DELETE-ACCOUNT       VALUE 'IDA'.
              88 PROC-TY-WEB-DELETE-CUSTOMER      VALUE 'IDC'.
              88 PROC-TY-BRANCH-CREATE-ACCOUNT    VALUE 'OCA'.
              88 PROC-TY-BRANCH-CREATE-CUSTOMER   VALUE 'OCC'.
              88 PROC-TY-BRANCH-DELETE-ACCOUNT    VALUE 'ODA'.
              88 PROC-TY-BRANCH-DELETE-CUSTOMER   VALUE 'ODC'.
              88 PROC-TY-CREATE-SODD              VALUE 'OCS'.
              88 PROC-TY-PAYMENT-CREDIT           VALUE 'PCR'.
              88 PROC-TY-PAYMENT-DEBIT            VALUE 'PDR'.
              88 PROC-TY-TRANSFER                 VALUE 'TFR'.
              05 PROC-TRAN-DESC               PIC X(40).
              05 PROC-TRAN-DESC-XFR REDEFINES PROC-TRAN-DESC.
                07 PROC-TRAN-DESC-XFR-HEADER PIC X(26).
                88 PROC-TRAN-DESC-XFR-FLAG
                   VALUE 'TRANSFER'.
                07 PROC-TRAN-DESC-XFR-SORTCODE
                   PIC 9(6).
                07 PROC-TRAN-DESC-XFR-ACCOUNT
                   PIC 9(8).
              05 PROC-TRAN-DESC-DELACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELACC-ACCTYPE PIC X(8).
                07 PROC-DESC-DELACC-LAST-DD PIC 99.
                07 PROC-DESC-DELACC-LAST-MM PIC 99.
                07 PROC-DESC-DELACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-DELACC-NEXT-DD PIC 99.
                07 PROC-DESC-DELACC-NEXT-MM PIC 99.
                07 PROC-DESC-DELACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-DELACC-FOOTER PIC X(6).
                88 PROC-DESC-DELACC-FLAG
                   VALUE 'DELETE'.
              05 PROC-TRAN-DESC-CREACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CREACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-CREACC-ACCTYPE PIC X(8).
                07 PROC-DESC-CREACC-LAST-DD PIC 99.
                07 PROC-DESC-CREACC-LAST-MM PIC 99.
                07 PROC-DESC-CREACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-CREACC-NEXT-DD PIC 99.
                07 PROC-DESC-CREACC-NEXT-MM PIC 99.
                07 PROC-DESC-CREACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-CREACC-FOOTER PIC X(6).
                88 PROC-DESC-CREACC-FLAG
                   VALUE 'CREATE'.
              05 PROC-TRAN-DESC-DELCUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELCUS-SORTCODE PIC 9(6).
                07 PROC-DESC-DELCUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELCUS-NAME     PIC X(14).
                07 PROC-DESC-DELCUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-DELCUS-FILLER    PIC X.
                88 PROC-DESC-DELCUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-MM    PIC 99.
                07 PROC-DESC-DELCUS-FILLER2   PIC X.
                88 PROC-DESC-DELCUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-DD    PIC 99.
              05 PROC-TRAN-DESC-CRECUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CRECUS-SORTCODE PIC 9(6).
                07 PROC-DESC-CRECUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-CRECUS-NAME     PIC X(14).
                07 PROC-DESC-CRECUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-CRECUS-FILLER    PIC X.
                88 PROC-DESC-CRECUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-MM    PIC 99.
                07 PROC-DESC-CRECUS-FILLER2   PIC X.
                88 PROC-DESC-CRECUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-DD    PIC 99.
              05 PROC-TRAN-AMOUNT             PIC S9(10)V99.
       01 PROCTRAN-RIDFLD                 PIC S9(8) COMP.
       77 PROCTRAN-RETRY                  PIC 999.
       01 ACCOUNT-ACT-BAL-STORE           PIC S9(10)V99 VALUE 0.
       01 RETURNED-DATA.
           03 RETURNED-EYE-CATCHER        PIC X(4).
           03 RETURNED-CUST-NO            PIC 9(10).
           03 RETURNED-KEY.
              05 RETURNED-SORT-CODE       PIC 9(6).
              05 RETURNED-NUMBER          PIC 9(8).
           03 RETURNED-TYPE               PIC X(8).
           03 RETURNED-INTEREST-RATE      PIC 9(4)V99.
           03 RETURNED-OPENED             PIC 9(8).
           03 RETURNED-OVERDRAFT-LIMIT    PIC 9(8).
           03 RETURNED-LAST-STMT-DATE     PIC 9(8).
           03 RETURNED-NEXT-STMT-DATE     PIC 9(8).
           03 RETURNED-AVAILABLE-BALANCE  PIC S9(10)V99.
           03 RETURNED-ACTUAL-BALANCE     PIC S9(10)V99.
       01 ACCTCUST-DESIRED-KEY PIC 9(10) BINARY.
       01 DB2-DATE-REFORMAT.
          03 DB2-DATE-REF-YR           PIC 9(4).
          03 FILLER                    PIC X.
          03 DB2-DATE-REF-MNTH         PIC 99.
          03 FILLER                    PIC X.
          03 DB2-DATE-REF-DAY          PIC 99.
       01 DB2-EXIT-LOOP                PIC X.
       01 FETCH-DATA-CNT               PIC 9(4) COMP.
       01 WS-CUST-ALT-KEY-LEN          PIC S9(4) COMP VALUE +10.
       01 WS-EIBTASKN12                PIC 9(12) VALUE 0.
       01 WS-CNT                       PIC S9(4) COMP VALUE 0.
       01 CUSTOMER-KY.
          03 REQUIRED-SORT-CODE        PIC 9(6)  VALUE 0.
       01 WS-ACC-KEY-LEN               PIC S9(4) COMP VALUE +14.
       01 WS-ACC-NUM                   PIC S9(4) COMP VALUE 0.
       01 WS-CUST-KEY-LEN              PIC S9(4) COMP VALUE +16.
       01 WS-CUST-NUM                  PIC S9(4) COMP VALUE 0.
       01 DESIRED-KEY-ACCTCUST.
           03 DESIRED-KEY-CUSTOMER-ACCTCUST   PIC 9(10).
           03 DESIRED-KEY-SORTCODE-ACCTCUST   PIC 9(6).
       01 DESIRED-KEY.
           03 DESIRED-KEY-SORTCODE     PIC 9(6).
           03 DESIRED-KEY-CUSTOMER     PIC 9(10).
       01 WS-U-TIME                    PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                 PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD              PIC 99.
          03 FILLER                       PIC X.
          03 WS-ORIG-DATE-MM              PIC 99.
          03 FILLER                       PIC X.
          03 WS-ORIG-DATE-YYYY            PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X          PIC XX.
          03 FILLER                     PIC X VALUE '.'.
          03 WS-ORIG-DATE-MM-X          PIC XX.
          03 FILLER                     PIC X VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X        PIC X(4).
       01 REMIX-STMT-DATE              PIC 9(8).
       01 WS-APPLID                    PIC X(8).
       01 VAR-REMIX.
          03 REMIX-SCODE               PIC 9(6).
          03 REMIX-CHAR REDEFINES REMIX-SCODE.
             05 REMIX-SCODE-CHAR           PIC X(6).
       01 WS-STOREDC-CUSTOMER.
          03 WS-STOREDC-EYECATCHER           PIC X(4).
          03 WS-STOREDC-SORTCODE             PIC 9(6).
          03 WS-STOREDC-NUMBER               PIC 9(10).
          03 WS-STOREDC-NAME                 PIC X(60).
          03 WS-STOREDC-ADDRESS              PIC X(160).
          03 WS-STOREDC-DATE-OF-BIRTH        PIC X(10).
          03 WS-STOREDC-CREDIT-SCORE         PIC 9(3).
          03 WS-STOREDC-CS-REVIEW-DATE       PIC X(10).
       01 WS-NONE-LEFT                 PIC X VALUE 'N'.
       01 WS-EXIT-FETCH                PIC X VALUE 'N'.
       01 SQLCODE-DISPLAY              PIC S9(8) DISPLAY
                                         SIGN LEADING SEPARATE.
       01 DELACC-COMMAREA.
          03 DELACC-COMM-EYE           PIC X(4).
          03 DELACC-COMM-CUSTNO        PIC X(10).
          03 DELACC-COMM-SCODE         PIC X(6).
          03 DELACC-COMM-ACCNO         PIC 9(8).
          03 DELACC-COMM-ACC-TYPE      PIC X(8).
          03 DELACC-COMM-INT-RATE      PIC 9(4)V99.
          03 DELACC-COMM-OPENED        PIC 9(8).
          03 DELACC-COMM-OVERDRAFT     PIC 9(8).
          03 DELACC-COMM-LAST-STMT-DT  PIC 9(8).
          03 DELACC-COMM-NEXT-STMT-DT  PIC 9(8).
          03 DELACC-COMM-AVAIL-BAL     PIC S9(10)V99.
          03 DELACC-COMM-ACTUAL-BAL    PIC S9(10)V99.
          03 DELACC-COMM-SUCCESS       PIC X.
          03 DELACC-COMM-FAIL-CD       PIC X.
          03 DELACC-COMM-DEL-SUCCESS   PIC X.
          03 DELACC-COMM-DEL-FAIL-CD   PIC X.
          03 DELACC-COMM-APPLID        PIC X(8).
          03 DELACC-COMM-PCB1          POINTER.
          03 DELACC-COMM-PCB2          POINTER.
       01 WS-TOKEN                     PIC S9(8) BINARY.
       01 WS-INDEX                     PIC S9(8) BINARY.
       01 INQACCCU-PROGRAM         PIC X(8) VALUE 'INQACCCU'.
       01 INQACCCU-COMMAREA.
          03 NUMBER-OF-ACCOUNTS        PIC S9(8) BINARY.
          03 CUSTOMER-NUMBER           PIC 9(10).
          03 COMM-SUCCESS              PIC X.
          03 COMM-FAIL-CODE            PIC X.
          03 CUSTOMER-FOUND            PIC X.
          03 COMM-PCB-POINTER          POINTER.
          03 ACCOUNT-DETAILS OCCURS 1 TO 20 DEPENDING ON
              NUMBER-OF-ACCOUNTS.
            05 COMM-EYE                  PIC X(4).
            05 COMM-CUSTNO               PIC X(10).
            05 COMM-SCODE                PIC X(6).
            05 COMM-ACCNO                PIC 9(8).
            05 COMM-ACC-TYPE             PIC X(8).
            05 COMM-INT-RATE             PIC 9(4)V99.
            05 COMM-OPENED               PIC 9(8).
            05 COMM-OPENED-GROUP REDEFINES COMM-OPENED.
              07 COMM-OPENED-DAY PIC 99.
              07 COMM-OPENED-MONTH PIC 99.
              07 COMM-OPENED-YEAR PIC 9999.
            05 COMM-OVERDRAFT            PIC 9(8).
            05 COMM-LAST-STMT-DT         PIC 9(8).
            05 COMM-LAST-STMT-GROUP REDEFINES COMM-LAST-STMT-DT.
              07 COMM-LAST-STMT-DAY PIC 99.
              07 COMM-LAST-STMT-MONTH PIC 99.
              07 COMM-LAST-STMT-YEAR PIC 9999.
            05 COMM-NEXT-STMT-DT         PIC 9(8).
            05 COMM-NEXT-STMT-GROUP REDEFINES COMM-NEXT-STMT-DT.
              07 COMM-NEXT-STMT-DAY PIC 99.
              07 COMM-NEXT-STMT-MONTH PIC 99.
              07 COMM-NEXT-STMT-YEAR PIC 9999.
            05 COMM-AVAIL-BAL            PIC S9(10)V99.
            05 COMM-ACTUAL-BAL           PIC S9(10)V99.
       01 STORM-DRAIN-CONDITION       PIC X(20).
       01 INQCUST-PROGRAM          PIC X(8) VALUE 'INQCUST '.
       01 INQCUST-COMMAREA.
          03 INQCUST-EYE                  PIC X(4).
          03 INQCUST-SCODE                PIC X(6).
          03 INQCUST-CUSTNO               PIC 9(10).
          03 INQCUST-NAME                 PIC X(60).
          03 INQCUST-ADDR                 PIC X(160).
          03 INQCUST-DOB.
            05 INQCUST-DOB-DD             PIC 99.
            05 INQCUST-DOB-MM             PIC 99.
            05 INQCUST-DOB-YYYY           PIC 9999.
          03 INQCUST-CREDIT-SCORE         PIC 999.
          03 INQCUST-CS-REVIEW-DT.
            05 INQCUST-CS-REVIEW-DD       PIC 99.
            05 INQCUST-CS-REVIEW-MM       PIC 99.
            05 INQCUST-CS-REVIEW-YYYY     PIC 9999.
          03 INQCUST-INQ-SUCCESS          PIC X.
          03 INQCUST-INQ-FAIL-CD          PIC X.
          03 INQCUST-PCB-POINTER          POINTER.
       01 WS-TIME-DATA.
           03 WS-TIME-NOW                  PIC 9(6).
           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
              05 WS-TIME-NOW-GRP-HH     PIC 99.
              05 WS-TIME-NOW-GRP-MM     PIC 99.
              05 WS-TIME-NOW-GRP-SS     PIC 99.
       01 WS-ABEND-PGM                  PIC X(8) VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 COMM-EYE                  PIC X(4).
          03 COMM-SCODE                PIC X(6).
          03 COMM-CUSTNO               PIC X(10).
          03 COMM-NAME                 PIC X(60).
          03 COMM-ADDR                 PIC X(160).
          03 COMM-DOB                  PIC 9(8).
          03 COMM-DOB-GROUP REDEFINES COMM-DOB.
             05 COMM-BIRTH-DAY               PIC 99.
             05 COMM-BIRTH-MONTH             PIC 99.
             05 COMM-BIRTH-YEAR              PIC 9999.
          03 COMM-CREDIT-SCORE         PIC 9(3).
          03 COMM-CS-REVIEW-DATE       PIC 9(8).
          03 COMM-CS-REVIEW-GROUP REDEFINES COMM-CS-REVIEW-DATE.
             05 COMM-CS-REVIEW-DD            PIC 99.
             05 COMM-CS-REVIEW-MM            PIC 99.
             05 COMM-CS-REVIEW-YYYY          PIC 9999.
          03 COMM-DEL-SUCCESS          PIC X.
          03 COMM-DEL-FAIL-CD          PIC X.
","['PREMIERE', 'DELETE-ACCOUNTS', 'GET-ACCOUNTS', 'DEL-CUST-VSAM', 'WRITE-PROCTRAN-CUST', 'WRITE-PROCTRAN-CUST-DB2', 'GET-ME-OUT-OF-HERE', 'POPULATE-TIME-DATE', 'A010', 'A999', 'DA010', 'DA999', 'GAC010', 'GAC999', 'DCV010', 'DCV999', 'WPC010', 'WPC999', 'WPCD010', 'WPCD999', 'GMOFH010', 'GMOFH999', 'PTD010', 'PTD999']","Paragraph PREMIERE calls paragraph GET-ME-OUT-OF-HERE, DELETE-ACCOUNTS, GET-ACCOUNTS, DEL-CUST-VSAM.
Paragraph DEL-CUST-VSAM calls paragraph POPULATE-TIME-DATE, WRITE-PROCTRAN-CUST, DCV999.
Paragraph WRITE-PROCTRAN-CUST calls paragraph WRITE-PROCTRAN-CUST-DB2.
Paragraph WRITE-PROCTRAN-CUST-DB2 calls paragraph POPULATE-TIME-DATE.
",733,"This program takes an incoming customer number & retrieves the associated accounts for it and stores these in an array. Then it deletes the accounts one at a time and writes a PROCTRAN delete account record out for each deleted account. When all accounts have been deleted, it deletes the customer record (and writes out a customer delete record to PROCTRAN). If there is a failure at any time after we have started to delete things then abend (or else the records will be out of step). The only failure excluded from this, is where we go to delete an account and it had already been deleted (if this happens then we can just continue).","['WS-ABEND-PGM', 'INQACCCU', 'DELACC', 'INQCUST-PROGRAM']",,['CUSTOMER'],Error Long,1,1,1,"The COBOL program manages customer data by sorting it and deleting associated accounts. It starts with the PREMIERE section, retrieving accounts via GET-ACCOUNTS and deleting using DELETE-ACCOUNTS with the DELACC program. DEL-CUST-VSAM deletes a customer record, leveraging time-populating functionality from POPULATE-TIME-DATE, and writes updates to a DB2 database through WRITE-PROCTRAN-CUST, which invokes WRITE-PROCTRAN-CUST-DB2. The program handles successful and failed operations systematically, culminating in cleanup and termination actions in GET-ME-OUT-OF-HERE.",
132,cicsdev_cics-banking-sample-application-cbsa,cics-banking-sample-application-cbsa/src/base/cobol_src/BNKMENU.cbl,"       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)
       CBL CICS('SP,EDF')
       IDENTIFICATION DIVISION.
       PROGRAM-ID. BNKMENU.
       AUTHOR. Jon Collett.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.  IBM-370.
       OBJECT-COMPUTER.  IBM-370.
       INPUT-OUTPUT SECTION.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01 WS-CICS-WORK-AREA.
          03 WS-CICS-RESP              PIC S9(8) COMP VALUE 0.
          03 WS-CICS-RESP2             PIC S9(8) COMP VALUE 0.
       01 WS-FAIL-INFO.
          03 FILLER                    PIC X(9) VALUE 'BNKMENU  '.
          03 WS-CICS-FAIL-MSG          PIC X(70) VALUE ' '.
          03 FILLER                    PIC X(6)  VALUE ' RESP='.
          03 WS-CICS-RESP-DISP         PIC 9(10) VALUE 0.
          03 FILLER                    PIC X(7)  VALUE ' RESP2='.
          03 WS-CICS-RESP2-DISP        PIC 9(10) VALUE 0.
          03 FILLER                   PIC X(15) VALUE ' ABENDING TASK.'.
       01 SWITCHES.
           03 VALID-DATA-SW            PIC X VALUE 'Y'.
              88 VALID-DATA                VALUE 'Y'.
       01 FLAGS.
           03 SEND-FLAG                PIC X.
              88 SEND-ERASE              VALUE '1'.
              88 SEND-DATAONLY           VALUE '2'.
              88 SEND-DATAONLY-ALARM     VALUE '3'.
       01 ACTION-ALPHA.
           03 ACTION-CHAR              PIC X.
       01 END-OF-SESSION-MESSAGE       PIC X(13) VALUE 'Session Ended'.
       01 RESPONSE-CODE                PIC S9(8) COMP.
       01 COMMUNICATION-AREA           PIC X.
       01 WS-U-TIME                    PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                 PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD           PIC 99.
          03 FILLER                    PIC X.
          03 WS-ORIG-DATE-MM           PIC 99.
          03 FILLER                    PIC X.
          03 WS-ORIG-DATE-YYYY         PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-MM-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X       PIC X(4).
       01 WS-TIME-DATA.
           03 WS-TIME-NOW              PIC 9(6).
           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
              05 WS-TIME-NOW-GRP-HH       PIC 99.
              05 WS-TIME-NOW-GRP-MM       PIC 99.
              05 WS-TIME-NOW-GRP-SS       PIC 99.
       01 WS-ABEND-PGM                 PIC X(8) VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA                  PIC X.
       PROCEDURE DIVISION.
       PREMIERE SECTION.
       A010.
           EVALUATE TRUE
              WHEN EIBCALEN = ZERO
                 MOVE LOW-VALUE TO BNK1MEO
                 MOVE -1 TO ACTIONL
                 SET SEND-ERASE TO TRUE
                 PERFORM SEND-MAP
              WHEN EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
                 CONTINUE
              WHEN EIBAID = DFHPF3 OR DFHPF12
                 PERFORM SEND-TERMINATION-MSG
                 EXEC CICS
                    RETURN
                 END-EXEC
              WHEN EIBAID = DFHCLEAR
                EXEC CICS SEND CONTROL
                          ERASE
                          FREEKB
                END-EXEC
                EXEC CICS RETURN
                END-EXEC
              WHEN EIBAID = DFHENTER
                 PERFORM PROCESS-MENU-MAP
              WHEN OTHER
                 MOVE LOW-VALUES TO BNK1MEO
                 MOVE 'Invalid key pressed.' TO MESSAGEO
                 MOVE -1 TO ACTIONL
                 SET SEND-DATAONLY-ALARM TO TRUE
                 PERFORM SEND-MAP
           END-EVALUATE.
           EXEC CICS
              RETURN TRANSID('OMEN')
              COMMAREA(COMMUNICATION-AREA)
              LENGTH(1)
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'A010 - RETURN TRANSID(MENU) FAIL.'
                    DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNKMENU - A010 - RETURN TRANSID(MENU) FAIL' TO
                 WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM ABEND-THIS-TASK
           END-IF.
       A999.
           EXIT.
       PROCESS-MENU-MAP SECTION.
       PMM010.
           PERFORM RECEIVE-MENU-MAP.
           PERFORM EDIT-MENU-DATA.
           IF VALID-DATA
              PERFORM INVOKE-OTHER-TXNS
           END-IF.
           SET SEND-DATAONLY-ALARM TO TRUE.
           PERFORM SEND-MAP.
       PMM999.
           EXIT.
       RECEIVE-MENU-MAP SECTION.
       RMM010.
           EXEC CICS
              RECEIVE MAP('BNK1ME')
              MAPSET('BNK1MAI')
              INTO(BNK1MEI)
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              IF WS-CICS-RESP = DFHRESP(MAPFAIL)
                 MOVE LOW-VALUES TO BNK1MEO
                 MOVE -1 TO ACTIONL
                 SET SEND-ERASE TO TRUE
                 PERFORM SEND-MAP
              ELSE
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'RMM010  - RECEIVE MAP FAIL.'
                       DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNKMENU - RMM010 - RECEIVE MAP FAIL' TO
                    WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
           END-IF.
       RMM999.
           EXIT.
       EDIT-MENU-DATA SECTION.
       EMD010.
           IF ACTIONI NOT = '1' AND ACTIONI NOT = '2' AND
           ACTIONI NOT = '3' AND ACTIONI NOT = '4' AND
           ACTIONI NOT = '5' AND ACTIONI NOT = '6' AND
           ACTIONI NOT = '7' AND ACTIONI NOT = 'A'
              MOVE SPACES TO MESSAGEO
              MOVE 'You must enter a valid value (1-7 or A).' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
           ELSE
              MOVE ACTIONI TO ACTION-ALPHA
           END-IF.
       EMD999.
           EXIT.
       INVOKE-OTHER-TXNS SECTION.
       IOT010.
           IF ACTIONI = '1'
              EXEC CICS RETURN
                 TRANSID('ODCS')
                 IMMEDIATE
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                      ':' DELIMITED BY SIZE,
                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                       INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'IOT010 - RETURN TRANSID(ODCS) FAIL.'
                       DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                      ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNKMENU - IOT010 - RETURN TRANSID(ODCS) FAIL'
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
           END-IF.
           IF ACTIONI = '2'
              EXEC CICS RETURN
                 TRANSID('ODAC')
                 IMMEDIATE
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                  EXEC CICS ASSIGN APPLID(ABND-APPLID)
                  END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'IOT010 - RETURN TRANSID(ODAC) FAIL.'
                       DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNKMENU - IOT010 - RETURN TRANSID(ODAC) FAIL'
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
           END-IF.
           IF ACTIONI = '3'
              EXEC CICS RETURN
                 TRANSID('OCCS')
                 IMMEDIATE
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                  EXEC CICS ASSIGN APPLID(ABND-APPLID)
                  END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'IOT010 - RETURN TRANSID(OCCS) FAIL.'
                       DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNKMENU - IOT010 - RETURN TRANSID(OCCS) FAIL'
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
           END-IF.
           IF ACTIONI = '4'
              EXEC CICS RETURN
                 TRANSID('OCAC')
                 IMMEDIATE
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                  EXEC CICS ASSIGN APPLID(ABND-APPLID)
                  END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'IOT010 - RETURN TRANSID(OCAC) FAIL.'
                       DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNKMENU - IOT010 - RETURN TRANSID(OCAC) FAIL'
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
           END-IF.
           IF ACTIONI = '5'
              EXEC CICS RETURN
                 TRANSID('OUAC')
                 IMMEDIATE
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                  EXEC CICS ASSIGN APPLID(ABND-APPLID)
                  END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'IOT010 - RETURN TRANSID(OUAC) FAIL.'
                       DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNKMENU - IOT010 - RETURN TRANSID(OUAC) FAIL'
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
           END-IF.
           IF ACTIONI = '6'
              EXEC CICS RETURN
                 TRANSID('OCRA')
                 IMMEDIATE
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                  EXEC CICS ASSIGN APPLID(ABND-APPLID)
                  END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'IOT010 - RETURN TRANSID(OCRA) FAIL.'
                       DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNKMENU - IOT010 - RETURN TRANSID(OCRA) FAIL'
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
           END-IF.
           IF ACTIONI = '7'
              EXEC CICS RETURN
                 TRANSID('OTFN')
                 IMMEDIATE
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                  EXEC CICS ASSIGN APPLID(ABND-APPLID)
                  END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'IOT010 - RETURN TRANSID(OTFN) FAIL.'
                       DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNKMENU - IOT010 - RETURN TRANSID(OTFN) FAIL'
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
           END-IF.
           IF ACTIONI = 'A'
              EXEC CICS RETURN
                 TRANSID('OCCA')
                 IMMEDIATE
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                  EXEC CICS ASSIGN APPLID(ABND-APPLID)
                  END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'IOT010 - RETURN TRANSID(OCCA) FAIL.'
                       DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNKMENU - IOT010 - RETURN TRANSID(OCCA) FAIL'
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
           END-IF.
       IOT999.
           EXIT.
       SEND-MAP SECTION.
       SMM010.
           IF SEND-ERASE
              EXEC CICS SEND MAP('BNK1ME')
                 MAPSET('BNK1MAI')
                 FROM(BNK1MEO)
                 ERASE
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'SMM010 - SEND MAP ERASE FAIL.'
                       DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNKMENU - SMM010 - SEND MAP ERASE FAIL'
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
              GO TO SMM999
           END-IF.
           IF SEND-DATAONLY
              EXEC CICS SEND MAP('BNK1ME')
                 MAPSET('BNK1MAI')
                 FROM(BNK1MEO)
                 DATAONLY
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'SMM010 - SEND MAP DATAONLY FAIL.'
                       DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNKMENU - SMM010 - SEND MAP DATAONLY FAIL'
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
              GO TO SMM999
           END-IF.
           IF SEND-DATAONLY-ALARM
              EXEC CICS SEND MAP('BNK1ME')
                 MAPSET('BNK1MAI')
                 FROM(BNK1MEO)
                 DATAONLY
                 ALARM
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'SMM010 - SEND MAP DATAONLY ALARM FAIL.'
                       DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNKMENU - SMM010 - SEND MAP DATAONLY ALARM FAIL'
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
           END-IF.
       SMM999.
           EXIT.
       SEND-TERMINATION-MSG SECTION.
       STM010.
           EXEC CICS SEND TEXT
              FROM(END-OF-SESSION-MESSAGE)
              ERASE
              FREEKB
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'STM010 - SEND TEXT FAIL.'
                    DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNKMENU - STM010 - SEND TEXT FAIL'
                 TO WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM ABEND-THIS-TASK
           END-IF.
       STM999.
           EXIT.
       ABEND-THIS-TASK SECTION.
       ATT010.
           DISPLAY WS-FAIL-INFO.
           EXEC CICS ABEND
              ABCODE('HBNK')
              NODUMP
           END-EXEC.
       ATT999.
           EXIT.
       POPULATE-TIME-DATE SECTION.
       PTD010.
           EXEC CICS ASKTIME
              ABSTIME(WS-U-TIME)
           END-EXEC.
           EXEC CICS FORMATTIME
                     ABSTIME(WS-U-TIME)
                     DDMMYYYY(WS-ORIG-DATE)
                     TIME(WS-TIME-NOW)
                     DATESEP
           END-EXEC.
       PTD999.
           EXIT.
","       WORKING-STORAGE SECTION.
       01 WS-CICS-WORK-AREA.
          03 WS-CICS-RESP              PIC S9(8) COMP VALUE 0.
          03 WS-CICS-RESP2             PIC S9(8) COMP VALUE 0.
       01 WS-FAIL-INFO.
          03 FILLER                    PIC X(9) VALUE 'BNKMENU  '.
          03 WS-CICS-FAIL-MSG          PIC X(70) VALUE ' '.
          03 FILLER                    PIC X(6)  VALUE ' RESP='.
          03 WS-CICS-RESP-DISP         PIC 9(10) VALUE 0.
          03 FILLER                    PIC X(7)  VALUE ' RESP2='.
          03 WS-CICS-RESP2-DISP        PIC 9(10) VALUE 0.
          03 FILLER                   PIC X(15) VALUE ' ABENDING TASK.'.
       01 SWITCHES.
           03 VALID-DATA-SW            PIC X VALUE 'Y'.
              88 VALID-DATA                VALUE 'Y'.
       01 FLAGS.
           03 SEND-FLAG                PIC X.
              88 SEND-ERASE              VALUE '1'.
              88 SEND-DATAONLY           VALUE '2'.
              88 SEND-DATAONLY-ALARM     VALUE '3'.
       01 ACTION-ALPHA.
           03 ACTION-CHAR              PIC X.
       01 END-OF-SESSION-MESSAGE       PIC X(13) VALUE 'Session Ended'.
       01 RESPONSE-CODE                PIC S9(8) COMP.
       01 COMMUNICATION-AREA           PIC X.
       01 WS-U-TIME                    PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                 PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD           PIC 99.
          03 FILLER                    PIC X.
          03 WS-ORIG-DATE-MM           PIC 99.
          03 FILLER                    PIC X.
          03 WS-ORIG-DATE-YYYY         PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-MM-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X       PIC X(4).
       01 WS-TIME-DATA.
           03 WS-TIME-NOW              PIC 9(6).
           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
              05 WS-TIME-NOW-GRP-HH       PIC 99.
              05 WS-TIME-NOW-GRP-MM       PIC 99.
              05 WS-TIME-NOW-GRP-SS       PIC 99.
       01 WS-ABEND-PGM                 PIC X(8) VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA                  PIC X.
","['PREMIERE', 'PROCESS-MENU-MAP', 'RECEIVE-MENU-MAP', 'EDIT-MENU-DATA', 'INVOKE-OTHER-TXNS', 'SEND-MAP', 'SEND-TERMINATION-MSG', 'ABEND-THIS-TASK', 'POPULATE-TIME-DATE', 'A010', 'A999', 'PMM010', 'PMM999', 'RMM010', 'RMM999', 'EMD010', 'EMD999', 'IOT010', 'IOT999', 'SMM010', 'SMM999', 'STM010', 'STM999', 'ATT010', 'ATT999', 'PTD010', 'PTD999']","Paragraph PREMIERE calls paragraph PROCESS-MENU-MAP, SEND-MAP, SEND-TERMINATION-MSG, ABEND-THIS-TASK, POPULATE-TIME-DATE.
Paragraph PROCESS-MENU-MAP calls paragraph SEND-MAP, RECEIVE-MENU-MAP, EDIT-MENU-DATA, INVOKE-OTHER-TXNS.
Paragraph RECEIVE-MENU-MAP calls paragraph SEND-MAP, POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph INVOKE-OTHER-TXNS calls paragraph POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph SEND-MAP calls paragraph SMM999, POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph SEND-TERMINATION-MSG calls paragraph POPULATE-TIME-DATE, ABEND-THIS-TASK.
",857,"This is the BANK MENU (i.e. the first program initiated by the BMS suite). It displays the map and allows the user to select an option, validates the option number/letter and returns with the appropriate transaction.",['WS-ABEND-PGM'],,,Error Long,1,1,0.875,"The COBOL code is a menu processing program that interacts with the CICS system to manage user input and perform actions accordingly. It validates menu data, receives and edits menu maps, and invokes other transactions based on user choices. The program handles errors by sending termination messages and managing abend scenarios. Key operations include populating date and time, manipulating variable values, and ensuring successful data transmission, all while maintaining flow control through conditional logic and looping.",1
135,cicsdev_cics-banking-sample-application-cbsa,cics-banking-sample-application-cbsa/src/base/cobol_src/CREACC.cbl,"       CBL CICS('SP,EDF')
       CBL SQL
       IDENTIFICATION DIVISION.
       PROGRAM-ID. CREACC.
       AUTHOR. Jon Collett.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.  IBM-370.
       OBJECT-COMPUTER.  IBM-370.
       INPUT-OUTPUT SECTION.
       DATA DIVISION.
       FILE SECTION.
       WORKING-STORAGE SECTION.
       77 SORTCODE           PIC 9(6) VALUE 987654.
       77 SYSIDERR-RETRY PIC 999.
           EXEC SQL
              INCLUDE ACCDB2
           END-EXEC.
       01 HOST-ACCOUNT-ROW.
          03 HV-ACCOUNT-EYECATCHER          PIC X(4).
          03 HV-ACCOUNT-CUST-NO             PIC X(10).
          03 HV-ACCOUNT-SORTCODE            PIC X(6).
          03 HV-ACCOUNT-ACC-NO              PIC X(8).
          03 HV-ACCOUNT-ACC-TYPE            PIC X(8).
          03 HV-ACCOUNT-INT-RATE            PIC S9(4)V99 COMP-3.
          03 HV-ACCOUNT-OPENED              PIC X(10).
          03 HV-ACCOUNT-OPENED-GROUP REDEFINES HV-ACCOUNT-OPENED.
             05 HV-ACCOUNT-OPENED-DAY       PIC XX.
             05 HV-ACCOUNT-OPENED-DELIM1    PIC X.
             05 HV-ACCOUNT-OPENED-MONTH     PIC XX.
             05 HV-ACCOUNT-OPENED-DELIM2    PIC X.
             05 HV-ACCOUNT-OPENED-YEAR      PIC X(4).
          03 HV-ACCOUNT-OVERDRAFT-LIM       PIC S9(9) COMP.
          03 HV-ACCOUNT-LAST-STMT           PIC X(10).
          03 HV-ACCOUNT-LAST-STMT-GROUP
             REDEFINES HV-ACCOUNT-LAST-STMT.
             05 HV-ACCOUNT-LAST-STMT-DAY    PIC XX.
             05 HV-ACCOUNT-LAST-STMT-DELIM1 PIC X.
             05 HV-ACCOUNT-LAST-STMT-MONTH  PIC XX.
             05 HV-ACCOUNT-LAST-STMT-DELIM2 PIC X.
             05 HV-ACCOUNT-LAST-STMT-YEAR   PIC X(4).
          03 HV-ACCOUNT-NEXT-STMT           PIC X(10).
          03 HV-ACCOUNT-NEXT-STMT-GROUP
             REDEFINES HV-ACCOUNT-NEXT-STMT.
             05 HV-ACCOUNT-NEXT-STMT-DAY    PIC XX.
             05 HV-ACCOUNT-NEXT-STMT-DELIM1 PIC X.
             05 HV-ACCOUNT-NEXT-STMT-MONTH  PIC XX.
             05 HV-ACCOUNT-NEXT-STMT-DELIM2 PIC X.
             05 HV-ACCOUNT-NEXT-STMT-YEAR   PIC X(4).
          03 HV-ACCOUNT-AVAIL-BAL           PIC S9(10)V99 COMP-3.
          03 HV-ACCOUNT-ACTUAL-BAL          PIC S9(10)V99 COMP-3.
       01 SQLCODE-DISPLAY                   PIC S9(8) DISPLAY
           SIGN LEADING SEPARATE.
          EXEC SQL
             INCLUDE PROCDB2
          END-EXEC.
       01 HOST-PROCTRAN-ROW.
          03 HV-PROCTRAN-EYECATCHER         PIC X(4).
          03 HV-PROCTRAN-SORT-CODE          PIC X(6).
          03 HV-PROCTRAN-ACC-NUMBER         PIC X(8).
          03 HV-PROCTRAN-DATE               PIC X(10).
          03 HV-PROCTRAN-TIME               PIC X(6).
          03 HV-PROCTRAN-REF                PIC X(12).
          03 HV-PROCTRAN-TYPE               PIC X(3).
          03 HV-PROCTRAN-DESC               PIC X(40).
          03 HV-PROCTRAN-AMOUNT             PIC S9(10)V99 COMP-3.
       01 HOST-CONTROL-ROW.
           03 HV-CONTROL-NAME                  PIC X(32).
           03 HV-CONTROL-VALUE-NUM             PIC S9(9) COMP.
           03 HV-CONTROL-VALUE-STR             PIC X(40).
       EXEC SQL
          INCLUDE SQLCA
       END-EXEC.
       01 PROCTRAN-AREA.
           03 PROC-TRAN-DATA.
              05 PROC-TRAN-EYE-CATCHER        PIC X(4).
              88 PROC-TRAN-VALID VALUE 'PRTR'.
              05 PROC-TRAN-LOGICAL-DELETE-AREA REDEFINES
                 PROC-TRAN-EYE-CATCHER.
                 07 PROC-TRAN-LOGICAL-DELETE-FLAG PIC X.
                 88 PROC-TRAN-LOGICALLY-DELETED VALUE X'FF'.
                 07 FILLER PIC X(3).
              05 PROC-TRAN-ID.
                 07 PROC-TRAN-SORT-CODE       PIC 9(6).
                 07 PROC-TRAN-NUMBER          PIC 9(8).
              05 PROC-TRAN-DATE               PIC 9(8).
              05 PROC-TRAN-DATE-GRP REDEFINES PROC-TRAN-DATE.
                 07 PROC-TRAN-DATE-GRP-YYYY   PIC 9999.
                 07 PROC-TRAN-DATE-GRP-MM     PIC 99.
                 07 PROC-TRAN-DATE-GRP-DD     PIC 99.
              05 PROC-TRAN-TIME               PIC 9(6).
              05 PROC-TRAN-TIME-GRP REDEFINES PROC-TRAN-TIME.
                 07 PROC-TRAN-TIME-GRP-HH     PIC 99.
                 07 PROC-TRAN-TIME-GRP-MM     PIC 99.
                 07 PROC-TRAN-TIME-GRP-SS     PIC 99.
              05 PROC-TRAN-REF                PIC 9(12).
              05 PROC-TRAN-TYPE               PIC X(3).
              88 PROC-TY-CHEQUE-ACKNOWLEDGED      VALUE 'CHA'.
              88 PROC-TY-CHEQUE-FAILURE           VALUE 'CHF'.
              88 PROC-TY-CHEQUE-PAID-IN           VALUE 'CHI'.
              88 PROC-TY-CHEQUE-PAID-OUT          VALUE 'CHO'.
              88 PROC-TY-CREDIT                   VALUE 'CRE'.
              88 PROC-TY-DEBIT                    VALUE 'DEB'.
              88 PROC-TY-WEB-CREATE-ACCOUNT       VALUE 'ICA'.
              88 PROC-TY-WEB-CREATE-CUSTOMER      VALUE 'ICC'.
              88 PROC-TY-WEB-DELETE-ACCOUNT       VALUE 'IDA'.
              88 PROC-TY-WEB-DELETE-CUSTOMER      VALUE 'IDC'.
              88 PROC-TY-BRANCH-CREATE-ACCOUNT    VALUE 'OCA'.
              88 PROC-TY-BRANCH-CREATE-CUSTOMER   VALUE 'OCC'.
              88 PROC-TY-BRANCH-DELETE-ACCOUNT    VALUE 'ODA'.
              88 PROC-TY-BRANCH-DELETE-CUSTOMER   VALUE 'ODC'.
              88 PROC-TY-CREATE-SODD              VALUE 'OCS'.
              88 PROC-TY-PAYMENT-CREDIT           VALUE 'PCR'.
              88 PROC-TY-PAYMENT-DEBIT            VALUE 'PDR'.
              88 PROC-TY-TRANSFER                 VALUE 'TFR'.
              05 PROC-TRAN-DESC               PIC X(40).
              05 PROC-TRAN-DESC-XFR REDEFINES PROC-TRAN-DESC.
                07 PROC-TRAN-DESC-XFR-HEADER PIC X(26).
                88 PROC-TRAN-DESC-XFR-FLAG
                   VALUE 'TRANSFER'.
                07 PROC-TRAN-DESC-XFR-SORTCODE
                   PIC 9(6).
                07 PROC-TRAN-DESC-XFR-ACCOUNT
                   PIC 9(8).
              05 PROC-TRAN-DESC-DELACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELACC-ACCTYPE PIC X(8).
                07 PROC-DESC-DELACC-LAST-DD PIC 99.
                07 PROC-DESC-DELACC-LAST-MM PIC 99.
                07 PROC-DESC-DELACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-DELACC-NEXT-DD PIC 99.
                07 PROC-DESC-DELACC-NEXT-MM PIC 99.
                07 PROC-DESC-DELACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-DELACC-FOOTER PIC X(6).
                88 PROC-DESC-DELACC-FLAG
                   VALUE 'DELETE'.
              05 PROC-TRAN-DESC-CREACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CREACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-CREACC-ACCTYPE PIC X(8).
                07 PROC-DESC-CREACC-LAST-DD PIC 99.
                07 PROC-DESC-CREACC-LAST-MM PIC 99.
                07 PROC-DESC-CREACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-CREACC-NEXT-DD PIC 99.
                07 PROC-DESC-CREACC-NEXT-MM PIC 99.
                07 PROC-DESC-CREACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-CREACC-FOOTER PIC X(6).
                88 PROC-DESC-CREACC-FLAG
                   VALUE 'CREATE'.
              05 PROC-TRAN-DESC-DELCUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELCUS-SORTCODE PIC 9(6).
                07 PROC-DESC-DELCUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELCUS-NAME     PIC X(14).
                07 PROC-DESC-DELCUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-DELCUS-FILLER    PIC X.
                88 PROC-DESC-DELCUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-MM    PIC 99.
                07 PROC-DESC-DELCUS-FILLER2   PIC X.
                88 PROC-DESC-DELCUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-DD    PIC 99.
              05 PROC-TRAN-DESC-CRECUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CRECUS-SORTCODE PIC 9(6).
                07 PROC-DESC-CRECUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-CRECUS-NAME     PIC X(14).
                07 PROC-DESC-CRECUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-CRECUS-FILLER    PIC X.
                88 PROC-DESC-CRECUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-MM    PIC 99.
                07 PROC-DESC-CRECUS-FILLER2   PIC X.
                88 PROC-DESC-CRECUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-DD    PIC 99.
              05 PROC-TRAN-AMOUNT             PIC S9(10)V99.
       01 PROCTRAN-RIDFLD                   PIC S9(8) COMP.
       01 PROCTRAN-RETRY                    PIC 999.
       01 WS-EXIT-RETRY-LOOP                PIC X VALUE ' '.
       01 WS-CICS-WORK-AREA.
          05 WS-CICS-RESP                   PIC S9(8) COMP.
          05 WS-CICS-RESP2                  PIC S9(8) COMP.
          05 WS-EIBRESP-DISPLAY             PIC S9(8) DISPLAY
                                               SIGN LEADING SEPARATE.
       01 WS-CUSTOMER-NO-NUM                PIC 9(10).
       LOCAL-STORAGE SECTION.
       01 FILE-RETRY                        PIC 999.
       01 OUTPUT-DATA.
              03 ACCOUNT-DATA.
                 05 ACCOUNT-EYE-CATCHER        PIC X(4).
                 88 ACCOUNT-EYECATCHER-VALUE        VALUE 'ACCT'.
                 05 ACCOUNT-CUST-NO            PIC 9(10).
                 05 ACCOUNT-KEY.
                    07 ACCOUNT-SORT-CODE       PIC 9(6).
                    07 ACCOUNT-NUMBER          PIC 9(8).
                 05 ACCOUNT-TYPE               PIC X(8).
                 05 ACCOUNT-INTEREST-RATE      PIC 9(4)V99.
                 05 ACCOUNT-OPENED             PIC 9(8).
                 05 ACCOUNT-OPENED-GROUP REDEFINES ACCOUNT-OPENED.
                    07 ACCOUNT-OPENED-DAY       PIC 99.
                    07 ACCOUNT-OPENED-MONTH     PIC 99.
                    07 ACCOUNT-OPENED-YEAR      PIC 9999.
                 05 ACCOUNT-OVERDRAFT-LIMIT    PIC 9(8).
                 05 ACCOUNT-LAST-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-LAST-STMT-GROUP
                    REDEFINES ACCOUNT-LAST-STMT-DATE.
                    07 ACCOUNT-LAST-STMT-DAY   PIC 99.
                    07 ACCOUNT-LAST-STMT-MONTH PIC 99.
                    07 ACCOUNT-LAST-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-NEXT-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-NEXT-STMT-GROUP
                   REDEFINES ACCOUNT-NEXT-STMT-DATE.
                    07 ACCOUNT-NEXT-STMT-DAY   PIC 99.
                    07 ACCOUNT-NEXT-STMT-MONTH PIC 99.
                    07 ACCOUNT-NEXT-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-AVAILABLE-BALANCE  PIC S9(10)V99.
                 05 ACCOUNT-ACTUAL-BALANCE     PIC S9(10)V99.
       01 OUTPUTC-DATA.
           03 CUSTOMER-RECORD.
              05 CUSTOMER-EYECATCHER                 PIC X(4).
                 88 CUSTOMER-EYECATCHER-VALUE        VALUE 'CUST'.
              05 CUSTOMER-KEY.
                 07 CUSTOMER-SORTCODE                PIC 9(6) DISPLAY.
                 07 CUSTOMER-NUMBER                  PIC 9(10) DISPLAY.
              05 CUSTOMER-NAME                       PIC X(60).
              05 CUSTOMER-ADDRESS                    PIC X(160).
              05 CUSTOMER-DATE-OF-BIRTH              PIC 9(8).
              05 CUSTOMER-DOB-GROUP REDEFINES CUSTOMER-DATE-OF-BIRTH.
                 07 CUSTOMER-BIRTH-DAY               PIC 99.
                 07 CUSTOMER-BIRTH-MONTH             PIC 99.
                 07 CUSTOMER-BIRTH-YEAR              PIC 9999.
              05 CUSTOMER-CREDIT-SCORE               PIC 999.
              05 CUSTOMER-CS-REVIEW-DATE             PIC 9(8).
              05 CUSTOMER-CS-GROUP
                 REDEFINES CUSTOMER-CS-REVIEW-DATE.
                 07 CUSTOMER-CS-REVIEW-DAY           PIC 99.
                 07 CUSTOMER-CS-REVIEW-MONTH         PIC 99.
                 07 CUSTOMER-CS-REVIEW-YEAR          PIC 9999.
       01 RETURN-DATA.
          03 RETURN-DATA-EYECATCHER         PIC X(4).
          03 RETURN-DATA-NUMBER             PIC 9(10) DISPLAY.
          03 RETURN-DATA-NAME               PIC X(60).
          03 RETURN-DATA-ADDRESS            PIC X(160).
          03 RETURN-DATA-DATE-OF-BIRTH      PIC 9(8).
       01 CUSTOMER-KY.
          03 REQUIRED-SORT-CODE             PIC 9(6) VALUE 0.
          03 REQUIRED-CUST-NUMBER           PIC 9(10) VALUE 0.
       01 ACCOUNT-KY.
          03 REQUIRED-SORT-CODE2            PIC 9(6) VALUE 0.
          03 REQUIRED-ACC-NUMBER            PIC 9(8) VALUE 0.
       01 RANDOM-CUSTOMER                   PIC 9(10) VALUE 0.
       01 HIGHEST-CUST-NUMBER               PIC 9(10) VALUE 0.
       01 EXIT-VSAM-READ                    PIC X VALUE 'N'.
       01 EXIT-DB2-READ                     PIC X VALUE 'N'.
       01 WS-V-RETRIED                      PIC X VALUE 'N'.
       01 WS-D-RETRIED                      PIC X VALUE 'N'.
       01 WS-ERROR                          PIC X(40) VALUE ALL '#'.
       01 NCS-ACC-NO-STUFF.
          03 NCS-ACC-NO-NAME.
             05 NCS-ACC-NO-ACT-NAME         PIC X(8)
                                 VALUE 'CBSAACCT'.
             05 NCS-ACC-NO-TEST-SORT        PIC X(6)
                                 VALUE '      '.
             05 NCS-ACC-NO-FILL             PIC XX
                                 VALUE '  '.
          03 NCS-ACC-NO-INC                 PIC 9(16) COMP
                                 VALUE 0.
          03 NCS-ACC-NO-VALUE               PIC 9(16) COMP
                                 VALUE 0.
          03 NCS-ACC-NO-RESP                PIC XX VALUE '00'.
       01 WS-DISP-CUST-NO-VAL               PIC S9(18) DISPLAY.
       01 WS-ACC-REC-LEN                    PIC S9(4) COMP VALUE 0.
       01 NCS-UPDATED                       PIC X VALUE 'N'.
       01 WS-U-TIME                         PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                      PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD                PIC 99.
          03 FILLER                         PIC X.
          03 WS-ORIG-DATE-MM                PIC 99.
          03 FILLER                         PIC X.
          03 WS-ORIG-DATE-YYYY              PIC 9999.
       01 DONT-CARE                         PIC 9(8) BINARY.
       01 LEAP-YEAR                         PIC 9(8) BINARY.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X              PIC XX.
          03 FILLER                         PIC X VALUE '.'.
          03 WS-ORIG-DATE-MM-X              PIC XX.
          03 FILLER                         PIC X VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X            PIC X(4).
       01 WS-STDT-X                         PIC X(8).
       01 WS-STDT-9  REDEFINES WS-STDT-X.
          03 WS-STDT-9-NUM                  PIC 9(8).
       01 WS-STDT-9-NUMERIC                 PIC 9(8).
       01 WS-INTEGER                        PIC S9(9) COMP VALUE 0.
       01 WS-FUTURE-DATE                    PIC 9(8).
       01 WS-FUT REDEFINES WS-FUTURE-DATE.
          03 WS-FUTURE-YY                   PIC 9(4).
          03 WS-FUTURE-MM                   PIC 99.
          03 WS-FUTURE-DD                   PIC 99.
       01 WS-FUTURE-CONV.
          03 WS-FUT-9                       PIC 9(8).
          03 WS-FUT-X REDEFINES WS-FUT-9.
             05 WS-FUT-X-YY                 PIC X(4).
             05 WS-FUT-X-MM                 PIC XX.
             05 WS-FUT-X-DD                 PIC XX.
       01 NCS-ACC-NO-DISP                   PIC 9(16) VALUE 0.
       01 STORED-SORTCODE                   PIC X(6)  VALUE SPACES.
       01 STORED-CUSTNO                     PIC X(10) VALUE SPACES.
       01 STORED-ACCTYPE                    PIC X(8)  VALUE SPACES.
       01 STORED-LST-STMT                   PIC X(8)  VALUE SPACES.
       01 STORED-NXT-STMT                   PIC X(8)  VALUE SPACES.
       01 STORED-ACCNO                      PIC X(8)  VALUE SPACES.
       01 WS-EIBTASKN12                     PIC 9(12) VALUE 0.
       01 ACCOUNT-KY3.
          03 REQUIRED-SORT-CODE3            PIC 9(6) VALUE 0.
          03 REQUIRED-ACCT-NUMBER3          PIC 9(8) VALUE 0.
       01 ACCOUNT-KY3-BYTES REDEFINES ACCOUNT-KY3 PIC X(14).
       01 INQCUST-COMMAREA.
          03 INQCUST-EYE                  PIC X(4).
          03 INQCUST-SCODE                PIC X(6).
          03 INQCUST-CUSTNO               PIC 9(10).
          03 INQCUST-NAME                 PIC X(60).
          03 INQCUST-ADDR                 PIC X(160).
          03 INQCUST-DOB.
            05 INQCUST-DOB-DD             PIC 99.
            05 INQCUST-DOB-MM             PIC 99.
            05 INQCUST-DOB-YYYY           PIC 9999.
          03 INQCUST-CREDIT-SCORE         PIC 999.
          03 INQCUST-CS-REVIEW-DT.
            05 INQCUST-CS-REVIEW-DD       PIC 99.
            05 INQCUST-CS-REVIEW-MM       PIC 99.
            05 INQCUST-CS-REVIEW-YYYY     PIC 9999.
          03 INQCUST-INQ-SUCCESS          PIC X.
          03 INQCUST-INQ-FAIL-CD          PIC X.
          03 INQCUST-PCB-POINTER          POINTER.
       01 INQACCCU-COMMAREA.
          03 NUMBER-OF-ACCOUNTS        PIC S9(8) BINARY.
          03 CUSTOMER-NUMBER           PIC 9(10).
          03 COMM-SUCCESS              PIC X.
          03 COMM-FAIL-CODE            PIC X.
          03 CUSTOMER-FOUND            PIC X.
          03 COMM-PCB-POINTER          POINTER.
          03 ACCOUNT-DETAILS OCCURS 1 TO 20 DEPENDING ON
              NUMBER-OF-ACCOUNTS
            05 COMM-EYE                  PIC X(4).
            05 COMM-CUSTNO               PIC X(10).
            05 COMM-SCODE                PIC X(6).
            05 COMM-ACCNO                PIC 9(8).
            05 COMM-ACC-TYPE             PIC X(8).
            05 COMM-INT-RATE             PIC 9(4)V99.
            05 COMM-OPENED               PIC 9(8).
            05 COMM-OPENED-GROUP REDEFINES COMM-OPENED.
              07 COMM-OPENED-DAY PIC 99.
              07 COMM-OPENED-MONTH PIC 99.
              07 COMM-OPENED-YEAR PIC 9999.
            05 COMM-OVERDRAFT            PIC 9(8).
            05 COMM-LAST-STMT-DT         PIC 9(8).
            05 COMM-LAST-STMT-GROUP REDEFINES COMM-LAST-STMT-DT.
              07 COMM-LAST-STMT-DAY PIC 99.
              07 COMM-LAST-STMT-MONTH PIC 99.
              07 COMM-LAST-STMT-YEAR PIC 9999.
            05 COMM-NEXT-STMT-DT         PIC 9(8).
            05 COMM-NEXT-STMT-GROUP REDEFINES COMM-NEXT-STMT-DT.
              07 COMM-NEXT-STMT-DAY PIC 99.
              07 COMM-NEXT-STMT-MONTH PIC 99.
              07 COMM-NEXT-STMT-YEAR PIC 9999.
            05 COMM-AVAIL-BAL            PIC S9(10)V99.
            05 COMM-ACTUAL-BAL           PIC S9(10)V99.
           BY ==NUMBER-OF-ACCOUNTS IN INQACCCU-COMMAREA.==.
       01 STORM-DRAIN-CONDITION             PIC X(20).
       01 ACCOUNT-CONTROL.
              03 ACCOUNT-CONTROL-RECORD.
                 05 ACCOUNT-CONTROL-EYE-CATCHER        PIC X(4).
                 88 ACCOUNT-CONTROL-EYECATCHER-V   VALUE 'CTRL'.
                 05 FILLER                     PIC 9(10).
                 05 ACCOUNT-CONTROL-KEY.
                    07 ACCOUNT-CONTROL-SORT-CODE       PIC 9(6).
                    07 ACCOUNT-CONTROL-NUMBER          PIC 9(8).
                 05 NUMBER-OF-ACCOUNTS                 PIC 9(8).
                 05 LAST-ACCOUNT-NUMBER                PIC 9(8).
                 05 ACCOUNT-CONTROL-SUCCESS-FLAG       PIC X.
                 88 ACCOUNT-CONTROL-SUCCESS VALUE 'Y'.
                 05 ACCOUNT-CONTROL-FAIL-CODE PIC X.
                 05 FILLER                     PIC 9(4)V99.
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC S9(10)V99.
                 05 FILLER                     PIC X(2).
       01 WS-TIME-DATA.
           03 WS-TIME-NOW                   PIC 9(6).
           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
              05 WS-TIME-NOW-GRP-HH         PIC 99.
              05 WS-TIME-NOW-GRP-MM         PIC 99.
              05 WS-TIME-NOW-GRP-SS         PIC 99.
       01 WS-ABEND-PGM                      PIC X(8) VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 COMM-EYECATCHER                 PIC X(4).
          03 COMM-CUSTNO                     PIC 9(10).
          03 COMM-KEY.
             05 COMM-SORTCODE                PIC 9(6) DISPLAY.
             05 COMM-NUMBER                  PIC 9(8) DISPLAY.
          03 COMM-ACC-TYPE                   PIC X(8).
          03 COMM-INT-RT                     PIC 9(4)V99.
          03 COMM-OPENED                     PIC 9(8).
          03 COMM-OPENED-GROUP REDEFINES COMM-OPENED.
             05 COMM-OPENED-DAY              PIC 99.
             05 COMM-OPENED-MONTH            PIC 99.
             05 COMM-OPENED-YEAR             PIC 9999.
          03 COMM-OVERDR-LIM                 PIC 9(8).
          03 COMM-LAST-STMT-DT               PIC 9(8).
          03 COMM-LAST-STMNT-GROUP REDEFINES COMM-LAST-STMT-DT.
             05 COMM-LASTST-DAY               PIC 99.
             05 COMM-LASTST-MONTH             PIC 99.
             05 COMM-LASTST-YEAR              PIC 9999.
          03 COMM-NEXT-STMT-DT               PIC 9(8).
          03 COMM-NEXT-STMNT-GROUP REDEFINES COMM-NEXT-STMT-DT.
             05 COMM-NEXTST-DAY               PIC 99.
             05 COMM-NEXTST-MONTH             PIC 99.
             05 COMM-NEXTST-YEAR              PIC 9999.
          03 COMM-AVAIL-BAL                  PIC S9(10)V99.
          03 COMM-ACT-BAL                    PIC S9(10)V99.
          03 COMM-SUCCESS                    PIC X.
          03 COMM-FAIL-CODE                  PIC X.
       PROCEDURE DIVISION USING DFHCOMMAREA.
       PREMIERE SECTION.
       P010.
           MOVE SORTCODE TO
              REQUIRED-SORT-CODE
              REQUIRED-SORT-CODE2.
           MOVE ZERO TO ACCOUNT-NUMBER.
           INITIALIZE INQCUST-COMMAREA
           MOVE COMM-CUSTNO IN DFHCOMMAREA TO INQCUST-CUSTNO.
           EXEC CICS LINK PROGRAM('INQCUST ')
                     COMMAREA(INQCUST-COMMAREA)
                     RESP(WS-CICS-RESP)
           END-EXEC.
           IF EIBRESP IS NOT EQUAL TO DFHRESP(NORMAL)
           OR INQCUST-INQ-SUCCESS IS NOT EQUAL TO 'Y'
             MOVE 'N' TO COMM-SUCCESS IN DFHCOMMAREA
             MOVE '1' TO COMM-FAIL-CODE IN DFHCOMMAREA
             PERFORM GET-ME-OUT-OF-HERE
           END-IF
           PERFORM CUSTOMER-ACCOUNT-COUNT.
           IF WS-CICS-RESP IS NOT EQUAL TO DFHRESP(NORMAL)
             DISPLAY 'Error counting accounts'
             MOVE 'N' to COMM-SUCCESS IN DFHCOMMAREA
             MOVE 'N' to COMM-SUCCESS IN INQACCCU-COMMAREA
             MOVE '9' TO COMM-FAIL-CODE IN DFHCOMMAREA
             PERFORM GET-ME-OUT-OF-HERE
           END-IF
           IF COMM-SUCCESS IN INQACCCU-COMMAREA = 'N'
             DISPLAY 'Error counting accounts'
             MOVE 'N' to COMM-SUCCESS IN DFHCOMMAREA
             MOVE '9' TO COMM-FAIL-CODE IN DFHCOMMAREA
             PERFORM GET-ME-OUT-OF-HERE
           END-IF
           IF NUMBER-OF-ACCOUNTS IN INQACCCU-COMMAREA > 9
             MOVE 'N' TO COMM-SUCCESS IN DFHCOMMAREA
             MOVE '8' TO COMM-FAIL-CODE IN DFHCOMMAREA
             PERFORM GET-ME-OUT-OF-HERE
           END-IF
           PERFORM ACCOUNT-TYPE-CHECK
           IF COMM-SUCCESS OF DFHCOMMAREA = 'N'
             PERFORM GET-ME-OUT-OF-HERE
           END-IF
           PERFORM ENQ-NAMED-COUNTER.
           PERFORM FIND-NEXT-ACCOUNT.
           PERFORM WRITE-ACCOUNT-DB2
           PERFORM GET-ME-OUT-OF-HERE.
       P999.
           EXIT.
       ENQ-NAMED-COUNTER SECTION.
       ENC010.
           MOVE SORTCODE TO NCS-ACC-NO-TEST-SORT.
           EXEC CICS ENQ
              RESOURCE(NCS-ACC-NO-NAME)
              LENGTH(16)
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
             MOVE 'N' TO COMM-SUCCESS IN DFHCOMMAREA
             MOVE '3' TO COMM-FAIL-CODE IN DFHCOMMAREA
             PERFORM GET-ME-OUT-OF-HERE
           END-IF.
       ENC999.
           EXIT.
       DEQ-NAMED-COUNTER SECTION.
       DNC010.
           MOVE SORTCODE TO NCS-ACC-NO-TEST-SORT.
           EXEC CICS DEQ
              RESOURCE(NCS-ACC-NO-NAME)
              LENGTH(16)
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
             MOVE 'N' TO COMM-SUCCESS IN DFHCOMMAREA
             MOVE '5' TO COMM-FAIL-CODE IN DFHCOMMAREA
             PERFORM GET-ME-OUT-OF-HERE
           END-IF.
       DNC999.
           EXIT.
       FIND-NEXT-ACCOUNT SECTION.
       FNA010.
           MOVE 1 TO NCS-ACC-NO-INC.
           INITIALIZE OUTPUT-DATA.
           MOVE SPACES TO HV-CONTROL-NAME
           MOVE ZERO TO HV-CONTROL-VALUE-NUM
           MOVE SPACES TO HV-CONTROL-VALUE-STR
           STRING REQUIRED-SORT-CODE DELIMITED BY SIZE
           '-' DELIMITED BY SIZE
           'ACCOUNT-LAST' DELIMITED BY SIZE
           INTO HV-CONTROL-NAME
           EXEC SQL
              SELECT CONTROL_NAME,
                       CONTROL_VALUE_NUM,
                       CONTROL_VALUE_STR
              INTO :HV-CONTROL-NAME,
                      :HV-CONTROL-VALUE-NUM,
                      :HV-CONTROL-VALUE-STR
              FROM CONTROL
              WHERE CONTROL_NAME = :HV-CONTROL-NAME
           END-EXEC.
           IF SQLCODE IS NOT EQUAL TO ZERO
             MOVE SQLCODE TO SQLCODE-DISPLAY
             INITIALIZE ABNDINFO-REC
             MOVE EIBRESP    TO ABND-RESPCODE
             MOVE EIBRESP2   TO ABND-RESP2CODE
             EXEC CICS ASSIGN APPLID(ABND-APPLID)
             END-EXEC
             MOVE EIBTASKN   TO ABND-TASKNO-KEY
             MOVE EIBTRNID   TO ABND-TRANID
             PERFORM POPULATE-TIME-DATE2
             MOVE WS-ORIG-DATE TO ABND-DATE
             STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
             END-STRING
             MOVE WS-U-TIME   TO ABND-UTIME-KEY
             MOVE 'HNCS'      TO ABND-CODE
             EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
             END-EXEC
             MOVE SQLCODE-DISPLAY    TO ABND-SQLCODE
             STRING 'FNAND010 - ACCOUNT NCS '
                    DELIMITED BY SIZE,
                    NCS-ACC-NO-NAME DELIMITED BY SIZE,
                    ' Cannot be accessed and DB2 SELECT failed.'
                    DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
             END-STRING
             EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
             END-EXEC
             DISPLAY 'CREACC - ACCOUNT NCS ' NCS-ACC-NO-NAME
                ' CANNOT BE ACCESSED AND DB2 SELECT FAILED. SQLCODE='
                SQLCODE-DISPLAY
             EXEC CICS ABEND
                       ABCODE('HNCS')
                       NODUMP
             END-EXEC
           ELSE
             ADD 1 TO HV-CONTROL-VALUE-NUM GIVING
             COMM-NUMBER ACCOUNT-NUMBER REQUIRED-ACCT-NUMBER3
             NCS-ACC-NO-VALUE HV-CONTROL-VALUE-NUM
             EXEC SQL
               UPDATE CONTROL
               SET CONTROL_VALUE_NUM = :HV-CONTROL-VALUE-NUM
               WHERE (CONTROL_NAME = :HV-CONTROL-NAME)
             END-EXEC
             IF SQLCODE IS NOT EQUAL TO ZERO
               MOVE SQLCODE TO SQLCODE-DISPLAY
               INITIALIZE ABNDINFO-REC
               MOVE EIBRESP    TO ABND-RESPCODE
               MOVE EIBRESP2   TO ABND-RESP2CODE
               EXEC CICS ASSIGN APPLID(ABND-APPLID)
               END-EXEC
               MOVE EIBTASKN   TO ABND-TASKNO-KEY
               MOVE EIBTRNID   TO ABND-TRANID
               PERFORM POPULATE-TIME-DATE2
               MOVE WS-ORIG-DATE TO ABND-DATE
               STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
               END-STRING
               MOVE WS-U-TIME   TO ABND-UTIME-KEY
               MOVE 'HNCS'      TO ABND-CODE
               EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
               END-EXEC
               MOVE SQLCODE-DISPLAY    TO ABND-SQLCODE
               STRING 'FNAND010(2) - ACCOUNT NCS '
                    DELIMITED BY SIZE,
                    NCS-ACC-NO-NAME DELIMITED BY SIZE,
                    ' Cannot be accessed and DB2 UPDATE failed.'
                    DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
               END-STRING
               EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
               END-EXEC
               DISPLAY 'CREACC - ACCOUNT NCS ' NCS-ACC-NO-NAME
                  ' CANNOT BE ACCESSED AND DB2 UPDATE FAILED. SQLCODE='
                SQLCODE-DISPLAY
               EXEC CICS ABEND
                         ABCODE('HNCS')
                         NODUMP
               END-EXEC
             END-IF
           END-IF
           MOVE NCS-ACC-NO-VALUE TO
           COMM-NUMBER ACCOUNT-NUMBER REQUIRED-ACCT-NUMBER3.
           MOVE SPACES TO HV-CONTROL-NAME
           MOVE ZERO TO HV-CONTROL-VALUE-NUM
           MOVE SPACES TO HV-CONTROL-VALUE-STR
           STRING SORTCODE DELIMITED BY SIZE
           '-' DELIMITED BY SIZE
           'ACCOUNT-COUNT' DELIMITED BY SIZE
           INTO HV-CONTROL-NAME
           EXEC SQL
              SELECT CONTROL_NAME,
                       CONTROL_VALUE_NUM,
                       CONTROL_VALUE_STR
              INTO :HV-CONTROL-NAME,
                      :HV-CONTROL-VALUE-NUM,
                      :HV-CONTROL-VALUE-STR
              FROM CONTROL
              WHERE CONTROL_NAME = :HV-CONTROL-NAME
           END-EXEC.
           IF SQLCODE IS NOT EQUAL TO ZERO
             MOVE SQLCODE TO SQLCODE-DISPLAY
             INITIALIZE ABNDINFO-REC
             MOVE EIBRESP    TO ABND-RESPCODE
             MOVE EIBRESP2   TO ABND-RESP2CODE
             EXEC CICS ASSIGN APPLID(ABND-APPLID)
             END-EXEC
             MOVE EIBTASKN   TO ABND-TASKNO-KEY
             MOVE EIBTRNID   TO ABND-TRANID
             PERFORM POPULATE-TIME-DATE2
             MOVE WS-ORIG-DATE TO ABND-DATE
             STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
             END-STRING
             MOVE WS-U-TIME   TO ABND-UTIME-KEY
             MOVE 'HNCS'      TO ABND-CODE
             EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
             END-EXEC
             MOVE SQLCODE-DISPLAY    TO ABND-SQLCODE
             STRING 'FNAND010(3) - ACCOUNT NCS '
                    DELIMITED BY SIZE,
                    NCS-ACC-NO-NAME DELIMITED BY SIZE,
                    ' Cannot be accessed and DB2 SELECT failed.'
                    DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
             END-STRING
             EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
             END-EXEC
             DISPLAY 'CREACC - ACCOUNT NCS ' NCS-ACC-NO-NAME
                ' CANNOT BE ACCESSED AND DB2 SELECT FAILED. SQLCODE='
                SQLCODE-DISPLAY
             EXEC CICS ABEND
                       ABCODE('HNCS')
                       NODUMP
             END-EXEC
           ELSE
             ADD 1 TO HV-CONTROL-VALUE-NUM GIVING
             HV-CONTROL-VALUE-NUM
             EXEC SQL
               UPDATE CONTROL
               SET CONTROL_VALUE_NUM = :HV-CONTROL-VALUE-NUM
               WHERE (CONTROL_NAME = :HV-CONTROL-NAME)
             END-EXEC
             IF SQLCODE IS NOT EQUAL TO ZERO
               MOVE SQLCODE TO SQLCODE-DISPLAY
               INITIALIZE ABNDINFO-REC
               MOVE EIBRESP    TO ABND-RESPCODE
               MOVE EIBRESP2   TO ABND-RESP2CODE
               EXEC CICS ASSIGN APPLID(ABND-APPLID)
               END-EXEC
               MOVE EIBTASKN   TO ABND-TASKNO-KEY
               MOVE EIBTRNID   TO ABND-TRANID
               PERFORM POPULATE-TIME-DATE2
               MOVE WS-ORIG-DATE TO ABND-DATE
               STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
               END-STRING
               MOVE WS-U-TIME   TO ABND-UTIME-KEY
               MOVE 'HNCS'      TO ABND-CODE
               EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
               END-EXEC
               MOVE SQLCODE-DISPLAY    TO ABND-SQLCODE
               STRING 'FNAND010(4) - ACCOUNT NCS '
                    DELIMITED BY SIZE,
                    NCS-ACC-NO-NAME DELIMITED BY SIZE,
                    ' Cannot be accessed and DB2 UPDATE failed.'
                    DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
               END-STRING
               EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
               END-EXEC
               DISPLAY 'CREACC - ACCOUNT NCS ' NCS-ACC-NO-NAME
                  ' CANNOT BE ACCESSED AND DB2 UPDATE FAILED. SQLCODE='
                SQLCODE-DISPLAY
               EXEC CICS ABEND
                         ABCODE('HNCS')
                         NODUMP
               END-EXEC
             END-IF
           END-IF.
       FNA999.
           EXIT.
       WRITE-ACCOUNT-DB2 SECTION.
       WAD010.
           INITIALIZE HOST-ACCOUNT-ROW.
           MOVE 'ACCT' TO HV-ACCOUNT-EYECATCHER.
           MOVE COMM-CUSTNO IN DFHCOMMAREA  TO HV-ACCOUNT-CUST-NO.
           MOVE SORTCODE  TO HV-ACCOUNT-SORTCODE.
           MOVE NCS-ACC-NO-VALUE TO NCS-ACC-NO-DISP.
           MOVE NCS-ACC-NO-DISP(9:8) TO HV-ACCOUNT-ACC-NO.
           MOVE COMM-ACC-TYPE IN DFHCOMMAREA    TO HV-ACCOUNT-ACC-TYPE.
           MOVE COMM-INT-RT      TO HV-ACCOUNT-INT-RATE.
           MOVE COMM-OVERDR-LIM  TO HV-ACCOUNT-OVERDRAFT-LIM.
           MOVE COMM-AVAIL-BAL IN DFHCOMMAREA   TO HV-ACCOUNT-AVAIL-BAL.
           MOVE COMM-ACT-BAL     TO HV-ACCOUNT-ACTUAL-BAL.
           PERFORM CALCULATE-DATES.
           STRING WS-ORIG-DATE-YYYY DELIMITED BY SIZE,
                  WS-ORIG-DATE-MM   DELIMITED BY SIZE,
                  WS-ORIG-DATE-DD   DELIMITED BY SIZE
           INTO WS-STDT-X.
           MOVE WS-STDT-9-NUM TO WS-STDT-9-NUMERIC.
           COMPUTE WS-INTEGER =
              FUNCTION INTEGER-OF-DATE(WS-STDT-9-NUMERIC).
           COMPUTE WS-INTEGER = WS-INTEGER + 30.
           COMPUTE WS-FUTURE-DATE =
              FUNCTION DATE-OF-INTEGER (WS-INTEGER).
           MOVE WS-FUTURE-DATE      TO WS-FUT-9.
           MOVE WS-FUT-X-YY         TO HV-ACCOUNT-NEXT-STMT-YEAR.
           MOVE '.'                 TO HV-ACCOUNT-NEXT-STMT-DELIM2.
           MOVE WS-FUT-X-MM         TO HV-ACCOUNT-NEXT-STMT-MONTH.
           MOVE '.'                 TO HV-ACCOUNT-NEXT-STMT-DELIM1.
           MOVE WS-FUT-X-DD         TO HV-ACCOUNT-NEXT-STMT-DAY.
           EXEC SQL
              INSERT INTO ACCOUNT
                     (ACCOUNT_EYECATCHER,
                      ACCOUNT_CUSTOMER_NUMBER,
                      ACCOUNT_SORTCODE,
                      ACCOUNT_NUMBER,
                      ACCOUNT_TYPE,
                      ACCOUNT_INTEREST_RATE,
                      ACCOUNT_OPENED,
                      ACCOUNT_OVERDRAFT_LIMIT,
                      ACCOUNT_LAST_STATEMENT,
                      ACCOUNT_NEXT_STATEMENT,
                      ACCOUNT_AVAILABLE_BALANCE,
                      ACCOUNT_ACTUAL_BALANCE
                      )
              VALUES (:HV-ACCOUNT-EYECATCHER,
                      :HV-ACCOUNT-CUST-NO,
                      :HV-ACCOUNT-SORTCODE,
                      :HV-ACCOUNT-ACC-NO,
                      :HV-ACCOUNT-ACC-TYPE,
                      :HV-ACCOUNT-INT-RATE,
                      :HV-ACCOUNT-OPENED,
                      :HV-ACCOUNT-OVERDRAFT-LIM,
                      :HV-ACCOUNT-LAST-STMT,
                      :HV-ACCOUNT-NEXT-STMT,
                      :HV-ACCOUNT-AVAIL-BAL,
                      :HV-ACCOUNT-ACTUAL-BAL
                     )
           END-EXEC.
           IF SQLCODE NOT = 0
              MOVE SQLCODE TO SQLCODE-DISPLAY
              MOVE 'N' TO COMM-SUCCESS IN DFHCOMMAREA
              MOVE '7' TO COMM-FAIL-CODE IN DFHCOMMAREA
              PERFORM DEQ-NAMED-COUNTER
              MOVE SQLCODE TO SQLCODE-DISPLAY
              PERFORM GET-ME-OUT-OF-HERE
           END-IF.
           MOVE HV-ACCOUNT-SORTCODE       TO STORED-SORTCODE.
           MOVE HV-ACCOUNT-ACC-NO         TO STORED-ACCNO.
           MOVE HV-ACCOUNT-CUST-NO        TO STORED-CUSTNO.
           MOVE HV-ACCOUNT-ACC-TYPE       TO STORED-ACCTYPE.
           MOVE HV-ACCOUNT-LAST-STMT(1:2) TO STORED-LST-STMT(1:2).
           MOVE HV-ACCOUNT-LAST-STMT(4:2) TO STORED-LST-STMT(3:2).
           MOVE HV-ACCOUNT-LAST-STMT(7:4) TO STORED-LST-STMT(5:4).
           MOVE HV-ACCOUNT-NEXT-STMT(1:2) TO STORED-NXT-STMT(1:2).
           MOVE HV-ACCOUNT-NEXT-STMT(4:2) TO STORED-NXT-STMT(3:2).
           MOVE HV-ACCOUNT-NEXT-STMT(7:4) TO STORED-NXT-STMT(5:4).
           PERFORM WRITE-PROCTRAN.
           PERFORM DEQ-NAMED-COUNTER.
           MOVE HV-ACCOUNT-SORTCODE    TO COMM-SORTCODE.
           MOVE HV-ACCOUNT-ACC-NO      TO COMM-NUMBER.
           MOVE HV-ACCOUNT-OPENED-DAY(1:2)
             TO COMM-OPENED IN DFHCOMMAREA(1:2).
           MOVE HV-ACCOUNT-OPENED-MONTH(1:2)
             TO COMM-OPENED IN DFHCOMMAREA(3:2).
           MOVE HV-ACCOUNT-OPENED-YEAR(1:4)
             TO COMM-OPENED IN DFHCOMMAREA(5:4).
           MOVE HV-ACCOUNT-LAST-STMT-DAY(1:2)
              TO COMM-LAST-STMT-DT IN DFHCOMMAREA(1:2).
           MOVE HV-ACCOUNT-LAST-STMT-MONTH(1:2)
              TO COMM-LAST-STMT-DT IN DFHCOMMAREA(3:2).
           MOVE HV-ACCOUNT-LAST-STMT-YEAR(1:4)
              TO COMM-LAST-STMT-DT IN DFHCOMMAREA(5:4).
           MOVE HV-ACCOUNT-NEXT-STMT-DAY(1:2)
              TO COMM-NEXT-STMT-DT IN DFHCOMMAREA(1:2).
           MOVE HV-ACCOUNT-NEXT-STMT-MONTH(1:2)
              TO COMM-NEXT-STMT-DT IN DFHCOMMAREA(3:2).
           MOVE HV-ACCOUNT-NEXT-STMT-YEAR(1:4)
              TO COMM-NEXT-STMT-DT IN DFHCOMMAREA(5:4).
           MOVE 'ACCT'                 TO COMM-EYECATCHER.
           MOVE 'Y' TO COMM-SUCCESS IN DFHCOMMAREA.
           MOVE ' ' TO COMM-FAIL-CODE IN DFHCOMMAREA.
       WAD999.
           EXIT.
       WRITE-PROCTRAN SECTION.
       WP010.
               PERFORM WRITE-PROCTRAN-DB2.
       WP999.
           EXIT.
       WRITE-PROCTRAN-DB2 SECTION.
       WPD010.
           INITIALIZE HOST-PROCTRAN-ROW.
           INITIALIZE WS-EIBTASKN12.
           MOVE 'PRTR'   TO HV-PROCTRAN-EYECATCHER.
           MOVE SORTCODE TO HV-PROCTRAN-SORT-CODE.
           MOVE STORED-ACCNO TO HV-PROCTRAN-ACC-NUMBER.
           MOVE EIBTASKN TO WS-EIBTASKN12.
           MOVE WS-EIBTASKN12 TO HV-PROCTRAN-REF.
           EXEC CICS ASKTIME
              ABSTIME(WS-U-TIME)
           END-EXEC.
           EXEC CICS FORMATTIME
                     ABSTIME(WS-U-TIME)
                     DDMMYYYY(WS-ORIG-DATE)
                     TIME(HV-PROCTRAN-TIME)
                     DATESEP('.')
           END-EXEC.
           MOVE WS-ORIG-DATE TO WS-ORIG-DATE-GRP-X.
           MOVE WS-ORIG-DATE-GRP-X TO HV-PROCTRAN-DATE.
           MOVE STORED-CUSTNO     TO HV-PROCTRAN-DESC(1:10).
           MOVE STORED-ACCTYPE    TO HV-PROCTRAN-DESC(11:8).
           MOVE STORED-LST-STMT   TO HV-PROCTRAN-DESC(19:8).
           MOVE STORED-NXT-STMT   TO HV-PROCTRAN-DESC(27:8).
           MOVE SPACES            TO HV-PROCTRAN-DESC(35:6).
           MOVE 'OCA'             TO HV-PROCTRAN-TYPE.
           MOVE 0                 TO HV-PROCTRAN-AMOUNT.
           EXEC SQL
              INSERT INTO PROCTRAN
                     (
                      PROCTRAN_EYECATCHER,
                      PROCTRAN_SORTCODE,
                      PROCTRAN_NUMBER,
                      PROCTRAN_DATE,
                      PROCTRAN_TIME,
                      PROCTRAN_REF,
                      PROCTRAN_TYPE,
                      PROCTRAN_DESC,
                      PROCTRAN_AMOUNT
                     )
              VALUES
                     (
                      :HV-PROCTRAN-EYECATCHER,
                      :HV-PROCTRAN-SORT-CODE,
                      :HV-PROCTRAN-ACC-NUMBER,
                      :HV-PROCTRAN-DATE,
                      :HV-PROCTRAN-TIME,
                      :HV-PROCTRAN-REF,
                      :HV-PROCTRAN-TYPE,
                      :HV-PROCTRAN-DESC,
                      :HV-PROCTRAN-AMOUNT
                     )
           END-EXEC.
           IF SQLCODE NOT = 0
              DISPLAY 'In CREACC (WPD010) '
              'UNABLE TO WRITE TO PROCTRAN ROW DATASTORE'
              ' RESP CODE=' WS-CICS-RESP, ' RESP2=' WS-CICS-RESP2
              'WITH THE FOLLOWING DATA:' HOST-PROCTRAN-ROW
              PERFORM DEQ-NAMED-COUNTER
              MOVE SQLCODE TO SQLCODE-DISPLAY
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE2
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HWPT'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE SQLCODE-DISPLAY    TO ABND-SQLCODE
              STRING 'WPD010  - PROCTRAN DB2 INSERT issue.'
                    DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              EXEC CICS ABEND
                 ABCODE ('HWPT')
              END-EXEC
           END-IF.
       WPD999.
           EXIT.
       GET-ME-OUT-OF-HERE SECTION.
       GMOFH010.
           EXEC CICS RETURN
           END-EXEC.
       GMOFH999.
           EXIT.
       CUSTOMER-ACCOUNT-COUNT SECTION.
       CAC010.
           MOVE 20 TO NUMBER-OF-ACCOUNTS IN INQACCCU-COMMAREA.
           MOVE COMM-CUSTNO IN DFHCOMMAREA
             TO CUSTOMER-NUMBER IN INQACCCU-COMMAREA.
           SET COMM-PCB-POINTER TO NULL
           EXEC CICS LINK PROGRAM('INQACCCU')
                COMMAREA(INQACCCU-COMMAREA)
                RESP(WS-CICS-RESP)
                SYNCONRETURN
           END-EXEC.
       CAC999.
           EXIT.
       CALCULATE-DATES SECTION.
       CD010.
           EXEC CICS ASKTIME
              ABSTIME(WS-U-TIME)
           END-EXEC.
           EXEC CICS FORMATTIME
                     ABSTIME(WS-U-TIME)
                     DDMMYYYY(WS-ORIG-DATE)
                     TIME(PROC-TRAN-TIME OF PROCTRAN-AREA)
                     DATESEP
           END-EXEC.
           STRING WS-ORIG-DATE-YYYY DELIMITED BY SIZE,
                  WS-ORIG-DATE-MM   DELIMITED BY SIZE,
                  WS-ORIG-DATE-DD   DELIMITED BY SIZE
              INTO WS-STDT-X.
           MOVE WS-STDT-9-NUM TO WS-STDT-9-NUMERIC.
           COMPUTE WS-INTEGER =
              FUNCTION INTEGER-OF-DATE(WS-STDT-9-NUMERIC).
           EVALUATE WS-ORIG-DATE-MM
              WHEN 1
              WHEN 3
              WHEN 5
              WHEN 7
              WHEN 8
              WHEN 10
              WHEN 12
                 COMPUTE WS-INTEGER = WS-INTEGER + 30
              WHEN 9
              WHEN 4
              WHEN 6
              WHEN 11
                 COMPUTE WS-INTEGER = WS-INTEGER + 30
              WHEN 2
                 COMPUTE WS-INTEGER = WS-INTEGER + 28
                 DIVIDE WS-ORIG-DATE-YYYY BY 4 GIVING DONT-CARE
                 REMAINDER LEAP-YEAR
                 IF LEAP-YEAR = ZERO
                    DIVIDE WS-ORIG-DATE-YYYY BY 100 GIVING DONT-CARE
                       REMAINDER LEAP-YEAR
                    IF LEAP-YEAR > 0
                       ADD 1 TO WS-INTEGER GIVING WS-INTEGER
                    ELSE
                       DIVIDE WS-ORIG-DATE-YYYY BY 400 GIVING DONT-CARE
                          REMAINDER LEAP-YEAR
                       IF LEAP-YEAR = ZERO
                         ADD 1 TO WS-INTEGER GIVING WS-INTEGER
                       END-IF
                    END-IF
                 END-IF
           END-EVALUATE.
           COMPUTE WS-FUTURE-DATE =
              FUNCTION DATE-OF-INTEGER (WS-INTEGER).
           MOVE WS-FUTURE-DATE(1:4) TO ACCOUNT-NEXT-STMT-DATE(5:4).
           MOVE WS-FUTURE-DATE(5:2) TO ACCOUNT-NEXT-STMT-DATE(3:2).
           MOVE WS-FUTURE-DATE(7:2) TO ACCOUNT-NEXT-STMT-DATE(1:2).
           MOVE WS-ORIG-DATE-DD   TO ACCOUNT-OPENED(1:2).
           MOVE WS-ORIG-DATE-MM   TO ACCOUNT-OPENED(3:2).
           MOVE WS-ORIG-DATE-YYYY TO ACCOUNT-OPENED(5:4).
           MOVE ACCOUNT-OPENED    TO ACCOUNT-LAST-STMT-DATE.
           MOVE WS-ORIG-DATE-DD   TO HV-ACCOUNT-OPENED-DAY.
           MOVE '.'               TO HV-ACCOUNT-OPENED-DELIM1.
           MOVE WS-ORIG-DATE-MM   TO HV-ACCOUNT-OPENED-MONTH.
           MOVE '.'               TO HV-ACCOUNT-OPENED-DELIM2.
           MOVE WS-ORIG-DATE-YYYY TO HV-ACCOUNT-OPENED-YEAR.
           MOVE WS-ORIG-DATE-DD   TO HV-ACCOUNT-LAST-STMT-DAY.
           MOVE '.'               TO HV-ACCOUNT-LAST-STMT-DELIM1.
           MOVE WS-ORIG-DATE-MM   TO HV-ACCOUNT-LAST-STMT-MONTH.
           MOVE '.'               TO HV-ACCOUNT-LAST-STMT-DELIM2.
           MOVE WS-ORIG-DATE-YYYY TO HV-ACCOUNT-LAST-STMT-YEAR.
       CD999.
           EXIT.
       ACCOUNT-TYPE-CHECK SECTION.
       ATC010.
           EVALUATE TRUE
              WHEN COMM-ACC-TYPE IN DFHCOMMAREA(1:3) = 'ISA'
              WHEN COMM-ACC-TYPE IN DFHCOMMAREA(1:8) = 'MORTGAGE'
              WHEN COMM-ACC-TYPE IN DFHCOMMAREA(1:6) = 'SAVING'
              WHEN COMM-ACC-TYPE IN DFHCOMMAREA(1:7) = 'CURRENT'
              WHEN COMM-ACC-TYPE IN DFHCOMMAREA(1:4) = 'LOAN'
                 MOVE 'Y' TO COMM-SUCCESS OF DFHCOMMAREA
              WHEN OTHER
                 MOVE 'N' TO COMM-SUCCESS OF DFHCOMMAREA
                 MOVE 'A' TO COMM-FAIL-CODE IN DFHCOMMAREA
           END-EVALUATE.
       ATC999.
           EXIT.
       POPULATE-TIME-DATE2 SECTION.
       PTD2010.
           EXEC CICS ASKTIME
              ABSTIME(WS-U-TIME)
           END-EXEC.
           EXEC CICS FORMATTIME
                     ABSTIME(WS-U-TIME)
                     DDMMYYYY(WS-ORIG-DATE)
                     TIME(WS-TIME-NOW)
                     DATESEP
           END-EXEC.
       PTD2999.
           EXIT.
","       FILE SECTION.
       WORKING-STORAGE SECTION.
       77 SORTCODE           PIC 9(6) VALUE 987654.
       77 SYSIDERR-RETRY PIC 999.
           EXEC SQL
              INCLUDE ACCDB2
           END-EXEC.
       01 HOST-ACCOUNT-ROW.
          03 HV-ACCOUNT-EYECATCHER          PIC X(4).
          03 HV-ACCOUNT-CUST-NO             PIC X(10).
          03 HV-ACCOUNT-SORTCODE            PIC X(6).
          03 HV-ACCOUNT-ACC-NO              PIC X(8).
          03 HV-ACCOUNT-ACC-TYPE            PIC X(8).
          03 HV-ACCOUNT-INT-RATE            PIC S9(4)V99 COMP-3.
          03 HV-ACCOUNT-OPENED              PIC X(10).
          03 HV-ACCOUNT-OPENED-GROUP REDEFINES HV-ACCOUNT-OPENED.
             05 HV-ACCOUNT-OPENED-DAY       PIC XX.
             05 HV-ACCOUNT-OPENED-DELIM1    PIC X.
             05 HV-ACCOUNT-OPENED-MONTH     PIC XX.
             05 HV-ACCOUNT-OPENED-DELIM2    PIC X.
             05 HV-ACCOUNT-OPENED-YEAR      PIC X(4).
          03 HV-ACCOUNT-OVERDRAFT-LIM       PIC S9(9) COMP.
          03 HV-ACCOUNT-LAST-STMT           PIC X(10).
          03 HV-ACCOUNT-LAST-STMT-GROUP
             REDEFINES HV-ACCOUNT-LAST-STMT.
             05 HV-ACCOUNT-LAST-STMT-DAY    PIC XX.
             05 HV-ACCOUNT-LAST-STMT-DELIM1 PIC X.
             05 HV-ACCOUNT-LAST-STMT-MONTH  PIC XX.
             05 HV-ACCOUNT-LAST-STMT-DELIM2 PIC X.
             05 HV-ACCOUNT-LAST-STMT-YEAR   PIC X(4).
          03 HV-ACCOUNT-NEXT-STMT           PIC X(10).
          03 HV-ACCOUNT-NEXT-STMT-GROUP
             REDEFINES HV-ACCOUNT-NEXT-STMT.
             05 HV-ACCOUNT-NEXT-STMT-DAY    PIC XX.
             05 HV-ACCOUNT-NEXT-STMT-DELIM1 PIC X.
             05 HV-ACCOUNT-NEXT-STMT-MONTH  PIC XX.
             05 HV-ACCOUNT-NEXT-STMT-DELIM2 PIC X.
             05 HV-ACCOUNT-NEXT-STMT-YEAR   PIC X(4).
          03 HV-ACCOUNT-AVAIL-BAL           PIC S9(10)V99 COMP-3.
          03 HV-ACCOUNT-ACTUAL-BAL          PIC S9(10)V99 COMP-3.
       01 SQLCODE-DISPLAY                   PIC S9(8) DISPLAY
           SIGN LEADING SEPARATE.
          EXEC SQL
             INCLUDE PROCDB2
          END-EXEC.
       01 HOST-PROCTRAN-ROW.
          03 HV-PROCTRAN-EYECATCHER         PIC X(4).
          03 HV-PROCTRAN-SORT-CODE          PIC X(6).
          03 HV-PROCTRAN-ACC-NUMBER         PIC X(8).
          03 HV-PROCTRAN-DATE               PIC X(10).
          03 HV-PROCTRAN-TIME               PIC X(6).
          03 HV-PROCTRAN-REF                PIC X(12).
          03 HV-PROCTRAN-TYPE               PIC X(3).
          03 HV-PROCTRAN-DESC               PIC X(40).
          03 HV-PROCTRAN-AMOUNT             PIC S9(10)V99 COMP-3.
       01 HOST-CONTROL-ROW.
           03 HV-CONTROL-NAME                  PIC X(32).
           03 HV-CONTROL-VALUE-NUM             PIC S9(9) COMP.
           03 HV-CONTROL-VALUE-STR             PIC X(40).
       EXEC SQL
          INCLUDE SQLCA
       END-EXEC.
       01 PROCTRAN-AREA.
           03 PROC-TRAN-DATA.
              05 PROC-TRAN-EYE-CATCHER        PIC X(4).
              88 PROC-TRAN-VALID VALUE 'PRTR'.
              05 PROC-TRAN-LOGICAL-DELETE-AREA REDEFINES
                 PROC-TRAN-EYE-CATCHER.
                 07 PROC-TRAN-LOGICAL-DELETE-FLAG PIC X.
                 88 PROC-TRAN-LOGICALLY-DELETED VALUE X'FF'.
                 07 FILLER PIC X(3).
              05 PROC-TRAN-ID.
                 07 PROC-TRAN-SORT-CODE       PIC 9(6).
                 07 PROC-TRAN-NUMBER          PIC 9(8).
              05 PROC-TRAN-DATE               PIC 9(8).
              05 PROC-TRAN-DATE-GRP REDEFINES PROC-TRAN-DATE.
                 07 PROC-TRAN-DATE-GRP-YYYY   PIC 9999.
                 07 PROC-TRAN-DATE-GRP-MM     PIC 99.
                 07 PROC-TRAN-DATE-GRP-DD     PIC 99.
              05 PROC-TRAN-TIME               PIC 9(6).
              05 PROC-TRAN-TIME-GRP REDEFINES PROC-TRAN-TIME.
                 07 PROC-TRAN-TIME-GRP-HH     PIC 99.
                 07 PROC-TRAN-TIME-GRP-MM     PIC 99.
                 07 PROC-TRAN-TIME-GRP-SS     PIC 99.
              05 PROC-TRAN-REF                PIC 9(12).
              05 PROC-TRAN-TYPE               PIC X(3).
              88 PROC-TY-CHEQUE-ACKNOWLEDGED      VALUE 'CHA'.
              88 PROC-TY-CHEQUE-FAILURE           VALUE 'CHF'.
              88 PROC-TY-CHEQUE-PAID-IN           VALUE 'CHI'.
              88 PROC-TY-CHEQUE-PAID-OUT          VALUE 'CHO'.
              88 PROC-TY-CREDIT                   VALUE 'CRE'.
              88 PROC-TY-DEBIT                    VALUE 'DEB'.
              88 PROC-TY-WEB-CREATE-ACCOUNT       VALUE 'ICA'.
              88 PROC-TY-WEB-CREATE-CUSTOMER      VALUE 'ICC'.
              88 PROC-TY-WEB-DELETE-ACCOUNT       VALUE 'IDA'.
              88 PROC-TY-WEB-DELETE-CUSTOMER      VALUE 'IDC'.
              88 PROC-TY-BRANCH-CREATE-ACCOUNT    VALUE 'OCA'.
              88 PROC-TY-BRANCH-CREATE-CUSTOMER   VALUE 'OCC'.
              88 PROC-TY-BRANCH-DELETE-ACCOUNT    VALUE 'ODA'.
              88 PROC-TY-BRANCH-DELETE-CUSTOMER   VALUE 'ODC'.
              88 PROC-TY-CREATE-SODD              VALUE 'OCS'.
              88 PROC-TY-PAYMENT-CREDIT           VALUE 'PCR'.
              88 PROC-TY-PAYMENT-DEBIT            VALUE 'PDR'.
              88 PROC-TY-TRANSFER                 VALUE 'TFR'.
              05 PROC-TRAN-DESC               PIC X(40).
              05 PROC-TRAN-DESC-XFR REDEFINES PROC-TRAN-DESC.
                07 PROC-TRAN-DESC-XFR-HEADER PIC X(26).
                88 PROC-TRAN-DESC-XFR-FLAG
                   VALUE 'TRANSFER'.
                07 PROC-TRAN-DESC-XFR-SORTCODE
                   PIC 9(6).
                07 PROC-TRAN-DESC-XFR-ACCOUNT
                   PIC 9(8).
              05 PROC-TRAN-DESC-DELACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELACC-ACCTYPE PIC X(8).
                07 PROC-DESC-DELACC-LAST-DD PIC 99.
                07 PROC-DESC-DELACC-LAST-MM PIC 99.
                07 PROC-DESC-DELACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-DELACC-NEXT-DD PIC 99.
                07 PROC-DESC-DELACC-NEXT-MM PIC 99.
                07 PROC-DESC-DELACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-DELACC-FOOTER PIC X(6).
                88 PROC-DESC-DELACC-FLAG
                   VALUE 'DELETE'.
              05 PROC-TRAN-DESC-CREACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CREACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-CREACC-ACCTYPE PIC X(8).
                07 PROC-DESC-CREACC-LAST-DD PIC 99.
                07 PROC-DESC-CREACC-LAST-MM PIC 99.
                07 PROC-DESC-CREACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-CREACC-NEXT-DD PIC 99.
                07 PROC-DESC-CREACC-NEXT-MM PIC 99.
                07 PROC-DESC-CREACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-CREACC-FOOTER PIC X(6).
                88 PROC-DESC-CREACC-FLAG
                   VALUE 'CREATE'.
              05 PROC-TRAN-DESC-DELCUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELCUS-SORTCODE PIC 9(6).
                07 PROC-DESC-DELCUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELCUS-NAME     PIC X(14).
                07 PROC-DESC-DELCUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-DELCUS-FILLER    PIC X.
                88 PROC-DESC-DELCUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-MM    PIC 99.
                07 PROC-DESC-DELCUS-FILLER2   PIC X.
                88 PROC-DESC-DELCUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-DD    PIC 99.
              05 PROC-TRAN-DESC-CRECUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CRECUS-SORTCODE PIC 9(6).
                07 PROC-DESC-CRECUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-CRECUS-NAME     PIC X(14).
                07 PROC-DESC-CRECUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-CRECUS-FILLER    PIC X.
                88 PROC-DESC-CRECUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-MM    PIC 99.
                07 PROC-DESC-CRECUS-FILLER2   PIC X.
                88 PROC-DESC-CRECUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-DD    PIC 99.
              05 PROC-TRAN-AMOUNT             PIC S9(10)V99.
       01 PROCTRAN-RIDFLD                   PIC S9(8) COMP.
       01 PROCTRAN-RETRY                    PIC 999.
       01 WS-EXIT-RETRY-LOOP                PIC X VALUE ' '.
       01 WS-CICS-WORK-AREA.
          05 WS-CICS-RESP                   PIC S9(8) COMP.
          05 WS-CICS-RESP2                  PIC S9(8) COMP.
          05 WS-EIBRESP-DISPLAY             PIC S9(8) DISPLAY
                                               SIGN LEADING SEPARATE.
       01 WS-CUSTOMER-NO-NUM                PIC 9(10).
       LOCAL-STORAGE SECTION.
       01 FILE-RETRY                        PIC 999.
       01 OUTPUT-DATA.
              03 ACCOUNT-DATA.
                 05 ACCOUNT-EYE-CATCHER        PIC X(4).
                 88 ACCOUNT-EYECATCHER-VALUE        VALUE 'ACCT'.
                 05 ACCOUNT-CUST-NO            PIC 9(10).
                 05 ACCOUNT-KEY.
                    07 ACCOUNT-SORT-CODE       PIC 9(6).
                    07 ACCOUNT-NUMBER          PIC 9(8).
                 05 ACCOUNT-TYPE               PIC X(8).
                 05 ACCOUNT-INTEREST-RATE      PIC 9(4)V99.
                 05 ACCOUNT-OPENED             PIC 9(8).
                 05 ACCOUNT-OPENED-GROUP REDEFINES ACCOUNT-OPENED.
                    07 ACCOUNT-OPENED-DAY       PIC 99.
                    07 ACCOUNT-OPENED-MONTH     PIC 99.
                    07 ACCOUNT-OPENED-YEAR      PIC 9999.
                 05 ACCOUNT-OVERDRAFT-LIMIT    PIC 9(8).
                 05 ACCOUNT-LAST-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-LAST-STMT-GROUP
                    REDEFINES ACCOUNT-LAST-STMT-DATE.
                    07 ACCOUNT-LAST-STMT-DAY   PIC 99.
                    07 ACCOUNT-LAST-STMT-MONTH PIC 99.
                    07 ACCOUNT-LAST-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-NEXT-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-NEXT-STMT-GROUP
                   REDEFINES ACCOUNT-NEXT-STMT-DATE.
                    07 ACCOUNT-NEXT-STMT-DAY   PIC 99.
                    07 ACCOUNT-NEXT-STMT-MONTH PIC 99.
                    07 ACCOUNT-NEXT-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-AVAILABLE-BALANCE  PIC S9(10)V99.
                 05 ACCOUNT-ACTUAL-BALANCE     PIC S9(10)V99.
       01 OUTPUTC-DATA.
           03 CUSTOMER-RECORD.
              05 CUSTOMER-EYECATCHER                 PIC X(4).
                 88 CUSTOMER-EYECATCHER-VALUE        VALUE 'CUST'.
              05 CUSTOMER-KEY.
                 07 CUSTOMER-SORTCODE                PIC 9(6) DISPLAY.
                 07 CUSTOMER-NUMBER                  PIC 9(10) DISPLAY.
              05 CUSTOMER-NAME                       PIC X(60).
              05 CUSTOMER-ADDRESS                    PIC X(160).
              05 CUSTOMER-DATE-OF-BIRTH              PIC 9(8).
              05 CUSTOMER-DOB-GROUP REDEFINES CUSTOMER-DATE-OF-BIRTH.
                 07 CUSTOMER-BIRTH-DAY               PIC 99.
                 07 CUSTOMER-BIRTH-MONTH             PIC 99.
                 07 CUSTOMER-BIRTH-YEAR              PIC 9999.
              05 CUSTOMER-CREDIT-SCORE               PIC 999.
              05 CUSTOMER-CS-REVIEW-DATE             PIC 9(8).
              05 CUSTOMER-CS-GROUP
                 REDEFINES CUSTOMER-CS-REVIEW-DATE.
                 07 CUSTOMER-CS-REVIEW-DAY           PIC 99.
                 07 CUSTOMER-CS-REVIEW-MONTH         PIC 99.
                 07 CUSTOMER-CS-REVIEW-YEAR          PIC 9999.
       01 RETURN-DATA.
          03 RETURN-DATA-EYECATCHER         PIC X(4).
          03 RETURN-DATA-NUMBER             PIC 9(10) DISPLAY.
          03 RETURN-DATA-NAME               PIC X(60).
          03 RETURN-DATA-ADDRESS            PIC X(160).
          03 RETURN-DATA-DATE-OF-BIRTH      PIC 9(8).
       01 CUSTOMER-KY.
          03 REQUIRED-SORT-CODE             PIC 9(6) VALUE 0.
          03 REQUIRED-CUST-NUMBER           PIC 9(10) VALUE 0.
       01 ACCOUNT-KY.
          03 REQUIRED-SORT-CODE2            PIC 9(6) VALUE 0.
          03 REQUIRED-ACC-NUMBER            PIC 9(8) VALUE 0.
       01 RANDOM-CUSTOMER                   PIC 9(10) VALUE 0.
       01 HIGHEST-CUST-NUMBER               PIC 9(10) VALUE 0.
       01 EXIT-VSAM-READ                    PIC X VALUE 'N'.
       01 EXIT-DB2-READ                     PIC X VALUE 'N'.
       01 WS-V-RETRIED                      PIC X VALUE 'N'.
       01 WS-D-RETRIED                      PIC X VALUE 'N'.
       01 WS-ERROR                          PIC X(40) VALUE ALL '#'.
       01 NCS-ACC-NO-STUFF.
          03 NCS-ACC-NO-NAME.
             05 NCS-ACC-NO-ACT-NAME         PIC X(8)
                                 VALUE 'CBSAACCT'.
             05 NCS-ACC-NO-TEST-SORT        PIC X(6)
                                 VALUE '      '.
             05 NCS-ACC-NO-FILL             PIC XX
                                 VALUE '  '.
          03 NCS-ACC-NO-INC                 PIC 9(16) COMP
                                 VALUE 0.
          03 NCS-ACC-NO-VALUE               PIC 9(16) COMP
                                 VALUE 0.
          03 NCS-ACC-NO-RESP                PIC XX VALUE '00'.
       01 WS-DISP-CUST-NO-VAL               PIC S9(18) DISPLAY.
       01 WS-ACC-REC-LEN                    PIC S9(4) COMP VALUE 0.
       01 NCS-UPDATED                       PIC X VALUE 'N'.
       01 WS-U-TIME                         PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                      PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD                PIC 99.
          03 FILLER                         PIC X.
          03 WS-ORIG-DATE-MM                PIC 99.
          03 FILLER                         PIC X.
          03 WS-ORIG-DATE-YYYY              PIC 9999.
       01 DONT-CARE                         PIC 9(8) BINARY.
       01 LEAP-YEAR                         PIC 9(8) BINARY.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X              PIC XX.
          03 FILLER                         PIC X VALUE '.'.
          03 WS-ORIG-DATE-MM-X              PIC XX.
          03 FILLER                         PIC X VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X            PIC X(4).
       01 WS-STDT-X                         PIC X(8).
       01 WS-STDT-9  REDEFINES WS-STDT-X.
          03 WS-STDT-9-NUM                  PIC 9(8).
       01 WS-STDT-9-NUMERIC                 PIC 9(8).
       01 WS-INTEGER                        PIC S9(9) COMP VALUE 0.
       01 WS-FUTURE-DATE                    PIC 9(8).
       01 WS-FUT REDEFINES WS-FUTURE-DATE.
          03 WS-FUTURE-YY                   PIC 9(4).
          03 WS-FUTURE-MM                   PIC 99.
          03 WS-FUTURE-DD                   PIC 99.
       01 WS-FUTURE-CONV.
          03 WS-FUT-9                       PIC 9(8).
          03 WS-FUT-X REDEFINES WS-FUT-9.
             05 WS-FUT-X-YY                 PIC X(4).
             05 WS-FUT-X-MM                 PIC XX.
             05 WS-FUT-X-DD                 PIC XX.
       01 NCS-ACC-NO-DISP                   PIC 9(16) VALUE 0.
       01 STORED-SORTCODE                   PIC X(6)  VALUE SPACES.
       01 STORED-CUSTNO                     PIC X(10) VALUE SPACES.
       01 STORED-ACCTYPE                    PIC X(8)  VALUE SPACES.
       01 STORED-LST-STMT                   PIC X(8)  VALUE SPACES.
       01 STORED-NXT-STMT                   PIC X(8)  VALUE SPACES.
       01 STORED-ACCNO                      PIC X(8)  VALUE SPACES.
       01 WS-EIBTASKN12                     PIC 9(12) VALUE 0.
       01 ACCOUNT-KY3.
          03 REQUIRED-SORT-CODE3            PIC 9(6) VALUE 0.
          03 REQUIRED-ACCT-NUMBER3          PIC 9(8) VALUE 0.
       01 ACCOUNT-KY3-BYTES REDEFINES ACCOUNT-KY3 PIC X(14).
       01 INQCUST-COMMAREA.
          03 INQCUST-EYE                  PIC X(4).
          03 INQCUST-SCODE                PIC X(6).
          03 INQCUST-CUSTNO               PIC 9(10).
          03 INQCUST-NAME                 PIC X(60).
          03 INQCUST-ADDR                 PIC X(160).
          03 INQCUST-DOB.
            05 INQCUST-DOB-DD             PIC 99.
            05 INQCUST-DOB-MM             PIC 99.
            05 INQCUST-DOB-YYYY           PIC 9999.
          03 INQCUST-CREDIT-SCORE         PIC 999.
          03 INQCUST-CS-REVIEW-DT.
            05 INQCUST-CS-REVIEW-DD       PIC 99.
            05 INQCUST-CS-REVIEW-MM       PIC 99.
            05 INQCUST-CS-REVIEW-YYYY     PIC 9999.
          03 INQCUST-INQ-SUCCESS          PIC X.
          03 INQCUST-INQ-FAIL-CD          PIC X.
          03 INQCUST-PCB-POINTER          POINTER.
       01 INQACCCU-COMMAREA.
          03 NUMBER-OF-ACCOUNTS        PIC S9(8) BINARY.
          03 CUSTOMER-NUMBER           PIC 9(10).
          03 COMM-SUCCESS              PIC X.
          03 COMM-FAIL-CODE            PIC X.
          03 CUSTOMER-FOUND            PIC X.
          03 COMM-PCB-POINTER          POINTER.
          03 ACCOUNT-DETAILS OCCURS 1 TO 20 DEPENDING ON
              NUMBER-OF-ACCOUNTS
            05 COMM-EYE                  PIC X(4).
            05 COMM-CUSTNO               PIC X(10).
            05 COMM-SCODE                PIC X(6).
            05 COMM-ACCNO                PIC 9(8).
            05 COMM-ACC-TYPE             PIC X(8).
            05 COMM-INT-RATE             PIC 9(4)V99.
            05 COMM-OPENED               PIC 9(8).
            05 COMM-OPENED-GROUP REDEFINES COMM-OPENED.
              07 COMM-OPENED-DAY PIC 99.
              07 COMM-OPENED-MONTH PIC 99.
              07 COMM-OPENED-YEAR PIC 9999.
            05 COMM-OVERDRAFT            PIC 9(8).
            05 COMM-LAST-STMT-DT         PIC 9(8).
            05 COMM-LAST-STMT-GROUP REDEFINES COMM-LAST-STMT-DT.
              07 COMM-LAST-STMT-DAY PIC 99.
              07 COMM-LAST-STMT-MONTH PIC 99.
              07 COMM-LAST-STMT-YEAR PIC 9999.
            05 COMM-NEXT-STMT-DT         PIC 9(8).
            05 COMM-NEXT-STMT-GROUP REDEFINES COMM-NEXT-STMT-DT.
              07 COMM-NEXT-STMT-DAY PIC 99.
              07 COMM-NEXT-STMT-MONTH PIC 99.
              07 COMM-NEXT-STMT-YEAR PIC 9999.
            05 COMM-AVAIL-BAL            PIC S9(10)V99.
            05 COMM-ACTUAL-BAL           PIC S9(10)V99.
           BY ==NUMBER-OF-ACCOUNTS IN INQACCCU-COMMAREA.==.
       01 STORM-DRAIN-CONDITION             PIC X(20).
       01 ACCOUNT-CONTROL.
              03 ACCOUNT-CONTROL-RECORD.
                 05 ACCOUNT-CONTROL-EYE-CATCHER        PIC X(4).
                 88 ACCOUNT-CONTROL-EYECATCHER-V   VALUE 'CTRL'.
                 05 FILLER                     PIC 9(10).
                 05 ACCOUNT-CONTROL-KEY.
                    07 ACCOUNT-CONTROL-SORT-CODE       PIC 9(6).
                    07 ACCOUNT-CONTROL-NUMBER          PIC 9(8).
                 05 NUMBER-OF-ACCOUNTS                 PIC 9(8).
                 05 LAST-ACCOUNT-NUMBER                PIC 9(8).
                 05 ACCOUNT-CONTROL-SUCCESS-FLAG       PIC X.
                 88 ACCOUNT-CONTROL-SUCCESS VALUE 'Y'.
                 05 ACCOUNT-CONTROL-FAIL-CODE PIC X.
                 05 FILLER                     PIC 9(4)V99.
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC S9(10)V99.
                 05 FILLER                     PIC X(2).
       01 WS-TIME-DATA.
           03 WS-TIME-NOW                   PIC 9(6).
           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
              05 WS-TIME-NOW-GRP-HH         PIC 99.
              05 WS-TIME-NOW-GRP-MM         PIC 99.
              05 WS-TIME-NOW-GRP-SS         PIC 99.
       01 WS-ABEND-PGM                      PIC X(8) VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 COMM-EYECATCHER                 PIC X(4).
          03 COMM-CUSTNO                     PIC 9(10).
          03 COMM-KEY.
             05 COMM-SORTCODE                PIC 9(6) DISPLAY.
             05 COMM-NUMBER                  PIC 9(8) DISPLAY.
          03 COMM-ACC-TYPE                   PIC X(8).
          03 COMM-INT-RT                     PIC 9(4)V99.
          03 COMM-OPENED                     PIC 9(8).
          03 COMM-OPENED-GROUP REDEFINES COMM-OPENED.
             05 COMM-OPENED-DAY              PIC 99.
             05 COMM-OPENED-MONTH            PIC 99.
             05 COMM-OPENED-YEAR             PIC 9999.
          03 COMM-OVERDR-LIM                 PIC 9(8).
          03 COMM-LAST-STMT-DT               PIC 9(8).
          03 COMM-LAST-STMNT-GROUP REDEFINES COMM-LAST-STMT-DT.
             05 COMM-LASTST-DAY               PIC 99.
             05 COMM-LASTST-MONTH             PIC 99.
             05 COMM-LASTST-YEAR              PIC 9999.
          03 COMM-NEXT-STMT-DT               PIC 9(8).
          03 COMM-NEXT-STMNT-GROUP REDEFINES COMM-NEXT-STMT-DT.
             05 COMM-NEXTST-DAY               PIC 99.
             05 COMM-NEXTST-MONTH             PIC 99.
             05 COMM-NEXTST-YEAR              PIC 9999.
          03 COMM-AVAIL-BAL                  PIC S9(10)V99.
          03 COMM-ACT-BAL                    PIC S9(10)V99.
          03 COMM-SUCCESS                    PIC X.
          03 COMM-FAIL-CODE                  PIC X.
","['PREMIERE', 'ENQ-NAMED-COUNTER', 'DEQ-NAMED-COUNTER', 'FIND-NEXT-ACCOUNT', 'WRITE-ACCOUNT-DB2', 'WRITE-PROCTRAN', 'WRITE-PROCTRAN-DB2', 'GET-ME-OUT-OF-HERE', 'CUSTOMER-ACCOUNT-COUNT', 'CALCULATE-DATES', 'ACCOUNT-TYPE-CHECK', 'POPULATE-TIME-DATE2', 'P010', 'P999', 'ENC010', 'ENC999', 'DNC010', 'DNC999', 'FNA010', 'FNA999', 'WAD010', 'WAD999', 'WP010', 'WP999', 'WPD010', 'WPD999', 'GMOFH010', 'GMOFH999', 'CAC010', 'CAC999', 'CD010', 'CD999', 'ATC010', 'ATC999', 'PTD2010', 'PTD2999']","Paragraph PREMIERE calls paragraph WRITE-ACCOUNT-DB2, FIND-NEXT-ACCOUNT, CUSTOMER-ACCOUNT-COUNT, ENQ-NAMED-COUNTER, GET-ME-OUT-OF-HERE, ACCOUNT-TYPE-CHECK.
Paragraph ENQ-NAMED-COUNTER calls paragraph GET-ME-OUT-OF-HERE.
Paragraph DEQ-NAMED-COUNTER calls paragraph GET-ME-OUT-OF-HERE.
Paragraph FIND-NEXT-ACCOUNT calls paragraph POPULATE-TIME-DATE2.
Paragraph WRITE-ACCOUNT-DB2 calls paragraph GET-ME-OUT-OF-HERE, DEQ-NAMED-COUNTER, CALCULATE-DATES, WRITE-PROCTRAN.
Paragraph WRITE-PROCTRAN calls paragraph WRITE-PROCTRAN-DB2.
Paragraph WRITE-PROCTRAN-DB2 calls paragraph DEQ-NAMED-COUNTER, POPULATE-TIME-DATE2.
",1083,"This program takes account information from the BMS application (cust no, name, address and DOB) and then enqueues the Named Counter for ACCOUNT, increments the counter and takes the new account number, & attempt to update the ACCOUNT datastore on DB2. If that is successful, write a rec to the PROCTRAN datastore. Then, if all of that works, DEQUEUE the named counter and return the ACCOUNT number. If for any reason the write to the ACCOUNT or PROCTRAN datatsore is unsuccessful, then we need to decrement the Named Counter (restoring it to the start position) and DEQUEUE the Named Counter.","['WS-ABEND-PGM', 'INQACCCU', 'INQCUST']",,,Error Long,1,1,0.636,"This COBOL code processes customer data and account information through a series of operations including retrieval, enqueueing, and writing to a DB2 database. It performs customer checks, manages account types, and handles date calculations. Established procedures handle successful and failed operations, ensuring data integrity. Key interactions include customer inquiries and dynamic account management with CICS, ensuring organized control and data manipulation. Overall, it facilitates efficient account processing and handling within a CICS environment.",1
136,cicsdev_cics-banking-sample-application-cbsa,cics-banking-sample-application-cbsa/src/base/cobol_src/CRECUST.cbl,,"       FILE SECTION.
       WORKING-STORAGE SECTION.
       77 SORTCODE           PIC 9(6) VALUE 987654.
       01 SYSIDERR-RETRY                PIC 999.
          EXEC SQL
             INCLUDE PROCDB2
          END-EXEC.
       01 HOST-PROCTRAN-ROW.
          03 HV-PROCTRAN-EYECATCHER     PIC X(4).
          03 HV-PROCTRAN-SORT-CODE      PIC X(6).
          03 HV-PROCTRAN-ACC-NUMBER     PIC X(8).
          03 HV-PROCTRAN-DATE           PIC X(10).
          03 HV-PROCTRAN-TIME           PIC X(6).
          03 HV-PROCTRAN-REF            PIC X(12).
          03 HV-PROCTRAN-TYPE           PIC X(3).
          03 HV-PROCTRAN-DESC           PIC X(40).
          03 HV-PROCTRAN-AMOUNT         PIC S9(10)V99 COMP-3.
       EXEC SQL
          INCLUDE SQLCA
       END-EXEC.
       01 PROCTRAN-AREA.
           03 PROC-TRAN-DATA.
              05 PROC-TRAN-EYE-CATCHER        PIC X(4).
              88 PROC-TRAN-VALID VALUE 'PRTR'.
              05 PROC-TRAN-LOGICAL-DELETE-AREA REDEFINES
                 PROC-TRAN-EYE-CATCHER.
                 07 PROC-TRAN-LOGICAL-DELETE-FLAG PIC X.
                 88 PROC-TRAN-LOGICALLY-DELETED VALUE X'FF'.
                 07 FILLER PIC X(3).
              05 PROC-TRAN-ID.
                 07 PROC-TRAN-SORT-CODE       PIC 9(6).
                 07 PROC-TRAN-NUMBER          PIC 9(8).
              05 PROC-TRAN-DATE               PIC 9(8).
              05 PROC-TRAN-DATE-GRP REDEFINES PROC-TRAN-DATE.
                 07 PROC-TRAN-DATE-GRP-YYYY   PIC 9999.
                 07 PROC-TRAN-DATE-GRP-MM     PIC 99.
                 07 PROC-TRAN-DATE-GRP-DD     PIC 99.
              05 PROC-TRAN-TIME               PIC 9(6).
              05 PROC-TRAN-TIME-GRP REDEFINES PROC-TRAN-TIME.
                 07 PROC-TRAN-TIME-GRP-HH     PIC 99.
                 07 PROC-TRAN-TIME-GRP-MM     PIC 99.
                 07 PROC-TRAN-TIME-GRP-SS     PIC 99.
              05 PROC-TRAN-REF                PIC 9(12).
              05 PROC-TRAN-TYPE               PIC X(3).
              88 PROC-TY-CHEQUE-ACKNOWLEDGED      VALUE 'CHA'.
              88 PROC-TY-CHEQUE-FAILURE           VALUE 'CHF'.
              88 PROC-TY-CHEQUE-PAID-IN           VALUE 'CHI'.
              88 PROC-TY-CHEQUE-PAID-OUT          VALUE 'CHO'.
              88 PROC-TY-CREDIT                   VALUE 'CRE'.
              88 PROC-TY-DEBIT                    VALUE 'DEB'.
              88 PROC-TY-WEB-CREATE-ACCOUNT       VALUE 'ICA'.
              88 PROC-TY-WEB-CREATE-CUSTOMER      VALUE 'ICC'.
              88 PROC-TY-WEB-DELETE-ACCOUNT       VALUE 'IDA'.
              88 PROC-TY-WEB-DELETE-CUSTOMER      VALUE 'IDC'.
              88 PROC-TY-BRANCH-CREATE-ACCOUNT    VALUE 'OCA'.
              88 PROC-TY-BRANCH-CREATE-CUSTOMER   VALUE 'OCC'.
              88 PROC-TY-BRANCH-DELETE-ACCOUNT    VALUE 'ODA'.
              88 PROC-TY-BRANCH-DELETE-CUSTOMER   VALUE 'ODC'.
              88 PROC-TY-CREATE-SODD              VALUE 'OCS'.
              88 PROC-TY-PAYMENT-CREDIT           VALUE 'PCR'.
              88 PROC-TY-PAYMENT-DEBIT            VALUE 'PDR'.
              88 PROC-TY-TRANSFER                 VALUE 'TFR'.
              05 PROC-TRAN-DESC               PIC X(40).
              05 PROC-TRAN-DESC-XFR REDEFINES PROC-TRAN-DESC.
                07 PROC-TRAN-DESC-XFR-HEADER PIC X(26).
                88 PROC-TRAN-DESC-XFR-FLAG
                   VALUE 'TRANSFER'.
                07 PROC-TRAN-DESC-XFR-SORTCODE
                   PIC 9(6).
                07 PROC-TRAN-DESC-XFR-ACCOUNT
                   PIC 9(8).
              05 PROC-TRAN-DESC-DELACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELACC-ACCTYPE PIC X(8).
                07 PROC-DESC-DELACC-LAST-DD PIC 99.
                07 PROC-DESC-DELACC-LAST-MM PIC 99.
                07 PROC-DESC-DELACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-DELACC-NEXT-DD PIC 99.
                07 PROC-DESC-DELACC-NEXT-MM PIC 99.
                07 PROC-DESC-DELACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-DELACC-FOOTER PIC X(6).
                88 PROC-DESC-DELACC-FLAG
                   VALUE 'DELETE'.
              05 PROC-TRAN-DESC-CREACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CREACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-CREACC-ACCTYPE PIC X(8).
                07 PROC-DESC-CREACC-LAST-DD PIC 99.
                07 PROC-DESC-CREACC-LAST-MM PIC 99.
                07 PROC-DESC-CREACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-CREACC-NEXT-DD PIC 99.
                07 PROC-DESC-CREACC-NEXT-MM PIC 99.
                07 PROC-DESC-CREACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-CREACC-FOOTER PIC X(6).
                88 PROC-DESC-CREACC-FLAG
                   VALUE 'CREATE'.
              05 PROC-TRAN-DESC-DELCUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELCUS-SORTCODE PIC 9(6).
                07 PROC-DESC-DELCUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELCUS-NAME     PIC X(14).
                07 PROC-DESC-DELCUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-DELCUS-FILLER    PIC X.
                88 PROC-DESC-DELCUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-MM    PIC 99.
                07 PROC-DESC-DELCUS-FILLER2   PIC X.
                88 PROC-DESC-DELCUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-DD    PIC 99.
              05 PROC-TRAN-DESC-CRECUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CRECUS-SORTCODE PIC 9(6).
                07 PROC-DESC-CRECUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-CRECUS-NAME     PIC X(14).
                07 PROC-DESC-CRECUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-CRECUS-FILLER    PIC X.
                88 PROC-DESC-CRECUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-MM    PIC 99.
                07 PROC-DESC-CRECUS-FILLER2   PIC X.
                88 PROC-DESC-CRECUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-DD    PIC 99.
              05 PROC-TRAN-AMOUNT             PIC S9(10)V99.
       01 PROCTRAN-RIDFLD               PIC S9(8) COMP.
       01 WS-CICS-WORK-AREA.
          05 WS-CICS-RESP               PIC S9(8) COMP.
          05 WS-CICS-RESP2              PIC S9(8) COMP.
       01 WS-CUSTOMER-NO-NUM            PIC 9(10).
       01 WS-TIME-DATA.
          03 WS-TIME-NOW                PIC 9(6).
          03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
             05 WS-TIME-NOW-GRP-HH      PIC 99.
             05 WS-TIME-NOW-GRP-MM      PIC 99.
             05 WS-TIME-NOW-GRP-SS      PIC 99.
       01 WS-ABEND-PGM                  PIC X(8)      VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LOCAL-STORAGE SECTION.
       01 FILE-RETRY                    PIC 999.
       01 WS-EXIT-RETRY-LOOP            PIC X         VALUE ' '.
       01 OUTPUT-DATA.
           03 CUSTOMER-RECORD.
              05 CUSTOMER-EYECATCHER                 PIC X(4).
                 88 CUSTOMER-EYECATCHER-VALUE        VALUE 'CUST'.
              05 CUSTOMER-KEY.
                 07 CUSTOMER-SORTCODE                PIC 9(6) DISPLAY.
                 07 CUSTOMER-NUMBER                  PIC 9(10) DISPLAY.
              05 CUSTOMER-NAME                       PIC X(60).
              05 CUSTOMER-ADDRESS                    PIC X(160).
              05 CUSTOMER-DATE-OF-BIRTH              PIC 9(8).
              05 CUSTOMER-DOB-GROUP REDEFINES CUSTOMER-DATE-OF-BIRTH.
                 07 CUSTOMER-BIRTH-DAY               PIC 99.
                 07 CUSTOMER-BIRTH-MONTH             PIC 99.
                 07 CUSTOMER-BIRTH-YEAR              PIC 9999.
              05 CUSTOMER-CREDIT-SCORE               PIC 999.
              05 CUSTOMER-CS-REVIEW-DATE             PIC 9(8).
              05 CUSTOMER-CS-GROUP
                 REDEFINES CUSTOMER-CS-REVIEW-DATE.
                 07 CUSTOMER-CS-REVIEW-DAY           PIC 99.
                 07 CUSTOMER-CS-REVIEW-MONTH         PIC 99.
                 07 CUSTOMER-CS-REVIEW-YEAR          PIC 9999.
       01 RETURN-DATA.
          03 RETURN-DATA-EYECATCHER     PIC X(4).
          03 RETURN-DATA-NUMBER         PIC 9(10) DISPLAY.
          03 RETURN-DATA-NAME           PIC X(60).
          03 RETURN-DATA-ADDRESS        PIC X(160).
          03 RETURN-DATA-DATE-OF-BIRTH  PIC 9(8).
       01 CUSTOMER-KY.
          03 REQUIRED-SORT-CODE         PIC 9(6)      VALUE 0.
          03 REQUIRED-CUST-NUMBER       PIC 9(10)     VALUE 0.
       01 RANDOM-CUSTOMER               PIC 9(10)     VALUE 0.
       01 HIGHEST-CUST-NUMBER           PIC 9(10)     VALUE 0.
       01 EXIT-VSAM-READ                PIC X         VALUE 'N'.
       01 EXIT-DB2-READ                 PIC X         VALUE 'N'.
       01 WS-V-RETRIED                  PIC X         VALUE 'N'.
       01 WS-D-RETRIED                  PIC X         VALUE 'N'.
       01 SQLCODE-DISPLAY               PIC S9(8) DISPLAY
             SIGN LEADING SEPARATE.
       01 NCS-CUST-NO-STUFF.
          03 NCS-CUST-NO-NAME.
             05 NCS-CUST-NO-ACT-NAME    PIC X(8)
                                                      VALUE 'CBSACUST'.
             05 NCS-CUST-NO-TEST-SORT   PIC X(6)
                                                      VALUE '      '.
             05 NCS-CUST-NO-FILL        PIC XX
                                                      VALUE '  '.
          03 NCS-CUST-NO-INC            PIC 9(16) COMP
                                                      VALUE 0.
          03 NCS-CUST-NO-VALUE          PIC 9(16) COMP
                                                      VALUE 0.
          03 NCS-CUST-NO-RESP           PIC XX        VALUE '00'.
       01 WS-DISP-CUST-NO-VAL           PIC S9(18) DISPLAY.
       01 WS-CUST-REC-LEN               PIC S9(4) COMP
                                                      VALUE 0.
       01 NCS-UPDATED                   PIC X         VALUE 'N'.
       01 WS-U-TIME                     PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                  PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD            PIC 99.
          03 FILLER                     PIC X.
          03 WS-ORIG-DATE-MM            PIC 99.
          03 FILLER                     PIC X.
          03 WS-ORIG-DATE-YYYY          PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X          PIC XX.
          03 FILLER                     PIC X         VALUE '.'.
          03 WS-ORIG-DATE-MM-X          PIC XX.
          03 FILLER                     PIC X         VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X        PIC X(4).
       01 STORED-SORTCODE               PIC X(6)      VALUE SPACES.
       01 STORED-CUSTNO                 PIC X(10)     VALUE SPACES.
       01 STORED-NAME                   PIC X(60)     VALUE SPACES.
       01 STORED-DOB                    PIC X(10)     VALUE SPACES.
       01 WS-EIBTASKN12                 PIC 9(12)     VALUE 0.
       77 PROCTRAN-RETRY                PIC 999.
       01 CUSTOMER-KY2.
          03 REQUIRED-SORT-CODE2        PIC 9(6)      VALUE 0.
          03 REQUIRED-CUST-NUMBER2      PIC 9(10)     VALUE 0.
       01 CUSTOMER-KY2-BYTES REDEFINES CUSTOMER-KY2
                                        PIC X(16).
       01 HIGHEST-CUST-NUMBER           PIC 9(10)     VALUE 0.
       01 WS-CC-CNT                     PIC 9         VALUE 0.
       01 WS-FINISHED-FETCHING          PIC X         VALUE 'N'.
       01 WS-RETRIEVED-CNT              PIC 9         VALUE 0.
       01 WS-CHANNEL-NAME               PIC X(16)     VALUE SPACES.
       01 WS-CREDIT-CHECK-ERROR         PIC X         VALUE 'N'.
       01 WS-ACTUAL-CS-SCR              PIC 9(6)      VALUE 0.
       01 WS-TOTAL-CS-SCR               PIC 9(6)      VALUE 0.
       01 WS-CHILD-TOKENS.
          03 WS-ANY-CHILD-TKN           PIC X(16).
          03 WS-ANY-CHILD-FETCH-TKN     PIC X(16).
       01 WS-ANY-CHILD-FETCH-CHAN       PIC X(16).
       01 WS-ANY-CHILD-FETCH-ABCODE     PIC X(4)      VALUE SPACES.
       01 WS-CHILD-ISSUED-CNT           PIC 9         VALUE 0.
       01 WS-CHILD-ARRAY.
          03 WS-CHILD-DETAILS OCCURS 9 TIMES.
             05 WS-CHILD-CHAN           PIC X(16).
             05 WS-CHILD-TKN            PIC X(16).
       01 WS-CHILD-RECEIVED-CNT         PIC 9         VALUE 0.
       01 WS-RECEIVE-CHILD-ARRAY.
          03 WS-RECEIVE-CHILD-DTLS OCCURS 9 TIMES.
             05 WS-RECEIVE-CHILD-CHAN   PIC X(16).
       01 WS-CHILD-FETCH-COMPST         PIC S9(8) COMP.
       01 WS-CHILD-DATA.
          03 WS-CHILD-DATA-EYECATCHER   PIC X(4).
          03 WS-CHLD-DATA-KEY.
             05 WS-CHILD-DATA-SORTCODE  PIC 9(6) DISPLAY.
             05 WS-CHILD-DATA-NUMBER    PIC 9(10) DISPLAY.
          03 WS-CHILD-DATA-NAME         PIC X(60).
          03 WS-CHILD-DATA-ADDRESS      PIC X(160).
          03 WS-CHILD-DATA-DATE-OF-BIRTH
                                        PIC 9(8).
          03 WS-CHILD-DATA-DOB-GROUP
                REDEFINES WS-CHILD-DATA-DATE-OF-BIRTH.
             05 WS-CHILD-DATA-BIRTH-DAY PIC 99.
             05 WS-CHILD-DATA-BIRTH-MONTH
                                        PIC 99.
             05 WS-CHILD-DATA-BIRTH-YEAR
                                        PIC 9999.
          03 WS-CHILD-DATA-CREDIT-SCORE PIC 999.
          03 WS-CHILD-DATA-CS-REVIEW-DATE
                                        PIC 9(8).
          03 WS-CHILD-DATA-SUCCESS      PIC X.
          03 WS-CHILD-DATA-FAIL-CODE    PIC X.
       01 WS-CONTAINER-NAME             PIC X(16)     VALUE SPACES.
       01 WS-CHILD-CONTAINER-LEN        PIC S9(8) COMP
                                                      VALUE 0.
       01 WS-RUN-TRANSID                PIC X(4)      VALUE SPACES.
       01 CICSTSLEVEL                   PIC X(6)      VALUE SPACES.
       01 WS-CICSTS-LEVEL-DATA.
          03 WS-CICSTSLEVEL             PIC X(6).
          03 WS-CICSTS-LEVEL-NUM-GRP REDEFINES WS-CICSTSLEVEL.
             05 WS-CICSTS-LEVEL-NUM-VV  PIC 99.
             05 WS-CICSTS-LEVEL-NUM-RR  PIC 99.
             05 WS-CICSTS-LEVEL-NUM-MM  PIC 99.
       01 WS-CURRENT-DATE-DATA.
          03 WS-CURRENT-DATE.
             05 WS-CURRENT-YYYY         PIC 9(4).
             05 WS-CURRENT-MM           PIC 99.
             05 WS-CURRENT-DD           PIC 99.
          03 WS-CURRENT-TIME.
             05 WS-CURRENT-HOURS        PIC 99.
             05 WS-CURRENT-MINS         PIC 99.
             05 WS-CURRENT-SECS         PIC 99.
             05 WS-CURRENT-MILLI        PIC 99.
          03 WS-DIFFERENCE-FROM-GMT     PIC S9(4).
       01 WS-CURRENT-DATE-9             PIC 9(8)      VALUE 0.
       01 WS-TODAY-INT                  PIC 9(8)      VALUE 0.
       01 WS-REVIEW-DATE-ADD            PIC 99        VALUE 0.
       01 WS-NEW-REVIEW-DATE-INT        PIC 9(8)      VALUE 0.
       01 WS-NEW-REVIEW-YYYYMMDD        PIC 9(8)      VALUE 0.
       01 WS-PUT-CONT-NAME              PIC X(16)     VALUE SPACES.
       01 WS-PUT-CONT-LEN               PIC S9(8) COMP
                                                      VALUE 0.
       01 WS-SEED                       PIC S9(15) COMP.
       01 STORM-DRAIN-CONDITION         PIC X(20).
       01 WS-DATE-OF-BIRTH-ERROR        PIC X         VALUE 'N'.
       01 WS-DATE-OF-BIRTH-LILLIAN      PIC S9(9) BINARY.
       01 DATE-OF-BIRTH-FORMAT.
          03 DATE-OF-BIRTH-FORMAT-LENGTH
                                        PIC S9(4) BINARY
                                                      VALUE 10.
          03 DATE-OF-BIRTH-FORMAT-TEXT  PIC X(8)      VALUE 'YYYYMMDD'.
       01 DATE-OF-BIRTH-FOR-CEEDAYS.
          03 DATE-OF-BIRTH-CEEDAYS-LENGTH
                                        PIC S9(4) BINARY
                                                      VALUE 10.
          03 CEEDAYS-YEAR               PIC 9999.
          03 CEEDAYS-MONTH              PIC 99.
          03 CEEDAYS-DAY                PIC 99.
       01 FC.
          02 CONDITION-TOKEN-VALUE.
             03 CASE-1-CONDITION-ID.
                04 SEVERITY             PIC S9(4) BINARY.
                04 MSG-NO               PIC S9(4) BINARY.
             03 CASE-2-CONDITION-ID
                   REDEFINES CASE-1-CONDITION-ID.
                04 CLASS-CODE           PIC S9(4) BINARY.
                04 CAUSE-CODE           PIC S9(4) BINARY.
             03 CASE-SEV-CTL            PIC X.
             03 FACILITY-ID             PIC XXX.
          02 I-S-INFO                   PIC S9(9) BINARY.
       01 WS-TODAY-LILLIAN              PIC S9(9) BINARY.
       01 WS-TODAY-SECONDS COMP-2.
       01 WS-TODAY-GREGORIAN.
          03 WS-TODAY-G-YEAR            PIC 9(4).
          03 WS-TODAY-G-MONTH           PIC 9(2).
          03 WS-TODAY-G-DAY             PIC 9(2).
          03 WS-TODAY-G-HOURS           PIC 9(2).
          03 WS-TODAY-G-MINUTES         PIC 9(2).
          03 WS-TODAY-G-SECONDS         PIC 9(2).
          03 WS-TODAY-G-MILLISECONDS    PIC 999.
       01 CHRDATE.
          02 VSTRING-LENGTH             PIC S9(4) BINARY.
          02 VSTRING-TEXT.
             03 VSTRING-CHAR            PIC X
                   OCCURS 0 TO 256 TIMES
                   DEPENDING ON VSTRING-LENGTH
                   OF CHRDATE.
       01 PICSTR.
          02 VSTRING-LENGTH             PIC S9(4) BINARY.
          02 VSTRING-TEXT.
             03 VSTRING-CHAR            PIC X
                   OCCURS 0 TO 256 TIMES
                   DEPENDING ON VSTRING-LENGTH
                   OF PICSTR.
       01 LILIAN                        PIC S9(9) BINARY.
       01 WS-CUSTOMER-AGE               PIC S9999.
       01 CUSTOMER-CONTROL.
           03 CUSTOMER-CONTROL-RECORD.
              05 CUSTOMER-CONTROL-EYECATCHER             PIC X(4).
                 88 CUSTOMER-CONTROL-EYECATCHER-V        VALUE 'CTRL'.
              05 CUSTOMER-CONTROL-KEY.
                 07 CUSTOMER-CONTROL-SORTCODE        PIC 9(6) DISPLAY.
                 07 CUSTOMER-CONTROL-NUMBER          PIC 9(10) DISPLAY.
              05 NUMBER-OF-CUSTOMERS                 PIC 9(10) DISPLAY.
              05 LAST-CUSTOMER-NUMBER                PIC 9(10) DISPLAY.
              05 CUSTOMER-CONTROL-SUCCESS-FLAG       PIC X.
              88 CUSTOMER-CONTROL-SUCCESS VALUE 'Y'.
              05 CUSTOMER-CONTROL-FAIL-CODE PIC X.
              05 FILLER                              PIC X(38).
              05 FILLER                              PIC X(160).
              05 FILLER                              PIC 9(8).
              05 FILLER                              PIC 999.
              05 FILLER                              PIC 9(8).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 COMM-EYECATCHER                 PIC X(4).
          03 COMM-KEY.
             05 COMM-SORTCODE                PIC 9(6) DISPLAY.
             05 COMM-NUMBER                  PIC 9(10) DISPLAY.
          03 COMM-NAME                       PIC X(60).
          03 COMM-ADDRESS                    PIC X(160).
          03 COMM-DATE-OF-BIRTH              PIC 9(8).
          03 COMM-DOB-GROUP REDEFINES COMM-DATE-OF-BIRTH.
             05 COMM-BIRTH-DAY               PIC 99.
             05 COMM-BIRTH-MONTH             PIC 99.
             05 COMM-BIRTH-YEAR              PIC 9999.
          03 COMM-CREDIT-SCORE               PIC 999.
          03 COMM-CS-REVIEW-DATE             PIC 9(8).
          03 COMM-CS-REVIEW-DATE-GROUP REDEFINES COMM-CS-REVIEW-DATE.
             05 COMM-CS-REVIEW-DD            PIC 99.
             05 COMM-CS-REVIEW-MM            PIC 99.
             05 COMM-CS-REVIEW-YYYY          PIC 9999.
          03 COMM-SUCCESS                    PIC X.
          03 COMM-FAIL-CODE                  PIC X.
","['PREMIERE', 'POPULATE-TIME-DATE', 'ENQ-NAMED-COUNTER', 'DEQ-NAMED-COUNTER', 'UPD-NCS', 'CREDIT-CHECK', 'WRITE-CUSTOMER-VSAM', 'WRITE-PROCTRAN', 'WRITE-PROCTRAN-DB2', 'GET-ME-OUT-OF-HERE', 'GET-LAST-CUSTOMER-VSAM', 'DATE-OF-BIRTH-CHECK', 'POPULATE-TIME-DATE2', 'P010', 'P999', 'PTD010', 'PTD999', 'ENC010', 'ENC999', 'DNC010', 'DNC999', 'UN010', 'UN999', 'CC010', 'CC999', 'WCV010', 'WCV999', 'WP010', 'WP999', 'WPD010', 'WPD999', 'GMOFH010', 'GMOFH999', 'GLCV010', 'GLCV999', 'DOBC010', 'DOBC999', 'PTD2010', 'PTD2999']","Paragraph PREMIERE calls paragraph WRITE-CUSTOMER-VSAM, CREDIT-CHECK, POPULATE-TIME-DATE, ENQ-NAMED-COUNTER, GET-ME-OUT-OF-HERE, DATE-OF-BIRTH-CHECK, UPD-NCS.
Paragraph ENQ-NAMED-COUNTER calls paragraph GET-ME-OUT-OF-HERE.
Paragraph DEQ-NAMED-COUNTER calls paragraph GET-ME-OUT-OF-HERE.
Paragraph UPD-NCS calls paragraph GET-LAST-CUSTOMER-VSAM.
Paragraph CREDIT-CHECK calls paragraph GET-ME-OUT-OF-HERE.
Paragraph WRITE-CUSTOMER-VSAM calls paragraph GET-ME-OUT-OF-HERE, DEQ-NAMED-COUNTER, WRITE-PROCTRAN.
Paragraph WRITE-PROCTRAN calls paragraph WRITE-PROCTRAN-DB2.
Paragraph WRITE-PROCTRAN-DB2 calls paragraph DEQ-NAMED-COUNTER, POPULATE-TIME-DATE2.
Paragraph GET-LAST-CUSTOMER-VSAM calls paragraph GET-ME-OUT-OF-HERE, DEQ-NAMED-COUNTER.
Paragraph DATE-OF-BIRTH-CHECK calls paragraph DOBC999.
",1110,"This program takes customer information from the BMS application (name, address and DOB) and should get the SORTCODE, determine which datastore to use (VSAM or DB2), then enqueue the counter for CUSTOMER, increment the counter and get that number. It then performs a credit check on multiple credit agencies (using Async API), waits for 3 seconds and aggregates and averages the returned credit scores. If no data is returned, from the credit checks, then set the credit score to 0 and mark the credit score review date as today (so another attempt at credit scoring will be carried out later). Next, attempt to update the CUSTOMER datastore & if that is successful, write a rec to the PROCTRAN datastore. If all of that works, then DEQUEUE the named counter and return the SORTCODE and CUSTOMER number. If for any reason the write to the CUSTOMER or PROCTRAN datatsore is unsuccessful, then we need to decrement the Named Counter (restoring it to the start position) and DEQUEUE the Named Counter.",['WS-ABEND-PGM'],,"['CUSTOMER', 'EXECCICSWRIT']",Error Long,0.75,1,1,"This COBOL program processes customer data, including credit checks and record updates. It starts by populating the date and time, checks resource status, and manages customer information through functions like updating and retrieving customer numbers. It performs credit assessments and conditionally handles errors via appropriate exit routines. Data is written to a VSAM file and a DB2 table, ensuring records are accurate and managing resource locks during transactions, followed by a systematic termination process.",
140,cicsdev_cics-banking-sample-application-cbsa,cics-banking-sample-application-cbsa/src/base/cobol_src/DBCRFUN.cbl,"       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)
       CBL CICS('SP,EDF')
       CBL SQL
       IDENTIFICATION DIVISION.
       PROGRAM-ID. DBCRFUN.
       AUTHOR. Jon Collett.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.  IBM-370.
       OBJECT-COMPUTER.  IBM-370.
       INPUT-OUTPUT SECTION.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       77 SORTCODE           PIC 9(6) VALUE 987654.
       77 SYSIDERR-RETRY                PIC 999.
           EXEC SQL
              INCLUDE ACCDB2
           END-EXEC.
       01 HOST-ACCOUNT-ROW.
          03 HV-ACCOUNT-EYECATCHER      PIC X(4).
          03 HV-ACCOUNT-CUST-NO         PIC X(10).
          03 HV-ACCOUNT-KEY.
             05 HV-ACCOUNT-SORTCODE     PIC X(6).
             05 HV-ACCOUNT-ACC-NO       PIC X(8).
          03 HV-ACCOUNT-ACC-TYPE        PIC X(8).
          03 HV-ACCOUNT-INT-RATE        PIC S9(4)V99 COMP-3.
          03 HV-ACCOUNT-OPENED          PIC X(10).
          03 HV-ACCOUNT-OVERDRAFT-LIM   PIC S9(9) COMP.
          03 HV-ACCOUNT-LAST-STMT       PIC X(10).
          03 HV-ACCOUNT-NEXT-STMT       PIC X(10).
          03 HV-ACCOUNT-AVAIL-BAL       PIC S9(10)V99 COMP-3.
          03 HV-ACCOUNT-ACTUAL-BAL      PIC S9(10)V99 COMP-3.
          EXEC SQL
             INCLUDE PROCDB2
          END-EXEC.
       01 HOST-PROCTRAN-ROW.
          03 HV-PROCTRAN-EYECATCHER     PIC X(4).
          03 HV-PROCTRAN-SORT-CODE      PIC X(6).
          03 HV-PROCTRAN-ACC-NUMBER     PIC X(8).
          03 HV-PROCTRAN-DATE           PIC X(10).
          03 HV-PROCTRAN-TIME           PIC X(6).
          03 HV-PROCTRAN-REF            PIC X(12).
          03 HV-PROCTRAN-TYPE           PIC X(3).
          03 HV-PROCTRAN-DESC           PIC X(40).
          03 HV-PROCTRAN-AMOUNT         PIC S9(10)V99 COMP-3.
       EXEC SQL
          INCLUDE SQLCA
       END-EXEC.
       01 WS-CICS-WORK-AREA.
          05 WS-CICS-RESP               PIC S9(8) COMP.
          05 WS-CICS-RESP2              PIC S9(8) COMP.
       LOCAL-STORAGE SECTION.
       01 FILE-RETRY                    PIC 999.
       01 WS-EXIT-RETRY-LOOP            PIC X         VALUE ' '.
       01 DB2-DATE-REFORMAT.
          03 DB2-DATE-REF-YR            PIC 9(4).
          03 FILLER                     PIC X.
          03 DB2-DATE-REF-MNTH          PIC 99.
          03 FILLER                     PIC X.
          03 DB2-DATE-REF-DAY           PIC 99.
       01 DATA-STORE-TYPE               PIC X.
          88 DATASTORE-TYPE-DLI                       VALUE '1'.
          88 DATASTORE-TYPE-DB2                       VALUE '2'.
          88 DATASTORE-TYPE-VSAM                      VALUE 'V'.
       01 WS-ACC-DATA.
              03 ACCOUNT-DATA.
                 05 ACCOUNT-EYE-CATCHER        PIC X(4).
                 88 ACCOUNT-EYECATCHER-VALUE        VALUE 'ACCT'.
                 05 ACCOUNT-CUST-NO            PIC 9(10).
                 05 ACCOUNT-KEY.
                    07 ACCOUNT-SORT-CODE       PIC 9(6).
                    07 ACCOUNT-NUMBER          PIC 9(8).
                 05 ACCOUNT-TYPE               PIC X(8).
                 05 ACCOUNT-INTEREST-RATE      PIC 9(4)V99.
                 05 ACCOUNT-OPENED             PIC 9(8).
                 05 ACCOUNT-OPENED-GROUP REDEFINES ACCOUNT-OPENED.
                    07 ACCOUNT-OPENED-DAY       PIC 99.
                    07 ACCOUNT-OPENED-MONTH     PIC 99.
                    07 ACCOUNT-OPENED-YEAR      PIC 9999.
                 05 ACCOUNT-OVERDRAFT-LIMIT    PIC 9(8).
                 05 ACCOUNT-LAST-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-LAST-STMT-GROUP
                    REDEFINES ACCOUNT-LAST-STMT-DATE.
                    07 ACCOUNT-LAST-STMT-DAY   PIC 99.
                    07 ACCOUNT-LAST-STMT-MONTH PIC 99.
                    07 ACCOUNT-LAST-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-NEXT-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-NEXT-STMT-GROUP
                   REDEFINES ACCOUNT-NEXT-STMT-DATE.
                    07 ACCOUNT-NEXT-STMT-DAY   PIC 99.
                    07 ACCOUNT-NEXT-STMT-MONTH PIC 99.
                    07 ACCOUNT-NEXT-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-AVAILABLE-BALANCE  PIC S9(10)V99.
                 05 ACCOUNT-ACTUAL-BALANCE     PIC S9(10)V99.
       01 WS-EIBTASKN12                 PIC 9(12)     VALUE 0.
       01 WS-SQLCODE-DISP               PIC 9(9)      VALUE 0.
       01 DESIRED-ACC-KEY.
          03 DESIRED-SORT-CODE          PIC 9(6).
          03 DESIRED-ACC-NO             PIC 9(8).
       01 NEW-ACCOUNT-AVAILABLE-BALANCE PIC S9(10)V99 VALUE 0.
       01 NEW-ACCOUNT-ACTUAL-BALANCE    PIC S9(10)V99 VALUE 0.
       01 WS-ACC-REC-LEN                PIC S9(4) COMP
                                                      VALUE 0.
       01 WS-U-TIME                     PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                  PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD            PIC 99.
          03 FILLER                     PIC X.
          03 WS-ORIG-DATE-MM            PIC 99.
          03 FILLER                     PIC X.
          03 WS-ORIG-DATE-YYYY          PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X          PIC XX.
          03 FILLER                     PIC X         VALUE '.'.
          03 WS-ORIG-DATE-MM-X          PIC XX.
          03 FILLER                     PIC X         VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X        PIC X(4).
       01 PROCTRAN-AREA.
           03 PROC-TRAN-DATA.
              05 PROC-TRAN-EYE-CATCHER        PIC X(4).
              88 PROC-TRAN-VALID VALUE 'PRTR'.
              05 PROC-TRAN-LOGICAL-DELETE-AREA REDEFINES
                 PROC-TRAN-EYE-CATCHER.
                 07 PROC-TRAN-LOGICAL-DELETE-FLAG PIC X.
                 88 PROC-TRAN-LOGICALLY-DELETED VALUE X'FF'.
                 07 FILLER PIC X(3).
              05 PROC-TRAN-ID.
                 07 PROC-TRAN-SORT-CODE       PIC 9(6).
                 07 PROC-TRAN-NUMBER          PIC 9(8).
              05 PROC-TRAN-DATE               PIC 9(8).
              05 PROC-TRAN-DATE-GRP REDEFINES PROC-TRAN-DATE.
                 07 PROC-TRAN-DATE-GRP-YYYY   PIC 9999.
                 07 PROC-TRAN-DATE-GRP-MM     PIC 99.
                 07 PROC-TRAN-DATE-GRP-DD     PIC 99.
              05 PROC-TRAN-TIME               PIC 9(6).
              05 PROC-TRAN-TIME-GRP REDEFINES PROC-TRAN-TIME.
                 07 PROC-TRAN-TIME-GRP-HH     PIC 99.
                 07 PROC-TRAN-TIME-GRP-MM     PIC 99.
                 07 PROC-TRAN-TIME-GRP-SS     PIC 99.
              05 PROC-TRAN-REF                PIC 9(12).
              05 PROC-TRAN-TYPE               PIC X(3).
              88 PROC-TY-CHEQUE-ACKNOWLEDGED      VALUE 'CHA'.
              88 PROC-TY-CHEQUE-FAILURE           VALUE 'CHF'.
              88 PROC-TY-CHEQUE-PAID-IN           VALUE 'CHI'.
              88 PROC-TY-CHEQUE-PAID-OUT          VALUE 'CHO'.
              88 PROC-TY-CREDIT                   VALUE 'CRE'.
              88 PROC-TY-DEBIT                    VALUE 'DEB'.
              88 PROC-TY-WEB-CREATE-ACCOUNT       VALUE 'ICA'.
              88 PROC-TY-WEB-CREATE-CUSTOMER      VALUE 'ICC'.
              88 PROC-TY-WEB-DELETE-ACCOUNT       VALUE 'IDA'.
              88 PROC-TY-WEB-DELETE-CUSTOMER      VALUE 'IDC'.
              88 PROC-TY-BRANCH-CREATE-ACCOUNT    VALUE 'OCA'.
              88 PROC-TY-BRANCH-CREATE-CUSTOMER   VALUE 'OCC'.
              88 PROC-TY-BRANCH-DELETE-ACCOUNT    VALUE 'ODA'.
              88 PROC-TY-BRANCH-DELETE-CUSTOMER   VALUE 'ODC'.
              88 PROC-TY-CREATE-SODD              VALUE 'OCS'.
              88 PROC-TY-PAYMENT-CREDIT           VALUE 'PCR'.
              88 PROC-TY-PAYMENT-DEBIT            VALUE 'PDR'.
              88 PROC-TY-TRANSFER                 VALUE 'TFR'.
              05 PROC-TRAN-DESC               PIC X(40).
              05 PROC-TRAN-DESC-XFR REDEFINES PROC-TRAN-DESC.
                07 PROC-TRAN-DESC-XFR-HEADER PIC X(26).
                88 PROC-TRAN-DESC-XFR-FLAG
                   VALUE 'TRANSFER'.
                07 PROC-TRAN-DESC-XFR-SORTCODE
                   PIC 9(6).
                07 PROC-TRAN-DESC-XFR-ACCOUNT
                   PIC 9(8).
              05 PROC-TRAN-DESC-DELACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELACC-ACCTYPE PIC X(8).
                07 PROC-DESC-DELACC-LAST-DD PIC 99.
                07 PROC-DESC-DELACC-LAST-MM PIC 99.
                07 PROC-DESC-DELACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-DELACC-NEXT-DD PIC 99.
                07 PROC-DESC-DELACC-NEXT-MM PIC 99.
                07 PROC-DESC-DELACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-DELACC-FOOTER PIC X(6).
                88 PROC-DESC-DELACC-FLAG
                   VALUE 'DELETE'.
              05 PROC-TRAN-DESC-CREACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CREACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-CREACC-ACCTYPE PIC X(8).
                07 PROC-DESC-CREACC-LAST-DD PIC 99.
                07 PROC-DESC-CREACC-LAST-MM PIC 99.
                07 PROC-DESC-CREACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-CREACC-NEXT-DD PIC 99.
                07 PROC-DESC-CREACC-NEXT-MM PIC 99.
                07 PROC-DESC-CREACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-CREACC-FOOTER PIC X(6).
                88 PROC-DESC-CREACC-FLAG
                   VALUE 'CREATE'.
              05 PROC-TRAN-DESC-DELCUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELCUS-SORTCODE PIC 9(6).
                07 PROC-DESC-DELCUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELCUS-NAME     PIC X(14).
                07 PROC-DESC-DELCUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-DELCUS-FILLER    PIC X.
                88 PROC-DESC-DELCUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-MM    PIC 99.
                07 PROC-DESC-DELCUS-FILLER2   PIC X.
                88 PROC-DESC-DELCUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-DD    PIC 99.
              05 PROC-TRAN-DESC-CRECUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CRECUS-SORTCODE PIC 9(6).
                07 PROC-DESC-CRECUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-CRECUS-NAME     PIC X(14).
                07 PROC-DESC-CRECUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-CRECUS-FILLER    PIC X.
                88 PROC-DESC-CRECUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-MM    PIC 99.
                07 PROC-DESC-CRECUS-FILLER2   PIC X.
                88 PROC-DESC-CRECUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-DD    PIC 99.
              05 PROC-TRAN-AMOUNT             PIC S9(10)V99.
       01 WS-PASSED-DATA.
          02 WS-TEST-KEY                PIC X(4).
          02 WS-SORT-CODE               PIC 9(6).
          02 WS-CUSTOMER-RANGE.
             07 WS-CUSTOMER-RANGE-TOP   PIC X.
             07 WS-CUSTOMER-RANGE-MIDDLE
                                        PIC X.
             07 WS-CUSTOMER-RANGE-BOTTOM
                                        PIC X.
       01 PROCTRAN-RIDFLD               PIC S9(8) COMP.
       01 SQLCODE-DISPLAY               PIC S9(8) DISPLAY
             SIGN LEADING SEPARATE.
       01 MY-ABEND-CODE                 PIC XXXX.
       01 WS-STORM-DRAIN                PIC X         VALUE 'N'.
       01 STORM-DRAIN-CONDITION         PIC X(20).
       01 NUMERIC-AMOUNT-DISPLAY        PIC +9(10).99.
       01 WS-TIME-DATA.
          03 WS-TIME-NOW                PIC 9(6).
          03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
             05 WS-TIME-NOW-GRP-HH      PIC 99.
             05 WS-TIME-NOW-GRP-MM      PIC 99.
             05 WS-TIME-NOW-GRP-SS      PIC 99.
       01 WS-ABEND-PGM                  PIC X(8)      VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       01 WS-SUFFICIENT-FUNDS           PIC X VALUE 'N'.
       01 WS-DIFFERENCE                 PIC S9(10)V99.
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 COMM-ACCNO               PIC X(8).
          03 COMM-AMT                 PIC S9(10)V99.
          03 COMM-SORTC               PIC 9(6).
          03 COMM-AV-BAL              PIC S9(10)V99.
          03 COMM-ACT-BAL             PIC S9(10)V99.
          03 COMM-ORIGIN.
               05 COMM-APPLID           PIC X(8).
               05 COMM-USERID           PIC X(8).
               05 COMM-FACILITY-NAME    PIC X(8).
               05 COMM-NETWRK-ID        PIC X(8).
               05 COMM-FACILTYPE        PIC S9(8) COMP.
               05 FILLER                PIC X(4).
          03 COMM-SUCCESS             PIC X.
          03 COMM-FAIL-CODE           PIC X.
       PROCEDURE DIVISION USING DFHCOMMAREA.
       PREMIERE SECTION.
       A010.
           MOVE 'N' TO COMM-SUCCESS
           MOVE '0' TO COMM-FAIL-CODE
           EXEC CICS HANDLE ABEND
              LABEL(ABEND-HANDLING)
           END-EXEC.
           MOVE SORTCODE TO COMM-SORTC.
           MOVE SORTCODE TO DESIRED-SORT-CODE.
            PERFORM UPDATE-ACCOUNT-DB2.
           PERFORM GET-ME-OUT-OF-HERE.
       A999.
           EXIT.
       UPDATE-ACCOUNT-DB2 SECTION.
       UAD010.
           MOVE COMM-ACCNO TO DESIRED-ACC-NO.
           MOVE DESIRED-SORT-CODE TO HV-ACCOUNT-SORTCODE.
           MOVE DESIRED-ACC-NO TO HV-ACCOUNT-ACC-NO.
           EXEC SQL
              SELECT ACCOUNT_EYECATCHER,
                     ACCOUNT_CUSTOMER_NUMBER,
                     ACCOUNT_SORTCODE,
                     ACCOUNT_NUMBER,
                     ACCOUNT_TYPE,
                     ACCOUNT_INTEREST_RATE,
                     ACCOUNT_OPENED,
                     ACCOUNT_OVERDRAFT_LIMIT,
                     ACCOUNT_LAST_STATEMENT,
                     ACCOUNT_NEXT_STATEMENT,
                     ACCOUNT_AVAILABLE_BALANCE,
                     ACCOUNT_ACTUAL_BALANCE
              INTO  :HV-ACCOUNT-EYECATCHER,
                    :HV-ACCOUNT-CUST-NO,
                    :HV-ACCOUNT-SORTCODE,
                    :HV-ACCOUNT-ACC-NO,
                    :HV-ACCOUNT-ACC-TYPE,
                    :HV-ACCOUNT-INT-RATE,
                    :HV-ACCOUNT-OPENED,
                    :HV-ACCOUNT-OVERDRAFT-LIM,
                    :HV-ACCOUNT-LAST-STMT,
                    :HV-ACCOUNT-NEXT-STMT,
                    :HV-ACCOUNT-AVAIL-BAL,
                    :HV-ACCOUNT-ACTUAL-BAL
              FROM ACCOUNT
              WHERE  (ACCOUNT_SORTCODE = :HV-ACCOUNT-SORTCODE AND
                      ACCOUNT_NUMBER = :HV-ACCOUNT-ACC-NO)
           END-EXEC.
           IF SQLCODE NOT = 0
              MOVE 'N' TO COMM-SUCCESS
              IF SQLCODE = +100
                 MOVE '1' TO COMM-FAIL-CODE
              ELSE
                 MOVE '2' TO COMM-FAIL-CODE
              END-IF
              PERFORM CHECK-FOR-STORM-DRAIN-DB2
              GO TO UAD999
           END-IF.
           IF COMM-AMT < 0
              IF (HV-ACCOUNT-ACC-TYPE = 'MORTGAGE'
              AND COMM-FACILTYPE = 496)
              OR (HV-ACCOUNT-ACC-TYPE = 'LOAN    '
              AND COMM-FACILTYPE = 496)
                 MOVE 'N' TO COMM-SUCCESS
                 MOVE '4' TO COMM-FAIL-CODE
                 GO TO UAD999
              END-IF
              MOVE 0 TO WS-DIFFERENCE
              COMPUTE WS-DIFFERENCE = HV-ACCOUNT-AVAIL-BAL
                 + COMM-AMT
              IF WS-DIFFERENCE < 0 AND COMM-FACILTYPE = 496
                 MOVE 'N' TO COMM-SUCCESS
                 MOVE '3' TO COMM-FAIL-CODE
                 GO TO UAD999
              END-IF
           END-IF.
           IF (HV-ACCOUNT-ACC-TYPE = 'MORTGAGE' AND
           COMM-FACILTYPE = 496)
           OR (HV-ACCOUNT-ACC-TYPE = 'LOAN    '
           AND COMM-FACILTYPE = 496)
              MOVE 'N' TO COMM-SUCCESS
              MOVE '4' TO COMM-FAIL-CODE
              GO TO UAD999
           END-IF.
           COMPUTE HV-ACCOUNT-AVAIL-BAL =
              HV-ACCOUNT-AVAIL-BAL + COMM-AMT.
           COMPUTE HV-ACCOUNT-ACTUAL-BAL =
              HV-ACCOUNT-ACTUAL-BAL + COMM-AMT.
           EXEC SQL
              UPDATE ACCOUNT
              SET ACCOUNT_EYECATCHER = :HV-ACCOUNT-EYECATCHER,
                  ACCOUNT_CUSTOMER_NUMBER = :HV-ACCOUNT-CUST-NO,
                  ACCOUNT_SORTCODE = :HV-ACCOUNT-SORTCODE,
                  ACCOUNT_NUMBER = :HV-ACCOUNT-ACC-NO,
                  ACCOUNT_TYPE = :HV-ACCOUNT-ACC-TYPE,
                  ACCOUNT_INTEREST_RATE = :HV-ACCOUNT-INT-RATE,
                  ACCOUNT_OPENED = :HV-ACCOUNT-OPENED,
                  ACCOUNT_OVERDRAFT_LIMIT = :HV-ACCOUNT-OVERDRAFT-LIM,
                  ACCOUNT_LAST_STATEMENT = :HV-ACCOUNT-LAST-STMT,
                  ACCOUNT_NEXT_STATEMENT = :HV-ACCOUNT-NEXT-STMT,
                  ACCOUNT_AVAILABLE_BALANCE = :HV-ACCOUNT-AVAIL-BAL,
                  ACCOUNT_ACTUAL_BALANCE = :HV-ACCOUNT-ACTUAL-BAL
              WHERE (ACCOUNT_SORTCODE = :HV-ACCOUNT-SORTCODE AND
                     ACCOUNT_NUMBER = :HV-ACCOUNT-ACC-NO)
           END-EXEC.
           MOVE SQLCODE TO SQLCODE-DISPLAY.
           MOVE HV-ACCOUNT-AVAIL-BAL TO
              COMM-AV-BAL.
           MOVE HV-ACCOUNT-ACTUAL-BAL TO
              COMM-ACT-BAL.
           IF SQLCODE NOT = 0
              MOVE 'N' TO COMM-SUCCESS
              MOVE '2' TO COMM-FAIL-CODE
              PERFORM CHECK-FOR-STORM-DRAIN-DB2
              GO TO UAD999
           END-IF.
           PERFORM WRITE-TO-PROCTRAN.
       UAD999.
           EXIT.
       WRITE-TO-PROCTRAN SECTION.
       WTP010.
            PERFORM WRITE-TO-PROCTRAN-DB2.
       WTP999.
           EXIT.
       WRITE-TO-PROCTRAN-DB2 SECTION.
       WTPD010.
           INITIALIZE HOST-PROCTRAN-ROW.
           INITIALIZE WS-EIBTASKN12.
           MOVE 'PRTR' TO HV-PROCTRAN-EYECATCHER.
           MOVE COMM-SORTC TO HV-PROCTRAN-SORT-CODE.
           MOVE COMM-ACCNO TO HV-PROCTRAN-ACC-NUMBER.
           MOVE EIBTASKN TO WS-EIBTASKN12.
           MOVE WS-EIBTASKN12 TO HV-PROCTRAN-REF.
           EXEC CICS ASKTIME
              ABSTIME(WS-U-TIME)
           END-EXEC.
           EXEC CICS FORMATTIME
                     ABSTIME(WS-U-TIME)
                     DDMMYYYY(WS-ORIG-DATE)
                     TIME(HV-PROCTRAN-TIME)
                     DATESEP('.')
           END-EXEC.
           MOVE WS-ORIG-DATE TO WS-ORIG-DATE-GRP-X.
           MOVE WS-ORIG-DATE-GRP-X TO HV-PROCTRAN-DATE.
           MOVE SPACES TO HV-PROCTRAN-DESC.
           IF COMM-AMT < 0
              MOVE 'DEB' TO HV-PROCTRAN-TYPE
              MOVE 'COUNTER WTHDRW' TO HV-PROCTRAN-DESC
              IF COMM-FACILTYPE = 496
                 MOVE 'PDR' TO HV-PROCTRAN-TYPE
                 MOVE COMM-ORIGIN(1:14) TO
                    HV-PROCTRAN-DESC
              END-IF
           ELSE
              MOVE 'CRE' TO HV-PROCTRAN-TYPE
              MOVE 'COUNTER RECVED' TO HV-PROCTRAN-DESC
              IF COMM-FACILTYPE = 496
                 MOVE 'PCR' TO HV-PROCTRAN-TYPE
                 MOVE COMM-ORIGIN(1:14) TO
                    HV-PROCTRAN-DESC
              END-IF
           END-IF.
           MOVE COMM-AMT TO HV-PROCTRAN-AMOUNT.
           EXEC SQL
              INSERT INTO PROCTRAN
                     (
                      PROCTRAN_EYECATCHER,
                      PROCTRAN_SORTCODE,
                      PROCTRAN_NUMBER,
                      PROCTRAN_DATE,
                      PROCTRAN_TIME,
                      PROCTRAN_REF,
                      PROCTRAN_TYPE,
                      PROCTRAN_DESC,
                      PROCTRAN_AMOUNT
                     )
              VALUES
                     (
                      :HV-PROCTRAN-EYECATCHER,
                      :HV-PROCTRAN-SORT-CODE,
                      :HV-PROCTRAN-ACC-NUMBER,
                      :HV-PROCTRAN-DATE,
                      :HV-PROCTRAN-TIME,
                      :HV-PROCTRAN-REF,
                      :HV-PROCTRAN-TYPE,
                      :HV-PROCTRAN-DESC,
                      :HV-PROCTRAN-AMOUNT
                     )
           END-EXEC.
           IF SQLCODE NOT = 0
              MOVE SQLCODE TO SQLCODE-DISPLAY
              DISPLAY 'UNABLE TO WRITE TO PROCTRAN DB2 DATASTORE'
              ' SQLCODE=' SQLCODE-DISPLAY
              'WITH THE FOLLOWING DATA:' HOST-PROCTRAN-ROW
              EXEC CICS SYNCPOINT ROLLBACK
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HROL'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'WTPD010 - COULD NOT ROLL BACK, POSSIBLE DATA'
                       DELIMITED BY SIZE,
                       'INTEGRITY ISSUE BETWEEN ACCOUNT AND PROCTRAN '
                       DELIMITED BY SIZE,
                       'FOR ROW:' DELIMITED BY SIZE,
                       HOST-PROCTRAN-ROW DELIMITED BY SIZE,
                       'EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 DISPLAY ' COULD NOT ROLL BACK, POSSIBLE DATA '
                    'INTEGRITY ISSUE BETWEEN ACCOUNT AND PROCTRAN '
                    'FOR ROW:' HOST-PROCTRAN-ROW
                    'RESP CODE=' WS-CICS-RESP ' RESP2 CODE='
                    WS-CICS-RESP2
                 EXEC CICS ABEND
                    ABCODE ('HROL')
                    CANCEL
                 END-EXEC
              END-IF
              MOVE 'N' TO COMM-SUCCESS
              MOVE '02' TO COMM-FAIL-CODE
              PERFORM CHECK-FOR-STORM-DRAIN-DB2
           ELSE
              MOVE 'Y' TO COMM-SUCCESS
              MOVE '0' TO COMM-FAIL-CODE
           END-IF.
       WTPD999.
           EXIT.
       GET-ME-OUT-OF-HERE SECTION.
       GMOOH010.
           EXEC CICS RETURN
           END-EXEC.
           GOBACK.
       GMOOH999.
           EXIT.
       CHECK-FOR-STORM-DRAIN-DB2 SECTION.
       CFSDD010.
           EVALUATE SQLCODE
              WHEN 923
                 MOVE 'DB2 Connection lost ' TO STORM-DRAIN-CONDITION
              WHEN OTHER
                 MOVE 'Not Storm Drain     ' TO STORM-DRAIN-CONDITION
           END-EVALUATE.
           IF STORM-DRAIN-CONDITION NOT EQUAL 'Not Storm Drain     '
              DISPLAY 'DBCRFUN: Check-For-Storm-Drain-DB2: Storm '
                      'Drain condition (' STORM-DRAIN-CONDITION ') '
                      'has been met (' SQLCODE-DISPLAY ').'
           ELSE
              CONTINUE
           END-IF.
       CFSDD999.
           EXIT.
       ABEND-HANDLING SECTION.
       AH010.
           EXEC CICS ASSIGN ABCODE(MY-ABEND-CODE)
           END-EXEC.
           EVALUATE MY-ABEND-CODE
              WHEN 'AD2Z'
                 MOVE SQLCODE TO SQLCODE-DISPLAY
                 DISPLAY 'DB2 DEADLOCK DETECTED IN DBCRFUN, SQLCODE='
                    SQLCODE-DISPLAY
                 DISPLAY 'DB2 DEADLOCK FOR ACCOUNT '
                   HV-ACCOUNT-ACC-NO
                 DISPLAY  'SQLSTATE=' SQLSTATE
                        ',SQLERRMC=' SQLERRMC(1:SQLERRML)
                        ',SQLERRD(1)=' SQLERRD(1)
                        ',SQLERRD(2)=' SQLERRD(2)
                        ',SQLERRD(3)=' SQLERRD(3)
                        ',SQLERRD(4)=' SQLERRD(4)
                        ',SQLERRD(5)=' SQLERRD(5)
                        ',SQLERRD(6)=' SQLERRD(6)
              WHEN 'AFCR'
              WHEN 'AFCS'
              WHEN 'AFCT'
                 MOVE 'Y' TO WS-STORM-DRAIN
                 DISPLAY 'DBCRFUN: Check-For-Storm-Drain-VSAM: Storm '
                        'Drain condition (Abend ' MY-ABEND-CODE ') '
                        'has been met.'
                 EXEC CICS SYNCPOINT
                    ROLLBACK
                    RESP(WS-CICS-RESP)
                    RESP2(WS-CICS-RESP2)
                 END-EXEC
                 IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                    INITIALIZE ABNDINFO-REC
                    MOVE EIBRESP    TO ABND-RESPCODE
                    MOVE EIBRESP2   TO ABND-RESP2CODE
                    EXEC CICS ASSIGN APPLID(ABND-APPLID)
                    END-EXEC
                    MOVE EIBTASKN   TO ABND-TASKNO-KEY
                    MOVE EIBTRNID   TO ABND-TRANID
                    PERFORM POPULATE-TIME-DATE
                    MOVE WS-ORIG-DATE TO ABND-DATE
                    STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                    END-STRING
                    MOVE WS-U-TIME   TO ABND-UTIME-KEY
                    MOVE 'HROL'      TO ABND-CODE
                    EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                    END-EXEC
                    MOVE ZEROS      TO ABND-SQLCODE
                    STRING 'AH010 - Unable to perform Synpoint '
                       DELIMITED BY SIZE,
                       'Rollback.' DELIMITED BY SIZE,
                       ' Possible Integrity issue following VSAM RLS '
                       DELIMITED BY SIZE,
                       'abend.' DELIMITED BY SIZE,
                       'EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                    END-STRING
                    EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                    END-EXEC
                    DISPLAY 'DBCRFUN: Unable to perform Synpoint '
                       'Rollback.'
                       ' Possible Integrity issue following VSAM RLS'
                       ' abend'
                       ' RESP CODE=' WS-CICS-RESP
                       ' RESP2 CODE=' WS-CICS-RESP2
                    EXEC CICS ABEND
                       ABCODE ('HROL')
                       CANCEL
                    END-EXEC
                 END-IF
                 MOVE 'N' TO COMM-SUCCESS
                 MOVE '2' TO COMM-FAIL-CODE
                 EXEC CICS RETURN
                 END-EXEC
           END-EVALUATE.
           IF WS-STORM-DRAIN = 'N'
              EXEC CICS ABEND
                 ABCODE( MY-ABEND-CODE)
                 NODUMP
                 CANCEL
              END-EXEC
           END-IF.
       AH999.
           EXIT.
       POPULATE-TIME-DATE SECTION.
       PTD10.
           EXEC CICS ASKTIME
              ABSTIME(WS-U-TIME)
           END-EXEC.
           EXEC CICS FORMATTIME
                     ABSTIME(WS-U-TIME)
                     DDMMYYYY(WS-ORIG-DATE)
                     TIME(WS-TIME-NOW)
                     DATESEP
           END-EXEC.
       PTD999.
           EXIT.
","       WORKING-STORAGE SECTION.
       77 SORTCODE           PIC 9(6) VALUE 987654.
       77 SYSIDERR-RETRY                PIC 999.
           EXEC SQL
              INCLUDE ACCDB2
           END-EXEC.
       01 HOST-ACCOUNT-ROW.
          03 HV-ACCOUNT-EYECATCHER      PIC X(4).
          03 HV-ACCOUNT-CUST-NO         PIC X(10).
          03 HV-ACCOUNT-KEY.
             05 HV-ACCOUNT-SORTCODE     PIC X(6).
             05 HV-ACCOUNT-ACC-NO       PIC X(8).
          03 HV-ACCOUNT-ACC-TYPE        PIC X(8).
          03 HV-ACCOUNT-INT-RATE        PIC S9(4)V99 COMP-3.
          03 HV-ACCOUNT-OPENED          PIC X(10).
          03 HV-ACCOUNT-OVERDRAFT-LIM   PIC S9(9) COMP.
          03 HV-ACCOUNT-LAST-STMT       PIC X(10).
          03 HV-ACCOUNT-NEXT-STMT       PIC X(10).
          03 HV-ACCOUNT-AVAIL-BAL       PIC S9(10)V99 COMP-3.
          03 HV-ACCOUNT-ACTUAL-BAL      PIC S9(10)V99 COMP-3.
          EXEC SQL
             INCLUDE PROCDB2
          END-EXEC.
       01 HOST-PROCTRAN-ROW.
          03 HV-PROCTRAN-EYECATCHER     PIC X(4).
          03 HV-PROCTRAN-SORT-CODE      PIC X(6).
          03 HV-PROCTRAN-ACC-NUMBER     PIC X(8).
          03 HV-PROCTRAN-DATE           PIC X(10).
          03 HV-PROCTRAN-TIME           PIC X(6).
          03 HV-PROCTRAN-REF            PIC X(12).
          03 HV-PROCTRAN-TYPE           PIC X(3).
          03 HV-PROCTRAN-DESC           PIC X(40).
          03 HV-PROCTRAN-AMOUNT         PIC S9(10)V99 COMP-3.
       EXEC SQL
          INCLUDE SQLCA
       END-EXEC.
       01 WS-CICS-WORK-AREA.
          05 WS-CICS-RESP               PIC S9(8) COMP.
          05 WS-CICS-RESP2              PIC S9(8) COMP.
       LOCAL-STORAGE SECTION.
       01 FILE-RETRY                    PIC 999.
       01 WS-EXIT-RETRY-LOOP            PIC X         VALUE ' '.
       01 DB2-DATE-REFORMAT.
          03 DB2-DATE-REF-YR            PIC 9(4).
          03 FILLER                     PIC X.
          03 DB2-DATE-REF-MNTH          PIC 99.
          03 FILLER                     PIC X.
          03 DB2-DATE-REF-DAY           PIC 99.
       01 DATA-STORE-TYPE               PIC X.
          88 DATASTORE-TYPE-DLI                       VALUE '1'.
          88 DATASTORE-TYPE-DB2                       VALUE '2'.
          88 DATASTORE-TYPE-VSAM                      VALUE 'V'.
       01 WS-ACC-DATA.
              03 ACCOUNT-DATA.
                 05 ACCOUNT-EYE-CATCHER        PIC X(4).
                 88 ACCOUNT-EYECATCHER-VALUE        VALUE 'ACCT'.
                 05 ACCOUNT-CUST-NO            PIC 9(10).
                 05 ACCOUNT-KEY.
                    07 ACCOUNT-SORT-CODE       PIC 9(6).
                    07 ACCOUNT-NUMBER          PIC 9(8).
                 05 ACCOUNT-TYPE               PIC X(8).
                 05 ACCOUNT-INTEREST-RATE      PIC 9(4)V99.
                 05 ACCOUNT-OPENED             PIC 9(8).
                 05 ACCOUNT-OPENED-GROUP REDEFINES ACCOUNT-OPENED.
                    07 ACCOUNT-OPENED-DAY       PIC 99.
                    07 ACCOUNT-OPENED-MONTH     PIC 99.
                    07 ACCOUNT-OPENED-YEAR      PIC 9999.
                 05 ACCOUNT-OVERDRAFT-LIMIT    PIC 9(8).
                 05 ACCOUNT-LAST-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-LAST-STMT-GROUP
                    REDEFINES ACCOUNT-LAST-STMT-DATE.
                    07 ACCOUNT-LAST-STMT-DAY   PIC 99.
                    07 ACCOUNT-LAST-STMT-MONTH PIC 99.
                    07 ACCOUNT-LAST-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-NEXT-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-NEXT-STMT-GROUP
                   REDEFINES ACCOUNT-NEXT-STMT-DATE.
                    07 ACCOUNT-NEXT-STMT-DAY   PIC 99.
                    07 ACCOUNT-NEXT-STMT-MONTH PIC 99.
                    07 ACCOUNT-NEXT-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-AVAILABLE-BALANCE  PIC S9(10)V99.
                 05 ACCOUNT-ACTUAL-BALANCE     PIC S9(10)V99.
       01 WS-EIBTASKN12                 PIC 9(12)     VALUE 0.
       01 WS-SQLCODE-DISP               PIC 9(9)      VALUE 0.
       01 DESIRED-ACC-KEY.
          03 DESIRED-SORT-CODE          PIC 9(6).
          03 DESIRED-ACC-NO             PIC 9(8).
       01 NEW-ACCOUNT-AVAILABLE-BALANCE PIC S9(10)V99 VALUE 0.
       01 NEW-ACCOUNT-ACTUAL-BALANCE    PIC S9(10)V99 VALUE 0.
       01 WS-ACC-REC-LEN                PIC S9(4) COMP
                                                      VALUE 0.
       01 WS-U-TIME                     PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                  PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD            PIC 99.
          03 FILLER                     PIC X.
          03 WS-ORIG-DATE-MM            PIC 99.
          03 FILLER                     PIC X.
          03 WS-ORIG-DATE-YYYY          PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X          PIC XX.
          03 FILLER                     PIC X         VALUE '.'.
          03 WS-ORIG-DATE-MM-X          PIC XX.
          03 FILLER                     PIC X         VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X        PIC X(4).
       01 PROCTRAN-AREA.
           03 PROC-TRAN-DATA.
              05 PROC-TRAN-EYE-CATCHER        PIC X(4).
              88 PROC-TRAN-VALID VALUE 'PRTR'.
              05 PROC-TRAN-LOGICAL-DELETE-AREA REDEFINES
                 PROC-TRAN-EYE-CATCHER.
                 07 PROC-TRAN-LOGICAL-DELETE-FLAG PIC X.
                 88 PROC-TRAN-LOGICALLY-DELETED VALUE X'FF'.
                 07 FILLER PIC X(3).
              05 PROC-TRAN-ID.
                 07 PROC-TRAN-SORT-CODE       PIC 9(6).
                 07 PROC-TRAN-NUMBER          PIC 9(8).
              05 PROC-TRAN-DATE               PIC 9(8).
              05 PROC-TRAN-DATE-GRP REDEFINES PROC-TRAN-DATE.
                 07 PROC-TRAN-DATE-GRP-YYYY   PIC 9999.
                 07 PROC-TRAN-DATE-GRP-MM     PIC 99.
                 07 PROC-TRAN-DATE-GRP-DD     PIC 99.
              05 PROC-TRAN-TIME               PIC 9(6).
              05 PROC-TRAN-TIME-GRP REDEFINES PROC-TRAN-TIME.
                 07 PROC-TRAN-TIME-GRP-HH     PIC 99.
                 07 PROC-TRAN-TIME-GRP-MM     PIC 99.
                 07 PROC-TRAN-TIME-GRP-SS     PIC 99.
              05 PROC-TRAN-REF                PIC 9(12).
              05 PROC-TRAN-TYPE               PIC X(3).
              88 PROC-TY-CHEQUE-ACKNOWLEDGED      VALUE 'CHA'.
              88 PROC-TY-CHEQUE-FAILURE           VALUE 'CHF'.
              88 PROC-TY-CHEQUE-PAID-IN           VALUE 'CHI'.
              88 PROC-TY-CHEQUE-PAID-OUT          VALUE 'CHO'.
              88 PROC-TY-CREDIT                   VALUE 'CRE'.
              88 PROC-TY-DEBIT                    VALUE 'DEB'.
              88 PROC-TY-WEB-CREATE-ACCOUNT       VALUE 'ICA'.
              88 PROC-TY-WEB-CREATE-CUSTOMER      VALUE 'ICC'.
              88 PROC-TY-WEB-DELETE-ACCOUNT       VALUE 'IDA'.
              88 PROC-TY-WEB-DELETE-CUSTOMER      VALUE 'IDC'.
              88 PROC-TY-BRANCH-CREATE-ACCOUNT    VALUE 'OCA'.
              88 PROC-TY-BRANCH-CREATE-CUSTOMER   VALUE 'OCC'.
              88 PROC-TY-BRANCH-DELETE-ACCOUNT    VALUE 'ODA'.
              88 PROC-TY-BRANCH-DELETE-CUSTOMER   VALUE 'ODC'.
              88 PROC-TY-CREATE-SODD              VALUE 'OCS'.
              88 PROC-TY-PAYMENT-CREDIT           VALUE 'PCR'.
              88 PROC-TY-PAYMENT-DEBIT            VALUE 'PDR'.
              88 PROC-TY-TRANSFER                 VALUE 'TFR'.
              05 PROC-TRAN-DESC               PIC X(40).
              05 PROC-TRAN-DESC-XFR REDEFINES PROC-TRAN-DESC.
                07 PROC-TRAN-DESC-XFR-HEADER PIC X(26).
                88 PROC-TRAN-DESC-XFR-FLAG
                   VALUE 'TRANSFER'.
                07 PROC-TRAN-DESC-XFR-SORTCODE
                   PIC 9(6).
                07 PROC-TRAN-DESC-XFR-ACCOUNT
                   PIC 9(8).
              05 PROC-TRAN-DESC-DELACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELACC-ACCTYPE PIC X(8).
                07 PROC-DESC-DELACC-LAST-DD PIC 99.
                07 PROC-DESC-DELACC-LAST-MM PIC 99.
                07 PROC-DESC-DELACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-DELACC-NEXT-DD PIC 99.
                07 PROC-DESC-DELACC-NEXT-MM PIC 99.
                07 PROC-DESC-DELACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-DELACC-FOOTER PIC X(6).
                88 PROC-DESC-DELACC-FLAG
                   VALUE 'DELETE'.
              05 PROC-TRAN-DESC-CREACC REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CREACC-CUSTOMER PIC 9(10).
                07 PROC-DESC-CREACC-ACCTYPE PIC X(8).
                07 PROC-DESC-CREACC-LAST-DD PIC 99.
                07 PROC-DESC-CREACC-LAST-MM PIC 99.
                07 PROC-DESC-CREACC-LAST-YYYY PIC 9999.
                07 PROC-DESC-CREACC-NEXT-DD PIC 99.
                07 PROC-DESC-CREACC-NEXT-MM PIC 99.
                07 PROC-DESC-CREACC-NEXT-YYYY PIC 9999.
                07 PROC-DESC-CREACC-FOOTER PIC X(6).
                88 PROC-DESC-CREACC-FLAG
                   VALUE 'CREATE'.
              05 PROC-TRAN-DESC-DELCUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-DELCUS-SORTCODE PIC 9(6).
                07 PROC-DESC-DELCUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-DELCUS-NAME     PIC X(14).
                07 PROC-DESC-DELCUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-DELCUS-FILLER    PIC X.
                88 PROC-DESC-DELCUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-MM    PIC 99.
                07 PROC-DESC-DELCUS-FILLER2   PIC X.
                88 PROC-DESC-DELCUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-DELCUS-DOB-DD    PIC 99.
              05 PROC-TRAN-DESC-CRECUS REDEFINES PROC-TRAN-DESC.
                07 PROC-DESC-CRECUS-SORTCODE PIC 9(6).
                07 PROC-DESC-CRECUS-CUSTOMER PIC 9(10).
                07 PROC-DESC-CRECUS-NAME     PIC X(14).
                07 PROC-DESC-CRECUS-DOB-YYYY  PIC 9999.
                07 PROC-DESC-CRECUS-FILLER    PIC X.
                88 PROC-DESC-CRECUS-FILLER-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-MM    PIC 99.
                07 PROC-DESC-CRECUS-FILLER2   PIC X.
                88 PROC-DESC-CRECUS-FILLER2-SET VALUE '-'.
                07 PROC-DESC-CRECUS-DOB-DD    PIC 99.
              05 PROC-TRAN-AMOUNT             PIC S9(10)V99.
       01 WS-PASSED-DATA.
          02 WS-TEST-KEY                PIC X(4).
          02 WS-SORT-CODE               PIC 9(6).
          02 WS-CUSTOMER-RANGE.
             07 WS-CUSTOMER-RANGE-TOP   PIC X.
             07 WS-CUSTOMER-RANGE-MIDDLE
                                        PIC X.
             07 WS-CUSTOMER-RANGE-BOTTOM
                                        PIC X.
       01 PROCTRAN-RIDFLD               PIC S9(8) COMP.
       01 SQLCODE-DISPLAY               PIC S9(8) DISPLAY
             SIGN LEADING SEPARATE.
       01 MY-ABEND-CODE                 PIC XXXX.
       01 WS-STORM-DRAIN                PIC X         VALUE 'N'.
       01 STORM-DRAIN-CONDITION         PIC X(20).
       01 NUMERIC-AMOUNT-DISPLAY        PIC +9(10).99.
       01 WS-TIME-DATA.
          03 WS-TIME-NOW                PIC 9(6).
          03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
             05 WS-TIME-NOW-GRP-HH      PIC 99.
             05 WS-TIME-NOW-GRP-MM      PIC 99.
             05 WS-TIME-NOW-GRP-SS      PIC 99.
       01 WS-ABEND-PGM                  PIC X(8)      VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       01 WS-SUFFICIENT-FUNDS           PIC X VALUE 'N'.
       01 WS-DIFFERENCE                 PIC S9(10)V99.
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 COMM-ACCNO               PIC X(8).
          03 COMM-AMT                 PIC S9(10)V99.
          03 COMM-SORTC               PIC 9(6).
          03 COMM-AV-BAL              PIC S9(10)V99.
          03 COMM-ACT-BAL             PIC S9(10)V99.
          03 COMM-ORIGIN.
               05 COMM-APPLID           PIC X(8).
               05 COMM-USERID           PIC X(8).
               05 COMM-FACILITY-NAME    PIC X(8).
               05 COMM-NETWRK-ID        PIC X(8).
               05 COMM-FACILTYPE        PIC S9(8) COMP.
               05 FILLER                PIC X(4).
          03 COMM-SUCCESS             PIC X.
          03 COMM-FAIL-CODE           PIC X.
","['PREMIERE', 'UPDATE-ACCOUNT-DB2', 'WRITE-TO-PROCTRAN', 'WRITE-TO-PROCTRAN-DB2', 'GET-ME-OUT-OF-HERE', 'CHECK-FOR-STORM-DRAIN-DB2', 'ABEND-HANDLING', 'POPULATE-TIME-DATE', 'A010', 'A999', 'UAD010', 'UAD999', 'WTP010', 'WTP999', 'WTPD010', 'WTPD999', 'GMOOH010', 'GMOOH999', 'CFSDD010', 'CFSDD999', 'AH010', 'AH999', 'PTD10', 'PTD999']","Paragraph PREMIERE calls paragraph GET-ME-OUT-OF-HERE, UPDATE-ACCOUNT-DB2.
Paragraph UPDATE-ACCOUNT-DB2 calls paragraph UAD999, CHECK-FOR-STORM-DRAIN-DB2, WRITE-TO-PROCTRAN.
Paragraph WRITE-TO-PROCTRAN calls paragraph WRITE-TO-PROCTRAN-DB2.
Paragraph WRITE-TO-PROCTRAN-DB2 calls paragraph POPULATE-TIME-DATE, CHECK-FOR-STORM-DRAIN-DB2.
Paragraph ABEND-HANDLING calls paragraph POPULATE-TIME-DATE.
",658,"This program will get called when someone pays some cash in to the bank over the counter or takes out some cash out over the counter. This program takes an account number and amount, it then accesses the DB2 datastore and retrieves the associated Account record and applies the amount and returns the updated actual amount and the available balance from the Account datastore. If the update is successfully applied to the Account then a record is written to the PROCTRAN (Processed Transaction) datastore. If the transaction cannot be successfullty applied to the Account datastore, because the account no longer exists (for example) then the SUCCESS flag is set to 'N' and a fail code gets written to the return data, for the calling routine to handle.",['WS-ABEND-PGM'],,,Error Long,0.5,1,1,"This COBOL program manages account sorting and updates in a DB2 database, ensuring robustness through CICS error handling. It begins by terminating the program using GET-ME-OUT-OF-HERE, then updates accounts and checks for storm drain conditions. It also includes WRITE-TO-PROCTRAN, which writes to PROCTRAN in the database, invoking WRITE-TO-PROCTRAN-DB2 for the data insert and populating the current time and date. Additionally, it handles abnormal terminations through ABEND-HANDLING.",
143,cicsdev_cics-banking-sample-application-cbsa,cics-banking-sample-application-cbsa/src/base/cobol_src/BNK1CAC.cbl,"       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)
       CBL CICS('SP,EDF')
       IDENTIFICATION DIVISION.
       PROGRAM-ID. BNK1CAC.
       AUTHOR. Jon Collett.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.  IBM-370.
       OBJECT-COMPUTER.  IBM-370.
       INPUT-OUTPUT SECTION.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01 WS-CICS-WORK-AREA.
          03 WS-CICS-RESP              PIC S9(8) COMP VALUE 0.
          03 WS-CICS-RESP2             PIC S9(8) COMP VALUE 0.
       01 WS-FAIL-INFO.
          03 FILLER                    PIC X(9)  VALUE 'BNK1CAC  '.
          03 WS-CICS-FAIL-MSG          PIC X(70) VALUE ' '.
          03 FILLER                    PIC X(6)  VALUE ' RESP='.
          03 WS-CICS-RESP-DISP         PIC 9(10) VALUE 0.
          03 FILLER                    PIC X(7)  VALUE ' RESP2='.
          03 WS-CICS-RESP2-DISP        PIC 9(10) VALUE 0.
          03 FILLER                    PIC X(15)
                                          VALUE ' ABENDING TASK.'.
       01 SWITCHES.
           03 VALID-DATA-SW            PIC X VALUE 'Y'.
              88 VALID-DATA               VALUE 'Y'.
       01 FLAGS.
           03 SEND-FLAG                PIC X.
              88 SEND-ERASE               VALUE '1'.
              88 SEND-DATAONLY            VALUE '2'.
              88 SEND-DATAONLY-ALARM      VALUE '3'.
       01 ACTION-ALPHA.
           03 ACTION-NUM               PIC 9.
       01 END-OF-SESSION-MESSAGE       PIC X(13) VALUE 'Session Ended'.
       01 RESPONSE-CODE                PIC S9(8) COMP.
       01 COMMUNICATION-AREA           PIC X.
       01 COMM-DOB-SPLIT.
          03 COMM-DOB-SPLIT-DD         PIC 99.
          03 COMM-DOB-SPLIT-MM         PIC 99.
          03 COMM-DOB-SPLIT-YYYY       PIC 9999.
       01 WS-COMM-AREA.
          03 WS-COMM-CUSTNO            PIC 9(10).
          03 WS-COMM-ACCTYPE           PIC X(8).
          03 WS-COMM-INTRT             PIC 9(4)V99.
          03 WS-COMM-OVERDR            PIC 9(8).
       01 DATE-REFORMED.
          03 NSTMTDD-CHAR             PIC XX.
          03 NSTMTDD-REFORM REDEFINES NSTMTDD-CHAR.
             05 NSTMTDD-NUM              PIC 99.
          03 NSTMTMMI-CHAR               PIC XX.
          03 NSTMTMMI-REFORM REDEFINES NSTMTMMI-CHAR.
             05 NSTMTMMI-NUM             PIC 99.
          03 NSTMTYYI-CHAR               PIC XX.
          03 NSTMTYYI-REFORM REDEFINES NSTMTYYI-CHAR.
             05 NSTMTYYI-NUM             PIC 99.
       01 MORE-STRING-CONVS.
          03 NST-CHAR                  PIC X(8).
          03 NST-DATE-GRP REDEFINES NST-CHAR.
             05 NST-NUM                PIC 9(8).
       01 INTRTI-COMP-1 USAGE COMP-1.
       01 INTRT-PIC9                   PIC 9999.99.
       01 WS-NUM-COUNT-POINT           PIC S9(8) BINARY.
       01 WS-NUM-COUNT-TOTAL           PIC S9(8) BINARY.
       01 WS-REVERSE                   PIC X(8).
       01 SUBPGM-PARMS.
          03 SUBPGM-EYECATCHER         PIC X(4).
          03 SUBPGM-CUSTNO             PIC 9(10).
          03 SUBPGM-KEY.
             05 SUBPGM-SORTCODE        PIC 9(6) DISPLAY.
             05 SUBPGM-NUMBER          PIC 9(8) DISPLAY.
          03 SUBPGM-ACC-TYPE           PIC X(8).
          03 SUBPGM-INT-RT             PIC 9(4)V99.
          03 SUBPGM-OPENED             PIC 9(8).
          03 SUBPGM-OVERDR-LIM         PIC 9(8).
          03 SUBPGM-LAST-STMT-DT       PIC 9(8).
          03 SUBPGM-NEXT-STMT-DT       PIC 9(8).
          03 SUBPGM-AVAIL-BAL          PIC S9(10)V99.
          03 SUBPGM-ACT-BAL            PIC S9(10)V99.
          03 SUBPGM-SUCCESS            PIC X.
          03 SUBPGM-FAIL-CODE          PIC X.
       01 COMPANY-NAME-FULL            PIC X(32).
       01 AVAILABLE-BALANCE-DISPLAY    PIC +9(10).99.
       01 ACTUAL-BALANCE-DISPLAY       PIC +9(10).99.
       01 WS-U-TIME                    PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                 PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD           PIC 99.
          03 FILLER                    PIC X.
          03 WS-ORIG-DATE-MM           PIC 99.
          03 FILLER                    PIC X.
          03 WS-ORIG-DATE-YYYY         PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-MM-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X       PIC X(4).
       01 WS-TIME-DATA.
           03 WS-TIME-NOW              PIC 9(6).
           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
              05 WS-TIME-NOW-GRP-HH       PIC 99.
              05 WS-TIME-NOW-GRP-MM       PIC 99.
              05 WS-TIME-NOW-GRP-SS       PIC 99.
       01 WS-ABEND-PGM                 PIC X(8) VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 COMM-CUSTNO            PIC 9(10).
          03 COMM-ACCTYPE           PIC X(8).
          03 COMM-INTRT             PIC 9(4)V99.
          03 COMM-OVERDR            PIC 9(8).
       PROCEDURE DIVISION USING DFHCOMMAREA.
       PREMIERE SECTION.
       A010.
           EVALUATE TRUE
              WHEN EIBCALEN = ZERO
                 MOVE LOW-VALUE TO BNK1CAO
                 MOVE -1 TO CUSTNOL
                 SET SEND-ERASE TO TRUE
                 MOVE SPACES TO MESSAGEO
                 PERFORM SEND-MAP
              WHEN EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
                 CONTINUE
              WHEN EIBAID = DFHPF3
                 EXEC CICS RETURN
                    TRANSID('OMEN')
                    IMMEDIATE
                    RESP(WS-CICS-RESP)
                    RESP2(WS-CICS-RESP2)
                 END-EXEC
              WHEN EIBAID = DFHAID OR DFHPF12
                 PERFORM SEND-TERMINATION-MSG
                 EXEC CICS
                    RETURN
                 END-EXEC
              WHEN EIBAID = DFHCLEAR
                 EXEC CICS SEND CONTROL
                          ERASE
                          FREEKB
                 END-EXEC
                 EXEC CICS RETURN
                 END-EXEC
              WHEN EIBAID = DFHENTER
                 PERFORM PROCESS-MAP
              WHEN OTHER
                 MOVE LOW-VALUES TO BNK1CAO
                 MOVE SPACES TO MESSAGEO
                 MOVE 'Invalid key pressed.' TO MESSAGEO
                 SET SEND-DATAONLY-ALARM TO TRUE
                 PERFORM SEND-MAP
           END-EVALUATE.
            IF EIBCALEN NOT = 0
               MOVE SUBPGM-CUSTNO     TO WS-COMM-CUSTNO
               MOVE SUBPGM-ACC-TYPE   TO WS-COMM-ACCTYPE
               MOVE SUBPGM-INT-RT     TO WS-COMM-INTRT
               MOVE SUBPGM-OVERDR-LIM TO WS-COMM-OVERDR
            ELSE
               INITIALIZE WS-COMM-AREA
            END-IF.
            EXEC CICS
               RETURN TRANSID('OCAC')
               COMMAREA(WS-COMM-AREA)
               LENGTH(32)
               RESP(WS-CICS-RESP)
               RESP2(WS-CICS-RESP2)
            END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1CAC - A010 - RETURN TRANSID(OCAC) FAIL' TO
                 WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                INITIALIZE ABNDINFO-REC
                MOVE EIBRESP    TO ABND-RESPCODE
                MOVE EIBRESP2   TO ABND-RESP2CODE
                EXEC CICS ASSIGN APPLID(ABND-APPLID)
                END-EXEC
                MOVE EIBTASKN   TO ABND-TASKNO-KEY
                MOVE EIBTRNID   TO ABND-TRANID
                PERFORM POPULATE-TIME-DATE
                MOVE WS-ORIG-DATE TO ABND-DATE
                STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                       INTO ABND-TIME
                END-STRING
                MOVE WS-U-TIME   TO ABND-UTIME-KEY
                MOVE 'HBNK'      TO ABND-CODE
                EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                END-EXEC
                MOVE ZEROS      TO ABND-SQLCODE
                STRING 'A010- RETURN TRANSID(OCAC) ' DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                END-STRING
                EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                          COMMAREA(ABNDINFO-REC)
                END-EXEC
                PERFORM ABEND-THIS-TASK
           END-IF.
       A999.
           EXIT.
       PROCESS-MAP SECTION.
       PM010.
           PERFORM RECEIVE-MAP.
           PERFORM EDIT-DATA.
           IF VALID-DATA
              PERFORM CRE-ACC-DATA
           END-IF.
           SET SEND-DATAONLY-ALARM TO TRUE.
           PERFORM SEND-MAP.
       PM999.
           EXIT.
       RECEIVE-MAP SECTION.
       RM010.
           EXEC CICS
              RECEIVE MAP('BNK1CA')
              MAPSET('BNK1CAM')
              INTO(BNK1CAI)
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1CAC - RM010 - RECEIVE MAP FAIL ' TO
                 WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'RM010 - RECEIVE MAP FAIL ' DELIMITED BY SIZE,
                     ' EIBRESP=' DELIMITED BY SIZE,
                     ABND-RESPCODE DELIMITED BY SIZE,
                     ' RESP2=' DELIMITED BY SIZE,
                     ABND-RESP2CODE DELIMITED BY SIZE
                     INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                          COMMAREA(ABNDINFO-REC)
              END-EXEC
              PERFORM ABEND-THIS-TASK
           END-IF.
       RM999.
           EXIT.
       EDIT-DATA SECTION.
       ED010.
           EXEC CICS BIF DEEDIT
              FIELD(CUSTNOI)
           END-EXEC.
           IF CUSTNOL < 1 OR CUSTNOI = '__________'
              MOVE SPACES TO MESSAGEO
              STRING 'Please enter a 10 digit Customer Number '
                    DELIMITED BY SIZE,
                     ' ' DELIMITED BY SIZE
                 INTO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO CUSTNOL
              GO TO ED999
           END-IF.
           IF CUSTNOI NOT NUMERIC
              MOVE SPACES TO MESSAGEO
              STRING 'Please enter a numeric Customer number '
                    DELIMITED BY SIZE,
                     ' ' DELIMITED BY SIZE
                 INTO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO CUSTNOL
              GO TO ED999
           END-IF.
           IF ACCTYPI = '________' OR ACCTYPL < 1
              MOVE SPACES TO MESSAGEO
              STRING 'Account Type should be ISA,CURRENT,LOAN,'
                 DELIMITED BY SIZE,
                    'SAVING or MORTGAGE' DELIMITED BY SIZE
                 INTO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              move -1 to acctypl
              GO TO ED999
           END-IF.
           MOVE SPACES TO MESSAGEO.
           IF ACCTYPL > 0
              EVALUATE ACCTYPI
                 WHEN 'ISA_____'
                    MOVE 'ISA     ' TO ACCTYPI
                    CONTINUE
                 WHEN 'isa_____'
                    MOVE 'ISA     ' TO ACCTYPI
                    CONTINUE
                 WHEN 'ISA     '
                    CONTINUE
                 WHEN 'isa     '
                    MOVE 'ISA     ' TO ACCTYPI
                    CONTINUE
                 WHEN 'CURRENT_'
                    MOVE 'CURRENT ' TO ACCTYPI
                    CONTINUE
                 WHEN 'current_'
                    MOVE 'CURRENT ' TO ACCTYPI
                    CONTINUE
                 WHEN 'CURRENT '
                    CONTINUE
                 WHEN 'current '
                    MOVE 'CURRENT ' TO ACCTYPI
                    CONTINUE
                 WHEN 'LOAN____'
                    MOVE 'LOAN    ' TO ACCTYPI
                    CONTINUE
                 WHEN 'loan____'
                    MOVE 'LOAN    ' TO ACCTYPI
                    CONTINUE
                 WHEN 'loan    '
                    MOVE 'LOAN    ' TO ACCTYPI
                    CONTINUE
                 WHEN 'LOAN    '
                    CONTINUE
                 WHEN 'SAVING__'
                    MOVE 'SAVING  ' TO ACCTYPI
                    CONTINUE
                 WHEN 'saving__'
                    MOVE 'SAVING  ' TO ACCTYPI
                    CONTINUE
                 WHEN 'saving  '
                    MOVE 'SAVING  ' TO ACCTYPI
                    CONTINUE
                 WHEN 'SAVING  '
                    CONTINUE
                 WHEN 'MORTGAGE'
                    CONTINUE
                 WHEN 'mortgage'
                    MOVE 'MORTGAGE' TO ACCTYPI
                    CONTINUE
                 WHEN OTHER
                    MOVE SPACES TO MESSAGEO
                    STRING 'Account Type should be ISA,CURRENT,LOAN,'
                       DELIMITED BY SIZE,
                       'SAVING or MORTGAGE' DELIMITED BY SIZE
                       INTO MESSAGEO
                    MOVE 'N' TO VALID-DATA-SW
                    MOVE -1 TO ACCTYPL
                    GO TO ED999
              END-EVALUATE
           END-IF.
           IF INTRTL = ZERO
              MOVE SPACES TO MESSAGEO
              STRING 'Please supply a numeric interest rate'
                    DELIMITED BY SIZE,
              INTO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO INTRTL
              GO TO ED999
           END-IF
           IF INTRTI(1:INTRTL) IS NOT NUMERIC
              MOVE ZERO TO WS-NUM-COUNT-TOTAL
              INSPECT INTRTI(1:INTRTL) TALLYING
                 WS-NUM-COUNT-TOTAL FOR ALL '0'
                 WS-NUM-COUNT-TOTAL FOR ALL '1'
                 WS-NUM-COUNT-TOTAL FOR ALL '2'
                 WS-NUM-COUNT-TOTAL FOR ALL '3'
                 WS-NUM-COUNT-TOTAL FOR ALL '4'
                 WS-NUM-COUNT-TOTAL FOR ALL '5'
                 WS-NUM-COUNT-TOTAL FOR ALL '6'
                 WS-NUM-COUNT-TOTAL FOR ALL '7'
                 WS-NUM-COUNT-TOTAL FOR ALL '8'
                 WS-NUM-COUNT-TOTAL FOR ALL '9'
                 WS-NUM-COUNT-TOTAL FOR ALL '.'
                 WS-NUM-COUNT-TOTAL FOR ALL '-'
                 WS-NUM-COUNT-TOTAL FOR ALL '+'
                 WS-NUM-COUNT-TOTAL FOR ALL ' '
              IF WS-NUM-COUNT-TOTAL < INTRTL
                 MOVE SPACES TO MESSAGEO
                 STRING 'Please supply a numeric interest rate'
                      DELIMITED BY SIZE,
                 INTO MESSAGEO
                 MOVE 'N' TO VALID-DATA-SW
                 MOVE -1 TO INTRTL
                 GO TO ED999
              END-IF
              MOVE ZERO TO WS-NUM-COUNT-POINT
              INSPECT INTRTI(1:INTRTL) TALLYING
                 WS-NUM-COUNT-POINT for ALL '.'
              IF WS-NUM-COUNT-POINT > 1
                 MOVE SPACES TO MESSAGEO
                 STRING 'Use one decimal point for interest rate only'
                      DELIMITED BY SIZE,
                 INTO MESSAGEO
                 MOVE 'N' TO VALID-DATA-SW
                 MOVE -1 TO INTRTL
                 GO TO ED999
              END-If
              IF WS-NUM-COUNT-POINT = 1
                 MOVE ZERO TO WS-NUM-COUNT-TOTAL
                 INSPECT INTRTI(1:INTRTL) TALLYING
                    WS-NUM-COUNT-TOTAL FOR CHARACTERS AFTER '.'
                 IF WS-NUM-COUNT-TOTAL > 2
                    MOVE ZERO TO WS-NUM-COUNT-TOTAL WS-NUM-COUNT-POINT
                    INSPECT INTRTI(1:INTRTL) TALLYING
                       WS-NUM-COUNT-POINT FOR CHARACTERS BEFORE '.'
                    ADD 2 TO WS-NUM-COUNT-POINT
                       GIVING WS-NUM-COUNT-POINT
                    INSPECT INTRTI(WS-NUM-COUNT-POINT:INTRTL) TALLYING
                       WS-NUM-COUNT-TOTAL FOR ALL '0'
                       WS-NUM-COUNT-TOTAL FOR ALL '1'
                       WS-NUM-COUNT-TOTAL FOR ALL '2'
                       WS-NUM-COUNT-TOTAL FOR ALL '3'
                       WS-NUM-COUNT-TOTAL FOR ALL '4'
                       WS-NUM-COUNT-TOTAL FOR ALL '5'
                       WS-NUM-COUNT-TOTAL FOR ALL '6'
                       WS-NUM-COUNT-TOTAL FOR ALL '7'
                       WS-NUM-COUNT-TOTAL FOR ALL '8'
                       WS-NUM-COUNT-TOTAL FOR ALL '9'
                       WS-NUM-COUNT-TOTAL FOR ALL '-'
                       WS-NUM-COUNT-TOTAL FOR ALL '+'
                       AFTER '.'
                    IF WS-NUM-COUNT-TOTAL > 2
                       MOVE SPACES TO MESSAGEO
                       STRING
                         'Only up to two decimal places are supported'
                         DELIMITED BY SIZE,
                       INTO MESSAGEO
                       MOVE 'N' TO VALID-DATA-SW
                       MOVE -1 TO INTRTL
                       GO TO ED999
                    END-IF
                 END-IF
              END-IF
           END-IF
           COMPUTE INTRTI-COMP-1 = FUNCTION NUMVAL(INTRTI)
           IF INTRTI-COMP-1 < 0
              MOVE SPACES TO MESSAGEO
              STRING 'Please supply a zero or positive interest rate'
                    DELIMITED BY SIZE,
              INTO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO INTRTL
              GO TO ED999
           END-IF
           IF INTRTI-COMP-1 > 9999.99
              MOVE SPACES TO MESSAGEO
              STRING 'Please supply an interest rate less than 9999.99%'
                    DELIMITED BY SIZE,
              INTO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO INTRTL
              GO TO ED999
           END-IF
           MOVE FUNCTION REVERSE(OVERDRI) TO WS-REVERSE
           MOVE ZERO TO WS-NUM-COUNT-TOTAL
           INSPECT WS-REVERSE TALLYING WS-NUM-COUNT-TOTAL
           FOR LEADING SPACES
           SUBTRACT WS-NUM-COUNT-TOTAL FROM OVERDRL
             GIVING OVERDRL
           MOVE ZERO TO WS-NUM-COUNT-TOTAL
           INSPECT OVERDRI(1:OVERDRL) TALLYING
              WS-NUM-COUNT-TOTAL FOR ALL '0'
              WS-NUM-COUNT-TOTAL FOR ALL '1'
              WS-NUM-COUNT-TOTAL FOR ALL '2'
              WS-NUM-COUNT-TOTAL FOR ALL '3'
              WS-NUM-COUNT-TOTAL FOR ALL '4'
              WS-NUM-COUNT-TOTAL FOR ALL '5'
              WS-NUM-COUNT-TOTAL FOR ALL '6'
              WS-NUM-COUNT-TOTAL FOR ALL '7'
              WS-NUM-COUNT-TOTAL FOR ALL '8'
              WS-NUM-COUNT-TOTAL FOR ALL '9'.
           IF WS-NUM-COUNT-TOTAL < OVERDRL
              MOVE SPACES TO MESSAGEO
              MOVE 'Overdraft Limit must be numeric positive int' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO OVERDRL
              GO TO ED999
           END-IF.
           EXEC CICS BIF DEEDIT FIELD(OVERDRI)
           END-EXEC.
           IF OVERDRL < 1 OR OVERDRI = '________' or overdri = spaces
              MOVE ZERO TO OVERDRI
           END-IF.
           IF OVERDRI NOT NUMERIC
              MOVE SPACES TO MESSAGEO
              MOVE 'The Overdraft Limit must be numeric ' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO OVERDRL
              GO TO ED999
           END-IF.
           IF CUSTNOL < 1 OR ACCTYPL < 1
              MOVE SPACES TO MESSAGEO
              MOVE 'Missing expected data.               ' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              GO TO ED999
           END-IF.
       ED999.
           EXIT.
       CRE-ACC-DATA SECTION.
       CAD010.
           INITIALIZE SUBPGM-PARMS.
           MOVE 'ACCT' TO SUBPGM-EYECATCHER.
           MOVE 'N' TO SUBPGM-SUCCESS.
           MOVE CUSTNOI      TO SUBPGM-CUSTNO.
           MOVE ZEROS        TO SUBPGM-SORTCODE.
           MOVE ZEROS        TO SUBPGM-NUMBER.
           MOVE ACCTYPI      TO SUBPGM-ACC-TYPE.
           COMPUTE INTRTI-COMP-1 = FUNCTION NUMVAL(INTRTI)
           MOVE INTRTI-COMP-1 TO SUBPGM-INT-RT.
           MOVE ZEROS        TO SUBPGM-OPENED.
           MOVE OVERDRI      TO SUBPGM-OVERDR-LIM.
           MOVE ZEROS        TO SUBPGM-LAST-STMT-DT.
           MOVE ZEROS        TO SUBPGM-NEXT-STMT-DT.
           MOVE ZEROS        TO SUBPGM-AVAIL-BAL.
           MOVE ZEROS        TO SUBPGM-ACT-BAL.
           MOVE ' '          TO SUBPGM-FAIL-CODE.
           EXEC CICS LINK
              PROGRAM('CREACC')
              COMMAREA(SUBPGM-PARMS)
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
              SYNCONRETURN
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1CAC - CAD010 - LINK CREACC FAILED    '
                 TO WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                       INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'CAD010 - LINK CREACC FAILED ' DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                          COMMAREA(ABNDINFO-REC)
              END-EXEC
              PERFORM ABEND-THIS-TASK
           END-IF.
           IF SUBPGM-SUCCESS = 'N'
              MOVE SPACES TO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              EVALUATE SUBPGM-FAIL-CODE
                 WHEN '1'
                    MOVE 'The supplied customer number does not exist.'
                       TO  MESSAGEO
                 WHEN '2'
                    STRING 'The customer data cannot be accessed, '
                       DELIMITED BY SIZE,
                       ' unable to create account.'
                       DELIMITED BY SIZE
                    INTO MESSAGEO
                 WHEN '3'
                    STRING 'Account record creation failed.'
                       DELIMITED BY SIZE,
                       ' (unable to ENQ ACCOUNT NC).'
                       DELIMITED BY SIZE
                    INTO MESSAGEO
                 WHEN '4'
                    STRING 'Account record creation failed,'
                       DELIMITED BY SIZE,
                       ' (unable to increment ACCOUNT NC).'
                       DELIMITED BY SIZE
                    INTO MESSAGEO
                 WHEN '5'
                    STRING 'Account record creation failed,'
                       DELIMITED BY SIZE,
                       ' (unable to restore ACCOUNT NC).'
                       DELIMITED BY SIZE
                    INTO MESSAGEO
                 WHEN '6'
                    STRING 'Account record creation failed,'
                       DELIMITED BY SIZE,
                       ' (unable to WRITE to ACCOUNT file).'
                       DELIMITED BY SIZE
                    INTO MESSAGEO
                 WHEN '7'
                    STRING 'Account record creation failed,'
                       DELIMITED BY SIZE,
                       ' (unable to INSERT into ACCOUNT).'
                       DELIMITED BY SIZE
                    INTO MESSAGEO
                 WHEN '8'
                    STRING 'Account record creation failed,'
                       DELIMITED BY SIZE,
                       ' (too many accounts).'
                       DELIMITED BY SIZE
                    INTO MESSAGEO
                 WHEN '9'
                    STRING 'Account record creation failed, '
                       DELIMITED BY SIZE,
                       ' unable to count accounts.'
                       DELIMITED BY SIZE
                    INTO MESSAGEO
                 WHEN 'A'
                    STRING 'Account record creation failed, '
                       DELIMITED BY SIZE,
                       ' account type unsupported.'
                       DELIMITED BY SIZE
                    INTO MESSAGEO
                 WHEN OTHER
                    MOVE 'The account was not created.'
                       TO  MESSAGEO
              END-EVALUATE
           ELSE
              MOVE SPACES TO MESSAGEO
              MOVE 'The Account has been successfully created' TO
                 MESSAGEO
              MOVE SUBPGM-SORTCODE          TO SRTCDO
              MOVE SUBPGM-NUMBER            TO ACCNOO
              MOVE SUBPGM-OPENED(1:2)       TO OPENDDO
              MOVE SUBPGM-OPENED(3:2)       TO OPENMMO
              MOVE SUBPGM-OPENED(5:4)       TO OPENYYO
              MOVE SUBPGM-NEXT-STMT-DT(1:2) TO NSTMTDDO
              MOVE SUBPGM-NEXT-STMT-DT(3:2) TO NSTMTMMO
              MOVE SUBPGM-NEXT-STMT-DT(5:4) TO NSTMTYYO
              MOVE SUBPGM-LAST-STMT-DT(1:2) TO LSTMDDO
              MOVE SUBPGM-LAST-STMT-DT(3:2) TO LSTMMMO
              MOVE SUBPGM-LAST-STMT-DT(5:4) TO LSTMYYO
              MOVE SUBPGM-AVAIL-BAL         TO AVAILABLE-BALANCE-DISPLAY
              MOVE SUBPGM-ACT-BAL           TO ACTUAL-BALANCE-DISPLAY
              MOVE AVAILABLE-BALANCE-DISPLAY TO AVAILO
              MOVE ACTUAL-BALANCE-DISPLAY   TO ACTBALO
           END-IF.
           MOVE SUBPGM-CUSTNO               TO CUSTNOO.
           MOVE SUBPGM-ACC-TYPE             TO ACCTYPO.
           MOVE SUBPGM-INT-RT               TO INTRT-PIC9.
           MOVE INTRT-PIC9                  TO INTRTO.
           MOVE SUBPGM-OVERDR-LIM           TO OVERDRO.
       CAD999.
           EXIT.
       SEND-MAP SECTION.
       SM010.
           IF SEND-ERASE
              EXEC CICS SEND MAP('BNK1CA')
                 MAPSET('BNK1CAM')
                 FROM(BNK1CAO)
                 ERASE
                 CURSOR
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNK1CAC - SM010 - SEND MAP ERASE FAIL '
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'SM010 -SEND MAP ERASE FAIL' DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 PERFORM ABEND-THIS-TASK
              END-IF
              GO TO SM999
           END-IF.
           IF SEND-DATAONLY
              EXEC CICS SEND MAP('BNK1CA')
                 MAPSET('BNK1CAM')
                 FROM(BNK1CAO)
                 DATAONLY
                 CURSOR
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNK1CAC - SM010 - SEND MAP DATAONLY FAIL '
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'SM010 - SEND MAP DATAONLY Fail'
                      DELIMITED BY SIZE,
                      ' EIBRESP=' DELIMITED BY SIZE,
                      ABND-RESPCODE DELIMITED BY SIZE,
                      ' RESP2=' DELIMITED BY SIZE,
                      ABND-RESP2CODE DELIMITED BY SIZE
                      INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 PERFORM ABEND-THIS-TASK
              END-IF
              GO TO SM999
           END-IF.
           IF SEND-DATAONLY-ALARM
              EXEC CICS SEND MAP('BNK1CA')
                 MAPSET('BNK1CAM')
                 FROM(BNK1CAO)
                 DATAONLY
                 ALARM
                 CURSOR
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNK1CAC - SM010 - SEND MAP DATAONLY ALARM FAIL '
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'SM010 - SEND MAP DATAONLY ALARM fail'
                      DELIMITED BY SIZE,
                      ' EIBRESP=' DELIMITED BY SIZE,
                      ABND-RESPCODE DELIMITED BY SIZE,
                      ' RESP2=' DELIMITED BY SIZE,
                      ABND-RESP2CODE DELIMITED BY SIZE
                      INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 PERFORM ABEND-THIS-TASK
              END-IF
           END-IF.
       SM999.
           EXIT.
       SEND-TERMINATION-MSG SECTION.
       STM010.
           EXEC CICS SEND TEXT
              FROM(END-OF-SESSION-MESSAGE)
              ERASE
              FREEKB
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1CAC - STM010 - SEND TEXT FAIL'
                 TO WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'STM010 - SEND TEXT FAIL'
                   DELIMITED BY SIZE,
                   ' EIBRESP=' DELIMITED BY SIZE,
                   ABND-RESPCODE DELIMITED BY SIZE,
                   ' RESP2=' DELIMITED BY SIZE,
                   ABND-RESP2CODE DELIMITED BY SIZE
                   INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
              END-EXEC
              PERFORM ABEND-THIS-TASK
           END-IF.
       STM999.
           EXIT.
       ABEND-THIS-TASK SECTION.
       ATT010.
           DISPLAY WS-FAIL-INFO.
           EXEC CICS ABEND
              ABCODE('HBNK')
              NODUMP
           END-EXEC.
       ATT999.
           EXIT.
       POPULATE-TIME-DATE SECTION.
       PTD010.
           EXEC CICS ASKTIME
              ABSTIME(WS-U-TIME)
           END-EXEC.
           EXEC CICS FORMATTIME
                     ABSTIME(WS-U-TIME)
                     DDMMYYYY(WS-ORIG-DATE)
                     TIME(WS-TIME-NOW)
                     DATESEP
           END-EXEC.
       PTD999.
           EXIT.
","       WORKING-STORAGE SECTION.
       01 WS-CICS-WORK-AREA.
          03 WS-CICS-RESP              PIC S9(8) COMP VALUE 0.
          03 WS-CICS-RESP2             PIC S9(8) COMP VALUE 0.
       01 WS-FAIL-INFO.
          03 FILLER                    PIC X(9)  VALUE 'BNK1CAC  '.
          03 WS-CICS-FAIL-MSG          PIC X(70) VALUE ' '.
          03 FILLER                    PIC X(6)  VALUE ' RESP='.
          03 WS-CICS-RESP-DISP         PIC 9(10) VALUE 0.
          03 FILLER                    PIC X(7)  VALUE ' RESP2='.
          03 WS-CICS-RESP2-DISP        PIC 9(10) VALUE 0.
          03 FILLER                    PIC X(15)
                                          VALUE ' ABENDING TASK.'.
       01 SWITCHES.
           03 VALID-DATA-SW            PIC X VALUE 'Y'.
              88 VALID-DATA               VALUE 'Y'.
       01 FLAGS.
           03 SEND-FLAG                PIC X.
              88 SEND-ERASE               VALUE '1'.
              88 SEND-DATAONLY            VALUE '2'.
              88 SEND-DATAONLY-ALARM      VALUE '3'.
       01 ACTION-ALPHA.
           03 ACTION-NUM               PIC 9.
       01 END-OF-SESSION-MESSAGE       PIC X(13) VALUE 'Session Ended'.
       01 RESPONSE-CODE                PIC S9(8) COMP.
       01 COMMUNICATION-AREA           PIC X.
       01 COMM-DOB-SPLIT.
          03 COMM-DOB-SPLIT-DD         PIC 99.
          03 COMM-DOB-SPLIT-MM         PIC 99.
          03 COMM-DOB-SPLIT-YYYY       PIC 9999.
       01 WS-COMM-AREA.
          03 WS-COMM-CUSTNO            PIC 9(10).
          03 WS-COMM-ACCTYPE           PIC X(8).
          03 WS-COMM-INTRT             PIC 9(4)V99.
          03 WS-COMM-OVERDR            PIC 9(8).
       01 DATE-REFORMED.
          03 NSTMTDD-CHAR             PIC XX.
          03 NSTMTDD-REFORM REDEFINES NSTMTDD-CHAR.
             05 NSTMTDD-NUM              PIC 99.
          03 NSTMTMMI-CHAR               PIC XX.
          03 NSTMTMMI-REFORM REDEFINES NSTMTMMI-CHAR.
             05 NSTMTMMI-NUM             PIC 99.
          03 NSTMTYYI-CHAR               PIC XX.
          03 NSTMTYYI-REFORM REDEFINES NSTMTYYI-CHAR.
             05 NSTMTYYI-NUM             PIC 99.
       01 MORE-STRING-CONVS.
          03 NST-CHAR                  PIC X(8).
          03 NST-DATE-GRP REDEFINES NST-CHAR.
             05 NST-NUM                PIC 9(8).
       01 INTRTI-COMP-1 USAGE COMP-1.
       01 INTRT-PIC9                   PIC 9999.99.
       01 WS-NUM-COUNT-POINT           PIC S9(8) BINARY.
       01 WS-NUM-COUNT-TOTAL           PIC S9(8) BINARY.
       01 WS-REVERSE                   PIC X(8).
       01 SUBPGM-PARMS.
          03 SUBPGM-EYECATCHER         PIC X(4).
          03 SUBPGM-CUSTNO             PIC 9(10).
          03 SUBPGM-KEY.
             05 SUBPGM-SORTCODE        PIC 9(6) DISPLAY.
             05 SUBPGM-NUMBER          PIC 9(8) DISPLAY.
          03 SUBPGM-ACC-TYPE           PIC X(8).
          03 SUBPGM-INT-RT             PIC 9(4)V99.
          03 SUBPGM-OPENED             PIC 9(8).
          03 SUBPGM-OVERDR-LIM         PIC 9(8).
          03 SUBPGM-LAST-STMT-DT       PIC 9(8).
          03 SUBPGM-NEXT-STMT-DT       PIC 9(8).
          03 SUBPGM-AVAIL-BAL          PIC S9(10)V99.
          03 SUBPGM-ACT-BAL            PIC S9(10)V99.
          03 SUBPGM-SUCCESS            PIC X.
          03 SUBPGM-FAIL-CODE          PIC X.
       01 COMPANY-NAME-FULL            PIC X(32).
       01 AVAILABLE-BALANCE-DISPLAY    PIC +9(10).99.
       01 ACTUAL-BALANCE-DISPLAY       PIC +9(10).99.
       01 WS-U-TIME                    PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                 PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD           PIC 99.
          03 FILLER                    PIC X.
          03 WS-ORIG-DATE-MM           PIC 99.
          03 FILLER                    PIC X.
          03 WS-ORIG-DATE-YYYY         PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-MM-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X       PIC X(4).
       01 WS-TIME-DATA.
           03 WS-TIME-NOW              PIC 9(6).
           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
              05 WS-TIME-NOW-GRP-HH       PIC 99.
              05 WS-TIME-NOW-GRP-MM       PIC 99.
              05 WS-TIME-NOW-GRP-SS       PIC 99.
       01 WS-ABEND-PGM                 PIC X(8) VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 COMM-CUSTNO            PIC 9(10).
          03 COMM-ACCTYPE           PIC X(8).
          03 COMM-INTRT             PIC 9(4)V99.
          03 COMM-OVERDR            PIC 9(8).
","['PREMIERE', 'PROCESS-MAP', 'RECEIVE-MAP', 'EDIT-DATA', 'CRE-ACC-DATA', 'SEND-MAP', 'SEND-TERMINATION-MSG', 'ABEND-THIS-TASK', 'POPULATE-TIME-DATE', 'A010', 'A999', 'PM010', 'PM999', 'RM010', 'RM999', 'ED010', 'ED999', 'CAD010', 'CAD999', 'SM010', 'SM999', 'STM010', 'STM999', 'ATT010', 'ATT999', 'PTD010', 'PTD999']","Paragraph PREMIERE calls paragraph SEND-MAP, SEND-TERMINATION-MSG, ABEND-THIS-TASK, POPULATE-TIME-DATE, PROCESS-MAP.
Paragraph PROCESS-MAP calls paragraph EDIT-DATA, RECEIVE-MAP, CRE-ACC-DATA, SEND-MAP.
Paragraph RECEIVE-MAP calls paragraph POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph EDIT-DATA calls paragraph ED999.
Paragraph CRE-ACC-DATA calls paragraph POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph SEND-MAP calls paragraph POPULATE-TIME-DATE, ABEND-THIS-TASK, SM999.
Paragraph SEND-TERMINATION-MSG calls paragraph POPULATE-TIME-DATE, ABEND-THIS-TASK.
",920,"This is the Create Account program. It verifies the input and assuming it passes verification, it links to the CREACC program to add it to the Account datastore.",['WS-ABEND-PGM'],,,Error Long,0.75,1,0.875,"This COBOL program manages customer transactions by evaluating transaction identifiers and executing various operations based on their values. It includes sections for processing maps, receiving data, validating inputs, creating accounts, and sending messages to CICS. Error handling is a key focus, with mechanisms for abending the task on failures. Additionally, it ensures accurate time and date handling. By leveraging modular sections, the program enhances maintainability and clarity in its operations and error management.",1
144,cicsdev_cics-banking-sample-application-cbsa,cics-banking-sample-application-cbsa/src/base/cobol_src/BANKDATA.cbl,"       CBL SQL
       IDENTIFICATION DIVISION.
       PROGRAM-ID. BANKDATA.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. MAINFRAME.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT CUSTOMER-FILE
                  ASSIGN TO VSAM
                  ORGANIZATION IS INDEXED
                  ACCESS MODE  IS RANDOM
                  RECORD KEY   IS CUSTOMER-KEY
                  FILE STATUS  IS CUSTOMER-VSAM-STATUS.
       DATA DIVISION.
       FILE SECTION.
       FD  CUSTOMER-FILE.
       01  CUSTOMER-RECORD-STRUCTURE.
           03 CUSTOMER-RECORD.
              05 CUSTOMER-EYECATCHER                 PIC X(4).
                 88 CUSTOMER-EYECATCHER-VALUE        VALUE 'CUST'.
              05 CUSTOMER-KEY.
                 07 CUSTOMER-SORTCODE                PIC 9(6) DISPLAY.
                 07 CUSTOMER-NUMBER                  PIC 9(10) DISPLAY.
              05 CUSTOMER-NAME                       PIC X(60).
              05 CUSTOMER-ADDRESS                    PIC X(160).
              05 CUSTOMER-DATE-OF-BIRTH              PIC 9(8).
              05 CUSTOMER-DOB-GROUP REDEFINES CUSTOMER-DATE-OF-BIRTH.
                 07 CUSTOMER-BIRTH-DAY               PIC 99.
                 07 CUSTOMER-BIRTH-MONTH             PIC 99.
                 07 CUSTOMER-BIRTH-YEAR              PIC 9999.
              05 CUSTOMER-CREDIT-SCORE               PIC 999.
              05 CUSTOMER-CS-REVIEW-DATE             PIC 9(8).
              05 CUSTOMER-CS-GROUP
                 REDEFINES CUSTOMER-CS-REVIEW-DATE.
                 07 CUSTOMER-CS-REVIEW-DAY           PIC 99.
                 07 CUSTOMER-CS-REVIEW-MONTH         PIC 99.
                 07 CUSTOMER-CS-REVIEW-YEAR          PIC 9999.
       WORKING-STORAGE SECTION.
           EXEC SQL
              INCLUDE ACCDB2
           END-EXEC.
       77  WS-ACCOUNT-OPENED-DAY PIC 99.
       77  WS-ACCOUNT-OPENED-MONTH PIC 99.
       77  WS-ACCOUNT-OPENED-YEAR PIC 9999.
       01 HOST-ACCOUNT-ROW.
           03 HV-ACCOUNT-DATA.
              05 HV-ACCOUNT-EYECATCHER         PIC X(4).
              05 HV-ACCOUNT-CUST-NO            PIC X(10).
              05 HV-ACCOUNT-KEY.
                 07 HV-ACCOUNT-SORT-CODE       PIC X(6).
                 07 HV-ACCOUNT-NUMBER          PIC X(8).
              05 HV-ACCOUNT-TYPE               PIC X(8).
              05 HV-ACCOUNT-INTEREST-RATE      PIC S9(4)V99 COMP-3.
              05 HV-ACCOUNT-OPENED             PIC X(10).
              05 HV-ACCOUNT-OPENED-GROUP REDEFINES HV-ACCOUNT-OPENED.
                 07 HV-ACCOUNT-OPENED-DAY      PIC XX.
                 07 HV-ACCOUNT-OPENED-DELIM1   PIC X.
                 07 HV-ACCOUNT-OPENED-MONTH    PIC XX.
                 07 HV-ACCOUNT-OPENED-DELIM2   PIC X.
                 07 HV-ACCOUNT-OPENED-YEAR     PIC X(4).
              05 HV-ACCOUNT-OVERDRAFT-LIMIT    PIC S9(9) COMP.
              05 HV-ACCOUNT-LAST-STMT-DATE     PIC X(10).
              05 HV-ACCOUNT-LAST-STMT-GROUP
                 REDEFINES HV-ACCOUNT-LAST-STMT-DATE.
                  07 HV-ACCOUNT-LAST-STMT-DAY   PIC XX.
                  07 HV-ACCOUNT-LAST-STMT-DELIM1 PIC X.
                  07 HV-ACCOUNT-LAST-STMT-MONTH  PIC XX.
                  07 HV-ACCOUNT-LAST-STMT-DELIM2 PIC X.
                  07 HV-ACCOUNT-LAST-STMT-YEAR   PIC X(4).
              05 HV-ACCOUNT-NEXT-STMT-DATE     PIC X(10).
              05 HV-ACCOUNT-NEXT-STMT-GROUP
                 REDEFINES HV-ACCOUNT-NEXT-STMT-DATE.
                 07 HV-ACCOUNT-NEXT-STMT-DAY    PIC XX.
                 07 HV-ACCOUNT-NEXT-STMT-DELIM1 PIC X.
                 07 HV-ACCOUNT-NEXT-STMT-MONTH  PIC XX.
                 07 HV-ACCOUNT-NEXT-STMT-DELIM2 PIC X.
                 07 HV-ACCOUNT-NEXT-STMT-YEAR   PIC X(4).
              05 HV-ACCOUNT-AVAILABLE-BALANCE  PIC S9(10)V99 COMP-3.
              05 HV-ACCOUNT-ACTUAL-BALANCE     PIC S9(10)V99 COMP-3.
       EXEC SQL
          INCLUDE SQLCA
       END-EXEC.
       01 DISP-LOT.
          03 DISP-SIGN      PIC X.
          03 DISP-SQLCD     PIC 9999.
       01 DISP-REASON-CODE             PIC X(18).
       01  START-KEY                   PIC 9(10) DISPLAY.
       01  END-KEY                     PIC 9(10) DISPLAY.
       01  STEP-KEY                    PIC 9(10) DISPLAY.
       01  TESTNM                      PIC 9(4)  DISPLAY.
       01  CUSTOMER-VSAM-STATUS.
           05 VSAM-STATUS1             PIC X.
           05 VSAM-STATUS2             PIC X.
       01  NEXT-KEY                    PIC 9(10) DISPLAY.
       01  FORENAMES.
           05 FORENAME                 PIC X(20)
                                       OCCURS 100 TIMES
                                       DEPENDING ON FORENAMES-CNT.
       01  FORENAMES-CNT               PIC 9(8) BINARY   VALUE 0.
       01  FORENAMES-PTR               PIC 9(8) BINARY   VALUE 0.
       01  STREET-NAME-TREES.
           05 STREET-NAME-TREE         PIC X(20)
                                       OCCURS 26 TIMES
                                       DEPENDING ON STREET-NAME-T-CNT.
       01  STREET-NAME-T-CNT           PIC 9(8) BINARY   VALUE 0.
       01  STREET-NAME-T-PTR           PIC 9(8) BINARY   VALUE 0.
       01  STREET-NAME-ROADS.
           05 STREET-NAME-ROAD         PIC X(20)
                                       OCCURS 19 TIMES
                                       DEPENDING ON STREET-NAME-R-CNT.
       01  STREET-NAME-R-CNT           PIC 9(8) BINARY   VALUE 0.
       01  STREET-NAME-R-PTR           PIC 9(8) BINARY   VALUE 0.
       01  TOWNS.
           05 TOWN                     PIC X(20)
                                       OCCURS 50 TIMES
                                       DEPENDING ON TOWN-COUNT.
       01  TOWN-COUNT                  PIC 9(8) BINARY   VALUE 0.
       01  TOWN-PTR                    PIC 9(8) BINARY   VALUE 0.
       01  INITIALS.
           05 INITIAL-CHARACTER                  PIC X
                                       OCCURS 30 TIMES.
       01  INITIALS-CNT                PIC 9(8) BINARY   VALUE 0.
       01  INITIALS-PTR                PIC 9(8) BINARY   VALUE 0.
       01 TITLE-WORDS.
           03 TITLE-WORD OCCURS 36 PIC X(9).
       01 TITLE-ALPHABET.
           03 FILLER PIC X(9) VALUE 'Mr'.
           03 FILLER PIC X(9) VALUE 'Mrs'.
           03 FILLER PIC X(9) VALUE 'Miss'.
           03 FILLER PIC X(9) VALUE 'Ms'.
           03 FILLER PIC X(9) VALUE 'Mr'.
           03 FILLER PIC X(9) VALUE 'Mrs'.
           03 FILLER PIC X(9) VALUE 'Miss'.
           03 FILLER PIC X(9) VALUE 'Ms'.
           03 FILLER PIC X(9) VALUE 'Mr'.
           03 FILLER PIC X(9) VALUE 'Mrs'.
           03 FILLER PIC X(9) VALUE 'Miss'.
           03 FILLER PIC X(9) VALUE 'Ms'.
           03 FILLER PIC X(9) VALUE 'Mr'.
           03 FILLER PIC X(9) VALUE 'Mrs'.
           03 FILLER PIC X(9) VALUE 'Miss'.
           03 FILLER PIC X(9) VALUE 'Ms'.
           03 FILLER PIC X(9) VALUE 'Mr'.
           03 FILLER PIC X(9) VALUE 'Mrs'.
           03 FILLER PIC X(9) VALUE 'Miss'.
           03 FILLER PIC X(9) VALUE 'Ms'.
           03 FILLER PIC X(9) VALUE 'Dr'.
           03 FILLER PIC X(9) VALUE 'Drs'.
           03 FILLER PIC X(9) VALUE 'Dr'.
           03 FILLER PIC X(9) VALUE 'Ms'.
           03 FILLER PIC X(9) VALUE 'Dr'.
           03 FILLER PIC X(9) VALUE 'Ms'.
           03 FILLER PIC X(9) VALUE 'Dr'.
           03 FILLER PIC X(9) VALUE 'Ms'.
           03 FILLER PIC X(9) VALUE 'Professor'.
           03 FILLER PIC X(9) VALUE 'Professor'.
           03 FILLER PIC X(9) VALUE 'Professor'.
           03 FILLER PIC X(9) VALUE 'Lord'.
           03 FILLER PIC X(9) VALUE 'Sir'.
           03 FILLER PIC X(9) VALUE 'Sir'.
           03 FILLER PIC X(9) VALUE 'Lady'.
           03 FILLER PIC X(9) VALUE 'Lady'.
       01 TITLE-NUMBER PIC S9(9) BINARY.
       01 HOUSE-NUMBER PIC 99.
       01  SURNAMES.
           05 SURNAME                  PIC X(20)
                                       OCCURS 100 TIMES
                                       DEPENDING ON SURNAMES-CNT.
       01  SURNAMES-CNT                PIC 9(8) BINARY   VALUE 0.
       01  SURNAMES-PTR                PIC 9(8) BINARY   VALUE 0.
       01  RDATE                       PIC X(21).
       01  RDATE-NUMERIC               REDEFINES RDATE
                                       PIC 9(16) USAGE DISPLAY.
       01  RANDOM-SEED                 PIC X(16).
       01  RANDOM-SEED-NUMERIC REDEFINES RANDOM-SEED PIC 9(16)
            USAGE DISPLAY.
       01 WS-CNT                       PIC 9    VALUE 0.
       77 SORTCODE           PIC 9(6) VALUE 987654.
       01 WS-ACCOUNT-NUMBER            PIC 9(8) VALUE 1.
       01 WS-ACCOUNT-TYPES.
           05 WS-ACCOUNT-TYPE          PIC X(8)
                                       OCCURS 5 TIMES
                                       DEPENDING ON
                                       ACCOUNT-TYPES-COUNT.
       01 ACCOUNT-TYPES-COUNT          PIC 9(8) BINARY  VALUE 0.
       01 ACCOUNT-TYPES-PTR            PIC 9(8) BINARY   VALUE 0.
       01 WS-ACCOUNT-INT-RATES.
           05 WS-ACCOUNT-INT-RATE      PIC 9(4)V99
                                       OCCURS 5 TIMES
                                       DEPENDING ON
                                       ACCOUNT-INT-RATES-COUNT.
       01 ACCOUNT-INT-RATES-COUNT      PIC 9(8) BINARY  VALUE 0.
       01 ACCOUNT-INT-RATES-PTR        PIC 9(8) BINARY   VALUE 0.
       01 WS-ACCOUNT-OVERDRAFT-LIMS.
           05 WS-ACCOUNT-OVERDRAFT-LIM PIC 9(8)
                                       OCCURS 5 TIMES
                                       DEPENDING ON
                                       ACCOUNT-OVERDRAFT-COUNT.
       01 ACCOUNT-OVERDRAFT-COUNT      PIC 9(8) BINARY  VALUE 0.
       01 ACCOUNT-OVERDRAFT-PTR        PIC 9(8) BINARY   VALUE 0.
       01 NO-OF-ACCOUNTS               PIC 9(8) BINARY   VALUE 0.
       01 WS-OVERDRAFT-CONVERSION      PIC S9(9) COMP VALUE 0.
       01 WS-PGM-NAME                             PIC X(8) VALUE ' '.
       01 WS-SQLCODE-DISPLAY             PIC S9(8) DISPLAY
           SIGN LEADING SEPARATE.
       01 OPENED-DATE-ATTEMPTS           PIC S9(8) DISPLAY
           SIGN LEADING SEPARATE.
       01 OPENED-DATE-VALID              PIC X VALUE 'N'.
       01 COMMIT-COUNT PIC S9(8) BINARY.
       01 time-data.
           05 tod-clock                PIC X(20).
           05 period-start             PIC X(14).
           05 period-next              COMP-2.
           05 period-next-f            PIC 9(14).
           05 gmt-lilian               PIC S9(8) BINARY.
           05 gmt-seconds              COMP-2.
           05 delay-interval           PIC S9(9) BINARY VALUE 1.
           05 fc                       PIC X(12).
           05 datm-conv                PIC X(80).
           05 datm-picture.
              10 datm-length           PIC 9999 COMP.
              10 datm-format           PIC X(14).
       01 TIMESTAMP-FUNCTION PIC X(40).
       01 WS-CURRENT-DATE-DATA.
           03 WS-CURRENT-DATE.
              05 WS-CURRENT-YYYY         PIC 9(4).
              05 WS-CURRENT-MM           PIC 99.
              05 WS-CURRENT-DD           PIC 99.
           03 WS-CURRENT-TIME.
              05 WS-CURRENT-HOURS        PIC 99.
              05 WS-CURRENT-MINS         PIC 99.
              05 WS-CURRENT-SECS         PIC 99.
              05 WS-CURRENT-MILLI        PIC 99.
           03 WS-DIFFERENCE-FROM-GMT     PIC S9(4).
       01 WS-CURRENT-DATE-9              PIC 9(8) VALUE 0.
       01 WS-TODAY-INT                   PIC 9(8) VALUE 0.
       01 WS-REVIEW-DATE-ADD             PIC 99 VALUE 0.
       01 WS-NEW-REVIEW-DATE-INT         PIC 9(8) VALUE 0.
       01 WS-NEW-REVIEW-YYYYMMDD         PIC 9(8) VALUE 0.
       01 CUSTOMER-CONTROL.
           03 CUSTOMER-CONTROL-RECORD.
              05 CUSTOMER-CONTROL-EYECATCHER             PIC X(4).
                 88 CUSTOMER-CONTROL-EYECATCHER-V        VALUE 'CTRL'.
              05 CUSTOMER-CONTROL-KEY.
                 07 CUSTOMER-CONTROL-SORTCODE        PIC 9(6) DISPLAY.
                 07 CUSTOMER-CONTROL-NUMBER          PIC 9(10) DISPLAY.
              05 NUMBER-OF-CUSTOMERS                 PIC 9(10) DISPLAY.
              05 LAST-CUSTOMER-NUMBER                PIC 9(10) DISPLAY.
              05 CUSTOMER-CONTROL-SUCCESS-FLAG       PIC X.
              88 CUSTOMER-CONTROL-SUCCESS VALUE 'Y'.
              05 CUSTOMER-CONTROL-FAIL-CODE PIC X.
              05 FILLER                              PIC X(38).
              05 FILLER                              PIC X(160).
              05 FILLER                              PIC 9(8).
              05 FILLER                              PIC 999.
              05 FILLER                              PIC 9(8).
       01 ACCOUNT-CONTROL.
              03 ACCOUNT-CONTROL-RECORD.
                 05 ACCOUNT-CONTROL-EYE-CATCHER        PIC X(4).
                 88 ACCOUNT-CONTROL-EYECATCHER-V   VALUE 'CTRL'.
                 05 FILLER                     PIC 9(10).
                 05 ACCOUNT-CONTROL-KEY.
                    07 ACCOUNT-CONTROL-SORT-CODE       PIC 9(6).
                    07 ACCOUNT-CONTROL-NUMBER          PIC 9(8).
                 05 NUMBER-OF-ACCOUNTS                 PIC 9(8).
                 05 LAST-ACCOUNT-NUMBER                PIC 9(8).
                 05 ACCOUNT-CONTROL-SUCCESS-FLAG       PIC X.
                 88 ACCOUNT-CONTROL-SUCCESS VALUE 'Y'.
                 05 ACCOUNT-CONTROL-FAIL-CODE PIC X.
                 05 FILLER                     PIC 9(4)V99.
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC S9(10)V99.
                 05 FILLER                     PIC X(2).
           EXEC SQL
              INCLUDE CONTDB2
           END-EXEC.
       01 HOST-CONTROL-ROW.
           03 HV-CONTROL-NAME                  PIC X(32).
           03 HV-CONTROL-VALUE-NUM             PIC S9(9) COMP.
           03 HV-CONTROL-VALUE-STR             PIC X(40).
       01 WS-WEEKDAYS                    PIC X(63) VALUE ' '.
       01 WS-WEEKDAY-GROUP
           REDEFINES WS-WEEKDAYS.
           03 WS-WEEKDAY                 PIC X(9) OCCURS 7 TIMES.
       01 WS-DT                          PIC 9(8) VALUE 0.
       01 WS-DT-REM                      PIC S9(9) COMP VALUE 0.
       01 WS-DAY-OF-WEEK-VAL             PIC 9    VALUE 0.
       01 WS-DAY-TODAY                   PIC X(9) VALUE ' '.
       01 SQLCODE-DISPLAY                PIC S9(8) DISPLAY
           SIGN LEADING SEPARATE.
       LINKAGE SECTION.
       01 PARM-BUFFER.
           05 PARM-LENGTH              PIC 9(4) BINARY.
           05 PARM                     PIC X(256).
       PROCEDURE DIVISION USING PARM-BUFFER.
       PREMIERE SECTION.
       A010.
           MOVE 'Starting BANKDATA'
             to TIMESTAMP-FUNCTION
           perform TIMESTAMP
           PERFORM INITIALISE-ARRAYS.
           UNSTRING PARM(1:PARM-LENGTH)
                    DELIMITED BY SPACE OR ','
                    INTO START-KEY
                         END-KEY
                         STEP-KEY
                         RANDOM-SEED.
           IF END-KEY < START-KEY
             MOVE 12 TO RETURN-CODE
             DISPLAY 'Final customer number cannot be smaller than '
               'first customer number'
             GOBACK
           END-IF
           IF step-key = zero
             MOVE 12 TO RETURN-CODE
             DISPLAY 'Gap between customers cannot be zero'
             GOBACK
           END-IF
           PERFORM GET-TODAYS-DATE.
           PERFORM DELETE-DB2-ROWS.
           COMPUTE FORENAMES-PTR = FORENAMES-CNT *
                                   FUNCTION RANDOM(RANDOM-SEED-NUMERIC).
           COMPUTE INITIALS-PTR =  INITIALS-CNT *
                                   FUNCTION RANDOM.
           COMPUTE SURNAMES-PTR  =  SURNAMES-CNT *
                                   FUNCTION RANDOM.
           COMPUTE TOWN-PTR  =  TOWN-COUNT *
                                   FUNCTION RANDOM.
           COMPUTE STREET-NAME-R-PTR =  STREET-NAME-R-CNT *
                                   FUNCTION RANDOM.
           COMPUTE STREET-NAME-T-PTR =  STREET-NAME-T-CNT *
                                   FUNCTION RANDOM.
           COMPUTE ACCOUNT-TYPES-PTR = ACCOUNT-TYPES-COUNT *
                                   FUNCTION RANDOM.
           OPEN OUTPUT CUSTOMER-FILE.
           IF CUSTOMER-VSAM-STATUS NOT EQUAL '00' THEN
               DISPLAY 'Error opening CUSTOMER file, status='
                       CUSTOMER-VSAM-STATUS
               MOVE 12 TO RETURN-CODE
               PERFORM PROGRAM-DONE
           END-IF.
           MOVE 'Populating Customer + Account files'
             to TIMESTAMP-FUNCTION
           perform TIMESTAMP
           MOVE ZERO TO COMMIT-COUNT
           MOVE ZERO TO LAST-CUSTOMER-NUMBER NUMBER-OF-CUSTOMERS
           MOVE ZERO TO LAST-ACCOUNT-NUMBER NUMBER-OF-ACCOUNTS
           PERFORM TEST BEFORE
                   VARYING NEXT-KEY FROM START-KEY BY STEP-KEY
                     UNTIL NEXT-KEY > END-KEY
               INITIALIZE CUSTOMER-RECORD IN CUSTOMER-RECORD-STRUCTURE
               SET CUSTOMER-EYECATCHER-VALUE TO TRUE
               MOVE NEXT-KEY TO CUSTOMER-NUMBER
               MOVE NEXT-KEY TO LAST-CUSTOMER-NUMBER
               ADD 1 TO NUMBER-OF-CUSTOMERS GIVING NUMBER-OF-CUSTOMERS
               COMPUTE TITLE-NUMBER = ((36 - 1)
               COMPUTE FORENAMES-PTR = ((FORENAMES-CNT - 1)
               COMPUTE INITIALS-PTR  = ((INITIALS-CNT - 1)
               COMPUTE SURNAMES-PTR  = ((SURNAMES-CNT - 1)
               COMPUTE HOUSE-NUMBER  = (99
               COMPUTE STREET-NAME-T-PTR  = ((STREET-NAME-T-CNT - 1)
               COMPUTE STREET-NAME-R-PTR  = ((STREET-NAME-R-CNT - 1)
               COMPUTE TOWN-PTR           = ((TOWN-COUNT - 1)
               MOVE SPACES TO CUSTOMER-NAME
               STRING TITLE-WORD(TITLE-NUMBER) DELIMITED BY SPACE
               ' '  DELIMITED BY SIZE
               FORENAME(FORENAMES-PTR) DELIMITED BY SPACE
               ' '  DELIMITED BY SIZE
               INITIAL-CHARACTER(INITIALS-PTR) DELIMITED BY SPACE
               ' '  DELIMITED BY SIZE
               SURNAME(SURNAMES-PTR) DELIMITED BY SIZE
               INTO CUSTOMER-NAME
               MOVE SPACES TO CUSTOMER-ADDRESS
               STRING
               HOUSE-NUMBER DELIMITED BY SIZE
               ' ' DELIMITED BY SIZE
               STREET-NAME-TREE(STREET-NAME-T-PTR)
               DELIMITED BY SPACE
               ' ' DELIMITED BY SIZE
               STREET-NAME-ROAD(STREET-NAME-R-PTR)
               DELIMITED BY SPACE
               ', ' DELIMITED BY SIZE
               TOWN(TOWN-PTR)
               DELIMITED BY SPACE
               INTO CUSTOMER-ADDRESS
               COMPUTE CUSTOMER-BIRTH-DAY =  ((28 - 1)
               COMPUTE CUSTOMER-BIRTH-MONTH =  ((12 - 1)
               COMPUTE CUSTOMER-BIRTH-YEAR =  ((2000 - 1900)
               MOVE SORTCODE TO
                  CUSTOMER-SORTCODE
               COMPUTE CUSTOMER-CREDIT-SCORE = ((999 - 1)
               COMPUTE WS-REVIEW-DATE-ADD = ((21 - 1)
               COMPUTE WS-NEW-REVIEW-DATE-INT =
                  WS-TODAY-INT + WS-REVIEW-DATE-ADD
               COMPUTE WS-NEW-REVIEW-YYYYMMDD = FUNCTION
                  DATE-OF-INTEGER (WS-NEW-REVIEW-DATE-INT)
               MOVE WS-NEW-REVIEW-YYYYMMDD(1:4) TO
                  CUSTOMER-CS-REVIEW-YEAR
               MOVE WS-NEW-REVIEW-YYYYMMDD(5:2) TO
                  CUSTOMER-CS-REVIEW-MONTH
               MOVE WS-NEW-REVIEW-YYYYMMDD(7:2) TO
                  CUSTOMER-CS-REVIEW-DAY
               WRITE CUSTOMER-RECORD-STRUCTURE
               IF CUSTOMER-VSAM-STATUS NOT EQUAL '00' THEN
                   DISPLAY 'Error writing to VSAM file, status='
                           CUSTOMER-VSAM-STATUS
                   MOVE 12 TO RETURN-CODE
                   PERFORM PROGRAM-DONE
               END-IF
               PERFORM DEFINE-ACC
               ADD 1 TO COMMIT-COUNT GIVING COMMIT-COUNT
               IF COMMIT-COUNT > 1000
                 EXEC SQL
                  COMMIT WORK
                 END-EXEC
                 MOVE ZERO TO COMMIT-COUNT
               END-IF
           END-PERFORM
           MOVE '000000' TO CUSTOMER-CONTROL-SORTCODE
           MOVE '9999999999' TO CUSTOMER-CONTROL-NUMBER
           SET CUSTOMER-CONTROL-EYECATCHER-V TO TRUE
           MOVE CUSTOMER-CONTROL-RECORD
             TO CUSTOMER-RECORD IN CUSTOMER-RECORD-STRUCTURE
           WRITE CUSTOMER-RECORD-STRUCTURE
           IF CUSTOMER-VSAM-STATUS NOT EQUAL '00' THEN
                   DISPLAY 'Error writing CUSTOMER-CONTROL-RECORD file'
                   ', status=' CUSTOMER-VSAM-STATUS
                   MOVE 12 TO RETURN-CODE
                   PERFORM PROGRAM-DONE
           END-IF.
           MOVE SPACES TO HV-CONTROL-NAME
           MOVE LAST-ACCOUNT-NUMBER TO HV-CONTROL-VALUE-NUM
           MOVE SPACES TO HV-CONTROL-VALUE-STR
           STRING SORTCODE DELIMITED BY SIZE
           '-' DELIMITED BY SIZE
           'ACCOUNT-LAST' DELIMITED BY SIZE
           INTO HV-CONTROL-NAME
           EXEC SQL
              INSERT INTO CONTROL
                      (CONTROL_NAME,
                       CONTROL_VALUE_NUM,
                       CONTROL_VALUE_STR
                      )
              VALUES (:HV-CONTROL-NAME,
                      :HV-CONTROL-VALUE-NUM,
                      :HV-CONTROL-VALUE-STR
                     )
           END-EXEC.
           IF SQLCODE IS NOT EQUAL TO ZERO
             MOVE SQLCODE TO WS-SQLCODE-DISPLAY
             DISPLAY 'Error inserting last account control record '
             ws-sqlcode-display
             '.'
             HV-CONTROL-NAME,
             ','
             HV-CONTROL-VALUE-NUM
           END-IF
           MOVE SPACES TO HV-CONTROL-NAME
           MOVE NUMBER-OF-ACCOUNTS TO HV-CONTROL-VALUE-NUM
           MOVE SPACES TO HV-CONTROL-VALUE-STR
           STRING SORTCODE DELIMITED BY SIZE
           '-' DELIMITED BY SIZE
           'ACCOUNT-COUNT' DELIMITED BY SIZE
           INTO HV-CONTROL-NAME
           EXEC SQL
              INSERT INTO CONTROL
                      (CONTROL_NAME,
                       CONTROL_VALUE_NUM,
                       CONTROL_VALUE_STR
                      )
              VALUES (:HV-CONTROL-NAME,
                      :HV-CONTROL-VALUE-NUM,
                      :HV-CONTROL-VALUE-STR
                     )
           END-EXEC.
           IF SQLCODE IS NOT EQUAL TO ZERO
             MOVE SQLCODE TO WS-SQLCODE-DISPLAY
             DISPLAY 'Error inserting account count control record '
             ws-sqlcode-display
             '.'
             HV-CONTROL-NAME,
             ','
             HV-CONTROL-VALUE-NUM
           END-IF
           CLOSE CUSTOMER-FILE.
           MOVE 'Finishing BANKDATA'
             to TIMESTAMP-FUNCTION
           perform TIMESTAMP.
       A999.
           EXIT.
       PROGRAM-DONE SECTION.
       PD010.
           GOBACK.
       PD999.
           EXIT.
       DEFINE-ACC SECTION.
       DA010.
           COMPUTE NO-OF-ACCOUNTS =  ((5 - 1)
           PERFORM POPULATE-ACC VARYING WS-CNT FROM 1 BY 1
               UNTIL WS-CNT > NO-OF-ACCOUNTS.
           EXEC SQL
             COMMIT WORK
           END-EXEC.
       DA999.
           EXIT.
       POPULATE-ACC SECTION.
       PA010.
           MOVE 0 TO HV-ACCOUNT-OPENED-DAY
                     HV-ACCOUNT-OPENED-MONTH
                     HV-ACCOUNT-OPENED-YEAR
           MOVE 0 TO OPENED-DATE-ATTEMPTS
           MOVE 'N' TO OPENED-DATE-VALID
           PERFORM GENERATE-OPENED-DATE
                   UNTIL OPENED-DATE-VALID = 'Y'.
           MOVE 'ACCT' TO
              HV-ACCOUNT-EYECATCHER OF HOST-ACCOUNT-ROW.
           MOVE CUSTOMER-NUMBER TO
              HV-ACCOUNT-CUST-NO OF HOST-ACCOUNT-ROW.
           MOVE SORTCODE TO
              HV-ACCOUNT-SORT-CODE OF HOST-ACCOUNT-ROW.
           MOVE WS-ACCOUNT-NUMBER TO
              HV-ACCOUNT-NUMBER OF HOST-ACCOUNT-ROW.
           MOVE WS-ACCOUNT-NUMBER TO LAST-ACCOUNT-NUMBER
           MOVE WS-ACCOUNT-TYPE(WS-CNT) TO
              HV-ACCOUNT-TYPE OF HOST-ACCOUNT-ROW.
           MOVE WS-ACCOUNT-INT-RATE(WS-CNT) TO
              HV-ACCOUNT-INTEREST-RATE OF HOST-ACCOUNT-ROW.
           MOVE '.' TO HV-ACCOUNT-OPENED-DELIM1.
           MOVE '.' TO HV-ACCOUNT-OPENED-DELIM2.
           MOVE WS-ACCOUNT-OVERDRAFT-LIM(WS-CNT) TO
              WS-OVERDRAFT-CONVERSION.
           MOVE WS-OVERDRAFT-CONVERSION TO
              HV-ACCOUNT-OVERDRAFT-LIMIT OF HOST-ACCOUNT-ROW.
           MOVE '2021' TO
              HV-ACCOUNT-LAST-STMT-YEAR OF HOST-ACCOUNT-ROW.
           MOVE '.' TO HV-ACCOUNT-LAST-STMT-DELIM1.
           MOVE '07' TO
              HV-ACCOUNT-LAST-STMT-MONTH OF HOST-ACCOUNT-ROW.
           MOVE '.' TO HV-ACCOUNT-LAST-STMT-DELIM2.
           MOVE '01' TO
              HV-ACCOUNT-LAST-STMT-DAY OF HOST-ACCOUNT-ROW.
           MOVE '2021' TO
              HV-ACCOUNT-NEXT-STMT-YEAR OF HOST-ACCOUNT-ROW.
           MOVE '.' TO HV-ACCOUNT-NEXT-STMT-DELIM1.
           MOVE '08' TO
              HV-ACCOUNT-NEXT-STMT-MONTH OF HOST-ACCOUNT-ROW.
           MOVE '.' TO HV-ACCOUNT-NEXT-STMT-DELIM2.
           MOVE '01' TO
              HV-ACCOUNT-NEXT-STMT-DAY OF HOST-ACCOUNT-ROW.
           COMPUTE HV-ACCOUNT-AVAILABLE-BALANCE
                  = ((999999 - 1)
           MOVE HV-ACCOUNT-AVAILABLE-BALANCE  TO
              HV-ACCOUNT-ACTUAL-BALANCE.
           IF HV-ACCOUNT-TYPE OF HOST-ACCOUNT-ROW = 'LOAN    ' OR
           HV-ACCOUNT-TYPE OF HOST-ACCOUNT-ROW = 'MORTGAGE'
                COMPUTE HV-ACCOUNT-ACTUAL-BALANCE =
                   0 - HV-ACCOUNT-ACTUAL-BALANCE OF HOST-ACCOUNT-ROW
                COMPUTE HV-ACCOUNT-AVAILABLE-BALANCE
                   OF HOST-ACCOUNT-ROW =
                   0 - HV-ACCOUNT-AVAILABLE-BALANCE OF HOST-ACCOUNT-ROW
           END-IF.
           EXEC SQL
              INSERT INTO ACCOUNT
                     (ACCOUNT_EYECATCHER,
                      ACCOUNT_CUSTOMER_NUMBER,
                      ACCOUNT_SORTCODE,
                      ACCOUNT_NUMBER,
                      ACCOUNT_TYPE,
                      ACCOUNT_INTEREST_RATE,
                      ACCOUNT_OPENED,
                      ACCOUNT_OVERDRAFT_LIMIT,
                      ACCOUNT_LAST_STATEMENT,
                      ACCOUNT_NEXT_STATEMENT,
                      ACCOUNT_AVAILABLE_BALANCE,
                      ACCOUNT_ACTUAL_BALANCE
                      )
              VALUES (:HV-ACCOUNT-EYECATCHER,
                      :HV-ACCOUNT-CUST-NO,
                      :HV-ACCOUNT-SORT-CODE,
                      :HV-ACCOUNT-NUMBER,
                      :HV-ACCOUNT-TYPE,
                      :HV-ACCOUNT-INTEREST-RATE,
                      :HV-ACCOUNT-OPENED,
                      :HV-ACCOUNT-OVERDRAFT-LIMIT,
                      :HV-ACCOUNT-LAST-STMT-DATE,
                      :HV-ACCOUNT-NEXT-STMT-DATE,
                      :HV-ACCOUNT-AVAILABLE-BALANCE,
                      :HV-ACCOUNT-ACTUAL-BALANCE
                     )
           END-EXEC.
           IF SQLCODE NOT = 0
              MOVE SQLCODE TO WS-SQLCODE-DISPLAY
              EVALUATE TRUE
              WHEN SQLERRD(3) EQUAL 13172878
                 MOVE 'TIMEOUT  (00C900E)' TO DISP-REASON-CODE
              WHEN SQLERRD(3) EQUAL 13172872
                 MOVE 'DEADLOCK (00C9088)' TO DISP-REASON-CODE
              WHEN OTHER
                  MOVE 'Unknown ReasonCode' TO DISP-REASON-CODE
              END-EVALUATE
              DISPLAY DISP-REASON-CODE
              DISPLAY 'Error inserting rows on ACCOUNT table.'
                  'For ACC no=' HV-ACCOUNT-NUMBER ' for SORTCODE='
                  HV-ACCOUNT-SORT-CODE
                  'SQLCODE=' WS-SQLCODE-DISPLAY
                     ',SQLSTATE=' SQLSTATE
                      ',SQLERRMC=' sqlerrmc(1:sqlerrmL)
                      ',sqlerrd(1)=' sqlerrd(1)
                      ',sqlerrd(2)=' sqlerrd(2)
                      ',sqlerrd(3)=' sqlerrd(3)
                      ',sqlerrd(4)=' sqlerrd(4)
                      ',sqlerrd(5)=' sqlerrd(5)
                      ',sqlerrd(6)=' sqlerrd(6)
              MOVE 12 TO RETURN-CODE
              PERFORM PROGRAM-DONE
           END-IF.
           MOVE WS-ACCOUNT-NUMBER TO LAST-ACCOUNT-NUMBER
           ADD 1 TO NUMBER-OF-ACCOUNTS GIVING NUMBER-OF-ACCOUNTS
           ADD 1 TO WS-ACCOUNT-NUMBER.
       PA999.
           EXIT.
       GENERATE-OPENED-DATE SECTION.
       GOD010.
           COMPUTE WS-ACCOUNT-OPENED-DAY
                  =  ((28 - 1)
           MOVE WS-ACCOUNT-OPENED-DAY TO HV-ACCOUNT-OPENED-DAY.
           COMPUTE WS-ACCOUNT-OPENED-MONTH
                  =  ((12 - 1)
           MOVE WS-ACCOUNT-OPENED-MONTH TO HV-ACCOUNT-OPENED-MONTH.
           COMPUTE WS-ACCOUNT-OPENED-YEAR
                  =  ((2014 -
                                    CUSTOMER-BIRTH-YEAR)
                                    CUSTOMER-BIRTH-YEAR.
           MOVE WS-ACCOUNT-OPENED-YEAR TO HV-ACCOUNT-OPENED-YEAR.
           ADD 1 TO OPENED-DATE-ATTEMPTS GIVING OPENED-DATE-ATTEMPTS.
           IF HV-ACCOUNT-OPENED-YEAR
              > CUSTOMER-BIRTH-YEAR
             MOVE 'Y' TO OPENED-DATE-VALID
             GO TO GOD999
           END-IF.
           IF OPENED-DATE-ATTEMPTS > 100
             MOVE 'Y' TO OPENED-DATE-VALID
             MOVE CUSTOMER-BIRTH-DAY   TO HV-ACCOUNT-OPENED-DAY
             MOVE CUSTOMER-BIRTH-MONTH TO HV-ACCOUNT-OPENED-MONTH
             MOVE CUSTOMER-BIRTH-YEAR  TO HV-ACCOUNT-OPENED-YEAR
           END-IF.
       GOD999.
           EXIT.
       INITIALISE-ARRAYS SECTION.
       IA010.
           MOVE TITLE-ALPHABET TO TITLE-WORDS.
           MOVE 50 TO FORENAMES-CNT.
           MOVE 'Michael' TO FORENAME(01).
           MOVE 'Will'    TO FORENAME(02).
           MOVE 'Geoff'   TO FORENAME(03).
           MOVE 'Chris'   TO FORENAME(04).
           MOVE 'Dave'    TO FORENAME(05).
           MOVE 'Luke'    TO FORENAME(06).
           MOVE 'Adam'    TO FORENAME(07).
           MOVE 'Giuseppe' TO FORENAME(08).
           MOVE 'James'   TO FORENAME(09).
           MOVE 'Jon'     TO FORENAME(10).
           MOVE 'Andy'    TO FORENAME(11).
           MOVE 'Lou'     TO FORENAME(12).
           MOVE 'Robert'  TO FORENAME(13).
           MOVE 'Sam'     TO FORENAME(14).
           MOVE 'Frederick' TO FORENAME(15).
           MOVE 'Buford'  TO FORENAME(16).
           MOVE 'William' TO FORENAME(17).
           MOVE 'Howard'  TO FORENAME(18).
           MOVE 'Anthony' TO FORENAME(19).
           MOVE 'Bruce'   TO FORENAME(20).
           MOVE 'Peter'   TO FORENAME(21).
           MOVE 'Stephen' TO FORENAME(22).
           MOVE 'Donald'  TO FORENAME(23).
           MOVE 'Dennis'  TO FORENAME(24).
           MOVE 'Harold'  TO FORENAME(25).
           MOVE 'Amy'     TO FORENAME(26).
           MOVE 'Belinda' TO FORENAME(27).
           MOVE 'Charlotte' TO FORENAME(28).
           MOVE 'Donna' TO FORENAME(29).
           MOVE 'Felicia' TO FORENAME(30).
           MOVE 'Gretchen' TO FORENAME(31).
           MOVE 'Henrietta' TO FORENAME(32).
           MOVE 'Imogen' TO FORENAME(33).
           MOVE 'Josephine' TO FORENAME(34).
           MOVE 'Kimberley' TO FORENAME(35).
           MOVE 'Lucy' TO FORENAME(36).
           MOVE 'Monica' TO FORENAME(37).
           MOVE 'Natalie' TO FORENAME(38).
           MOVE 'Ophelia' TO FORENAME(39).
           MOVE 'Patricia' TO FORENAME(40).
           MOVE 'Querida' TO FORENAME(41).
           MOVE 'Rachel' TO FORENAME(42).
           MOVE 'Samantha' TO FORENAME(43).
           MOVE 'Tanya'   TO FORENAME(44).
           MOVE 'Ulrika'  TO FORENAME(45).
           MOVE 'Virginia' TO FORENAME(46).
           MOVE 'Wendy'   TO FORENAME(47).
           MOVE 'Xaviera' TO FORENAME(48).
           MOVE 'Yvonne'  TO FORENAME(49).
           MOVE 'Zsa Zsa' TO FORENAME(50).
           MOVE 30 TO INITIALS-CNT.
           MOVE 'ABCDEFGHIJLKMNOPQRSTUVWXYZ    ' TO INITIALS.
           MOVE 50 TO SURNAMES-CNT.
           MOVE 'Jones'        TO SURNAME(01).
           MOVE 'Davidson'     TO SURNAME(02).
           MOVE 'Baker'        TO SURNAME(03).
           MOVE 'Smith'        TO SURNAME(04).
           MOVE 'Taylor'       TO SURNAME(05).
           MOVE 'Evans'        TO SURNAME(06).
           MOVE 'Roberts'      TO SURNAME(07).
           MOVE 'Wright'       TO SURNAME(08).
           MOVE 'Walker'       TO SURNAME(09).
           MOVE 'Green'        TO SURNAME(10).
           MOVE 'Price'        TO SURNAME(11).
           MOVE 'Downton'      TO SURNAME(12).
           MOVE 'Gatting'      TO SURNAME(13).
           MOVE 'Robinson'     TO SURNAME(14).
           MOVE 'Justice'      TO SURNAME(15).
           MOVE 'Tell'         TO SURNAME(16).
           MOVE 'Stark'        TO SURNAME(17).
           MOVE 'Strange'      TO SURNAME(18).
           MOVE 'Parker'       TO SURNAME(19).
           MOVE 'Blake'        TO SURNAME(20).
           MOVE 'Jackson'      TO SURNAME(21).
           MOVE 'Groves'       TO SURNAME(22).
           MOVE 'Palmer'       TO SURNAME(23).
           MOVE 'Ramsbottom'   TO SURNAME(24).
           MOVE 'Lloyd'        TO SURNAME(24).
           MOVE 'Hughes'       TO SURNAME(25).
           MOVE 'Briggs'       TO SURNAME(26).
           MOVE 'Higins'       TO SURNAME(27).
           MOVE 'Goodwin'      TO SURNAME(28).
           MOVE 'Valmont'      TO SURNAME(29).
           MOVE 'Brown'        TO SURNAME(30).
           MOVE 'Hopkins'      TO SURNAME(31).
           MOVE 'Bonney'       TO SURNAME(32).
           MOVE 'Jenkins'      TO SURNAME(33).
           MOVE 'Lloyd'        TO SURNAME(34).
           MOVE 'Wilmore'      TO SURNAME(35).
           MOVE 'Franklin'     TO SURNAME(36).
           MOVE 'Renton'       TO SURNAME(37).
           MOVE 'Seward'       TO SURNAME(38).
           MOVE 'Morris'       TO SURNAME(39).
           MOVE 'Johnson'      TO SURNAME(40).
           MOVE 'Brennan'      TO SURNAME(41).
           MOVE 'Thomson'      TO SURNAME(42).
           MOVE 'Barker'       TO SURNAME(43).
           MOVE 'Corbett'      TO SURNAME(44).
           MOVE 'Weber'        TO SURNAME(45).
           MOVE 'Leigh'        TO SURNAME(46).
           MOVE 'Croft'        TO SURNAME(47).
           MOVE 'Walken'       TO SURNAME(48).
           MOVE 'Dubois'       TO SURNAME(49).
           MOVE 'Stephens'     TO SURNAME(50).
           MOVE 26 TO STREET-NAME-T-CNT.
           MOVE 19 TO STREET-NAME-R-CNT.
           MOVE 'Acacia' to    STREET-NAME-TREE(1).
           MOVE 'Birch' to     STREET-NAME-TREE(2).
           MOVE 'Cypress' to   STREET-NAME-TREE(3).
           MOVE 'Douglas' to   STREET-NAME-TREE(4).
           MOVE 'Elm' to       STREET-NAME-TREE(5).
           MOVE 'Fir' to       STREET-NAME-TREE(6).
           MOVE 'Gorse' to     STREET-NAME-TREE(7).
           MOVE 'Holly' to     STREET-NAME-TREE(8).
           MOVE 'Ironwood' to  STREET-NAME-TREE(9).
           MOVE 'Joshua' to    STREET-NAME-TREE(10).
           MOVE 'Kapok' to     STREET-NAME-TREE(11).
           MOVE 'Laburnam' to  STREET-NAME-TREE(12).
           MOVE 'Maple' to     STREET-NAME-TREE(13).
           MOVE 'Nutmeg' to    STREET-NAME-TREE(14).
           MOVE 'Oak' to       STREET-NAME-TREE(15).
           MOVE 'Pine' to      STREET-NAME-TREE(16).
           MOVE 'Quercine' to  STREET-NAME-TREE(17).
           MOVE 'Rowan' to     STREET-NAME-TREE(18).
           MOVE 'Sycamore' to  STREET-NAME-TREE(19).
           MOVE 'Thorn' to     STREET-NAME-TREE(20).
           MOVE 'Ulmus' to     STREET-NAME-TREE(21).
           MOVE 'Viburnum' to  STREET-NAME-TREE(22).
           MOVE 'Willow' to    STREET-NAME-TREE(23).
           MOVE 'Xylophone' to STREET-NAME-TREE(24).
           MOVE 'Yew' to       STREET-NAME-TREE(25).
           MOVE 'Zebratree' to STREET-NAME-TREE(26).
           MOVE 'Avenue' to    STREET-NAME-ROAD(1).
           MOVE 'Boulevard' to STREET-NAME-ROAD(2).
           MOVE 'Close' to     STREET-NAME-ROAD(3).
           MOVE 'Crescent' to  STREET-NAME-ROAD(4).
           MOVE 'Drive' to     STREET-NAME-ROAD(5).
           MOVE 'Escalade' to  STREET-NAME-ROAD(6).
           MOVE 'Frontage' to  STREET-NAME-ROAD(7).
           MOVE 'Lane' to      STREET-NAME-ROAD(8).
           MOVE 'Mews' to      STREET-NAME-ROAD(9).
           MOVE 'Rise' to      STREET-NAME-ROAD(10).
           MOVE 'Court' to     STREET-NAME-ROAD(11).
           MOVE 'Opening' to   STREET-NAME-ROAD(12).
           MOVE 'Loke' to      STREET-NAME-ROAD(13).
           MOVE 'Square' to    STREET-NAME-ROAD(14).
           MOVE 'Houses' to    STREET-NAME-ROAD(15).
           MOVE 'Gate' to      STREET-NAME-ROAD(16).
           MOVE 'Street' to    STREET-NAME-ROAD(17).
           MOVE 'Grove' to     STREET-NAME-ROAD(18).
           MOVE 'March' to     STREET-NAME-ROAD(19).
           MOVE 50 TO TOWN-COUNT.
           MOVE 'Norwich'      TO TOWN(01).
           MOVE 'Acle   '      TO TOWN(02).
           MOVE 'Aylsham'      TO TOWN(03).
           MOVE 'Wymondham'    TO TOWN(04).
           MOVE 'Attleborough' TO TOWN(05).
           MOVE 'Cromer '      TO TOWN(06).
           MOVE 'Cambridge'    TO TOWN(07).
           MOVE 'Peterborough' TO TOWN(08).
           MOVE 'Weobley'      TO TOWN(09).
           MOVE 'Wembley'      TO TOWN(10).
           MOVE 'Hereford'     TO TOWN(11).
           MOVE 'Ross-on-Wye'  TO TOWN(12).
           MOVE 'Hay-on-Wye'   TO TOWN(13).
           MOVE 'Nottingham'   TO TOWN(14).
           MOVE 'Northampton'  TO TOWN(15).
           MOVE 'Nuneaton'     TO TOWN(16).
           MOVE 'Oxford'       TO TOWN(17).
           MOVE 'Oswestry'     TO TOWN(18).
           MOVE 'Ormskirk'     TO TOWN(19).
           MOVE 'Royston'      TO TOWN(20).
           MOVE 'Chilcomb'     TO TOWN(21).
           MOVE 'Winchester'   TO TOWN(22).
           MOVE 'Wrexham'      TO TOWN(23).
           MOVE 'Crewe  '      TO TOWN(24).
           MOVE 'Plymouth'     TO TOWN(25).
           MOVE 'Portsmouth'   TO TOWN(26).
           MOVE 'Forfar '      TO TOWN(27).
           MOVE 'Fife   '      TO TOWN(28).
           MOVE 'Aberdeen'     TO TOWN(29).
           MOVE 'Glasgow'      TO TOWN(30).
           MOVE 'Birmingham'   TO TOWN(31).
           MOVE 'Bolton'       TO TOWN(32).
           MOVE 'Whitby '      TO TOWN(33).
           MOVE 'Manchester'   TO TOWN(34).
           MOVE 'Chester '     TO TOWN(35).
           MOVE 'Leicester'    TO TOWN(36).
           MOVE 'Lowestoft'    TO TOWN(37).
           MOVE 'Ipswich'      TO TOWN(38).
           MOVE 'Colchester'   TO TOWN(39).
           MOVE 'Dover  '      TO TOWN(40).
           MOVE 'Brighton'     TO TOWN(41).
           MOVE 'Salisbury'    TO TOWN(42).
           MOVE 'Bristol'      TO TOWN(43).
           MOVE 'Bath   '      TO TOWN(44).
           MOVE 'Gloucester'   TO TOWN(45).
           MOVE 'Cheltenham'   TO TOWN(46).
           MOVE 'Durham '      TO TOWN(47).
           MOVE 'Carlisle'     TO TOWN(48).
           MOVE 'York   '      TO TOWN(49).
           MOVE 'Exeter '      TO TOWN(50).
           MOVE 5 TO ACCOUNT-TYPES-COUNT.
           MOVE 'ISA     ' TO WS-ACCOUNT-TYPE(1).
           MOVE 'SAVING  ' TO WS-ACCOUNT-TYPE(2).
           MOVE 'CURRENT ' TO WS-ACCOUNT-TYPE(3).
           MOVE 'LOAN    ' TO WS-ACCOUNT-TYPE(4).
           MOVE 'MORTGAGE' TO WS-ACCOUNT-TYPE(5).
           MOVE 5 TO ACCOUNT-INT-RATES-COUNT.
           MOVE 2.10       TO WS-ACCOUNT-INT-RATE(1).
           MOVE 1.75       TO WS-ACCOUNT-INT-RATE(2).
           MOVE 000000     TO WS-ACCOUNT-INT-RATE(3).
           MOVE 17.90      TO WS-ACCOUNT-INT-RATE(4).
           MOVE 5.25       TO WS-ACCOUNT-INT-RATE(5).
           MOVE 5 TO ACCOUNT-OVERDRAFT-COUNT.
           MOVE 0          TO WS-ACCOUNT-OVERDRAFT-LIM(1).
           MOVE 0          TO WS-ACCOUNT-OVERDRAFT-LIM(2).
           MOVE 00000100   TO WS-ACCOUNT-OVERDRAFT-LIM(3).
           MOVE 0          TO WS-ACCOUNT-OVERDRAFT-LIM(4).
           MOVE 0          TO WS-ACCOUNT-OVERDRAFT-LIM(5).
       IA999.
           EXIT.
       DELETE-DB2-ROWS SECTION.
       DBR010.
           MOVE SORTCODE TO HV-ACCOUNT-SORT-CODE.
           MOVE 'Deleting from ACCOUNT table'
             to TIMESTAMP-FUNCTION
           perform TIMESTAMP
           EXEC SQL
              DELETE FROM ACCOUNT
              WHERE ACCOUNT_SORTCODE = :HV-ACCOUNT-SORT-CODE
           END-EXEC.
           MOVE 'Deleting from ACCOUNT table COMPLETE'
             to TIMESTAMP-FUNCTION
           perform TIMESTAMP
           IF SQLCODE NOT = +100 AND
           SQLCODE NOT = 0
              MOVE SQLCODE TO DISP-SQLCD
              IF SQLCODE < 0
                 MOVE '-' TO DISP-SIGN
              ELSE
                 MOVE '+' TO DISP-SIGN
              END-IF
              EVALUATE TRUE
              WHEN SQLERRD(3) EQUAL 13172878
                 MOVE 'TIMEOUT  (00C900E)' TO DISP-REASON-CODE
              WHEN SQLERRD(3) EQUAL 13172872
                 MOVE 'DEADLOCK (00C9088)' TO DISP-REASON-CODE
              WHEN OTHER
                  MOVE 'Unknown ReasonCode' TO DISP-REASON-CODE
              END-EVALUATE
              DISPLAY 'Error deleting rows from ACCOUNT table. For'
                      ' SORTCODE=' HV-ACCOUNT-SORT-CODE
                      ' SQLCODE=' DISP-LOT
                      ' SQLREASON=' DISP-REASON-CODE ' ( '
                      SQLERRD (3) ')'
                      ',SQLSTATE=' SQLSTATE
                      ',SQLERRMC=' sqlerrmc(1:sqlerrmL)
                      ',sqlerrd(1)=' sqlerrd(1)
                      ',sqlerrd(2)=' sqlerrd(2)
                      ',sqlerrd(3)=' sqlerrd(3)
                      ',sqlerrd(4)=' sqlerrd(4)
                      ',sqlerrd(5)=' sqlerrd(5)
                      ',sqlerrd(6)=' sqlerrd(6)
              MOVE 12 TO RETURN-CODE
              PERFORM PROGRAM-DONE
           END-IF.
           MOVE SPACES TO HV-CONTROL-NAME
           STRING SORTCODE DELIMITED BY SIZE
           '-' DELIMITED BY SIZE
           'ACCOUNT-LAST' DELIMITED BY SIZE
           INTO HV-CONTROL-NAME
           MOVE 'Deleting from CONTROL table'
             to TIMESTAMP-FUNCTION.
           PERFORM TIMESTAMP.
           EXEC SQL
              DELETE FROM CONTROL
              WHERE CONTROL_NAME = :HV-CONTROL-NAME
           END-EXEC.
           MOVE 'Deleting from CONTROL table COMPLETE'
             to TIMESTAMP-FUNCTION.
           PERFORM TIMESTAMP.
           IF SQLCODE NOT = +100 AND
           SQLCODE NOT = 0
              MOVE SQLCODE TO DISP-SQLCD
              IF SQLCODE < 0
                 MOVE '-' TO DISP-SIGN
              ELSE
                 MOVE '+' TO DISP-SIGN
              END-IF
              EVALUATE TRUE
              WHEN SQLERRD(3) EQUAL 13172878
                 MOVE 'TIMEOUT  (00C900E)' TO DISP-REASON-CODE
              WHEN SQLERRD(3) EQUAL 13172872
                 MOVE 'DEADLOCK (00C9088)' TO DISP-REASON-CODE
              WHEN OTHER
                  MOVE 'Unknown ReasonCode' TO DISP-REASON-CODE
              END-EVALUATE
              DISPLAY 'Error deleting rows from CONTROL table. For'
                      ' CONTROL_NAME=' HV-CONTROL-NAME
                      ' SQLCODE=' DISP-LOT
                      ' SQLREASON=' DISP-REASON-CODE ' ( '
                      SQLERRD (3) ')'
                      ',SQLSTATE=' SQLSTATE
                      ',SQLERRMC=' sqlerrmc(1:sqlerrmL)
                      ',sqlerrd(1)=' sqlerrd(1)
                      ',sqlerrd(2)=' sqlerrd(2)
                      ',sqlerrd(3)=' sqlerrd(3)
                      ',sqlerrd(4)=' sqlerrd(4)
                      ',sqlerrd(5)=' sqlerrd(5)
                      ',sqlerrd(6)=' sqlerrd(6)
              MOVE 12 TO RETURN-CODE
              PERFORM PROGRAM-DONE
           END-IF.
           MOVE SPACES TO HV-CONTROL-NAME
           STRING SORTCODE DELIMITED BY SIZE
           '-' DELIMITED BY SIZE
           'ACCOUNT-COUNT' DELIMITED BY SIZE
           INTO HV-CONTROL-NAME
           MOVE 'Deleting from CONTROL table'
             to TIMESTAMP-FUNCTION.
           PERFORM TIMESTAMP.
           EXEC SQL
              DELETE FROM CONTROL
              WHERE CONTROL_NAME = :HV-CONTROL-NAME
           END-EXEC.
           MOVE 'Deleting from CONTROL table COMPLETE'
             to TIMESTAMP-FUNCTION.
           PERFORM TIMESTAMP.
           IF SQLCODE NOT = +100 AND
           SQLCODE NOT = 0
              MOVE SQLCODE TO DISP-SQLCD
              IF SQLCODE < 0
                 MOVE '-' TO DISP-SIGN
              ELSE
                 MOVE '+' TO DISP-SIGN
              END-IF
              EVALUATE TRUE
              WHEN SQLERRD(3) EQUAL 13172878
                 MOVE 'TIMEOUT  (00C900E)' TO DISP-REASON-CODE
              WHEN SQLERRD(3) EQUAL 13172872
                 MOVE 'DEADLOCK (00C9088)' TO DISP-REASON-CODE
              WHEN OTHER
                  MOVE 'Unknown ReasonCode' TO DISP-REASON-CODE
              END-EVALUATE
              DISPLAY 'Error deleting rows from CONTROL table. For'
                      ' CONTROL_NAME=' HV-CONTROL-NAME
                      ' SQLCODE=' DISP-LOT
                      ' SQLREASON=' DISP-REASON-CODE ' ( '
                      SQLERRD (3) ')'
                      ',SQLSTATE=' SQLSTATE
                      ',SQLERRMC=' sqlerrmc(1:sqlerrmL)
                      ',sqlerrd(1)=' sqlerrd(1)
                      ',sqlerrd(2)=' sqlerrd(2)
                      ',sqlerrd(3)=' sqlerrd(3)
                      ',sqlerrd(4)=' sqlerrd(4)
                      ',sqlerrd(5)=' sqlerrd(5)
                      ',sqlerrd(6)=' sqlerrd(6)
              MOVE 12 TO RETURN-CODE
              PERFORM PROGRAM-DONE
           END-IF.
           EXEC SQL
              COMMIT WORK
           END-EXEC.
       DBR999.
           EXIT.
       GET-TODAYS-DATE SECTION.
       GTD010.
           MOVE FUNCTION CURRENT-DATE TO WS-CURRENT-DATE-DATA.
           MOVE WS-CURRENT-DATE-DATA (1:8) TO WS-CURRENT-DATE-9.
           COMPUTE WS-TODAY-INT =
              FUNCTION INTEGER-OF-DATE (WS-CURRENT-DATE-9).
       GTD999.
           EXIT.
       CALC-DAY-OF-WEEK SECTION.
       CDW010.
           STRING 'MONDAY   TUESDAY  WEDNESDAYTHURSDAY FRIDAY   '
                  DELIMITED BY SIZE
                  'SATURDAY SUNDAY   '
                  DELIMITED BY SIZE
                  INTO WS-WEEKDAYS
           END-STRING.
           DIVIDE WS-CURRENT-DATE-9 BY 7 GIVING WS-DT
                                         REMAINDER
                                         WS-DT-REM.
           IF WS-DT-REM = 0
              MOVE 7 TO WS-DT-REM
           END-IF.
           MOVE WS-WEEKDAY(WS-DT-REM) TO WS-DAY-TODAY.
       CDW999.
           EXIT.
       TIMESTAMP SECTION.
           CALL 'CEEGMT' USING BY REFERENCE gmt-lilian
                                           BY REFERENCE gmt-seconds
                                           BY REFERENCE fc
           MOVE gmt-seconds TO period-next-f.
           COMPUTE period-next   = period-next-f.
           MOVE 14               TO datm-length.
           MOVE 'YYYYMMDDHHMISS' TO datm-format.
           CALL 'CEEDATM' USING BY REFERENCE period-next
                                BY REFERENCE datm-picture
                                BY REFERENCE datm-conv
                                BY REFERENCE fc.
           EXIT.
","       FILE SECTION.
       FD  CUSTOMER-FILE.
       01  CUSTOMER-RECORD-STRUCTURE.
           03 CUSTOMER-RECORD.
              05 CUSTOMER-EYECATCHER                 PIC X(4).
                 88 CUSTOMER-EYECATCHER-VALUE        VALUE 'CUST'.
              05 CUSTOMER-KEY.
                 07 CUSTOMER-SORTCODE                PIC 9(6) DISPLAY.
                 07 CUSTOMER-NUMBER                  PIC 9(10) DISPLAY.
              05 CUSTOMER-NAME                       PIC X(60).
              05 CUSTOMER-ADDRESS                    PIC X(160).
              05 CUSTOMER-DATE-OF-BIRTH              PIC 9(8).
              05 CUSTOMER-DOB-GROUP REDEFINES CUSTOMER-DATE-OF-BIRTH.
                 07 CUSTOMER-BIRTH-DAY               PIC 99.
                 07 CUSTOMER-BIRTH-MONTH             PIC 99.
                 07 CUSTOMER-BIRTH-YEAR              PIC 9999.
              05 CUSTOMER-CREDIT-SCORE               PIC 999.
              05 CUSTOMER-CS-REVIEW-DATE             PIC 9(8).
              05 CUSTOMER-CS-GROUP
                 REDEFINES CUSTOMER-CS-REVIEW-DATE.
                 07 CUSTOMER-CS-REVIEW-DAY           PIC 99.
                 07 CUSTOMER-CS-REVIEW-MONTH         PIC 99.
                 07 CUSTOMER-CS-REVIEW-YEAR          PIC 9999.
       WORKING-STORAGE SECTION.
           EXEC SQL
              INCLUDE ACCDB2
           END-EXEC.
       77  WS-ACCOUNT-OPENED-DAY PIC 99.
       77  WS-ACCOUNT-OPENED-MONTH PIC 99.
       77  WS-ACCOUNT-OPENED-YEAR PIC 9999.
       01 HOST-ACCOUNT-ROW.
           03 HV-ACCOUNT-DATA.
              05 HV-ACCOUNT-EYECATCHER         PIC X(4).
              05 HV-ACCOUNT-CUST-NO            PIC X(10).
              05 HV-ACCOUNT-KEY.
                 07 HV-ACCOUNT-SORT-CODE       PIC X(6).
                 07 HV-ACCOUNT-NUMBER          PIC X(8).
              05 HV-ACCOUNT-TYPE               PIC X(8).
              05 HV-ACCOUNT-INTEREST-RATE      PIC S9(4)V99 COMP-3.
              05 HV-ACCOUNT-OPENED             PIC X(10).
              05 HV-ACCOUNT-OPENED-GROUP REDEFINES HV-ACCOUNT-OPENED.
                 07 HV-ACCOUNT-OPENED-DAY      PIC XX.
                 07 HV-ACCOUNT-OPENED-DELIM1   PIC X.
                 07 HV-ACCOUNT-OPENED-MONTH    PIC XX.
                 07 HV-ACCOUNT-OPENED-DELIM2   PIC X.
                 07 HV-ACCOUNT-OPENED-YEAR     PIC X(4).
              05 HV-ACCOUNT-OVERDRAFT-LIMIT    PIC S9(9) COMP.
              05 HV-ACCOUNT-LAST-STMT-DATE     PIC X(10).
              05 HV-ACCOUNT-LAST-STMT-GROUP
                 REDEFINES HV-ACCOUNT-LAST-STMT-DATE.
                  07 HV-ACCOUNT-LAST-STMT-DAY   PIC XX.
                  07 HV-ACCOUNT-LAST-STMT-DELIM1 PIC X.
                  07 HV-ACCOUNT-LAST-STMT-MONTH  PIC XX.
                  07 HV-ACCOUNT-LAST-STMT-DELIM2 PIC X.
                  07 HV-ACCOUNT-LAST-STMT-YEAR   PIC X(4).
              05 HV-ACCOUNT-NEXT-STMT-DATE     PIC X(10).
              05 HV-ACCOUNT-NEXT-STMT-GROUP
                 REDEFINES HV-ACCOUNT-NEXT-STMT-DATE.
                 07 HV-ACCOUNT-NEXT-STMT-DAY    PIC XX.
                 07 HV-ACCOUNT-NEXT-STMT-DELIM1 PIC X.
                 07 HV-ACCOUNT-NEXT-STMT-MONTH  PIC XX.
                 07 HV-ACCOUNT-NEXT-STMT-DELIM2 PIC X.
                 07 HV-ACCOUNT-NEXT-STMT-YEAR   PIC X(4).
              05 HV-ACCOUNT-AVAILABLE-BALANCE  PIC S9(10)V99 COMP-3.
              05 HV-ACCOUNT-ACTUAL-BALANCE     PIC S9(10)V99 COMP-3.
       EXEC SQL
          INCLUDE SQLCA
       END-EXEC.
       01 DISP-LOT.
          03 DISP-SIGN      PIC X.
          03 DISP-SQLCD     PIC 9999.
       01 DISP-REASON-CODE             PIC X(18).
       01  START-KEY                   PIC 9(10) DISPLAY.
       01  END-KEY                     PIC 9(10) DISPLAY.
       01  STEP-KEY                    PIC 9(10) DISPLAY.
       01  TESTNM                      PIC 9(4)  DISPLAY.
       01  CUSTOMER-VSAM-STATUS.
           05 VSAM-STATUS1             PIC X.
           05 VSAM-STATUS2             PIC X.
       01  NEXT-KEY                    PIC 9(10) DISPLAY.
       01  FORENAMES.
           05 FORENAME                 PIC X(20)
                                       OCCURS 100 TIMES
                                       DEPENDING ON FORENAMES-CNT.
       01  FORENAMES-CNT               PIC 9(8) BINARY   VALUE 0.
       01  FORENAMES-PTR               PIC 9(8) BINARY   VALUE 0.
       01  STREET-NAME-TREES.
           05 STREET-NAME-TREE         PIC X(20)
                                       OCCURS 26 TIMES
                                       DEPENDING ON STREET-NAME-T-CNT.
       01  STREET-NAME-T-CNT           PIC 9(8) BINARY   VALUE 0.
       01  STREET-NAME-T-PTR           PIC 9(8) BINARY   VALUE 0.
       01  STREET-NAME-ROADS.
           05 STREET-NAME-ROAD         PIC X(20)
                                       OCCURS 19 TIMES
                                       DEPENDING ON STREET-NAME-R-CNT.
       01  STREET-NAME-R-CNT           PIC 9(8) BINARY   VALUE 0.
       01  STREET-NAME-R-PTR           PIC 9(8) BINARY   VALUE 0.
       01  TOWNS.
           05 TOWN                     PIC X(20)
                                       OCCURS 50 TIMES
                                       DEPENDING ON TOWN-COUNT.
       01  TOWN-COUNT                  PIC 9(8) BINARY   VALUE 0.
       01  TOWN-PTR                    PIC 9(8) BINARY   VALUE 0.
       01  INITIALS.
           05 INITIAL-CHARACTER                  PIC X
                                       OCCURS 30 TIMES.
       01  INITIALS-CNT                PIC 9(8) BINARY   VALUE 0.
       01  INITIALS-PTR                PIC 9(8) BINARY   VALUE 0.
       01 TITLE-WORDS.
           03 TITLE-WORD OCCURS 36 PIC X(9).
       01 TITLE-ALPHABET.
           03 FILLER PIC X(9) VALUE 'Mr'.
           03 FILLER PIC X(9) VALUE 'Mrs'.
           03 FILLER PIC X(9) VALUE 'Miss'.
           03 FILLER PIC X(9) VALUE 'Ms'.
           03 FILLER PIC X(9) VALUE 'Mr'.
           03 FILLER PIC X(9) VALUE 'Mrs'.
           03 FILLER PIC X(9) VALUE 'Miss'.
           03 FILLER PIC X(9) VALUE 'Ms'.
           03 FILLER PIC X(9) VALUE 'Mr'.
           03 FILLER PIC X(9) VALUE 'Mrs'.
           03 FILLER PIC X(9) VALUE 'Miss'.
           03 FILLER PIC X(9) VALUE 'Ms'.
           03 FILLER PIC X(9) VALUE 'Mr'.
           03 FILLER PIC X(9) VALUE 'Mrs'.
           03 FILLER PIC X(9) VALUE 'Miss'.
           03 FILLER PIC X(9) VALUE 'Ms'.
           03 FILLER PIC X(9) VALUE 'Mr'.
           03 FILLER PIC X(9) VALUE 'Mrs'.
           03 FILLER PIC X(9) VALUE 'Miss'.
           03 FILLER PIC X(9) VALUE 'Ms'.
           03 FILLER PIC X(9) VALUE 'Dr'.
           03 FILLER PIC X(9) VALUE 'Drs'.
           03 FILLER PIC X(9) VALUE 'Dr'.
           03 FILLER PIC X(9) VALUE 'Ms'.
           03 FILLER PIC X(9) VALUE 'Dr'.
           03 FILLER PIC X(9) VALUE 'Ms'.
           03 FILLER PIC X(9) VALUE 'Dr'.
           03 FILLER PIC X(9) VALUE 'Ms'.
           03 FILLER PIC X(9) VALUE 'Professor'.
           03 FILLER PIC X(9) VALUE 'Professor'.
           03 FILLER PIC X(9) VALUE 'Professor'.
           03 FILLER PIC X(9) VALUE 'Lord'.
           03 FILLER PIC X(9) VALUE 'Sir'.
           03 FILLER PIC X(9) VALUE 'Sir'.
           03 FILLER PIC X(9) VALUE 'Lady'.
           03 FILLER PIC X(9) VALUE 'Lady'.
       01 TITLE-NUMBER PIC S9(9) BINARY.
       01 HOUSE-NUMBER PIC 99.
       01  SURNAMES.
           05 SURNAME                  PIC X(20)
                                       OCCURS 100 TIMES
                                       DEPENDING ON SURNAMES-CNT.
       01  SURNAMES-CNT                PIC 9(8) BINARY   VALUE 0.
       01  SURNAMES-PTR                PIC 9(8) BINARY   VALUE 0.
       01  RDATE                       PIC X(21).
       01  RDATE-NUMERIC               REDEFINES RDATE
                                       PIC 9(16) USAGE DISPLAY.
       01  RANDOM-SEED                 PIC X(16).
       01  RANDOM-SEED-NUMERIC REDEFINES RANDOM-SEED PIC 9(16)
            USAGE DISPLAY.
       01 WS-CNT                       PIC 9    VALUE 0.
       77 SORTCODE           PIC 9(6) VALUE 987654.
       01 WS-ACCOUNT-NUMBER            PIC 9(8) VALUE 1.
       01 WS-ACCOUNT-TYPES.
           05 WS-ACCOUNT-TYPE          PIC X(8)
                                       OCCURS 5 TIMES
                                       DEPENDING ON
                                       ACCOUNT-TYPES-COUNT.
       01 ACCOUNT-TYPES-COUNT          PIC 9(8) BINARY  VALUE 0.
       01 ACCOUNT-TYPES-PTR            PIC 9(8) BINARY   VALUE 0.
       01 WS-ACCOUNT-INT-RATES.
           05 WS-ACCOUNT-INT-RATE      PIC 9(4)V99
                                       OCCURS 5 TIMES
                                       DEPENDING ON
                                       ACCOUNT-INT-RATES-COUNT.
       01 ACCOUNT-INT-RATES-COUNT      PIC 9(8) BINARY  VALUE 0.
       01 ACCOUNT-INT-RATES-PTR        PIC 9(8) BINARY   VALUE 0.
       01 WS-ACCOUNT-OVERDRAFT-LIMS.
           05 WS-ACCOUNT-OVERDRAFT-LIM PIC 9(8)
                                       OCCURS 5 TIMES
                                       DEPENDING ON
                                       ACCOUNT-OVERDRAFT-COUNT.
       01 ACCOUNT-OVERDRAFT-COUNT      PIC 9(8) BINARY  VALUE 0.
       01 ACCOUNT-OVERDRAFT-PTR        PIC 9(8) BINARY   VALUE 0.
       01 NO-OF-ACCOUNTS               PIC 9(8) BINARY   VALUE 0.
       01 WS-OVERDRAFT-CONVERSION      PIC S9(9) COMP VALUE 0.
       01 WS-PGM-NAME                             PIC X(8) VALUE ' '.
       01 WS-SQLCODE-DISPLAY             PIC S9(8) DISPLAY
           SIGN LEADING SEPARATE.
       01 OPENED-DATE-ATTEMPTS           PIC S9(8) DISPLAY
           SIGN LEADING SEPARATE.
       01 OPENED-DATE-VALID              PIC X VALUE 'N'.
       01 COMMIT-COUNT PIC S9(8) BINARY.
       01 time-data.
           05 tod-clock                PIC X(20).
           05 period-start             PIC X(14).
           05 period-next              COMP-2.
           05 period-next-f            PIC 9(14).
           05 gmt-lilian               PIC S9(8) BINARY.
           05 gmt-seconds              COMP-2.
           05 delay-interval           PIC S9(9) BINARY VALUE 1.
           05 fc                       PIC X(12).
           05 datm-conv                PIC X(80).
           05 datm-picture.
              10 datm-length           PIC 9999 COMP.
              10 datm-format           PIC X(14).
       01 TIMESTAMP-FUNCTION PIC X(40).
       01 WS-CURRENT-DATE-DATA.
           03 WS-CURRENT-DATE.
              05 WS-CURRENT-YYYY         PIC 9(4).
              05 WS-CURRENT-MM           PIC 99.
              05 WS-CURRENT-DD           PIC 99.
           03 WS-CURRENT-TIME.
              05 WS-CURRENT-HOURS        PIC 99.
              05 WS-CURRENT-MINS         PIC 99.
              05 WS-CURRENT-SECS         PIC 99.
              05 WS-CURRENT-MILLI        PIC 99.
           03 WS-DIFFERENCE-FROM-GMT     PIC S9(4).
       01 WS-CURRENT-DATE-9              PIC 9(8) VALUE 0.
       01 WS-TODAY-INT                   PIC 9(8) VALUE 0.
       01 WS-REVIEW-DATE-ADD             PIC 99 VALUE 0.
       01 WS-NEW-REVIEW-DATE-INT         PIC 9(8) VALUE 0.
       01 WS-NEW-REVIEW-YYYYMMDD         PIC 9(8) VALUE 0.
       01 CUSTOMER-CONTROL.
           03 CUSTOMER-CONTROL-RECORD.
              05 CUSTOMER-CONTROL-EYECATCHER             PIC X(4).
                 88 CUSTOMER-CONTROL-EYECATCHER-V        VALUE 'CTRL'.
              05 CUSTOMER-CONTROL-KEY.
                 07 CUSTOMER-CONTROL-SORTCODE        PIC 9(6) DISPLAY.
                 07 CUSTOMER-CONTROL-NUMBER          PIC 9(10) DISPLAY.
              05 NUMBER-OF-CUSTOMERS                 PIC 9(10) DISPLAY.
              05 LAST-CUSTOMER-NUMBER                PIC 9(10) DISPLAY.
              05 CUSTOMER-CONTROL-SUCCESS-FLAG       PIC X.
              88 CUSTOMER-CONTROL-SUCCESS VALUE 'Y'.
              05 CUSTOMER-CONTROL-FAIL-CODE PIC X.
              05 FILLER                              PIC X(38).
              05 FILLER                              PIC X(160).
              05 FILLER                              PIC 9(8).
              05 FILLER                              PIC 999.
              05 FILLER                              PIC 9(8).
       01 ACCOUNT-CONTROL.
              03 ACCOUNT-CONTROL-RECORD.
                 05 ACCOUNT-CONTROL-EYE-CATCHER        PIC X(4).
                 88 ACCOUNT-CONTROL-EYECATCHER-V   VALUE 'CTRL'.
                 05 FILLER                     PIC 9(10).
                 05 ACCOUNT-CONTROL-KEY.
                    07 ACCOUNT-CONTROL-SORT-CODE       PIC 9(6).
                    07 ACCOUNT-CONTROL-NUMBER          PIC 9(8).
                 05 NUMBER-OF-ACCOUNTS                 PIC 9(8).
                 05 LAST-ACCOUNT-NUMBER                PIC 9(8).
                 05 ACCOUNT-CONTROL-SUCCESS-FLAG       PIC X.
                 88 ACCOUNT-CONTROL-SUCCESS VALUE 'Y'.
                 05 ACCOUNT-CONTROL-FAIL-CODE PIC X.
                 05 FILLER                     PIC 9(4)V99.
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC 9(8).
                 05 FILLER                     PIC S9(10)V99.
                 05 FILLER                     PIC X(2).
           EXEC SQL
              INCLUDE CONTDB2
           END-EXEC.
       01 HOST-CONTROL-ROW.
           03 HV-CONTROL-NAME                  PIC X(32).
           03 HV-CONTROL-VALUE-NUM             PIC S9(9) COMP.
           03 HV-CONTROL-VALUE-STR             PIC X(40).
       01 WS-WEEKDAYS                    PIC X(63) VALUE ' '.
       01 WS-WEEKDAY-GROUP
           REDEFINES WS-WEEKDAYS.
           03 WS-WEEKDAY                 PIC X(9) OCCURS 7 TIMES.
       01 WS-DT                          PIC 9(8) VALUE 0.
       01 WS-DT-REM                      PIC S9(9) COMP VALUE 0.
       01 WS-DAY-OF-WEEK-VAL             PIC 9    VALUE 0.
       01 WS-DAY-TODAY                   PIC X(9) VALUE ' '.
       01 SQLCODE-DISPLAY                PIC S9(8) DISPLAY
           SIGN LEADING SEPARATE.
       LINKAGE SECTION.
       01 PARM-BUFFER.
           05 PARM-LENGTH              PIC 9(4) BINARY.
           05 PARM                     PIC X(256).
","['PREMIERE', 'PROGRAM-DONE', 'DEFINE-ACC', 'POPULATE-ACC', 'GENERATE-OPENED-DATE', 'INITIALISE-ARRAYS', 'DELETE-DB2-ROWS', 'GET-TODAYS-DATE', 'CALC-DAY-OF-WEEK', 'TIMESTAMP', 'A010', 'A999', 'PD010', 'PD999', 'DA010', 'DA999', 'PA010', 'PA999', 'GOD010', 'GOD999', 'IA010', 'IA999', 'DBR010', 'DBR999', 'GTD010', 'GTD999', 'CDW010', 'CDW999']","Paragraph PREMIERE calls paragraph TIMESTAMP, DEFINE-ACC, GET-TODAYS-DATE, INITIALISE-ARRAYS, DELETE-DB2-ROWS, PROGRAM-DONE.
Paragraph POPULATE-ACC calls paragraph PROGRAM-DONE, GENERATE-OPENED-DATE.
Paragraph GENERATE-OPENED-DATE calls paragraph GOD999.
Paragraph DELETE-DB2-ROWS calls paragraph TIMESTAMP, PROGRAM-DONE.
",1061,"Title: BANKDATA Description: Batch program to initialise the data used in the bank application. Datastores populated by this program include CUSTOMER (VSAM) and ACCOUNT (DB2). Input: parm='fffffff,ttttttt,ssssss,rrrrrr' where fffffff is the key to start generating from ttttttt is the last key to generate sssssss is the step for generation rrrrrrr is the random event seed Output: The populated VSAM file CUSTOMER, the DB2 table ACCOUNT.",,"['CEEDATM', 'CEEGMT']",,Error Long,1,1,1,"This COBOL file generates a database of customer records by initializing variables, reading parameters, and processing customer numbers. It includes sections for generating account details, populating tables, and managing opened dates. The program also deletes existing database rows as needed, retrieves the current date, and calculates additional timestamps. Finally, it gracefully concludes by calling the appropriate termination routines. Each section is interconnected, ensuring a logical flow of data processing and record management.",
146,cicsdev_cics-banking-sample-application-cbsa,cics-banking-sample-application-cbsa/src/base/cobol_src/BNK1DAC.cbl,"       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)
       CBL CICS('SP,EDF')
       IDENTIFICATION DIVISION.
       PROGRAM-ID. BNK1DAC.
       AUTHOR. Jon Collett.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.  IBM-370.
       OBJECT-COMPUTER.  IBM-370.
       INPUT-OUTPUT SECTION.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01 WS-CICS-WORK-AREA.
          03 WS-CICS-RESP              PIC S9(8) COMP VALUE 0.
          03 WS-CICS-RESP2             PIC S9(8) COMP VALUE 0.
       01 WS-FAIL-INFO.
          03 FILLER                    PIC X(9)  VALUE 'BNK1DAC  '.
          03 WS-CICS-FAIL-MSG          PIC X(70) VALUE ' '.
          03 FILLER                    PIC X(6)  VALUE ' RESP='.
          03 WS-CICS-RESP-DISP         PIC 9(10) VALUE 0.
          03 FILLER                    PIC X(7)  VALUE ' RESP2='.
          03 WS-CICS-RESP2-DISP        PIC 9(10) VALUE 0.
          03 FILLER                    PIC X(15)
                                          VALUE ' ABENDING TASK.'.
       01 SWITCHES.
           03 VALID-DATA-SW            PIC X VALUE 'Y'.
              88 VALID-DATA               VALUE 'Y'.
       01 FLAGS.
           03 SEND-FLAG                PIC X.
              88 SEND-ERASE               VALUE '1'.
              88 SEND-DATAONLY            VALUE '2'.
              88 SEND-DATAONLY-ALARM      VALUE '3'.
       01 ACTION-ALPHA.
           03 ACTION-NUM               PIC 9.
       01 END-OF-SESSION-MESSAGE       PIC X(13) VALUE 'Session Ended'.
       01 RESPONSE-CODE                PIC S9(8) COMP.
       01 COMMUNICATION-AREA           PIC X.
       01 COMM-OPENED-SPLIT.
          03 COMM-OPENED-SPLIT-DD      PIC 99.
          03 COMM-OPENED-SPLIT-MM      PIC 99.
          03 COMM-OPENED-SPLIT-YY      PIC 9999.
       01 COMM-LAST-ST-SPLIT.
          03 COMM-LAST-ST-DD           PIC 99.
          03 COMM-LAST-ST-MM           PIC 99.
          03 COMM-LAST-ST-YY           PIC 9999.
       01 COMM-NEXT-ST-SPLIT.
          03 COMM-NEXT-ST-DD           PIC 99.
          03 COMM-NEXT-ST-MM           PIC 99.
          03 COMM-NEXT-ST-YY           PIC 9999.
       01 PARMS-SUBPGM.
          03 PARMS-SUBPGM-EYE          PIC X(4).
          88 PARMS-SUBPGM-EYE-VALID        VALUE 'ACCT'.
          03 PARMS-SUBPGM-CUSTNO       PIC X(10).
          03 PARMS-SUBPGM-SCODE        PIC X(6).
          03 PARMS-SUBPGM-ACCNO        PIC 9(8).
          03 PARMS-SUBPGM-ACC-TYPE     PIC X(8).
          03 PARMS-SUBPGM-INT-RATE     PIC 9(4)V99.
          03 PARMS-SUBPGM-OPENED       PIC 9(8).
          03 PARMS-SUBPGM-OVERDRAFT    PIC 9(8).
          03 PARMS-SUBPGM-LAST-STMT-DT PIC 9(8).
          03 PARMS-SUBPGM-NEXT-STMT-DT PIC 9(8).
          03 PARMS-SUBPGM-AVAIL-BAL    PIC S9(10)V99.
          03 PARMS-SUBPGM-ACTUAL-BAL   PIC S9(10)V99.
          03 PARMS-SUBPGM-SUCCESS      PIC X.
          03 PARMS-SUBPGM-FAIL-CD      PIC X.
          03 PARMS-SUBPGM-DEL-SUCCESS  PIC X.
          03 PARMS-SUBPGM-DEL-FAIL-CD  PIC X.
          03 PARMS-SUBPGM-DEL-APPLID   PIC X(8).
          03 PARMS-SUBPGM-DEL-PCB1     POINTER.
          03 PARMS-SUBPGM-DEL-PCB2     POINTER.
          03 PARMS-SUBPGM-DEL-PCB3     POINTER.
       01 INQACC-COMMAREA.
          03 INQACC-EYE                  PIC X(4).
          03 INQACC-CUSTNO               PIC 9(10).
          03 INQACC-SCODE                PIC 9(6).
          03 INQACC-ACCNO                PIC 9(8).
          03 INQACC-ACC-TYPE             PIC X(8).
          03 INQACC-INT-RATE             PIC 9(4)V99.
          03 INQACC-OPENED               PIC 9(8).
          03 INQACC-OPENED-GROUP REDEFINES INQACC-OPENED.
            05 INQACC-OPENED-DAY         PIC 99.
            05 INQACC-OPENED-MONTH         PIC 99.
            05 INQACC-OPENED-YEAR         PIC 9999.
          03 INQACC-OVERDRAFT            PIC 9(8).
          03 INQACC-LAST-STMT-DT         PIC 9(8).
          03 INQACC-LAST-STMT-GROUP REDEFINES INQACC-LAST-STMT-DT.
            05 INQACC-LAST-STMT-DAY         PIC 99.
            05 INQACC-LAST-STMT-MONTH         PIC 99.
            05 INQACC-LAST-STMT-YEAR         PIC 9999.
          03 INQACC-NEXT-STMT-DT         PIC 9(8).
          03 INQACC-NEXT-STMT-GROUP REDEFINES INQACC-NEXT-STMT-DT.
            05 INQACC-NEXT-STMT-DAY         PIC 99.
            05 INQACC-NEXT-STMT-MONTH         PIC 99.
            05 INQACC-NEXT-STMT-YEAR         PIC 9999.
          03 INQACC-AVAIL-BAL            PIC S9(10)V99.
          03 INQACC-ACTUAL-BAL           PIC S9(10)V99.
          03 INQACC-SUCCESS              PIC X.
          03 INQACC-PCB1-POINTER         POINTER.
       01 WS-COMM-AREA.
          03 WS-COMM-EYE               PIC X(4).
          03 WS-COMM-CUSTNO            PIC X(10).
          03 WS-COMM-SCODE             PIC X(6).
          03 WS-COMM-ACCNO             PIC 9(8).
          03 WS-COMM-ACC-TYPE          PIC X(8).
          03 WS-COMM-INT-RATE          PIC 9(4)V99.
          03 WS-COMM-OPENED            PIC 9(8).
          03 WS-COMM-OVERDRAFT         PIC 9(8).
          03 WS-COMM-LAST-STMT-DT      PIC 9(8).
          03 WS-COMM-NEXT-STMT-DT      PIC 9(8).
          03 WS-COMM-AVAIL-BAL         PIC S9(10)V99.
          03 WS-COMM-ACTUAL-BAL        PIC S9(10)V99.
          03 WS-COMM-SUCCESS           PIC X.
          03 WS-COMM-FAIL-CD           PIC X.
          03 WS-COMM-DEL-SUCCESS       PIC X.
          03 WS-COMM-DEL-FAIL-CD       PIC X.
       01 COMM-AVAIL-BAL-DISP          PIC 9(12).
       01 COMM-ACT-BAL-DISP            PIC 9(12).
       01 WS-STUFF.
          03 WS-AVAIL-BAL-UNSIGN       PIC 9(12).
          03 WS-ACT-BAL-UNSIGN         PIC 9(12).
       01 COMPANY-NAME-FULL            PIC X(32).
       01 AVAILABLE-BALANCE-DISPLAY    PIC +9(10).99.
       01 ACTUAL-BALANCE-DISPLAY       PIC +9(10).99.
       01 WS-U-TIME                    PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                 PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD              PIC 99.
          03 FILLER                       PIC X.
          03 WS-ORIG-DATE-MM              PIC 99.
          03 FILLER                       PIC X.
          03 WS-ORIG-DATE-YYYY            PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-MM-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X       PIC X(4).
       01 WS-TIME-DATA.
           03 WS-TIME-NOW              PIC 9(6).
           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
              05 WS-TIME-NOW-GRP-HH       PIC 99.
              05 WS-TIME-NOW-GRP-MM       PIC 99.
              05 WS-TIME-NOW-GRP-SS       PIC 99.
       01 WS-ABEND-PGM                 PIC X(8) VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
           03 COMM-EYE                 PIC X(4).
           03 COMM-CUSTNO              PIC X(10).
           03 COMM-SCODE               PIC X(6).
           03 COMM-ACCNO               PIC 9(8).
           03 COMM-ACC-TYPE            PIC X(8).
           03 COMM-INT-RATE            PIC 9(6).
           03 COMM-OPENED              PIC 9(8).
           03 COMM-OVERDRAFT           PIC 9(8).
           03 COMM-LAST-STMT-DT        PIC 9(8).
           03 COMM-NEXT-STMT-DT        PIC 9(8).
           03 COMM-AVAIL-BAL           PIC S9(10)V99.
           03 COMM-ACTUAL-BAL          PIC S9(10)V99.
           03 COMM-SUCCESS             PIC X.
           03 COMM-FAIL-CD             PIC X.
           03 COMM-DEL-SUCCESS         PIC X.
           03 COMM-DEL-FAIL-CD         PIC X.
       PROCEDURE DIVISION.
       PREMIERE SECTION.
       A010.
           EVALUATE TRUE
              WHEN EIBCALEN = ZERO
                 MOVE LOW-VALUE TO BNK1DAO
                 MOVE -1 TO ACCNOL
                 SET SEND-ERASE TO TRUE
                 INITIALIZE WS-COMM-AREA
                 PERFORM SEND-MAP
              WHEN EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
                 CONTINUE
              WHEN EIBAID = DFHPF3
                 EXEC CICS RETURN
                    TRANSID('OMEN')
                    IMMEDIATE
                    RESP(WS-CICS-RESP)
                    RESP2(WS-CICS-RESP2)
                 END-EXEC
              WHEN EIBAID = DFHPF5
                 PERFORM PROCESS-MAP
              WHEN EIBAID = DFHPF12
                 PERFORM SEND-TERMINATION-MSG
                 EXEC CICS
                    RETURN
                 END-EXEC
              WHEN EIBAID = DFHCLEAR
                EXEC CICS SEND CONTROL
                          ERASE
                          FREEKB
                END-EXEC
                EXEC CICS RETURN
                END-EXEC
              WHEN EIBAID = DFHENTER
                 PERFORM PROCESS-MAP
              WHEN OTHER
                 MOVE LOW-VALUES TO BNK1DAO
                 MOVE 'Invalid key pressed.' TO MESSAGEO
                 MOVE -1 TO ACCNOL
                 SET SEND-DATAONLY-ALARM TO TRUE
                 PERFORM SEND-MAP
           END-EVALUATE.
           IF EIBCALEN NOT = ZERO
              IF INQACC-EYE = 'ACCT'
                 MOVE INQACC-EYE          TO WS-COMM-EYE
                 MOVE INQACC-CUSTNO       TO WS-COMM-CUSTNO
                 MOVE INQACC-SCODE        TO WS-COMM-SCODE
                 MOVE INQACC-ACCNO        TO WS-COMM-ACCNO
                 MOVE INQACC-ACC-TYPE     TO WS-COMM-ACC-TYPE
                 MOVE INQACC-INT-RATE     TO WS-COMM-INT-RATE
                 MOVE INQACC-OPENED       TO WS-COMM-OPENED
                 MOVE INQACC-OVERDRAFT    TO WS-COMM-OVERDRAFT
                 MOVE INQACC-LAST-STMT-DT TO WS-COMM-LAST-STMT-DT
                 MOVE INQACC-NEXT-STMT-DT TO WS-COMM-NEXT-STMT-DT
                 MOVE INQACC-AVAIL-BAL    TO WS-COMM-AVAIL-BAL
                 MOVE INQACC-ACTUAL-BAL   TO WS-COMM-ACTUAL-BAL
                 MOVE INQACC-SUCCESS      TO WS-COMM-SUCCESS
              ELSE
                 INITIALIZE WS-COMM-AREA
              END-IF
           END-IF.
           EXEC CICS
              RETURN TRANSID('ODAC')
              COMMAREA(WS-COMM-AREA)
              LENGTH(102)
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'A010 - RETURN TRANSID(ODAC) FAIL.'
                    DELIMITED BY SIZE,
                    'EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1DAC - A010 - RETURN TRANSID(ODAC) FAIL' TO
                 WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM ABEND-THIS-TASK
           END-IF.
       A999.
           EXIT.
       PROCESS-MAP SECTION.
       PM010.
           PERFORM RECEIVE-MAP.
           IF EIBAID = DFHENTER
              PERFORM EDIT-DATA
              IF VALID-DATA
                 PERFORM GET-ACC-DATA
              ELSE
                 INITIALIZE PARMS-SUBPGM
              END-IF
           END-IF.
           IF EIBAID = DFHPF5
              PERFORM VALIDATE-DATA
              IF VALID-DATA
                 PERFORM DEL-ACC-DATA
              END-IF
           END-IF.
           SET SEND-DATAONLY-ALARM TO TRUE.
           PERFORM SEND-MAP.
       PM999.
           EXIT.
       RECEIVE-MAP SECTION.
       RM010.
           EXEC CICS
              RECEIVE MAP('BNK1DA')
              MAPSET('BNK1DAM')
              INTO(BNK1DAI)
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'RM010 - RECEIVE MAP FAIL.'
                    DELIMITED BY SIZE,
                    'EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1DAC - RM010 - RECEIVE MAP FAIL ' TO
                 WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM ABEND-THIS-TASK
           END-IF.
       RM999.
           EXIT.
       EDIT-DATA SECTION.
       ED010.
           IF ACCNOI = LOW-VALUES
           OR ACCNOL = 0
             MOVE 'Please enter an account number.' TO
                 MESSAGEO
             MOVE 'N' TO VALID-DATA-SW
             GO TO ED999
           END-IF
           EXEC CICS BIF DEEDIT
              FIELD(ACCNOI)
           END-EXEC
           IF ACCNOI NOT NUMERIC
              MOVE 'Please enter an account number.' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
           END-IF.
       ED999.
           EXIT.
       VALIDATE-DATA SECTION.
       VD010.
           IF COMM-SCODE = ZEROES OR LOW-VALUES
           OR COMM-ACCNO = ZEROES OR LOW-VALUES
              MOVE 'N' TO VALID-DATA-SW
              MOVE SPACES TO MESSAGEO
              STRING 'Please enter an account number.'
                  DELIMITED BY SIZE,
                  INTO MESSAGEO
              MOVE -1 TO ACCNOL
            END-IF.
       VD999.
           EXIT.
       GET-ACC-DATA SECTION.
       GAD010.
           INITIALIZE PARMS-SUBPGM INQACC-COMMAREA
           SET INQACC-PCB1-POINTER TO NULL
           MOVE ACCNOI TO PARMS-SUBPGM-ACCNO INQACC-ACCNO.
           EXEC CICS LINK
              PROGRAM('INQACC')
              COMMAREA(INQACC-COMMAREA)
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
              SYNCONRETURN
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'GAD010  - LINK INQACC FAIL.'
                    DELIMITED BY SIZE,
                    'EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1DAC - GAD010 - LINK INQACC  FAIL      '
                 TO WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM ABEND-THIS-TASK
           END-IF.
           IF INQACC-ACC-TYPE  = SPACES AND
           INQACC-INT-RATE  = 0
           AND INQACC-SUCCESS = 'N'
              MOVE 'Sorry, but that account number was not found.' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE SPACES   TO SORTCO
              MOVE SPACES   TO CUSTNOO
              MOVE SPACES   TO ACCNO2O
              MOVE SPACES   TO ACTYPEO
              MOVE zero     TO INTRTO
              MOVE SPACES   TO COMM-OPENED-SPLIT
              MOVE SPACES   TO OPENDDO
              MOVE SPACES   TO OPENMMO
              MOVE SPACES   TO OPENYYO
              MOVE SPACES   TO OVERDRO
              MOVE SPACES   TO COMM-LAST-ST-SPLIT
              MOVE SPACES   TO LSTMTDDO
              MOVE SPACES   TO LSTMTMMO
              MOVE SPACES   TO LSTMTYYO
              MOVE SPACES   TO COMM-NEXT-ST-SPLIT
              MOVE SPACES   TO NSTMTDDO
              MOVE SPACES   TO NSTMTMMO
              MOVE SPACES   TO NSTMTYYO
              MOVE zero     TO AVAILABLE-BALANCE-DISPLAY
              MOVE zero     TO ACTUAL-BALANCE-DISPLAY
              MOVE available-balance-display TO AVBALO
              MOVE actual-balance-display    TO ACTBALO
              GO TO GAD999
           END-IF.
           MOVE INQACC-SCODE             TO SORTCO.
           MOVE INQACC-CUSTNO            TO CUSTNOO.
           MOVE INQACC-ACCNO             TO ACCNO2O.
           MOVE INQACC-ACC-TYPE          TO ACTYPEO.
           MOVE INQACC-INT-RATE          TO INTRTO.
           MOVE INQACC-OPENED            TO COMM-OPENED-SPLIT.
           MOVE COMM-OPENED-SPLIT-DD     TO OPENDDO.
           MOVE COMM-OPENED-SPLIT-MM     TO OPENMMO.
           MOVE COMM-OPENED-SPLIT-YY     TO OPENYYO.
           MOVE INQACC-OVERDRAFT    TO OVERDRO.
           MOVE INQACC-LAST-STMT-DT TO COMM-LAST-ST-SPLIT.
           MOVE COMM-LAST-ST-DD           TO LSTMTDDO.
           MOVE COMM-LAST-ST-MM           TO LSTMTMMO.
           MOVE COMM-LAST-ST-YY           TO LSTMTYYO.
           MOVE INQACC-NEXT-STMT-DT TO COMM-NEXT-ST-SPLIT.
           MOVE COMM-NEXT-ST-DD           TO NSTMTDDO.
           MOVE COMM-NEXT-ST-MM           TO NSTMTMMO.
           MOVE COMM-NEXT-ST-YY           TO NSTMTYYO.
           MOVE INQACC-AVAIL-BAL      TO AVAILABLE-BALANCE-DISPLAY.
           MOVE INQACC-ACTUAL-BAL     TO ACTual-balance-display.
           MOVE available-balance-display TO AVBALO
           MOVE actual-balance-display    TO ACTBALO
           MOVE SPACES TO MESSAGEO.
           STRING 'If you wish to delete the Account press <PF5>.'
                 DELIMITED BY SIZE,
                 ' ' DELIMITED BY SIZE
                 INTO MESSAGEO.
       GAD999.
           EXIT.
       DEL-ACC-DATA SECTION.
       DAD010.
           INITIALIZE PARMS-SUBPGM
           COMPUTE PARMS-SUBPGM-ACCNO = FUNCTION NUMVAL(ACCNO2I)
           SET PARMS-SUBPGM-DEL-PCB1 TO NULL.
           SET PARMS-SUBPGM-DEL-PCB2 TO NULL.
           SET PARMS-SUBPGM-DEL-PCB3 TO NULL.
           EXEC CICS LINK
              PROGRAM('DELACC')
              COMMAREA(PARMS-SUBPGM)
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
              SYNCONRETURN
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1DAC - DAD010 - LINK DELACC  FAIL      '
                 TO WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM ABEND-THIS-TASK
           END-IF.
           IF PARMS-SUBPGM-DEL-SUCCESS = 'N' AND
           PARMS-SUBPGM-DEL-FAIL-CD = '1'
              MOVE SPACES TO MESSAGEO
              STRING 'Sorry, but that account number was not found.'
                 DELIMITED BY SIZE,
                 ' Account NOT deleted.' DELIMITED BY SIZE
                 INTO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE PARMS-SUBPGM-SCODE   TO SORTCO
              GO TO DAD999
           END-IF.
           IF PARMS-SUBPGM-DEL-SUCCESS = 'N' AND
           PARMS-SUBPGM-DEL-FAIL-CD = '2'
              MOVE SPACES TO MESSAGEO
              STRING 'Sorry, but a datastore error occurred.'
                 DELIMITED BY SIZE,
                 ' Account NOT deleted.' DELIMITED BY SIZE
                 INTO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE PARMS-SUBPGM-SCODE   TO SORTCO
              GO TO DAD999
           END-IF.
           IF PARMS-SUBPGM-DEL-SUCCESS = 'N' AND
           PARMS-SUBPGM-DEL-FAIL-CD = '3'
              MOVE SPACES TO MESSAGEO
              STRING 'Sorry, but a delete error occurred.'
                 DELIMITED BY SIZE,
                 ' Account NOT deleted.' DELIMITED BY SIZE
                 INTO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE PARMS-SUBPGM-SCODE   TO SORTCO
              GO TO DAD999
           END-IF.
           IF PARMS-SUBPGM-DEL-SUCCESS = 'N'
              MOVE SPACES TO MESSAGEO
              STRING 'Sorry, but a delete error occurred.'
                 DELIMITED BY SIZE,
                 ' Account NOT deleted.' DELIMITED BY SIZE
                 INTO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE PARMS-SUBPGM-SCODE   TO SORTCO
              GO TO DAD999
           END-IF.
           MOVE SPACES TO SORTCO.
           MOVE SPACES TO CUSTNOO.
           MOVE SPACES TO ACCNO2O.
           MOVE SPACES TO ACTYPEO.
           MOVE ZERO TO INTRTO.
           MOVE SPACES TO OPENDDO.
           MOVE SPACES TO OPENMMO.
           MOVE SPACES TO OPENYYO.
           MOVE SPACES TO OVERDRO.
           MOVE SPACES TO LSTMTDDO.
           MOVE SPACES TO LSTMTMMO.
           MOVE SPACES TO LSTMTYYO.
           MOVE SPACES TO NSTMTDDO.
           MOVE SPACES TO NSTMTMMO.
           MOVE SPACES TO NSTMTYYO.
           MOVE ZERO TO AVAILABLE-BALANCE-DISPLAY.
           MOVE ZERO TO ACTUAL-BALANCE-DISPLAY.
           MOVE AVAILABLE-BALANCE-DISPLAY TO AVBALO
           MOVE ACTUAL-BALANCE-DISPLAY    TO ACTBALO
           MOVE SPACES TO MESSAGEO.
           STRING 'Account ' DELIMITED BY SIZE,
                 PARMS-SUBPGM-ACCNO DELIMITED BY SIZE,
                 ' was successfully deleted.'
                 DELIMITED BY SIZE,
                 INTO MESSAGEO
           END-STRING.
       DAD999.
           EXIT.
       SEND-MAP SECTION.
       SM010.
           IF SEND-ERASE
              EXEC CICS SEND MAP('BNK1DA')
                 MAPSET('BNK1DAM')
                 FROM(BNK1DAO)
                 ERASE
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'SM010 - SEND MAP ERASE FAIL.'
                       DELIMITED BY SIZE,
                       'EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNK1DAC - SM010 - SEND MAP ERASE FAIL '
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
              GO TO SM999
           END-IF.
           IF SEND-DATAONLY
              IF MESSAGEO IS NOT EQUAL SPACES
              AND MESSAGEO IS NOT EQUAL LOW-VALUES
                 MOVE 'Account lookup successful.' TO MESSAGEO
              END-IF
              EXEC CICS SEND MAP('BNK1DA')
                 MAPSET('BNK1DAM')
                 FROM(BNK1DAO)
                 DATAONLY
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'SM010 - SEND MAP DATAONLY FAIL.'
                       DELIMITED BY SIZE,
                       'EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNK1DAC - SM010 - SEND MAP DATAONLY FAIL '
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
              GO TO SM999
           END-IF.
           IF SEND-DATAONLY-ALARM
              EXEC CICS SEND MAP('BNK1DA')
                 MAPSET('BNK1DAM')
                 FROM(BNK1DAO)
                 DATAONLY
                 ALARM
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'SM010 - SEND MAP DATAONLY ALARM FAIL.'
                       DELIMITED BY SIZE,
                       'EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNK1DAC - SM010 - SEND MAP DATAONLY ALARM FAIL '
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
           END-IF.
       SM999.
           EXIT.
       SEND-TERMINATION-MSG SECTION.
       STM010.
           EXEC CICS SEND TEXT
              FROM(END-OF-SESSION-MESSAGE)
              ERASE
              FREEKB
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'STM010 - SEND TEXT FAIL.'
                    DELIMITED BY SIZE,
                    'EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1DAC - STM010 - SEND TEXT FAIL'
                 TO WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM ABEND-THIS-TASK
           END-IF.
       STM999.
           EXIT.
       ABEND-THIS-TASK SECTION.
       ATT010.
           EXEC CICS ABEND
                ABCODE('HBNK')
                NODUMP
           END-EXEC.
       ATT999.
           EXIT.
       POPULATE-TIME-DATE SECTION.
       PTD010.
           EXEC CICS ASKTIME
              ABSTIME(WS-U-TIME)
           END-EXEC.
           EXEC CICS FORMATTIME
                     ABSTIME(WS-U-TIME)
                     DDMMYYYY(WS-ORIG-DATE)
                     TIME(WS-TIME-NOW)
                     DATESEP
           END-EXEC.
       PTD999.
           EXIT.
","       WORKING-STORAGE SECTION.
       01 WS-CICS-WORK-AREA.
          03 WS-CICS-RESP              PIC S9(8) COMP VALUE 0.
          03 WS-CICS-RESP2             PIC S9(8) COMP VALUE 0.
       01 WS-FAIL-INFO.
          03 FILLER                    PIC X(9)  VALUE 'BNK1DAC  '.
          03 WS-CICS-FAIL-MSG          PIC X(70) VALUE ' '.
          03 FILLER                    PIC X(6)  VALUE ' RESP='.
          03 WS-CICS-RESP-DISP         PIC 9(10) VALUE 0.
          03 FILLER                    PIC X(7)  VALUE ' RESP2='.
          03 WS-CICS-RESP2-DISP        PIC 9(10) VALUE 0.
          03 FILLER                    PIC X(15)
                                          VALUE ' ABENDING TASK.'.
       01 SWITCHES.
           03 VALID-DATA-SW            PIC X VALUE 'Y'.
              88 VALID-DATA               VALUE 'Y'.
       01 FLAGS.
           03 SEND-FLAG                PIC X.
              88 SEND-ERASE               VALUE '1'.
              88 SEND-DATAONLY            VALUE '2'.
              88 SEND-DATAONLY-ALARM      VALUE '3'.
       01 ACTION-ALPHA.
           03 ACTION-NUM               PIC 9.
       01 END-OF-SESSION-MESSAGE       PIC X(13) VALUE 'Session Ended'.
       01 RESPONSE-CODE                PIC S9(8) COMP.
       01 COMMUNICATION-AREA           PIC X.
       01 COMM-OPENED-SPLIT.
          03 COMM-OPENED-SPLIT-DD      PIC 99.
          03 COMM-OPENED-SPLIT-MM      PIC 99.
          03 COMM-OPENED-SPLIT-YY      PIC 9999.
       01 COMM-LAST-ST-SPLIT.
          03 COMM-LAST-ST-DD           PIC 99.
          03 COMM-LAST-ST-MM           PIC 99.
          03 COMM-LAST-ST-YY           PIC 9999.
       01 COMM-NEXT-ST-SPLIT.
          03 COMM-NEXT-ST-DD           PIC 99.
          03 COMM-NEXT-ST-MM           PIC 99.
          03 COMM-NEXT-ST-YY           PIC 9999.
       01 PARMS-SUBPGM.
          03 PARMS-SUBPGM-EYE          PIC X(4).
          88 PARMS-SUBPGM-EYE-VALID        VALUE 'ACCT'.
          03 PARMS-SUBPGM-CUSTNO       PIC X(10).
          03 PARMS-SUBPGM-SCODE        PIC X(6).
          03 PARMS-SUBPGM-ACCNO        PIC 9(8).
          03 PARMS-SUBPGM-ACC-TYPE     PIC X(8).
          03 PARMS-SUBPGM-INT-RATE     PIC 9(4)V99.
          03 PARMS-SUBPGM-OPENED       PIC 9(8).
          03 PARMS-SUBPGM-OVERDRAFT    PIC 9(8).
          03 PARMS-SUBPGM-LAST-STMT-DT PIC 9(8).
          03 PARMS-SUBPGM-NEXT-STMT-DT PIC 9(8).
          03 PARMS-SUBPGM-AVAIL-BAL    PIC S9(10)V99.
          03 PARMS-SUBPGM-ACTUAL-BAL   PIC S9(10)V99.
          03 PARMS-SUBPGM-SUCCESS      PIC X.
          03 PARMS-SUBPGM-FAIL-CD      PIC X.
          03 PARMS-SUBPGM-DEL-SUCCESS  PIC X.
          03 PARMS-SUBPGM-DEL-FAIL-CD  PIC X.
          03 PARMS-SUBPGM-DEL-APPLID   PIC X(8).
          03 PARMS-SUBPGM-DEL-PCB1     POINTER.
          03 PARMS-SUBPGM-DEL-PCB2     POINTER.
          03 PARMS-SUBPGM-DEL-PCB3     POINTER.
       01 INQACC-COMMAREA.
          03 INQACC-EYE                  PIC X(4).
          03 INQACC-CUSTNO               PIC 9(10).
          03 INQACC-SCODE                PIC 9(6).
          03 INQACC-ACCNO                PIC 9(8).
          03 INQACC-ACC-TYPE             PIC X(8).
          03 INQACC-INT-RATE             PIC 9(4)V99.
          03 INQACC-OPENED               PIC 9(8).
          03 INQACC-OPENED-GROUP REDEFINES INQACC-OPENED.
            05 INQACC-OPENED-DAY         PIC 99.
            05 INQACC-OPENED-MONTH         PIC 99.
            05 INQACC-OPENED-YEAR         PIC 9999.
          03 INQACC-OVERDRAFT            PIC 9(8).
          03 INQACC-LAST-STMT-DT         PIC 9(8).
          03 INQACC-LAST-STMT-GROUP REDEFINES INQACC-LAST-STMT-DT.
            05 INQACC-LAST-STMT-DAY         PIC 99.
            05 INQACC-LAST-STMT-MONTH         PIC 99.
            05 INQACC-LAST-STMT-YEAR         PIC 9999.
          03 INQACC-NEXT-STMT-DT         PIC 9(8).
          03 INQACC-NEXT-STMT-GROUP REDEFINES INQACC-NEXT-STMT-DT.
            05 INQACC-NEXT-STMT-DAY         PIC 99.
            05 INQACC-NEXT-STMT-MONTH         PIC 99.
            05 INQACC-NEXT-STMT-YEAR         PIC 9999.
          03 INQACC-AVAIL-BAL            PIC S9(10)V99.
          03 INQACC-ACTUAL-BAL           PIC S9(10)V99.
          03 INQACC-SUCCESS              PIC X.
          03 INQACC-PCB1-POINTER         POINTER.
       01 WS-COMM-AREA.
          03 WS-COMM-EYE               PIC X(4).
          03 WS-COMM-CUSTNO            PIC X(10).
          03 WS-COMM-SCODE             PIC X(6).
          03 WS-COMM-ACCNO             PIC 9(8).
          03 WS-COMM-ACC-TYPE          PIC X(8).
          03 WS-COMM-INT-RATE          PIC 9(4)V99.
          03 WS-COMM-OPENED            PIC 9(8).
          03 WS-COMM-OVERDRAFT         PIC 9(8).
          03 WS-COMM-LAST-STMT-DT      PIC 9(8).
          03 WS-COMM-NEXT-STMT-DT      PIC 9(8).
          03 WS-COMM-AVAIL-BAL         PIC S9(10)V99.
          03 WS-COMM-ACTUAL-BAL        PIC S9(10)V99.
          03 WS-COMM-SUCCESS           PIC X.
          03 WS-COMM-FAIL-CD           PIC X.
          03 WS-COMM-DEL-SUCCESS       PIC X.
          03 WS-COMM-DEL-FAIL-CD       PIC X.
       01 COMM-AVAIL-BAL-DISP          PIC 9(12).
       01 COMM-ACT-BAL-DISP            PIC 9(12).
       01 WS-STUFF.
          03 WS-AVAIL-BAL-UNSIGN       PIC 9(12).
          03 WS-ACT-BAL-UNSIGN         PIC 9(12).
       01 COMPANY-NAME-FULL            PIC X(32).
       01 AVAILABLE-BALANCE-DISPLAY    PIC +9(10).99.
       01 ACTUAL-BALANCE-DISPLAY       PIC +9(10).99.
       01 WS-U-TIME                    PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                 PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD              PIC 99.
          03 FILLER                       PIC X.
          03 WS-ORIG-DATE-MM              PIC 99.
          03 FILLER                       PIC X.
          03 WS-ORIG-DATE-YYYY            PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-MM-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X       PIC X(4).
       01 WS-TIME-DATA.
           03 WS-TIME-NOW              PIC 9(6).
           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
              05 WS-TIME-NOW-GRP-HH       PIC 99.
              05 WS-TIME-NOW-GRP-MM       PIC 99.
              05 WS-TIME-NOW-GRP-SS       PIC 99.
       01 WS-ABEND-PGM                 PIC X(8) VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
           03 COMM-EYE                 PIC X(4).
           03 COMM-CUSTNO              PIC X(10).
           03 COMM-SCODE               PIC X(6).
           03 COMM-ACCNO               PIC 9(8).
           03 COMM-ACC-TYPE            PIC X(8).
           03 COMM-INT-RATE            PIC 9(6).
           03 COMM-OPENED              PIC 9(8).
           03 COMM-OVERDRAFT           PIC 9(8).
           03 COMM-LAST-STMT-DT        PIC 9(8).
           03 COMM-NEXT-STMT-DT        PIC 9(8).
           03 COMM-AVAIL-BAL           PIC S9(10)V99.
           03 COMM-ACTUAL-BAL          PIC S9(10)V99.
           03 COMM-SUCCESS             PIC X.
           03 COMM-FAIL-CD             PIC X.
           03 COMM-DEL-SUCCESS         PIC X.
           03 COMM-DEL-FAIL-CD         PIC X.
","['PREMIERE', 'PROCESS-MAP', 'RECEIVE-MAP', 'EDIT-DATA', 'VALIDATE-DATA', 'GET-ACC-DATA', 'DEL-ACC-DATA', 'SEND-MAP', 'SEND-TERMINATION-MSG', 'ABEND-THIS-TASK', 'POPULATE-TIME-DATE', 'A010', 'A999', 'PM010', 'PM999', 'RM010', 'RM999', 'ED010', 'ED999', 'VD010', 'VD999', 'GAD010', 'GAD999', 'DAD010', 'DAD999', 'SM010', 'SM999', 'STM010', 'STM999', 'ATT010', 'ATT999', 'PTD010', 'PTD999']","Paragraph PREMIERE calls paragraph SEND-MAP, SEND-TERMINATION-MSG, ABEND-THIS-TASK, POPULATE-TIME-DATE, PROCESS-MAP.
Paragraph PROCESS-MAP calls paragraph VALIDATE-DATA, DEL-ACC-DATA, EDIT-DATA, SEND-MAP, RECEIVE-MAP, GET-ACC-DATA.
Paragraph RECEIVE-MAP calls paragraph POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph EDIT-DATA calls paragraph ED999.
Paragraph GET-ACC-DATA calls paragraph GAD999, POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph DEL-ACC-DATA calls paragraph DAD999, ABEND-THIS-TASK.
Paragraph SEND-MAP calls paragraph POPULATE-TIME-DATE, ABEND-THIS-TASK, SM999.
Paragraph SEND-TERMINATION-MSG calls paragraph POPULATE-TIME-DATE, ABEND-THIS-TASK.
",828,This is the Display Account program in the BANKING application BMS suite. This program also handles requests to delete an account.,['WS-ABEND-PGM'],,,Error Long,0.5,1,0.9,"This COBOL program manages financial transactions by processing input data, validating accounts, and issuing messages based on specific conditions. Starting with PREMIERE, it directs flow to PROCESS-MAP for further operations like editing and receiving data. It handles error scenarios with SEND-TERMINATION-MSG and ABEND-THIS-TASK for failures, while SEND-MAP and GET-ACC-DATA ensure proper data retrieval and transmission. Additionally, it populates time and date for record-keeping throughout its operations, maintaining system integrity.",1
147,cicsdev_cics-banking-sample-application-cbsa,cics-banking-sample-application-cbsa/src/base/cobol_src/BNK1DCS.cbl,,"       WORKING-STORAGE SECTION.
       01 WS-CICS-WORK-AREA.
          03 WS-CICS-RESP             PIC S9(8) COMP VALUE 0.
          03 WS-CICS-RESP2            PIC S9(8) COMP VALUE 0.
       01 WS-FAIL-INFO.
          03 FILLER                   PIC X(9)  VALUE 'BNK1DCS  '.
          03 WS-CICS-FAIL-MSG         PIC X(70) VALUE ' '.
          03 FILLER                   PIC X(6)  VALUE ' RESP='.
          03 WS-CICS-RESP-DISP        PIC 9(10) VALUE 0.
          03 FILLER                   PIC X(7)  VALUE ' RESP2='.
          03 WS-CICS-RESP2-DISP       PIC 9(10) VALUE 0.
          03 FILLER                   PIC X(15) VALUE ' ABENDING TASK.'.
       01 SWITCHES.
           03 VALID-DATA-SW           PIC X VALUE 'Y'.
              88 VALID-DATA           VALUE 'Y'.
       01 FLAGS.
           03 SEND-FLAG               PIC X.
              88 SEND-ERASE           VALUE '1'.
              88 SEND-DATAONLY        VALUE '2'.
              88 SEND-DATAONLY-ALARM  VALUE '3'.
       01 ACTION-ALPHA.
           03 ACTION-NUM              PIC 9.
       01 END-OF-SESSION-MESSAGE      PIC X(13) VALUE 'Session Ended'.
       01 RESPONSE-CODE               PIC S9(8) COMP.
       01 COMMUNICATION-AREA          PIC X.
       01 WS-UCTRANS                  PIC S9(8) COMP VALUE 0.
       01 STORED-UCTRANS              PIC S9(8) COMP VALUE 0.
       01 COMM-DOB-SPLIT.
          03 COMM-DOB-SPLIT-DD         PIC 99.
          03 COMM-DOB-SPLIT-MM         PIC 99.
          03 COMM-DOB-SPLIT-YYYY       PIC 9999.
       01 COMM-ADDR-SPLIT.
          03 COMM-ADDR-SPLIT1         PIC X(60).
          03 COMM-ADDR-SPLIT2         PIC X(60).
          03 COMM-ADDR-SPLIT3         PIC X(40).
       01 COMM-DOB-UPD-FORMAT.
          03 COMM-DOB-UPD-X.
             05 COMM-DOBX-DD     PIC XX.
             05 COMM-DOBX-MM     PIC XX.
             05 COMM-DOBX-YYYY   PIC XXXX.
          03 COMM-DOB-UPD-9 REDEFINES COMM-DOB-UPD-X.
             05 COMM-DOB9-DD     PIC 99.
             05 COMM-DOB9-MM     PIC 99.
             05 COMM-DOB9-YYYY   PIC 9999.
       01 COMM-CS-REVIEW-UPD-FORMAT.
          03 COMM-CS-REVIEW-UPD-X.
             05 COMM-CS-REVIEWX-DD     PIC XX.
             05 COMM-CS-REVIEWX-MM     PIC XX.
             05 COMM-CS-REVIEWX-YYYY   PIC XXXX.
          03 COMM-CS-REVIEW-UPD-9 REDEFINES COMM-CS-REVIEW-UPD-X.
             05 COMM-CS-REVIEW9-DD     PIC 99.
             05 COMM-CS-REVIEW9-MM     PIC 99.
             05 COMM-CS-REVIEW9-YYYY   PIC 9999.
       01 CREDIT-SCORE-UPD-FORMAT.
          03 CREDIT-SCORE-UPD-X.
             05 CREDIT-SCORE-X   PIC X(3).
          03 CREDIT-SCORE-UPD-9 REDEFINES CREDIT-SCORE-UPD-X.
             05 CREDIT-SCORE-9   PIC 9(3).
       01 COMM-ADDR-UPD-SPLIT.
          03 COMM-ADDR-UPD1           PIC X(60).
          03 COMM-ADDR-UPD2           PIC X(60).
          03 COMM-ADDR-UPD3           PIC X(40).
       01 INQCUST-COMMAREA.
          03 INQCUST-EYE                  PIC X(4).
          03 INQCUST-SCODE                PIC X(6).
          03 INQCUST-CUSTNO               PIC 9(10).
          03 INQCUST-NAME                 PIC X(60).
          03 INQCUST-ADDR                 PIC X(160).
          03 INQCUST-DOB.
            05 INQCUST-DOB-DD             PIC 99.
            05 INQCUST-DOB-MM             PIC 99.
            05 INQCUST-DOB-YYYY           PIC 9999.
          03 INQCUST-CREDIT-SCORE         PIC 999.
          03 INQCUST-CS-REVIEW-DT.
            05 INQCUST-CS-REVIEW-DD       PIC 99.
            05 INQCUST-CS-REVIEW-MM       PIC 99.
            05 INQCUST-CS-REVIEW-YYYY     PIC 9999.
          03 INQCUST-INQ-SUCCESS          PIC X.
          03 INQCUST-INQ-FAIL-CD          PIC X.
          03 INQCUST-PCB-POINTER          POINTER.
       01 DELCUS-COMMAREA.
          03 COMM-EYE                  PIC X(4).
          03 COMM-SCODE                PIC X(6).
          03 COMM-CUSTNO               PIC X(10).
          03 COMM-NAME                 PIC X(60).
          03 COMM-ADDR                 PIC X(160).
          03 COMM-DOB                  PIC 9(8).
          03 COMM-DOB-GROUP REDEFINES COMM-DOB.
             05 COMM-BIRTH-DAY               PIC 99.
             05 COMM-BIRTH-MONTH             PIC 99.
             05 COMM-BIRTH-YEAR              PIC 9999.
          03 COMM-CREDIT-SCORE         PIC 9(3).
          03 COMM-CS-REVIEW-DATE       PIC 9(8).
          03 COMM-CS-REVIEW-GROUP REDEFINES COMM-CS-REVIEW-DATE.
             05 COMM-CS-REVIEW-DD            PIC 99.
             05 COMM-CS-REVIEW-MM            PIC 99.
             05 COMM-CS-REVIEW-YYYY          PIC 9999.
          03 COMM-DEL-SUCCESS          PIC X.
          03 COMM-DEL-FAIL-CD          PIC X.
       01 UPDCUST-COMMAREA.
          03 COMM-EYE                  PIC X(4).
          03 COMM-SCODE                PIC X(6).
          03 COMM-CUSTNO               PIC X(10).
          03 COMM-NAME                 PIC X(60).
          03 COMM-ADDR                 PIC X(160).
          03 COMM-DOB                  PIC 9(8).
          03 COMM-DOB-GROUP REDEFINES COMM-DOB.
             05 COMM-BIRTH-DAY               PIC 99.
             05 COMM-BIRTH-MONTH             PIC 99.
             05 COMM-BIRTH-YEAR              PIC 9999.
          03 COMM-CREDIT-SCORE         PIC 9(3).
          03 COMM-CS-REVIEW-DATE       PIC 9(8).
          03 COMM-CS-GROUP REDEFINES COMM-CS-REVIEW-DATE.
             05 COMM-CS-DAY                  PIC 99.
             05 COMM-CS-MONTH                PIC 99.
             05 COMM-CS-YEAR                 PIC 9999.
          03 COMM-UPD-SUCCESS          PIC X.
          03 COMM-UPD-FAIL-CD          PIC X.
       01 WS-COMM-AREA.
          03 WS-COMM-TERM              PIC S9(8) COMP.
          03 WS-COMM-EYE               PIC X(4).
          03 WS-COMM-SCODE             PIC X(6).
          03 WS-COMM-CUSTNO            PIC X(10).
          03 WS-COMM-NAME              PIC X(60).
          03 WS-COMM-ADDR              PIC X(160).
          03 WS-COMM-DOB               PIC 9(8).
          03 WS-COMM-CREDIT-SCORE      PIC 9(3).
          03 WS-COMM-CS-REVIEW-DATE    PIC 9(8).
          03 WS-COMM-DEL-SUCCESS       PIC X.
          03 WS-COMM-DEL-FAIL-CD       PIC X.
          03 WS-COMM-UPDATE            PIC X.
       01 WS-VALIDATE-NAME             PIC X(60) VALUE ' '.
       01 WS-UNSTR-TITLE               PIC X(9)  VALUE ' '.
       01 WS-TITLE-VALID               PIC X     VALUE ' '.
       01 WS-U-TIME                      PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                   PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD             PIC 99.
          03 FILLER                      PIC X.
          03 WS-ORIG-DATE-MM             PIC 99.
          03 FILLER                      PIC X.
          03 WS-ORIG-DATE-YYYY           PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X           PIC XX.
          03 FILLER                      PIC X VALUE '.'.
          03 WS-ORIG-DATE-MM-X           PIC XX.
          03 FILLER                      PIC X VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X         PIC X(4).
       01 WS-TIME-DATA.
           03 WS-TIME-NOW                  PIC 9(6).
           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
              05 WS-TIME-NOW-GRP-HH     PIC 99.
              05 WS-TIME-NOW-GRP-MM     PIC 99.
              05 WS-TIME-NOW-GRP-SS     PIC 99.
       01 WS-ABEND-PGM                  PIC X(8) VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 COMM-TERM                 PIC S9(8) COMP.
          03 COMM-EYE                  PIC X(4).
          03 COMM-SCODE                PIC X(6).
          03 COMM-CUSTNO               PIC X(10).
          03 COMM-NAME                 PIC X(60).
          03 COMM-ADDR                 PIC X(160).
          03 COMM-DOB                  PIC 9(8).
          03 COMM-CREDIT-SCORE         PIC 9(3).
          03 COMM-CS-REVIEW-DATE       PIC 9(8).
          03 COMM-DEL-SUCCESS          PIC X.
          03 COMM-DEL-FAIL-CD          PIC X.
          03 COMM-UPD                  PIC X.
","['PREMIERE', 'PROCESS-MAP', 'RECEIVE-MAP', 'EDIT-DATA', 'EDIT-DATA2', 'VALIDATE-DATA', 'GET-CUST-DATA', 'DEL-CUST-DATA', 'UPDATE-CUST-DATA', 'UNPROT-CUST-DATA', 'SEND-MAP', 'STORE-TERM-DEF', 'RESTORE-TERM-DEF', 'SEND-TERMINATION-MSG', 'ABEND-THIS-TASK', 'POPULATE-TIME-DATE', 'PROT-CUST-DATA', 'ABEND-HANDLING', 'A010', 'A999', 'PM010', 'PM999', 'RM010', 'RM999', 'ED010', 'ED999', 'ED2010', 'ED2999', 'VD010', 'VD999', 'GCD010', 'GCD999', 'DCD010', 'DCD999', 'UPDCD010', 'UPDCD999', 'UCD010', 'UCD999', 'SM010', 'SM999', 'STD010', 'STD999', 'RTD010', 'RTD999', 'STM010', 'STM999', 'ATT010', 'ATT999', 'PTD10', 'PTD999', 'PCD010', 'PCD999', 'AH010', 'AH999']","Paragraph PREMIERE calls paragraph STORE-TERM-DEF, SEND-MAP, RESTORE-TERM-DEF, SEND-TERMINATION-MSG, ABEND-THIS-TASK, POPULATE-TIME-DATE, PROCESS-MAP.
Paragraph PROCESS-MAP calls paragraph VALIDATE-DATA, UNPROT-CUST-DATA, EDIT-DATA, SEND-MAP, DEL-CUST-DATA, GET-CUST-DATA, EDIT-DATA2, RECEIVE-MAP, UPDATE-CUST-DATA.
Paragraph RECEIVE-MAP calls paragraph RESTORE-TERM-DEF, POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph EDIT-DATA calls paragraph ED999.
Paragraph GET-CUST-DATA calls paragraph RESTORE-TERM-DEF, POPULATE-TIME-DATE, GCD999, ABEND-THIS-TASK.
Paragraph DEL-CUST-DATA calls paragraph RESTORE-TERM-DEF, POPULATE-TIME-DATE, DCD999, ABEND-THIS-TASK.
Paragraph UPDATE-CUST-DATA calls paragraph RESTORE-TERM-DEF, ABEND-THIS-TASK, PROT-CUST-DATA, POPULATE-TIME-DATE, UPDCD999.
Paragraph SEND-MAP calls paragraph RESTORE-TERM-DEF, POPULATE-TIME-DATE, ABEND-THIS-TASK, SM999.
Paragraph STORE-TERM-DEF calls paragraph RESTORE-TERM-DEF, POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph RESTORE-TERM-DEF calls paragraph POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph SEND-TERMINATION-MSG calls paragraph RESTORE-TERM-DEF, POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph ABEND-HANDLING calls paragraph RESTORE-TERM-DEF, ABEND-THIS-TASK.
",1380,"This is the Display Customer program in the BANKING application BMS suite. It will not only display customer details, it will also delete the customer record if pf5 is pressed or will allow the customer record to be updated if pf10 is pressed.",['WS-ABEND-PGM'],,,Error Long,0.75,1,0.875,"This COBOL program processes customer data through CICS, handling various inputs and corresponding actions. It begins by storing terminal definitions and validating customer data in multiple stages, including editing and retrieval. The program efficiently manages errors, ensuring data integrity through defined routines for sending messages, updating, and deleting customer information. Additionally, it includes robust error handling mechanisms to manage abnormal terminations while populating time and date data throughout its operations.",1
150,cicsdev_cics-banking-sample-application-cbsa,cics-banking-sample-application-cbsa/src/base/cobol_src/BNK1TFN.cbl,"       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)
       CBL CICS('SP,EDF')
       IDENTIFICATION DIVISION.
       PROGRAM-ID. BNK1TFN.
       AUTHOR. Jon Collett.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.  IBM-370.
       OBJECT-COMPUTER.  IBM-370.
       INPUT-OUTPUT SECTION.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01 WS-CICS-WORK-AREA.
          03 WS-CICS-RESP               PIC S9(8) COMP
                                                      VALUE 0.
          03 WS-CICS-RESP2              PIC S9(8) COMP
                                                      VALUE 0.
       01 WS-FAIL-INFO.
          03 FILLER                     PIC X(9)      VALUE 'BNK1TFN  '.
          03 WS-CICS-FAIL-MSG           PIC X(70)     VALUE ' '.
          03 FILLER                     PIC X(6)      VALUE ' RESP='.
          03 WS-CICS-RESP-DISP          PIC 9(10)     VALUE 0.
          03 FILLER                     PIC X(7)      VALUE ' RESP2='.
          03 WS-CICS-RESP2-DISP         PIC 9(10)     VALUE 0.
          03 FILLER                     PIC X(15)     VALUE
                                                      ' ABENDING TASK.'.
       01 SWITCHES.
          03 VALID-DATA-SW              PIC X         VALUE 'Y'.
             88 VALID-DATA                            VALUE 'Y'.
       01 FLAGS.
          03 SEND-FLAG                  PIC X.
             88 SEND-ERASE                            VALUE '1'.
             88 SEND-DATAONLY                         VALUE '2'.
             88 SEND-DATAONLY-ALARM                   VALUE '3'.
       01 ACTION-ALPHA.
          03 ACTION-NUM                 PIC 9.
       01 END-OF-SESSION-MESSAGE        PIC X(13)     VALUE
                                                        'Session Ended'.
       01 RESPONSE-CODE                 PIC S9(8) COMP.
       01 COMMUNICATION-AREA            PIC X.
       01 WS-AMOUNT-AS-FLOAT COMP-2.
       01 WS-NUM-COUNT-TOTAL            PIC S9(8) BINARY.
       01 WS-NUM-COUNT-POINT            PIC S9(8) BINARY.
       01 WS-NUM-COUNT-SPACE            PIC S9(8) BINARY.
       01 WS-NUM-COUNT-MINUS            PIC S9(8) BINARY.
       01 WS-AMOUNT-UNSTR               PIC X(13).
       01 WS-AMOUNT-UNSTR-L             PIC S9(8) BINARY.
       01 WS-AMOUNT-UNSTR-REVERSE       PIC X(13).
       01 COMM-DOB-SPLIT.
          03 COMM-DOB-SPLIT-DD          PIC 99.
          03 COMM-DOB-SPLIT-MM          PIC 99.
          03 COMM-DOB-SPLIT-YYYY        PIC 9999.
       01 COMM-ADDR-SPLIT.
          03 COMM-ADDR-SPLIT1           PIC X(60).
          03 COMM-ADDR-SPLIT2           PIC X(60).
          03 COMM-ADDR-SPLIT3           PIC X(40).
       01 WS-CONVERSIONA.
          03 WS-CONVERT-PIC1            PIC X(13).
          03 WS-CONVERT-PIC1SP REDEFINES WS-CONVERT-PIC1.
             05 WS-CONVERT-PIC1-1ST     PIC X(10).
             05 WS-CONVERT-PIC1-POINT   PIC X.
             05 WS-CONVERT-PIC1-2ND     PIC XX.
       01 WS-CONVERSIONB.
          03 WS-CONVERT-PICX            PIC X(13).
          03 WS-CONVERT-SPLIT REDEFINES WS-CONVERT-PICX.
             05 WS-CONVERT-DEC          PIC 9(10).
             05 WS-CONVERT-POINT        PIC X.
             05 WS-CONVERT-REMAIN       PIC 99.
       01 WS-CONVERTED-VAL1             PIC S9(10)V99 VALUE 0.
       01 WS-CONVERTED-VAL2             PIC S9(10)V99 VALUE 0.
       01 WS-CONVERTED-VAL3             PIC S9(10)V99 VALUE 0.
       01 WS-CONVERTED-VAL4             PIC S9(10)V99 VALUE 0.
       01 SUBPGM-PARMS.
          03 SUBPGM-FACCNO              PIC 9(8).
          03 SUBPGM-FSCODE              PIC 9(6).
          03 SUBPGM-TACCNO              PIC 9(8).
          03 SUBPGM-TSCODE              PIC 9(6).
          03 SUBPGM-AMT                 PIC S9(10)V99.
          03 SUBPGM-FAVBAL              PIC S9(10)V99.
          03 SUBPGM-FACTBAL             PIC S9(10)V99.
          03 SUBPGM-TAVBAL              PIC S9(10)V99.
          03 SUBPGM-TACTBAL             PIC S9(10)V99.
          03 SUBPGM-FAIL-CODE           PIC X.
          03 SUBPGM-SUCCESS             PIC X.
       01 WS-COMMAREA.
          03 WS-COMMAREA-FACCNO         PIC 9(8).
          03 WS-COMMAREA-TACCNO         PIC 9(8).
          03 WS-COMMAREA-AMT            PIC 9(12).
       01 COMPANY-NAME-FULL             PIC X(32).
       01 FROM-AVAILABLE-BALANCE-DISPLAY
                                        PIC +9(10).99.
       01 FROM-ACTUAL-BALANCE-DISPLAY   PIC +9(10).99.
       01 TO-AVAILABLE-BALANCE-DISPLAY  PIC +9(10).99.
       01 TO-ACTUAL-BALANCE-DISPLAY     PIC +9(10).99.
       01 WS-U-TIME                     PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                  PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD            PIC 99.
          03 FILLER                     PIC X.
          03 WS-ORIG-DATE-MM            PIC 99.
          03 FILLER                     PIC X.
          03 WS-ORIG-DATE-YYYY          PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X          PIC XX.
          03 FILLER                     PIC X         VALUE '.'.
          03 WS-ORIG-DATE-MM-X          PIC XX.
          03 FILLER                     PIC X         VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X        PIC X(4).
       01 WS-TIME-DATA.
          03 WS-TIME-NOW                PIC 9(6).
          03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
             05 WS-TIME-NOW-GRP-HH      PIC 99.
             05 WS-TIME-NOW-GRP-MM      PIC 99.
             05 WS-TIME-NOW-GRP-SS      PIC 99.
       01 WS-ABEND-PGM                  PIC X(8)      VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 COMMAREA-FACCNO            PIC 9(8).
          03 COMMAREA-TACCNO            PIC 9(8).
          03 COMMAREA-AMT               PIC 9(12).
       PROCEDURE DIVISION.
       PREMIERE SECTION.
       A010.
           EVALUATE TRUE
              WHEN EIBCALEN = ZERO
                 MOVE LOW-VALUE TO BNK1TFO
                 SET SEND-ERASE TO TRUE
                 PERFORM SEND-MAP
              WHEN EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
                 CONTINUE
              WHEN EIBAID = DFHPF3
                 EXEC CICS RETURN
                    TRANSID('OMEN')
                    IMMEDIATE
                    RESP(WS-CICS-RESP)
                    RESP2(WS-CICS-RESP2)
                 END-EXEC
              WHEN EIBAID = DFHAID OR DFHPF12
                 PERFORM SEND-TERMINATION-MSG
                 EXEC CICS
                    RETURN
                 END-EXEC
              WHEN EIBAID = DFHCLEAR
                EXEC CICS SEND CONTROL
                          ERASE
                          FREEKB
                END-EXEC
                EXEC CICS RETURN
                END-EXEC
              WHEN EIBAID = DFHENTER
                 PERFORM PROCESS-MAP
              WHEN OTHER
                 MOVE LOW-VALUES TO BNK1TFO
                 MOVE 'Invalid key pressed.' TO MESSAGEO
                 SET SEND-DATAONLY-ALARM TO TRUE
                 PERFORM SEND-MAP
           END-EVALUATE.
            EXEC CICS
               RETURN TRANSID('OTFN')
               COMMAREA(WS-COMMAREA)
               LENGTH(29)
               RESP(WS-CICS-RESP)
               RESP2(WS-CICS-RESP2)
            END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'A010 - RETURN TRANSID(OCCS) FAIL.'
                    DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1TFN - A010 - RETURN TRANSID(OCCS) FAIL' TO
                 WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM ABEND-THIS-TASK
           END-IF.
       A999.
           EXIT.
       PROCESS-MAP SECTION.
       PM010.
           PERFORM RECEIVE-MAP.
           PERFORM EDIT-DATA.
           IF VALID-DATA
              PERFORM GET-ACC-DATA
           END-IF.
           SET SEND-DATAONLY-ALARM TO TRUE.
           PERFORM SEND-MAP.
       PM999.
           EXIT.
       RECEIVE-MAP SECTION.
       RM010.
           EXEC CICS
              RECEIVE MAP('BNK1TF')
              MAPSET('BNK1TFM')
              INTO(BNK1TFI)
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'RM010 - RECEIVE MAP FAIL.'
                    DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1TFN - RM010 - RECEIVE MAP FAIL ' TO
                 WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM ABEND-THIS-TASK
           END-IF.
       RM999.
           EXIT.
       EDIT-DATA SECTION.
       ED010.
           EXEC CICS BIF DEEDIT
              FIELD(FACCNOI)
           END-EXEC.
           IF FACCNOI NOT NUMERIC
              MOVE 'Please enter a FROM account no  ' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              GO TO ED999
           END-IF.
           EXEC CICS BIF DEEDIT
              FIELD(TACCNOI)
           END-EXEC.
           IF TACCNOI NOT NUMERIC
              MOVE 'Please enter a TO account no    ' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              GO TO ED999
           END-IF.
           IF FACCNOI = TACCNOI
              MOVE 'The FROM & TO account should be different ' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              GO TO ED999
           END-IF.
           IF FACCNOI = '00000000' OR TACCNOI = '00000000'
              MOVE 'Account no 00000000 is not valid          ' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              GO TO ED999
           END-IF.
           PERFORM VALIDATE-AMOUNT.
       ED999.
           EXIT.
       GET-ACC-DATA SECTION.
       GCD010.
           INITIALIZE SUBPGM-PARMS.
           MOVE FACCNOI TO  SUBPGM-FACCNO.
           MOVE TACCNOI TO  SUBPGM-TACCNO.
           MOVE 'N'     TO  SUBPGM-SUCCESS.
           MOVE WS-AMOUNT-AS-FLOAT TO SUBPGM-AMT.
           EXEC CICS LINK
              PROGRAM('XFRFUN')
              COMMAREA(SUBPGM-PARMS)
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
              SYNCONRETURN
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'GCD010 - LINK XFRFUN FAIL.'
                    DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1TFN - GCD010 - LINK XFRFUN  FAIL      '
                 TO WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM ABEND-THIS-TASK
           END-IF.
           MOVE SUBPGM-FACCNO    TO FACCNO2O
           MOVE SUBPGM-FSCODE    TO FSORTCO
           MOVE SUBPGM-TACCNO    TO TACCNO2O
           MOVE SUBPGM-TSCODE    TO TSORTCO
           MOVE ZERO             TO FROM-ACTUAL-BALANCE-DISPLAY
           MOVE ZERO             TO FROM-AVAILABLE-BALANCE-DISPLAY
           MOVE ZERO             TO TO-ACTUAL-BALANCE-DISPLAY
           MOVE ZERO             TO TO-AVAILABLE-BALANCE-DISPLAY
           MOVE FROM-ACTUAL-BALANCE-DISPLAY TO FACTBALO
           MOVE FROM-AVAILABLE-BALANCE-DISPLAY TO FAVBALO
           MOVE TO-ACTUAL-BALANCE-DISPLAY    TO TACTBALO
           MOVE TO-AVAILABLE-BALANCE-DISPLAY TO TAVBALO
           IF SUBPGM-SUCCESS = 'N'
              MOVE 'N' TO VALID-DATA-SW
              EVALUATE SUBPGM-FAIL-CODE
                 WHEN '1'
                    MOVE SPACES TO MESSAGEO
                    STRING 'Sorry the FROM ACCOUNT no was not found'
                           '. Transfer not applied. '
                           DELIMITED BY SIZE
                           INTO MESSAGEO
                    GO TO GCD999
                 WHEN '2'
                    MOVE SPACES TO MESSAGEO
                    STRING 'Sorry the TO ACCOUNT no was not found'
                           '. Transfer not applied. '
                           DELIMITED BY SIZE
                           INTO MESSAGEO
                    GO TO GCD999
                 WHEN '3'
                    MOVE SPACES TO MESSAGEO
                    STRING 'Sorry but the transfer could not be applied'
                           ' due to an unexpected error.'
                           DELIMITED BY SIZE
                           INTO MESSAGEO
                 WHEN '4'
                    MOVE SPACES TO MESSAGEO
                    STRING 'Please supply an amount greater than zero.'
                           DELIMITED BY SIZE
                           INTO MESSAGEO
                    GO TO GCD999
                 WHEN OTHER
                    MOVE SPACES TO MESSAGEO
                    STRING 'Sorry but the transfer could not be applied'
                           ' due to an error.'
                           DELIMITED BY SIZE
                           INTO MESSAGEO
                    GO TO GCD999
              END-EVALUATE
           END-IF.
           IF SUBPGM-SUCCESS NOT = 'Y'
              MOVE SPACES TO MESSAGEO
              STRING 'Sorry but the transfer could not be applied'
                     ' unable to determine success.'
                     DELIMITED BY SIZE
                     INTO MESSAGEO
              GO TO GCD999
           ELSE
              MOVE SPACES TO MESSAGEO
              MOVE 'Transfer successfully applied.             ' TO
                 MESSAGEO
           END-IF.
           MOVE SUBPGM-FACCNO    TO FACCNO2O.
           MOVE SUBPGM-FSCODE    TO FSORTCO.
           MOVE SUBPGM-TACCNO    TO TACCNO2O.
           MOVE SUBPGM-TSCODE    TO TSORTCO.
           MOVE SUBPGM-FACTBAL   TO FROM-ACTUAL-BALANCE-DISPLAY.
           MOVE SUBPGM-FAVBAL    TO FROM-AVAILABLE-BALANCE-DISPLAY.
           MOVE SUBPGM-TACTBAL   TO TO-ACTUAL-BALANCE-DISPLAY.
           MOVE SUBPGM-TAVBAL    TO TO-AVAILABLE-BALANCE-DISPLAY.
           MOVE FROM-ACTUAL-BALANCE-DISPLAY TO FACTBALO.
           MOVE FROM-AVAILABLE-BALANCE-DISPLAY TO FAVBALO.
           MOVE TO-ACTUAL-BALANCE-DISPLAY    TO TACTBALO.
           MOVE TO-AVAILABLE-BALANCE-DISPLAY TO TAVBALO.
       GCD999.
           EXIT.
       SEND-MAP SECTION.
       SM010.
           IF SEND-ERASE
              EXEC CICS SEND MAP('BNK1TF')
                 MAPSET('BNK1TFM')
                 FROM(BNK1TFO)
                 ERASE
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'SM010 - SEND MAP ERASE FAIL.'
                       DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNK1TFN - SM010 - SEND MAP ERASE FAIL '
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
              GO TO SM999
           END-IF.
           IF SEND-DATAONLY
              EXEC CICS SEND MAP('BNK1TF')
                 MAPSET('BNK1TFM')
                 FROM(BNK1TFO)
                 DATAONLY
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'SM010 - SEND MAP DATAONLY FAIL.'
                       DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNK1TFN - SM010 - SEND MAP DATAONLY FAIL '
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
              GO TO SM999
           END-IF.
           IF SEND-DATAONLY-ALARM
              EXEC CICS SEND MAP('BNK1TF')
                 MAPSET('BNK1TFM')
                 FROM(BNK1TFO)
                 DATAONLY
                 ALARM
                 RESP(WS-CICS-RESP)
                 RESP2(WS-CICS-RESP2)
              END-EXEC
              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                 INITIALIZE ABNDINFO-REC
                 MOVE EIBRESP    TO ABND-RESPCODE
                 MOVE EIBRESP2   TO ABND-RESP2CODE
                 EXEC CICS ASSIGN APPLID(ABND-APPLID)
                 END-EXEC
                 MOVE EIBTASKN   TO ABND-TASKNO-KEY
                 MOVE EIBTRNID   TO ABND-TRANID
                 PERFORM POPULATE-TIME-DATE
                 MOVE WS-ORIG-DATE TO ABND-DATE
                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                 END-STRING
                 MOVE WS-U-TIME   TO ABND-UTIME-KEY
                 MOVE 'HBNK'      TO ABND-CODE
                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                 END-EXEC
                 MOVE ZEROS      TO ABND-SQLCODE
                 STRING 'SM010 - SEND MAP DATAONLY ALARM FAIL.'
                       DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                 END-STRING
                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                 END-EXEC
                 INITIALIZE WS-FAIL-INFO
                 MOVE 'BNK1TFN - SM010 - SEND MAP DATAONLY ALARM FAIL '
                    TO WS-CICS-FAIL-MSG
                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
                 PERFORM ABEND-THIS-TASK
              END-IF
           END-IF.
       SM999.
           EXIT.
       SEND-TERMINATION-MSG SECTION.
       STM010.
           EXEC CICS SEND TEXT
              FROM(END-OF-SESSION-MESSAGE)
              ERASE
              FREEKB
              RESP(WS-CICS-RESP)
              RESP2(WS-CICS-RESP2)
           END-EXEC.
           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HBNK'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'STM010 - SEND TEXT FAIL.'
                    DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              INITIALIZE WS-FAIL-INFO
              MOVE 'BNK1TFN - STM010 - SEND TEXT FAIL'
                 TO WS-CICS-FAIL-MSG
              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP
              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP
              PERFORM ABEND-THIS-TASK
           END-IF.
       STM999.
           EXIT.
       ABEND-THIS-TASK SECTION.
       ATT010.
           DISPLAY WS-FAIL-INFO.
           EXEC CICS ABEND
              ABCODE('HBNK')
              NODUMP
           END-EXEC.
       ATT999.
           EXIT.
       VALIDATE-AMOUNT SECTION.
       VA010.
           IF AMTL = ZERO
              MOVE 'The Amount entered must be numeric.' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO AMTL
              GO TO VA999
           END-IF
           IF AMTI(1:AMTL) IS NUMERIC
              COMPUTE WS-AMOUNT-AS-FLOAT =
                 FUNCTION NUMVAL(AMTI(1:AMTL))
              IF WS-AMOUNT-AS-FLOAT <= 0
                 MOVE SPACES TO MESSAGEO
                 STRING 'Please supply a positive amount.'
                    DELIMITED BY SIZE,
                 INTO MESSAGEO
                 MOVE 'N' TO VALID-DATA-SW
                 MOVE -1 TO AMTL
                 GO TO VA999
              END-IF
              MOVE 'Y' TO VALID-DATA-SW
              GO TO VA999
           END-IF.
           MOVE ZERO TO WS-NUM-COUNT-TOTAL.
           INSPECT AMTI(1:AMTL) TALLYING WS-NUM-COUNT-TOTAL
              FOR LEADING SPACES.
           IF WS-NUM-COUNT-TOTAL = AMTL
              MOVE 'The Amount entered must be numeric.' TO
                 MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO AMTL
              GO TO VA999
           END-IF.
           COMPUTE WS-AMOUNT-UNSTR-L = AMTL - WS-NUM-COUNT-TOTAL.
           IF WS-NUM-COUNT-TOTAL = ZERO
              MOVE SPACES TO WS-AMOUNT-UNSTR
              UNSTRING AMTI(1:AMTL)
                 INTO WS-AMOUNT-UNSTR
           ELSE
              MOVE SPACES TO WS-AMOUNT-UNSTR
              ADD 1 TO WS-NUM-COUNT-TOTAL GIVING WS-NUM-COUNT-TOTAL
              UNSTRING AMTI(WS-NUM-COUNT-TOTAL:AMTL)
                 INTO WS-AMOUNT-UNSTR
           END-IF.
           MOVE ZERO TO WS-NUM-COUNT-TOTAL.
           MOVE FUNCTION REVERSE(WS-AMOUNT-UNSTR(1:WS-AMOUNT-UNSTR-L))
              TO WS-AMOUNT-UNSTR-REVERSE.
           INSPECT WS-AMOUNT-UNSTR-REVERSE
              TALLYING WS-NUM-COUNT-TOTAL
              FOR LEADING SPACES.
           SUBTRACT WS-NUM-COUNT-TOTAL FROM WS-AMOUNT-UNSTR-L
              GIVING WS-AMOUNT-UNSTR-L.
           MOVE ZERO TO WS-NUM-COUNT-TOTAL WS-NUM-COUNT-SPACE
                        WS-NUM-COUNT-MINUS.
           INSPECT WS-AMOUNT-UNSTR(1:WS-AMOUNT-UNSTR-L)
              TALLYING
              WS-NUM-COUNT-TOTAL FOR ALL '0'
              WS-NUM-COUNT-TOTAL FOR ALL '1'
              WS-NUM-COUNT-TOTAL FOR ALL '2'
              WS-NUM-COUNT-TOTAL FOR ALL '3'
              WS-NUM-COUNT-TOTAL FOR ALL '4'
              WS-NUM-COUNT-TOTAL FOR ALL '5'
              WS-NUM-COUNT-TOTAL FOR ALL '6'
              WS-NUM-COUNT-TOTAL FOR ALL '7'
              WS-NUM-COUNT-TOTAL FOR ALL '8'
              WS-NUM-COUNT-TOTAL FOR ALL '9'
              WS-NUM-COUNT-TOTAL FOR ALL '.'
              WS-NUM-COUNT-SPACE FOR ALL ' '
              WS-NUM-COUNT-MINUS FOR ALL '-'.
           IF WS-NUM-COUNT-MINUS > 0
              MOVE SPACES TO MESSAGEO
              STRING 'Please supply a positive amount.'
                 DELIMITED BY SIZE,
                 INTO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO AMTL
              GO TO VA999
           END-IF.
           IF WS-NUM-COUNT-SPACE > 0
              MOVE SPACES TO MESSAGEO
              STRING
                 'Please supply a numeric amount without embedded'
                 DELIMITED BY SIZE,
                 '  spaces.' DELIMITED BY SIZE
               INTO MESSAGEO
               MOVE 'N' TO VALID-DATA-SW
               MOVE -1 TO AMTL
               GO TO VA999
           END-IF.
           IF WS-NUM-COUNT-TOTAL < WS-AMOUNT-UNSTR-L
              MOVE SPACES TO MESSAGEO
              STRING 'Please supply a numeric amount.'
                 DELIMITED BY SIZE,
                 INTO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO AMTL
              GO TO VA999
           END-IF.
           MOVE ZERO TO WS-NUM-COUNT-POINT.
           INSPECT WS-AMOUNT-UNSTR(1:WS-AMOUNT-UNSTR-L)
              TALLYING
              WS-NUM-COUNT-POINT FOR ALL '.'.
           IF WS-NUM-COUNT-POINT > 1
              MOVE SPACES TO MESSAGEO
              STRING 'Use one decimal point for amount only.'
                 DELIMITED BY SIZE,
                 INTO MESSAGEO
              MOVE 'N' TO VALID-DATA-SW
              MOVE -1 TO AMTL
              GO TO VA999
           END-IF.
           IF WS-NUM-COUNT-POINT = 1
              MOVE ZERO TO WS-NUM-COUNT-TOTAL
              INSPECT WS-AMOUNT-UNSTR(1:WS-AMOUNT-UNSTR-L)
                 TALLYING
                 WS-NUM-COUNT-TOTAL FOR CHARACTERS AFTER '.'
              IF WS-NUM-COUNT-TOTAL > 2
                 MOVE ZERO TO WS-NUM-COUNT-TOTAL WS-NUM-COUNT-POINT
                 INSPECT WS-AMOUNT-UNSTR(1:WS-AMOUNT-UNSTR-L)
                    TALLYING WS-NUM-COUNT-POINT
                    FOR CHARACTERS BEFORE '.'
                 ADD 2 TO WS-NUM-COUNT-POINT GIVING WS-NUM-COUNT-POINT
                 INSPECT WS-AMOUNT-UNSTR
                    (WS-NUM-COUNT-POINT:WS-AMOUNT-UNSTR-L)
                    TALLYING
                    WS-NUM-COUNT-TOTAL FOR ALL '0'
                    WS-NUM-COUNT-TOTAL FOR ALL '1'
                    WS-NUM-COUNT-TOTAL FOR ALL '2'
                    WS-NUM-COUNT-TOTAL FOR ALL '3'
                    WS-NUM-COUNT-TOTAL FOR ALL '4'
                    WS-NUM-COUNT-TOTAL FOR ALL '5'
                    WS-NUM-COUNT-TOTAL FOR ALL '6'
                    WS-NUM-COUNT-TOTAL FOR ALL '7'
                    WS-NUM-COUNT-TOTAL FOR ALL '8'
                    WS-NUM-COUNT-TOTAL FOR ALL '9'
                    AFTER '.'
                 IF WS-NUM-COUNT-TOTAL > 2
                    MOVE SPACES TO MESSAGEO
                    STRING
                       'Only up to two decimal places are supported.'
                       DELIMITED BY SIZE,
                    INTO MESSAGEO
                    MOVE 'N' TO VALID-DATA-SW
                    MOVE -1 TO AMTL
                    GO TO VA999
                 END-IF
              END-IF
           END-IF.
           COMPUTE WS-AMOUNT-AS-FLOAT =
              FUNCTION NUMVAL(WS-AMOUNT-UNSTR(1:WS-AMOUNT-UNSTR-L)).
           IF WS-AMOUNT-AS-FLOAT = ZERO
              MOVE SPACES TO MESSAGEO
              STRING 'Please supply a non-zero amount.'
                 DELIMITED BY SIZE,
                 INTO MESSAGEO
                 MOVE 'N' TO VALID-DATA-SW
                 MOVE -1 TO AMTL
                 GO TO VA999
           END-IF.
           MOVE SPACES TO MESSAGEO.
           MOVE 'Y' TO VALID-DATA-SW.
       VA999.
           EXIT.
       POPULATE-TIME-DATE SECTION.
       PTD010.
           EXEC CICS ASKTIME
              ABSTIME(WS-U-TIME)
           END-EXEC.
           EXEC CICS FORMATTIME
                     ABSTIME(WS-U-TIME)
                     DDMMYYYY(WS-ORIG-DATE)
                     TIME(WS-TIME-NOW)
                     DATESEP
           END-EXEC.
       PTD999.
           EXIT.
","       WORKING-STORAGE SECTION.
       01 WS-CICS-WORK-AREA.
          03 WS-CICS-RESP               PIC S9(8) COMP
                                                      VALUE 0.
          03 WS-CICS-RESP2              PIC S9(8) COMP
                                                      VALUE 0.
       01 WS-FAIL-INFO.
          03 FILLER                     PIC X(9)      VALUE 'BNK1TFN  '.
          03 WS-CICS-FAIL-MSG           PIC X(70)     VALUE ' '.
          03 FILLER                     PIC X(6)      VALUE ' RESP='.
          03 WS-CICS-RESP-DISP          PIC 9(10)     VALUE 0.
          03 FILLER                     PIC X(7)      VALUE ' RESP2='.
          03 WS-CICS-RESP2-DISP         PIC 9(10)     VALUE 0.
          03 FILLER                     PIC X(15)     VALUE
                                                      ' ABENDING TASK.'.
       01 SWITCHES.
          03 VALID-DATA-SW              PIC X         VALUE 'Y'.
             88 VALID-DATA                            VALUE 'Y'.
       01 FLAGS.
          03 SEND-FLAG                  PIC X.
             88 SEND-ERASE                            VALUE '1'.
             88 SEND-DATAONLY                         VALUE '2'.
             88 SEND-DATAONLY-ALARM                   VALUE '3'.
       01 ACTION-ALPHA.
          03 ACTION-NUM                 PIC 9.
       01 END-OF-SESSION-MESSAGE        PIC X(13)     VALUE
                                                        'Session Ended'.
       01 RESPONSE-CODE                 PIC S9(8) COMP.
       01 COMMUNICATION-AREA            PIC X.
       01 WS-AMOUNT-AS-FLOAT COMP-2.
       01 WS-NUM-COUNT-TOTAL            PIC S9(8) BINARY.
       01 WS-NUM-COUNT-POINT            PIC S9(8) BINARY.
       01 WS-NUM-COUNT-SPACE            PIC S9(8) BINARY.
       01 WS-NUM-COUNT-MINUS            PIC S9(8) BINARY.
       01 WS-AMOUNT-UNSTR               PIC X(13).
       01 WS-AMOUNT-UNSTR-L             PIC S9(8) BINARY.
       01 WS-AMOUNT-UNSTR-REVERSE       PIC X(13).
       01 COMM-DOB-SPLIT.
          03 COMM-DOB-SPLIT-DD          PIC 99.
          03 COMM-DOB-SPLIT-MM          PIC 99.
          03 COMM-DOB-SPLIT-YYYY        PIC 9999.
       01 COMM-ADDR-SPLIT.
          03 COMM-ADDR-SPLIT1           PIC X(60).
          03 COMM-ADDR-SPLIT2           PIC X(60).
          03 COMM-ADDR-SPLIT3           PIC X(40).
       01 WS-CONVERSIONA.
          03 WS-CONVERT-PIC1            PIC X(13).
          03 WS-CONVERT-PIC1SP REDEFINES WS-CONVERT-PIC1.
             05 WS-CONVERT-PIC1-1ST     PIC X(10).
             05 WS-CONVERT-PIC1-POINT   PIC X.
             05 WS-CONVERT-PIC1-2ND     PIC XX.
       01 WS-CONVERSIONB.
          03 WS-CONVERT-PICX            PIC X(13).
          03 WS-CONVERT-SPLIT REDEFINES WS-CONVERT-PICX.
             05 WS-CONVERT-DEC          PIC 9(10).
             05 WS-CONVERT-POINT        PIC X.
             05 WS-CONVERT-REMAIN       PIC 99.
       01 WS-CONVERTED-VAL1             PIC S9(10)V99 VALUE 0.
       01 WS-CONVERTED-VAL2             PIC S9(10)V99 VALUE 0.
       01 WS-CONVERTED-VAL3             PIC S9(10)V99 VALUE 0.
       01 WS-CONVERTED-VAL4             PIC S9(10)V99 VALUE 0.
       01 SUBPGM-PARMS.
          03 SUBPGM-FACCNO              PIC 9(8).
          03 SUBPGM-FSCODE              PIC 9(6).
          03 SUBPGM-TACCNO              PIC 9(8).
          03 SUBPGM-TSCODE              PIC 9(6).
          03 SUBPGM-AMT                 PIC S9(10)V99.
          03 SUBPGM-FAVBAL              PIC S9(10)V99.
          03 SUBPGM-FACTBAL             PIC S9(10)V99.
          03 SUBPGM-TAVBAL              PIC S9(10)V99.
          03 SUBPGM-TACTBAL             PIC S9(10)V99.
          03 SUBPGM-FAIL-CODE           PIC X.
          03 SUBPGM-SUCCESS             PIC X.
       01 WS-COMMAREA.
          03 WS-COMMAREA-FACCNO         PIC 9(8).
          03 WS-COMMAREA-TACCNO         PIC 9(8).
          03 WS-COMMAREA-AMT            PIC 9(12).
       01 COMPANY-NAME-FULL             PIC X(32).
       01 FROM-AVAILABLE-BALANCE-DISPLAY
                                        PIC +9(10).99.
       01 FROM-ACTUAL-BALANCE-DISPLAY   PIC +9(10).99.
       01 TO-AVAILABLE-BALANCE-DISPLAY  PIC +9(10).99.
       01 TO-ACTUAL-BALANCE-DISPLAY     PIC +9(10).99.
       01 WS-U-TIME                     PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                  PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD            PIC 99.
          03 FILLER                     PIC X.
          03 WS-ORIG-DATE-MM            PIC 99.
          03 FILLER                     PIC X.
          03 WS-ORIG-DATE-YYYY          PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X          PIC XX.
          03 FILLER                     PIC X         VALUE '.'.
          03 WS-ORIG-DATE-MM-X          PIC XX.
          03 FILLER                     PIC X         VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X        PIC X(4).
       01 WS-TIME-DATA.
          03 WS-TIME-NOW                PIC 9(6).
          03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
             05 WS-TIME-NOW-GRP-HH      PIC 99.
             05 WS-TIME-NOW-GRP-MM      PIC 99.
             05 WS-TIME-NOW-GRP-SS      PIC 99.
       01 WS-ABEND-PGM                  PIC X(8)      VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 COMMAREA-FACCNO            PIC 9(8).
          03 COMMAREA-TACCNO            PIC 9(8).
          03 COMMAREA-AMT               PIC 9(12).
","['PREMIERE', 'PROCESS-MAP', 'RECEIVE-MAP', 'EDIT-DATA', 'GET-ACC-DATA', 'SEND-MAP', 'SEND-TERMINATION-MSG', 'ABEND-THIS-TASK', 'VALIDATE-AMOUNT', 'POPULATE-TIME-DATE', 'A010', 'A999', 'PM010', 'PM999', 'RM010', 'RM999', 'ED010', 'ED999', 'GCD010', 'GCD999', 'SM010', 'SM999', 'STM010', 'STM999', 'ATT010', 'ATT999', 'VA010', 'VA999', 'PTD010', 'PTD999']","Paragraph PREMIERE calls paragraph SEND-MAP, SEND-TERMINATION-MSG, ABEND-THIS-TASK, POPULATE-TIME-DATE, PROCESS-MAP.
Paragraph PROCESS-MAP calls paragraph EDIT-DATA, RECEIVE-MAP, GET-ACC-DATA, SEND-MAP.
Paragraph RECEIVE-MAP calls paragraph POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph EDIT-DATA calls paragraph ED999, VALIDATE-AMOUNT.
Paragraph GET-ACC-DATA calls paragraph POPULATE-TIME-DATE, GCD999, ABEND-THIS-TASK.
Paragraph SEND-MAP calls paragraph POPULATE-TIME-DATE, ABEND-THIS-TASK, SM999.
Paragraph SEND-TERMINATION-MSG calls paragraph POPULATE-TIME-DATE, ABEND-THIS-TASK.
Paragraph VALIDATE-AMOUNT calls paragraph VA999.
",842,This is the Transfer Funds between accounts program (in the same bank) in the BANKING application BMS suite.,['WS-ABEND-PGM'],,,Error Long,1,1,0.667,"This COBOL program processes various types of input through an EVALUATE statement, managing data validation, transfers, and map handling. It orchestrates multiple sections like PROCESS-MAP for execution flow, RECEIVE-MAP for error management, and SEND-MAP for CICS communication. Data checks and transfers are facilitated by EDIT-DATA and GET-ACC-DATA. Abnormal conditions are managed via SEND-TERMINATION-MSG and ABEND-THIS-TASK for error handling, while time and date are populated to ensure accurate record-keeping.",1
151,cicsdev_cics-banking-sample-application-cbsa,cics-banking-sample-application-cbsa/src/base/cobol_src/INQACC.cbl,"       CBL CICS('SP,EDF,DLI')
       CBL SQL
       IDENTIFICATION DIVISION.
       PROGRAM-ID. INQACC.
       AUTHOR. Jon Collett.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.  IBM-370.
       OBJECT-COMPUTER.  IBM-370.
       INPUT-OUTPUT SECTION.
       DATA DIVISION.
       FILE SECTION.
       WORKING-STORAGE SECTION.
       77 SORTCODE           PIC 9(6) VALUE 987654.
           EXEC SQL
              INCLUDE ACCDB2
           END-EXEC.
       01 HOST-ACCOUNT-ROW.
          03 HV-ACCOUNT-EYECATCHER     PIC X(4).
          03 HV-ACCOUNT-CUST-NO        PIC X(10).
          03 HV-ACCOUNT-SORTCODE       PIC X(6).
          03 HV-ACCOUNT-ACC-NO         PIC X(8).
          03 HV-ACCOUNT-ACC-TYPE       PIC X(8).
          03 HV-ACCOUNT-INT-RATE       PIC S9(4)V99 COMP-3.
          03 HV-ACCOUNT-OPENED         PIC X(10).
          03 HV-ACCOUNT-OVERDRAFT-LIM  PIC S9(9) COMP.
          03 HV-ACCOUNT-LAST-STMT      PIC X(10).
          03 HV-ACCOUNT-NEXT-STMT      PIC X(10).
          03 HV-ACCOUNT-AVAIL-BAL      PIC S9(10)V99 COMP-3.
          03 HV-ACCOUNT-ACTUAL-BAL     PIC S9(10)V99 COMP-3.
       EXEC SQL
          INCLUDE SQLCA
       END-EXEC.
           EXEC SQL DECLARE ACC-CURSOR CURSOR FOR
              SELECT ACCOUNT_EYECATCHER,
                     ACCOUNT_CUSTOMER_NUMBER,
                     ACCOUNT_SORTCODE,
                     ACCOUNT_NUMBER,
                     ACCOUNT_TYPE,
                     ACCOUNT_INTEREST_RATE,
                     ACCOUNT_OPENED,
                     ACCOUNT_OVERDRAFT_LIMIT,
                     ACCOUNT_LAST_STATEMENT,
                     ACCOUNT_NEXT_STATEMENT,
                     ACCOUNT_AVAILABLE_BALANCE,
                     ACCOUNT_ACTUAL_BALANCE
                     FROM ACCOUNT
                     WHERE ACCOUNT_SORTCODE =
                        :HV-ACCOUNT-SORTCODE AND
                        ACCOUNT_NUMBER =
                        :HV-ACCOUNT-ACC-NO
                     FOR FETCH ONLY
           END-EXEC.
       01 WS-CICS-WORK-AREA.
          05 WS-CICS-RESP              PIC S9(8) COMP.
          05 WS-CICS-RESP2             PIC S9(8) COMP.
       01 EXIT-BROWSE-LOOP             PIC X VALUE 'N'.
       01 OUTPUT-DATA.
              03 ACCOUNT-DATA.
                 05 ACCOUNT-EYE-CATCHER        PIC X(4).
                 88 ACCOUNT-EYECATCHER-VALUE        VALUE 'ACCT'.
                 05 ACCOUNT-CUST-NO            PIC 9(10).
                 05 ACCOUNT-KEY.
                    07 ACCOUNT-SORT-CODE       PIC 9(6).
                    07 ACCOUNT-NUMBER          PIC 9(8).
                 05 ACCOUNT-TYPE               PIC X(8).
                 05 ACCOUNT-INTEREST-RATE      PIC 9(4)V99.
                 05 ACCOUNT-OPENED             PIC 9(8).
                 05 ACCOUNT-OPENED-GROUP REDEFINES ACCOUNT-OPENED.
                    07 ACCOUNT-OPENED-DAY       PIC 99.
                    07 ACCOUNT-OPENED-MONTH     PIC 99.
                    07 ACCOUNT-OPENED-YEAR      PIC 9999.
                 05 ACCOUNT-OVERDRAFT-LIMIT    PIC 9(8).
                 05 ACCOUNT-LAST-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-LAST-STMT-GROUP
                    REDEFINES ACCOUNT-LAST-STMT-DATE.
                    07 ACCOUNT-LAST-STMT-DAY   PIC 99.
                    07 ACCOUNT-LAST-STMT-MONTH PIC 99.
                    07 ACCOUNT-LAST-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-NEXT-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-NEXT-STMT-GROUP
                   REDEFINES ACCOUNT-NEXT-STMT-DATE.
                    07 ACCOUNT-NEXT-STMT-DAY   PIC 99.
                    07 ACCOUNT-NEXT-STMT-MONTH PIC 99.
                    07 ACCOUNT-NEXT-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-AVAILABLE-BALANCE  PIC S9(10)V99.
                 05 ACCOUNT-ACTUAL-BALANCE     PIC S9(10)V99.
       01 RETURNED-DATA.
           03 RETURNED-EYE-CATCHER     PIC X(4).
           03 RETURNED-CUST-NO         PIC 9(10).
           03 RETURNED-KEY.
              05 RETURNED-SORT-CODE       PIC 9(6).
              05 RETURNED-NUMBER          PIC 9(8).
           03 RETURNED-TYPE            PIC X(8).
           03 RETURNED-INTEREST-RATE   PIC 9(4)V99.
           03 RETURNED-OPENED          PIC 9(8).
           03 RETURNED-OVERDRAFT-LIMIT PIC 9(8).
           03 RETURNED-LAST-STMT-DATE  PIC 9(8).
           03 RETURNED-NEXT-STMT-DATE  PIC 9(8).
           03 RETURNED-AVAILABLE-BALANCE  PIC S9(10)V99.
           03 RETURNED-ACTUAL-BALANCE     PIC S9(10)V99.
       01 DESIRED-KEY                  PIC 9(10) BINARY.
       01 DB2-DATE-REFORMAT.
          03 DB2-DATE-REF-YR           PIC 9(4).
          03 FILLER                    PIC X.
          03 DB2-DATE-REF-MNTH         PIC 99.
          03 FILLER                    PIC X.
          03 DB2-DATE-REF-DAY          PIC 99.
       01 DATA-STORE-TYPE              PIC X.
          88 DATASTORE-TYPE-DB2           VALUE '2'.
          88 DATASTORE-TYPE-VSAM          VALUE 'V'.
       01 DB2-EXIT-LOOP                PIC X.
       01 FETCH-DATA-CNT               PIC 9(4) COMP.
       01 WS-CUST-ALT-KEY-LEN          PIC S9(4) COMP VALUE +10.
       01 ACCOUNT-KY.
          03 REQUIRED-SORT-CODE        PIC 9(6)  VALUE 0.
          03 REQUIRED-ACC-NUM          PIC 9(8)  VALUE 0.
       01 MY-ABEND-CODE                PIC XXXX.
       01 WS-STORM-DRAIN               PIC X VALUE 'N'.
       01 STORM-DRAIN-CONDITION        PIC X(20).
       01 SQLCODE-DISPLAY              PIC S9(8) DISPLAY
           SIGN LEADING SEPARATE.
       01 NCS-ACC-NO-STUFF.
          03 NCS-ACC-NO-NAME.
             05 NCS-ACC-NO-ACT-NAME    PIC X(8)
                                          VALUE 'HBNKACCT'.
             05 NCS-ACC-NO-TEST-SORT   PIC X(6)
                                          VALUE '      '.
             05 NCS-ACC-NO-FILL        PIC XX
                                          VALUE '  '.
          03 NCS-ACC-NO-INC            PIC 9(16) COMP
                                          VALUE 0.
          03 NCS-ACC-NO-VALUE          PIC 9(16) COMP
                                          VALUE 0.
          03 NCS-ACC-NO-RESP           PIC XX VALUE '00'.
       01 WS-DISP-ACC-NO-VAL           PIC S9(18) DISPLAY.
       01 ACCOUNT-KY2.
          03 REQUIRED-SORT-CODE2       PIC 9(6) VALUE 0.
          03 REQUIRED-ACC-NUMBER2      PIC 9(8) VALUE 0.
       01 WS-POINTER USAGE POINTER.
       01 WS-POINTER-BYTES  REDEFINES WS-POINTER  PIC X(8).
       01 WS-POINTER-NUMBER  REDEFINES WS-POINTER PIC 9(8) BINARY.
       01 WS-POINTER-NUMBER-DISPLAY    PIC 9(8) DISPLAY.
       01 WS-U-TIME                    PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                 PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD           PIC 99.
          03 FILLER                    PIC X.
          03 WS-ORIG-DATE-MM           PIC 99.
          03 FILLER                    PIC X.
          03 WS-ORIG-DATE-YYYY         PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-MM-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X       PIC X(4).
       01 WS-TIME-DATA.
           03 WS-TIME-NOW              PIC 9(6).
           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
              05 WS-TIME-NOW-GRP-HH       PIC 99.
              05 WS-TIME-NOW-GRP-MM       PIC 99.
              05 WS-TIME-NOW-GRP-SS       PIC 99.
       01 WS-ABEND-PGM                 PIC X(8) VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 INQACC-EYE                  PIC X(4).
          03 INQACC-CUSTNO               PIC 9(10).
          03 INQACC-SCODE                PIC 9(6).
          03 INQACC-ACCNO                PIC 9(8).
          03 INQACC-ACC-TYPE             PIC X(8).
          03 INQACC-INT-RATE             PIC 9(4)V99.
          03 INQACC-OPENED               PIC 9(8).
          03 INQACC-OPENED-GROUP REDEFINES INQACC-OPENED.
            05 INQACC-OPENED-DAY         PIC 99.
            05 INQACC-OPENED-MONTH         PIC 99.
            05 INQACC-OPENED-YEAR         PIC 9999.
          03 INQACC-OVERDRAFT            PIC 9(8).
          03 INQACC-LAST-STMT-DT         PIC 9(8).
          03 INQACC-LAST-STMT-GROUP REDEFINES INQACC-LAST-STMT-DT.
            05 INQACC-LAST-STMT-DAY         PIC 99.
            05 INQACC-LAST-STMT-MONTH         PIC 99.
            05 INQACC-LAST-STMT-YEAR         PIC 9999.
          03 INQACC-NEXT-STMT-DT         PIC 9(8).
          03 INQACC-NEXT-STMT-GROUP REDEFINES INQACC-NEXT-STMT-DT.
            05 INQACC-NEXT-STMT-DAY         PIC 99.
            05 INQACC-NEXT-STMT-MONTH         PIC 99.
            05 INQACC-NEXT-STMT-YEAR         PIC 9999.
          03 INQACC-AVAIL-BAL            PIC S9(10)V99.
          03 INQACC-ACTUAL-BAL           PIC S9(10)V99.
          03 INQACC-SUCCESS              PIC X.
          03 INQACC-PCB1-POINTER         POINTER.
       PROCEDURE DIVISION USING DFHCOMMAREA.
       PREMIERE SECTION.
       A010.
           INITIALIZE OUTPUT-DATA.
           EXEC CICS HANDLE
              ABEND LABEL(ABEND-HANDLING)
           END-EXEC.
           MOVE SORTCODE TO REQUIRED-SORT-CODE OF ACCOUNT-KY.
           IF INQACC-ACCNO = 99999999
             PERFORM READ-ACCOUNT-LAST
           ELSE
             PERFORM READ-ACCOUNT-DB2
           END-IF
           IF ACCOUNT-TYPE = SPACES OR LOW-VALUES
              MOVE 'N' TO INQACC-SUCCESS
           ELSE
              MOVE ACCOUNT-EYE-CATCHER       TO INQACC-EYE
              MOVE ACCOUNT-CUST-NO           TO INQACC-CUSTNO
              MOVE ACCOUNT-SORT-CODE         TO INQACC-SCODE
              MOVE ACCOUNT-NUMBER            TO INQACC-ACCNO
              MOVE ACCOUNT-TYPE              TO INQACC-ACC-TYPE
              MOVE ACCOUNT-INTEREST-RATE     TO INQACC-INT-RATE
              MOVE ACCOUNT-OPENED            TO INQACC-OPENED
              MOVE ACCOUNT-OVERDRAFT-LIMIT   TO INQACC-OVERDRAFT
              MOVE ACCOUNT-LAST-STMT-DATE    TO INQACC-LAST-STMT-DT
              MOVE ACCOUNT-NEXT-STMT-DATE    TO INQACC-NEXT-STMT-DT
              MOVE ACCOUNT-AVAILABLE-BALANCE TO INQACC-AVAIL-BAL
              MOVE ACCOUNT-ACTUAL-BALANCE    TO INQACC-ACTUAL-BAL
              MOVE 'Y'                       TO INQACC-SUCCESS
           END-IF.
           PERFORM GET-ME-OUT-OF-HERE.
       A999.
           EXIT.
       READ-ACCOUNT-DB2 SECTION.
       RAD010.
           MOVE INQACC-ACCNO
              TO HV-ACCOUNT-ACC-NO.
           MOVE SORTCODE TO HV-ACCOUNT-SORTCODE.
           EXEC SQL OPEN ACC-CURSOR
           END-EXEC.
           IF SQLCODE NOT = 0
              MOVE SQLCODE TO SQLCODE-DISPLAY
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HRAC'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE SQLCODE-DISPLAY TO ABND-SQLCODE
              STRING 'RAD010 -Failure when attempting to OPEN DB2 '
                    DELIMITED BY SIZE,
                    'CURSOR. Check SQLCODE. '
                    DELIMITED BY SIZE,
                    'SQLCODE=' DELIMITED BY SIZE,
                    SQLCODE-DISPLAY DELIMITED BY SIZE,
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              DISPLAY 'Failure when attempting to open DB2 CURSOR '
                  'ACC-CURSOR. With SQL code='
                  SQLCODE-DISPLAY
              PERFORM CHECK-FOR-STORM-DRAIN-DB2
              EXEC CICS ABEND ABCODE('HRAC')
                 CANCEL
                 NODUMP
              END-EXEC
           END-IF.
           PERFORM FETCH-DATA.
           EXEC SQL CLOSE ACC-CURSOR
           END-EXEC.
           IF SQLCODE NOT = 0
              MOVE SQLCODE TO SQLCODE-DISPLAY
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HRAC'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE SQLCODE-DISPLAY TO ABND-SQLCODE
              STRING 'RAD010 -Failure when attempting to CLOSE DB2 '
                    DELIMITED BY SIZE,
                    'CURSOR (ACC-CUSOR). Check SQLCODE'
                    DELIMITED BY SIZE,
                    'SQLCODE=' DELIMITED BY SIZE,
                    SQLCODE-DISPLAY DELIMITED BY SIZE,
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              DISPLAY 'Failure when attempting to close the DB2 CURSOR'
                  ' ACC-CURSOR. With SQL code='
                  SQLCODE-DISPLAY
              PERFORM CHECK-FOR-STORM-DRAIN-DB2
              EXEC CICS ABEND ABCODE('HRAC')
                 CANCEL
                 NODUMP
              END-EXEC
           END-IF.
       RAD999.
           EXIT.
       FETCH-DATA SECTION.
       FD010.
           EXEC SQL FETCH FROM ACC-CURSOR
              INTO :HV-ACCOUNT-EYECATCHER,
                   :HV-ACCOUNT-CUST-NO,
                   :HV-ACCOUNT-SORTCODE,
                   :HV-ACCOUNT-ACC-NO,
                   :HV-ACCOUNT-ACC-TYPE,
                   :HV-ACCOUNT-INT-RATE,
                   :HV-ACCOUNT-OPENED,
                   :HV-ACCOUNT-OVERDRAFT-LIM,
                   :HV-ACCOUNT-LAST-STMT,
                   :HV-ACCOUNT-NEXT-STMT,
                   :HV-ACCOUNT-AVAIL-BAL,
                   :HV-ACCOUNT-ACTUAL-BAL
           END-EXEC.
           IF SQLCODE = +100
             INITIALIZE OUTPUT-DATA
             MOVE SORTCODE TO ACCOUNT-SORT-CODE OF OUTPUT-DATA
             MOVE INQACC-ACCNO TO ACCOUNT-NUMBER OF OUTPUT-DATA
             GO TO FD999
           END-IF.
           IF SQLCODE NOT = 0
              PERFORM CHECK-FOR-STORM-DRAIN-DB2
              MOVE SQLCODE TO SQLCODE-DISPLAY
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HRAC'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE SQLCODE-DISPLAY TO ABND-SQLCODE
              STRING 'FD010 -Failure when attempting to FETCH from '
                    DELIMITED BY SIZE,
                    'DB2 CURSOR (ACC-CURSOR). Check SQLCODE'
                    DELIMITED BY SIZE,
                    'SQLCODE=' DELIMITED BY SIZE,
                    SQLCODE-DISPLAY DELIMITED BY SIZE,
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                        COMMAREA(ABNDINFO-REC)
              END-EXEC
              DISPLAY 'Failure when attempting to FETCH from the DB2 '
                  'CURSOR ACC-CURSOR. With SQL code='
                  SQLCODE-DISPLAY
              EXEC CICS ABEND ABCODE('HRAC')
                 CANCEL
                 NODUMP
              END-EXEC
           END-IF.
           MOVE HV-ACCOUNT-EYECATCHER TO
              ACCOUNT-EYE-CATCHER OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-CUST-NO TO
              ACCOUNT-CUST-NO OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-SORTCODE TO
              ACCOUNT-SORT-CODE OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-ACC-NO TO
              ACCOUNT-NUMBER OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-ACC-TYPE TO
              ACCOUNT-TYPE OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-INT-RATE TO
              ACCOUNT-INTEREST-RATE OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-OPENED TO DB2-DATE-REFORMAT.
           MOVE DB2-DATE-REF-DAY TO
              ACCOUNT-OPENED-DAY OF OUTPUT-DATA.
           MOVE DB2-DATE-REF-MNTH TO
              ACCOUNT-OPENED-MONTH OF OUTPUT-DATA.
           MOVE DB2-DATE-REF-YR TO
              ACCOUNT-OPENED-YEAR OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-OVERDRAFT-LIM TO
              ACCOUNT-OVERDRAFT-LIMIT OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-LAST-STMT TO DB2-DATE-REFORMAT.
           MOVE DB2-DATE-REF-DAY TO
              ACCOUNT-LAST-STMT-DAY OF OUTPUT-DATA.
           MOVE DB2-DATE-REF-MNTH TO
              ACCOUNT-LAST-STMT-MONTH OF OUTPUT-DATA.
           MOVE DB2-DATE-REF-YR TO
              ACCOUNT-LAST-STMT-YEAR OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-NEXT-STMT TO DB2-DATE-REFORMAT
           MOVE DB2-DATE-REF-DAY TO
              ACCOUNT-NEXT-STMT-DAY OF OUTPUT-DATA.
           MOVE DB2-DATE-REF-MNTH TO
              ACCOUNT-NEXT-STMT-MONTH OF OUTPUT-DATA.
           MOVE DB2-DATE-REF-YR TO
              ACCOUNT-NEXT-STMT-YEAR OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-AVAIL-BAL TO
              ACCOUNT-AVAILABLE-BALANCE OF OUTPUT-DATA.
           MOVE HV-ACCOUNT-ACTUAL-BAL TO
              ACCOUNT-ACTUAL-BALANCE OF OUTPUT-DATA.
       FD999.
           EXIT.
       GET-ME-OUT-OF-HERE SECTION.
       GMOFH010.
           EXEC CICS RETURN
           END-EXEC.
           GOBACK.
       GMOFH999.
           EXIT.
       CHECK-FOR-STORM-DRAIN-DB2 SECTION.
       CFSDCD010.
           EVALUATE SQLCODE
              WHEN 923
                 MOVE 'DB2 Connection lost ' TO STORM-DRAIN-CONDITION
              WHEN OTHER
                 MOVE 'Not Storm Drain     ' TO STORM-DRAIN-CONDITION
           END-EVALUATE.
           MOVE SQLCODE TO SQLCODE-DISPLAY.
           IF STORM-DRAIN-CONDITION NOT EQUAL 'Not Storm Drain     '
              DISPLAY 'INQACC: Check-For-Storm-Drain-DB2: Storm '
                      'Drain condition (' STORM-DRAIN-CONDITION ') '
                      'has been met (' SQLCODE-DISPLAY ').'
           ELSE
              CONTINUE
           END-IF.
       CFSDCD999.
           EXIT.
       ABEND-HANDLING SECTION.
       AH010.
           EXEC CICS ASSIGN ABCODE(MY-ABEND-CODE)
           END-EXEC.
           EVALUATE MY-ABEND-CODE
              WHEN 'AD2Z'
                 MOVE SQLCODE TO SQLCODE-DISPLAY
                 DISPLAY 'DB2 DEADLOCK DETECTED IN INQACC, SQLCODE='
                    SQLCODE-DISPLAY
                 DISPLAY 'DB2 DEADLOCK FOR ACCOUNT '
                    HV-ACCOUNT-ACC-NO
                 DISPLAY  'SQLSTATE=' SQLSTATE
                        ',SQLERRMC=' sqlerrmc(1:sqlerrmL)
                        ',SQLERRD(1)=' SQLERRD(1)
                        ',SQLERRD(2)=' SQLERRD(2)
                        ',SQLERRD(3)=' SQLERRD(3)
                        ',SQLERRD(4)=' SQLERRD(4)
                        ',SQLERRD(5)=' SQLERRD(5)
                        ',SQLERRD(6)=' SQLERRD(6)
              WHEN 'AFCR'
              WHEN 'AFCS'
              WHEN 'AFCT'
                 MOVE 'Y' TO WS-STORM-DRAIN
                 DISPLAY 'INQACC: Check-For-Storm-Drain-VSAM: Storm '
                       'Drain condition (Abend ' MY-ABEND-CODE ') '
                       'has been met.'
                 EXEC CICS SYNCPOINT ROLLBACK
                    RESP(WS-CICS-RESP)
                    RESP2(WS-CICS-RESP2)
                 END-EXEC
                IF WS-CICS-RESP NOT = DFHRESP(NORMAL)
                   INITIALIZE ABNDINFO-REC
                   MOVE EIBRESP    TO ABND-RESPCODE
                   MOVE EIBRESP2   TO ABND-RESP2CODE
                   EXEC CICS ASSIGN APPLID(ABND-APPLID)
                   END-EXEC
                   MOVE EIBTASKN   TO ABND-TASKNO-KEY
                   MOVE EIBTRNID   TO ABND-TRANID
                   PERFORM POPULATE-TIME-DATE
                   MOVE WS-ORIG-DATE TO ABND-DATE
                   STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                       ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                        ':' DELIMITED BY SIZE,
                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                        INTO ABND-TIME
                   END-STRING
                   MOVE WS-U-TIME   TO ABND-UTIME-KEY
                   MOVE 'HROL'      TO ABND-CODE
                   EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
                   END-EXEC
                   MOVE 0 TO ABND-SQLCODE
                   STRING 'AH010 -Unable to perform SYNCPOINT ROLLBACK.'
                       DELIMITED BY SIZE,
                       ' Possible integrity issue following VSAM RLS '
                       DELIMITED BY SIZE,
                       ' abend.' DELIMITED BY SIZE,
                       ' EIBRESP=' DELIMITED BY SIZE,
                       ABND-RESPCODE DELIMITED BY SIZE,
                       ' RESP2=' DELIMITED BY SIZE,
                       ABND-RESP2CODE DELIMITED BY SIZE
                       INTO ABND-FREEFORM
                   END-STRING
                   EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                           COMMAREA(ABNDINFO-REC)
                   END-EXEC
                   DISPLAY 'INQACC: Unable to perform Syncpoint '
                           'Rollback. Possible Integrity issue '
                           ' following VSAM RLS abend. '
                           ' RESP CODE=' WS-CICS-RESP
                           ' RESP2 CODE=' WS-CICS-RESP2
                   EXEC CICS ABEND
                      ABCODE ('HROL')
                      NODUMP
                       CANCEL
                   END-EXEC
                END-IF
                MOVE 'N' TO INQACC-SUCCESS
                EXEC CICS RETURN
                END-EXEC
           END-EVALUATE.
           IF WS-STORM-DRAIN = 'N'
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                     ':' DELIMITED BY SIZE,
                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE MY-ABEND-CODE TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE ZEROS      TO ABND-SQLCODE
              STRING 'AH010 -WVS-STORM-DRAIN=N'
                    DELIMITED BY SIZE,
                    ' EIBRESP=' DELIMITED BY SIZE,
                    ABND-RESPCODE DELIMITED BY SIZE,
                    ' RESP2=' DELIMITED BY SIZE,
                    ABND-RESP2CODE DELIMITED BY SIZE
                    INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                 COMMAREA(ABNDINFO-REC)
              END-EXEC
              EXEC CICS ABEND ABCODE( MY-ABEND-CODE)
              NODUMP
              CANCEL
              END-EXEC
           END-IF.
       AH999.
           EXIT.
       READ-ACCOUNT-LAST SECTION.
       RAN010.
            PERFORM GET-LAST-ACCOUNT-DB2.
            MOVE REQUIRED-ACC-NUMBER2 TO NCS-ACC-NO-VALUE.
       RAN999.
           EXIT.
       GET-LAST-ACCOUNT-DB2 SECTION.
       GLAD010.
           INITIALIZE OUTPUT-DATA.
           MOVE REQUIRED-ACC-NUMBER2 TO HV-ACCOUNT-ACC-NO.
           MOVE REQUIRED-SORT-CODE TO HV-ACCOUNT-SORTCODE.
           MOVE SORTCODE TO HV-ACCOUNT-SORTCODE.
           EXEC SQL
              SELECT ACCOUNT_EYECATCHER,
                     ACCOUNT_CUSTOMER_NUMBER,
                     ACCOUNT_SORTCODE,
                     ACCOUNT_NUMBER,
                     ACCOUNT_TYPE,
                     ACCOUNT_INTEREST_RATE,
                     ACCOUNT_OPENED,
                     ACCOUNT_OVERDRAFT_LIMIT,
                     ACCOUNT_LAST_STATEMENT,
                     ACCOUNT_NEXT_STATEMENT,
                     ACCOUNT_AVAILABLE_BALANCE,
                     ACCOUNT_ACTUAL_BALANCE
              INTO :HV-ACCOUNT-EYECATCHER,
                   :HV-ACCOUNT-CUST-NO,
                   :HV-ACCOUNT-SORTCODE,
                   :HV-ACCOUNT-ACC-NO,
                   :HV-ACCOUNT-ACC-TYPE,
                   :HV-ACCOUNT-INT-RATE,
                   :HV-ACCOUNT-OPENED,
                   :HV-ACCOUNT-OVERDRAFT-LIM,
                   :HV-ACCOUNT-LAST-STMT,
                   :HV-ACCOUNT-NEXT-STMT,
                   :HV-ACCOUNT-AVAIL-BAL,
                   :HV-ACCOUNT-ACTUAL-BAL
              FROM ACCOUNT
              WHERE ACCOUNT_SORTCODE = :HV-ACCOUNT-SORTCODE
              ORDER BY ACCOUNT_NUMBER DESC
              FETCH FIRST 1 ROWS ONLY
           END-EXEC.
           IF SQLCODE IS NOT EQUAL TO ZERO
              MOVE SQLCODE TO SQLCODE-DISPLAY
              INITIALIZE ABNDINFO-REC
              MOVE EIBRESP    TO ABND-RESPCODE
              MOVE EIBRESP2   TO ABND-RESP2CODE
              EXEC CICS ASSIGN APPLID(ABND-APPLID)
              END-EXEC
              MOVE EIBTASKN   TO ABND-TASKNO-KEY
              MOVE EIBTRNID   TO ABND-TRANID
              PERFORM POPULATE-TIME-DATE
              MOVE WS-ORIG-DATE TO ABND-DATE
              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,
                   ':' DELIMITED BY SIZE,
                    WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,
                    ':' DELIMITED BY SIZE,
                    WS-TIME-NOW-GRP-MM DELIMITED BY SIZE
                     INTO ABND-TIME
              END-STRING
              MOVE WS-U-TIME   TO ABND-UTIME-KEY
              MOVE 'HNCS'      TO ABND-CODE
              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)
              END-EXEC
              MOVE SQLCODE-DISPLAY TO ABND-SQLCODE
              STRING 'GLAD010 -ACCOUNT NCS '
                   DELIMITED BY SIZE,
                   NCS-ACC-NO-NAME   DELIMITED BY SIZE,
                   ' CANNOT be accessed and DB2 ' DELIMITED BY SIZE,
                   ' SELECT failed. SQLCODE='
                   DELIMITED BY SIZE,
                   SQLCODE-DISPLAY DELIMITED BY SIZE
                   INTO ABND-FREEFORM
              END-STRING
              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)
                       COMMAREA(ABNDINFO-REC)
              END-EXEC
              DISPLAY 'INQACC - ACCOUNT NCS ' NCS-ACC-NO-NAME
                 ' CANNOT BE ACCESSED AND DB2 SELECT FAILED. SQLCODE='
                 SQLCODE-DISPLAY
              EXEC CICS ABEND
                       ABCODE('HNCS')
                       NODUMP
                       CANCEL
              END-EXEC
           ELSE
             MOVE HV-ACCOUNT-EYECATCHER TO
                ACCOUNT-EYE-CATCHER OF OUTPUT-DATA
             MOVE HV-ACCOUNT-CUST-NO TO
                ACCOUNT-CUST-NO OF OUTPUT-DATA
             MOVE HV-ACCOUNT-SORTCODE TO
                ACCOUNT-SORT-CODE OF OUTPUT-DATA
             MOVE HV-ACCOUNT-ACC-NO TO
                ACCOUNT-NUMBER OF OUTPUT-DATA
             MOVE HV-ACCOUNT-ACC-TYPE TO
                ACCOUNT-TYPE OF OUTPUT-DATA
             MOVE HV-ACCOUNT-INT-RATE TO
                ACCOUNT-INTEREST-RATE OF OUTPUT-DATA
             MOVE HV-ACCOUNT-OPENED TO DB2-DATE-REFORMAT
             MOVE DB2-DATE-REF-DAY TO
                ACCOUNT-OPENED-DAY OF OUTPUT-DATA
             MOVE DB2-DATE-REF-MNTH TO
                ACCOUNT-OPENED-MONTH OF OUTPUT-DATA
             MOVE DB2-DATE-REF-YR TO
                ACCOUNT-OPENED-YEAR OF OUTPUT-DATA
             MOVE HV-ACCOUNT-OVERDRAFT-LIM TO
                ACCOUNT-OVERDRAFT-LIMIT OF OUTPUT-DATA
             MOVE HV-ACCOUNT-LAST-STMT TO DB2-DATE-REFORMAT
             MOVE DB2-DATE-REF-DAY TO
                ACCOUNT-LAST-STMT-DAY OF OUTPUT-DATA
             MOVE DB2-DATE-REF-MNTH TO
                ACCOUNT-LAST-STMT-MONTH OF OUTPUT-DATA
             MOVE DB2-DATE-REF-YR TO
                ACCOUNT-LAST-STMT-YEAR OF OUTPUT-DATA
             MOVE HV-ACCOUNT-NEXT-STMT TO DB2-DATE-REFORMAT
             MOVE DB2-DATE-REF-DAY TO
                ACCOUNT-NEXT-STMT-DAY OF OUTPUT-DATA
             MOVE DB2-DATE-REF-MNTH TO
                ACCOUNT-NEXT-STMT-MONTH OF OUTPUT-DATA
             MOVE DB2-DATE-REF-YR TO
                ACCOUNT-NEXT-STMT-YEAR OF OUTPUT-DATA
             MOVE HV-ACCOUNT-AVAIL-BAL TO
                ACCOUNT-AVAILABLE-BALANCE OF OUTPUT-DATA
             MOVE HV-ACCOUNT-ACTUAL-BAL TO
                ACCOUNT-ACTUAL-BALANCE OF OUTPUT-DATA
           END-IF.
       GLAD999.
           EXIT.
       POPULATE-TIME-DATE SECTION.
       PTD010.
           EXEC CICS ASKTIME
              ABSTIME(WS-U-TIME)
           END-EXEC.
           EXEC CICS FORMATTIME
                     ABSTIME(WS-U-TIME)
                     DDMMYYYY(WS-ORIG-DATE)
                     TIME(WS-TIME-NOW)
                     DATESEP
           END-EXEC.
       PTD999.
           EXIT.
","       FILE SECTION.
       WORKING-STORAGE SECTION.
       77 SORTCODE           PIC 9(6) VALUE 987654.
           EXEC SQL
              INCLUDE ACCDB2
           END-EXEC.
       01 HOST-ACCOUNT-ROW.
          03 HV-ACCOUNT-EYECATCHER     PIC X(4).
          03 HV-ACCOUNT-CUST-NO        PIC X(10).
          03 HV-ACCOUNT-SORTCODE       PIC X(6).
          03 HV-ACCOUNT-ACC-NO         PIC X(8).
          03 HV-ACCOUNT-ACC-TYPE       PIC X(8).
          03 HV-ACCOUNT-INT-RATE       PIC S9(4)V99 COMP-3.
          03 HV-ACCOUNT-OPENED         PIC X(10).
          03 HV-ACCOUNT-OVERDRAFT-LIM  PIC S9(9) COMP.
          03 HV-ACCOUNT-LAST-STMT      PIC X(10).
          03 HV-ACCOUNT-NEXT-STMT      PIC X(10).
          03 HV-ACCOUNT-AVAIL-BAL      PIC S9(10)V99 COMP-3.
          03 HV-ACCOUNT-ACTUAL-BAL     PIC S9(10)V99 COMP-3.
       EXEC SQL
          INCLUDE SQLCA
       END-EXEC.
           EXEC SQL DECLARE ACC-CURSOR CURSOR FOR
              SELECT ACCOUNT_EYECATCHER,
                     ACCOUNT_CUSTOMER_NUMBER,
                     ACCOUNT_SORTCODE,
                     ACCOUNT_NUMBER,
                     ACCOUNT_TYPE,
                     ACCOUNT_INTEREST_RATE,
                     ACCOUNT_OPENED,
                     ACCOUNT_OVERDRAFT_LIMIT,
                     ACCOUNT_LAST_STATEMENT,
                     ACCOUNT_NEXT_STATEMENT,
                     ACCOUNT_AVAILABLE_BALANCE,
                     ACCOUNT_ACTUAL_BALANCE
                     FROM ACCOUNT
                     WHERE ACCOUNT_SORTCODE =
                        :HV-ACCOUNT-SORTCODE AND
                        ACCOUNT_NUMBER =
                        :HV-ACCOUNT-ACC-NO
                     FOR FETCH ONLY
           END-EXEC.
       01 WS-CICS-WORK-AREA.
          05 WS-CICS-RESP              PIC S9(8) COMP.
          05 WS-CICS-RESP2             PIC S9(8) COMP.
       01 EXIT-BROWSE-LOOP             PIC X VALUE 'N'.
       01 OUTPUT-DATA.
              03 ACCOUNT-DATA.
                 05 ACCOUNT-EYE-CATCHER        PIC X(4).
                 88 ACCOUNT-EYECATCHER-VALUE        VALUE 'ACCT'.
                 05 ACCOUNT-CUST-NO            PIC 9(10).
                 05 ACCOUNT-KEY.
                    07 ACCOUNT-SORT-CODE       PIC 9(6).
                    07 ACCOUNT-NUMBER          PIC 9(8).
                 05 ACCOUNT-TYPE               PIC X(8).
                 05 ACCOUNT-INTEREST-RATE      PIC 9(4)V99.
                 05 ACCOUNT-OPENED             PIC 9(8).
                 05 ACCOUNT-OPENED-GROUP REDEFINES ACCOUNT-OPENED.
                    07 ACCOUNT-OPENED-DAY       PIC 99.
                    07 ACCOUNT-OPENED-MONTH     PIC 99.
                    07 ACCOUNT-OPENED-YEAR      PIC 9999.
                 05 ACCOUNT-OVERDRAFT-LIMIT    PIC 9(8).
                 05 ACCOUNT-LAST-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-LAST-STMT-GROUP
                    REDEFINES ACCOUNT-LAST-STMT-DATE.
                    07 ACCOUNT-LAST-STMT-DAY   PIC 99.
                    07 ACCOUNT-LAST-STMT-MONTH PIC 99.
                    07 ACCOUNT-LAST-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-NEXT-STMT-DATE     PIC 9(8).
                 05 ACCOUNT-NEXT-STMT-GROUP
                   REDEFINES ACCOUNT-NEXT-STMT-DATE.
                    07 ACCOUNT-NEXT-STMT-DAY   PIC 99.
                    07 ACCOUNT-NEXT-STMT-MONTH PIC 99.
                    07 ACCOUNT-NEXT-STMT-YEAR  PIC 9999.
                 05 ACCOUNT-AVAILABLE-BALANCE  PIC S9(10)V99.
                 05 ACCOUNT-ACTUAL-BALANCE     PIC S9(10)V99.
       01 RETURNED-DATA.
           03 RETURNED-EYE-CATCHER     PIC X(4).
           03 RETURNED-CUST-NO         PIC 9(10).
           03 RETURNED-KEY.
              05 RETURNED-SORT-CODE       PIC 9(6).
              05 RETURNED-NUMBER          PIC 9(8).
           03 RETURNED-TYPE            PIC X(8).
           03 RETURNED-INTEREST-RATE   PIC 9(4)V99.
           03 RETURNED-OPENED          PIC 9(8).
           03 RETURNED-OVERDRAFT-LIMIT PIC 9(8).
           03 RETURNED-LAST-STMT-DATE  PIC 9(8).
           03 RETURNED-NEXT-STMT-DATE  PIC 9(8).
           03 RETURNED-AVAILABLE-BALANCE  PIC S9(10)V99.
           03 RETURNED-ACTUAL-BALANCE     PIC S9(10)V99.
       01 DESIRED-KEY                  PIC 9(10) BINARY.
       01 DB2-DATE-REFORMAT.
          03 DB2-DATE-REF-YR           PIC 9(4).
          03 FILLER                    PIC X.
          03 DB2-DATE-REF-MNTH         PIC 99.
          03 FILLER                    PIC X.
          03 DB2-DATE-REF-DAY          PIC 99.
       01 DATA-STORE-TYPE              PIC X.
          88 DATASTORE-TYPE-DB2           VALUE '2'.
          88 DATASTORE-TYPE-VSAM          VALUE 'V'.
       01 DB2-EXIT-LOOP                PIC X.
       01 FETCH-DATA-CNT               PIC 9(4) COMP.
       01 WS-CUST-ALT-KEY-LEN          PIC S9(4) COMP VALUE +10.
       01 ACCOUNT-KY.
          03 REQUIRED-SORT-CODE        PIC 9(6)  VALUE 0.
          03 REQUIRED-ACC-NUM          PIC 9(8)  VALUE 0.
       01 MY-ABEND-CODE                PIC XXXX.
       01 WS-STORM-DRAIN               PIC X VALUE 'N'.
       01 STORM-DRAIN-CONDITION        PIC X(20).
       01 SQLCODE-DISPLAY              PIC S9(8) DISPLAY
           SIGN LEADING SEPARATE.
       01 NCS-ACC-NO-STUFF.
          03 NCS-ACC-NO-NAME.
             05 NCS-ACC-NO-ACT-NAME    PIC X(8)
                                          VALUE 'HBNKACCT'.
             05 NCS-ACC-NO-TEST-SORT   PIC X(6)
                                          VALUE '      '.
             05 NCS-ACC-NO-FILL        PIC XX
                                          VALUE '  '.
          03 NCS-ACC-NO-INC            PIC 9(16) COMP
                                          VALUE 0.
          03 NCS-ACC-NO-VALUE          PIC 9(16) COMP
                                          VALUE 0.
          03 NCS-ACC-NO-RESP           PIC XX VALUE '00'.
       01 WS-DISP-ACC-NO-VAL           PIC S9(18) DISPLAY.
       01 ACCOUNT-KY2.
          03 REQUIRED-SORT-CODE2       PIC 9(6) VALUE 0.
          03 REQUIRED-ACC-NUMBER2      PIC 9(8) VALUE 0.
       01 WS-POINTER USAGE POINTER.
       01 WS-POINTER-BYTES  REDEFINES WS-POINTER  PIC X(8).
       01 WS-POINTER-NUMBER  REDEFINES WS-POINTER PIC 9(8) BINARY.
       01 WS-POINTER-NUMBER-DISPLAY    PIC 9(8) DISPLAY.
       01 WS-U-TIME                    PIC S9(15) COMP-3.
       01 WS-ORIG-DATE                 PIC X(10).
       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.
          03 WS-ORIG-DATE-DD           PIC 99.
          03 FILLER                    PIC X.
          03 WS-ORIG-DATE-MM           PIC 99.
          03 FILLER                    PIC X.
          03 WS-ORIG-DATE-YYYY         PIC 9999.
       01 WS-ORIG-DATE-GRP-X.
          03 WS-ORIG-DATE-DD-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-MM-X         PIC XX.
          03 FILLER                    PIC X VALUE '.'.
          03 WS-ORIG-DATE-YYYY-X       PIC X(4).
       01 WS-TIME-DATA.
           03 WS-TIME-NOW              PIC 9(6).
           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.
              05 WS-TIME-NOW-GRP-HH       PIC 99.
              05 WS-TIME-NOW-GRP-MM       PIC 99.
              05 WS-TIME-NOW-GRP-SS       PIC 99.
       01 WS-ABEND-PGM                 PIC X(8) VALUE 'ABNDPROC'.
       01 ABNDINFO-REC.
           03 ABND-VSAM-KEY.
              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.
              05 ABND-TASKNO-KEY                 PIC 9(4).
           03 ABND-APPLID                        PIC X(8).
           03 ABND-TRANID                        PIC X(4).
           03 ABND-DATE                          PIC X(10).
           03 ABND-TIME                          PIC X(8).
           03 ABND-CODE                          PIC X(4).
           03 ABND-PROGRAM                       PIC X(8).
           03 ABND-RESPCODE                      PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-SQLCODE                       PIC S9(8) DISPLAY
                  SIGN LEADING SEPARATE.
           03 ABND-FREEFORM                      PIC X(600).
       LINKAGE SECTION.
       01 DFHCOMMAREA.
          03 INQACC-EYE                  PIC X(4).
          03 INQACC-CUSTNO               PIC 9(10).
          03 INQACC-SCODE                PIC 9(6).
          03 INQACC-ACCNO                PIC 9(8).
          03 INQACC-ACC-TYPE             PIC X(8).
          03 INQACC-INT-RATE             PIC 9(4)V99.
          03 INQACC-OPENED               PIC 9(8).
          03 INQACC-OPENED-GROUP REDEFINES INQACC-OPENED.
            05 INQACC-OPENED-DAY         PIC 99.
            05 INQACC-OPENED-MONTH         PIC 99.
            05 INQACC-OPENED-YEAR         PIC 9999.
          03 INQACC-OVERDRAFT            PIC 9(8).
          03 INQACC-LAST-STMT-DT         PIC 9(8).
          03 INQACC-LAST-STMT-GROUP REDEFINES INQACC-LAST-STMT-DT.
            05 INQACC-LAST-STMT-DAY         PIC 99.
            05 INQACC-LAST-STMT-MONTH         PIC 99.
            05 INQACC-LAST-STMT-YEAR         PIC 9999.
          03 INQACC-NEXT-STMT-DT         PIC 9(8).
          03 INQACC-NEXT-STMT-GROUP REDEFINES INQACC-NEXT-STMT-DT.
            05 INQACC-NEXT-STMT-DAY         PIC 99.
            05 INQACC-NEXT-STMT-MONTH         PIC 99.
            05 INQACC-NEXT-STMT-YEAR         PIC 9999.
          03 INQACC-AVAIL-BAL            PIC S9(10)V99.
          03 INQACC-ACTUAL-BAL           PIC S9(10)V99.
          03 INQACC-SUCCESS              PIC X.
          03 INQACC-PCB1-POINTER         POINTER.
","['PREMIERE', 'READ-ACCOUNT-DB2', 'FETCH-DATA', 'GET-ME-OUT-OF-HERE', 'CHECK-FOR-STORM-DRAIN-DB2', 'ABEND-HANDLING', 'READ-ACCOUNT-LAST', 'GET-LAST-ACCOUNT-DB2', 'POPULATE-TIME-DATE', 'A010', 'A999', 'RAD010', 'RAD999', 'FD010', 'FD999', 'GMOFH010', 'GMOFH999', 'CFSDCD010', 'CFSDCD999', 'AH010', 'AH999', 'RAN010', 'RAN999', 'GLAD010', 'GLAD999', 'PTD010', 'PTD999']","Paragraph PREMIERE calls paragraph GET-ME-OUT-OF-HERE, READ-ACCOUNT-LAST, READ-ACCOUNT-DB2.
Paragraph READ-ACCOUNT-DB2 calls paragraph POPULATE-TIME-DATE, FETCH-DATA, CHECK-FOR-STORM-DRAIN-DB2.
Paragraph FETCH-DATA calls paragraph POPULATE-TIME-DATE, FD999, CHECK-FOR-STORM-DRAIN-DB2.
Paragraph ABEND-HANDLING calls paragraph POPULATE-TIME-DATE.
Paragraph READ-ACCOUNT-LAST calls paragraph GET-LAST-ACCOUNT-DB2.
Paragraph GET-LAST-ACCOUNT-DB2 calls paragraph POPULATE-TIME-DATE.
",734,"This program takes an incoming account number. It then accesses the DB2 datastore & retrieves the associated account record/row matching on the account number & the account_type. Should there be any issues, the program will abend.",['WS-ABEND-PGM'],,,Error Long,1,1,1,"This COBOL program retrieves and processes account information while handling potential errors. It initializes output data and checks account numbers to either read the last account or from a DB2 database. The program populates time and date, fetches data, and checks for storm drain conditions, handling any abnormalities or terminations accordingly. The code concludes with proper exits to the CICS system, ensuring all operations complete smoothly and efficiently, returning control appropriately.",1
165,cicsdev_cics-genapp,cics-genapp/base/src/lgwebst5.cbl,"       IDENTIFICATION DIVISION.
       PROGRAM-ID. LGWEBST5
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01  CountVal                   PIC S9(8) COMP.
       01  CountSuccess               PIC S9(9) COMP.
       01  CountErrors                PIC S9(8) COMP.
       01  CountInq                   PIC S9(8) COMP.
       01  CountAdd                   PIC S9(8) COMP.
       01  CountUpd                   PIC S9(8) COMP.
       01  CountDel                   PIC S9(8) COMP.
       01  DRateVal                   PIC 9(9).
       01  NRateVal                   PIC 9(9).
       01  ORateVal                   PIC 9(9).
       01  ICountVal                  PIC 9(6).
       01  OCountVal                  PIC 9(6).
       01  NCountVal                  PIC 9(6).
       01  HHval                      PIC 9(6).
       01  MMval                      PIC 9(6).
       01  SSval                      PIC 9(6).
       01  WS-RESP                    PIC S9(8) COMP.
       01  WS-ABSTIME                 PIC S9(8) COMP VALUE +0.
       01  WS-CODE                    Pic 9(4) Comp.
       01  WS-TIME                    Pic X(8).
       01  WS-Startup                 Pic X(40) Value
                     'GENAPP Statistics collector started.'.
       01  TCPservice                Pic X(8) Value 'SSISTAT1'.
       01  TCPaddress                Pic X(15).
       01  TCPaddrLen                Pic S9(8) Comp sync.
       01  Part1                     Pic X(8).
       01  Part2                     Pic X(8).
       01  Part3                     Pic X(8).
       01  Part4                     Pic X(8).
       01  TSQpre                    Pic X(4).
       01  WS-TSQname                 Pic X(8).
       01  WS-TSQdata                 Pic X(9).
       01  WS-TSQstart                Pic X(24).
       01  WS-HHMMSS.
         03  WS-HH                    Pic X(2).
         03  WS-MM                    Pic X(2).
         03  WS-SS                    Pic X(2).
       01  WS-DATE                    PIC X(10) VALUE SPACES.
       01  StatQ                      PIC X(8)  Value 'GENASTAT'.
       01  TemplateName               PIC X(48) Value 'GENAST3TEMP'.
       01  WS-APPLID                  PIC X(8).
       01  WS-TOKEN                   PIC X(16).
       01  WS-TEXT                    PIC X(2)  Value 'OK'.
       01  WS-MTYPE                   Pic X(56) Value 'text/html'.
       01  WS-CHARSET                 Pic X(40) Value 'ISO-8859-1'.
       01  WS-OLDV.
         02 WS-OLDVHH                 Pic X(2).
         02 WS-OLDVMM                 Pic X(2).
         02 WS-OLDVSS                 Pic X(2).
       01  WS-NEWV                    PIC X(6).
       01  WRITE-MSG-H                PIC X(24) Value '  Statistics.'.
       01  WS-HEADER.
          03 WS-EYECATCHER            PIC X(16)
                                       VALUE 'LGWEBST5------WS'.
          03 WS-TRANSID               PIC X(4).
          03 WS-TERMID                PIC X(4).
          03 WS-TASKNUM               PIC 9(7).
          03 WS-CALEN                 PIC 9(7).
       01  SymbList.
          03  Filler                  Pic X(7)  Value 'APPLID='.
          03  S1                      Pic X(8)  Value Spaces.
          03  Filler                  Pic X(13) Value '&GENACount-V='.
          03  S2                      Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNT100-V='.
          03  S3                      Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNT199-V='.
          03  S4                      Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNT200-V='.
          03  S5                      Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNT299-V='.
          03  S6                      Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNT300-V='.
          03  S7                      Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNT399-V='.
          03  S8                      Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNT400-V='.
          03  S9                      Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNT499-V='.
          03  S10                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNT500-V='.
          03  S11                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNT599-V='.
          03  S12                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNT600-V='.
          03  S13                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNT699-V='.
          03  S14                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNT700-V='.
          03  S15                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNT799-V='.
          03  S16                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNT800-V='.
          03  S17                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNT899-V='.
          03  S18                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNT900-V='.
          03  S19                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNT999-V='.
          03  S20                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNTA00-V='.
          03  S21                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNTA99-V='.
          03  S22                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNTB00-V='.
          03  S23                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNTB99-V='.
          03  S24                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNTC00-V='.
          03  S25                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNTC99-V='.
          03  S26                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNTD00-V='.
          03  S27                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNTD99-V='.
          03  S28                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNTE00-V='.
          03  S29                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNTE99-V='.
          03  S30                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNTF00-V='.
          03  S31                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNTF99-V='.
          03  S32                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNTG00-V='.
          03  S33                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNTG99-V='.
          03  S34                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNTH00-V='.
          03  S35                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNTH99-V='.
          03  S36                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNTI99-V='.
          03  S37                     Pic Z(9)9.
          03  Filler                  Pic X(14) Value '&GENAsucces-V='.
          03  S38                     Pic Z(9)9.
          03  Filler                  Pic X(14) Value '&GENAerrors-V='.
          03  S39                     Pic Z(9)9.
          03  Filler                  Pic X(14) Value '&GENAstart='.
          03  S40                     Pic X(16).
       01 GENACount-V                 Pic 9(9)  Display.
       01 GENACNT100-V                Pic 9(9)  Display.
       01 GENACNT199-V                Pic 9(9)  Display.
       01 GENACNT200-V                Pic 9(9)  Display.
       01 GENACNT299-V                Pic 9(9)  Display.
       01 GENACNT300-V                Pic 9(9)  Display.
       01 GENACNT399-V                Pic 9(9)  Display.
       01 GENACNT400-V                Pic 9(9)  Display.
       01 GENACNT499-V                Pic 9(9)  Display.
       01 GENACNT500-V                Pic 9(9)  Display.
       01 GENACNT599-V                Pic 9(9)  Display.
       01 GENACNT600-V                Pic 9(9)  Display.
       01 GENACNT699-V                Pic 9(9)  Display.
       01 GENACNT700-V                Pic 9(9)  Display.
       01 GENACNT799-V                Pic 9(9)  Display.
       01 GENACNT800-V                Pic 9(9)  Display.
       01 GENACNT899-V                Pic 9(9)  Display.
       01 GENACNT900-V                Pic 9(9)  Display.
       01 GENACNT999-V                Pic 9(9)  Display.
       01 GENACNTA00-V                Pic 9(9)  Display.
       01 GENACNTA99-V                Pic 9(9)  Display.
       01 GENACNTB00-V                Pic 9(9)  Display.
       01 GENACNTB99-V                Pic 9(9)  Display.
       01 GENACNTC00-V                Pic 9(9)  Display.
       01 GENACNTC99-V                Pic 9(9)  Display.
       01 GENACNTD00-V                Pic 9(9)  Display.
       01 GENACNTD99-V                Pic 9(9)  Display.
       01 GENACNTE00-V                Pic 9(9)  Display.
       01 GENACNTE99-V                Pic 9(9)  Display.
       01 GENACNTF00-V                Pic 9(9)  Display.
       01 GENACNTF99-V                Pic 9(9)  Display.
       01 GENACNTG00-V                Pic 9(9)  Display.
       01 GENACNTG99-V                Pic 9(9)  Display.
       01 GENACNTH00-V                Pic 9(9)  Display.
       01 GENACNTH99-V                Pic 9(9)  Display.
       01 GENACNTI00-V                Pic 9(9)  Display.
       01 GENACNTI99-V                Pic 9(9)  Display.
       01 GENAsucces-V                Pic 9(9)  Display.
       01 GENAerrors-V                Pic 9(9)  Display.
       01  GENAcount                 PIC X(16) Value 'GENACUSTNUM'.
       01  GENApool                  PIC X(8)  Value 'GENA'.
       01  GENACNT100                PIC X(16) Value 'GENA01ICUS00'.
       01  GENACNT199                PIC X(32) Value 'GENA01ICUS99'.
       01  GENACNT200                PIC X(16) Value 'GENA01ACUS00'.
       01  GENACNT299                PIC X(32) Value 'GENA01ACUS99'.
       01  GENACNT300                PIC X(16) Value 'GENA01IMOT00'.
       01  GENACNT399                PIC X(32) Value 'GENA01IMOT99'.
       01  GENACNT400                PIC X(16) Value 'GENA01AMOT00'.
       01  GENACNT499                PIC X(32) Value 'GENA01AMOT99'.
       01  GENACNT500                PIC X(16) Value 'GENA01DMOT00'.
       01  GENACNT599                PIC X(32) Value 'GENA01DMOT99'.
       01  GENACNT600                PIC X(16) Value 'GENA01UMOT00'.
       01  GENACNT699                PIC X(32) Value 'GENA01UMOT99'.
       01  GENACNT700                PIC X(16) Value 'GENA01IEND00'.
       01  GENACNT799                PIC X(32) Value 'GENA01IEND99'.
       01  GENACNT800                PIC X(16) Value 'GENA01AEND00'.
       01  GENACNT899                PIC X(32) Value 'GENA01AEND99'.
       01  GENACNT900                PIC X(16) Value 'GENA01DEND00'.
       01  GENACNT999                PIC X(32) Value 'GENA01DEND99'.
       01  GENACNTA00                PIC X(16) Value 'GENA01UEND00'.
       01  GENACNTA99                PIC X(32) Value 'GENA01UEND99'.
       01  GENACNTB00                PIC X(16) Value 'GENA01IHOU00'.
       01  GENACNTB99                PIC X(32) Value 'GENA01IHOU99'.
       01  GENACNTC00                PIC X(16) Value 'GENA01AHOU00'.
       01  GENACNTC99                PIC X(32) Value 'GENA01AHOU99'.
       01  GENACNTD00                PIC X(16) Value 'GENA01DHOU00'.
       01  GENACNTD99                PIC X(32) Value 'GENA01DHOU99'.
       01  GENACNTE00                PIC X(16) Value 'GENA01UHOU00'.
       01  GENACNTE99                PIC X(32) Value 'GENA01UHOU99'.
       01  GENACNTF00                PIC X(16) Value 'GENA01ICOM00'.
       01  GENACNTF99                PIC X(32) Value 'GENA01ICOM99'.
       01  GENACNTG00                PIC X(16) Value 'GENA01ACOM00'.
       01  GENACNTG99                PIC X(32) Value 'GENA01ACOM99'.
       01  GENACNTH00                PIC X(16) Value 'GENA01DCOM00'.
       01  GENACNTH99                PIC X(32) Value 'GENA01DCOM99'.
       01  GENACNTI99                PIC X(16) Value 'GENAOTHER   '.
       LINKAGE SECTION.
       01  DFHCOMMAREA.
         03  COMMA-DATA.
           05 Comma-Data-H           Pic X(14).
           05 Comma-Data-High        Pic 9(10).
           05 FILLER                 Pic X(60).
       PROCEDURE DIVISION.
       MAINLINE.
           INITIALIZE WS-HEADER.
           MOVE EIBTRNID TO WS-TRANSID.
           MOVE EIBTRMID TO WS-TERMID.
           MOVE EIBTASKN TO WS-TASKNUM.
           MOVE EIBCALEN TO WS-CALEN.
           MOVE 'GENA'  To TSQpre
           EXEC CICS ASKTIME ABSTIME(WS-ABSTIME)
           END-EXEC
           EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)
                     MMDDYYYY(WS-DATE)
                     TIME(WS-TIME)
           END-EXEC
           Perform Tran-Rate-Interval
           Exec CICS Query Counter(GENAcount)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Move CountVal  To GENAcount-V
           Move GENAcount-V  To S3
           String TSQpre,
                  'X05V' Delimited By Spaces
                  Into WS-TSQname
           Move S3           To NRateVal
           Perform Tran-Rate-Counts
           Exec CICS Query Counter(GENACNT100)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Move CountVal  To CountSuccess
           Move CountVal  To CountInq
           Move CountVal  To GENACNT100-V
           Move GENACNT100-V To S3
           String TSQpre,
                  '100V' Delimited By Spaces
                  Into WS-TSQname
           Move S3           To NRateVal
           Perform Tran-Rate-Counts
           Exec CICS Query Counter(GENACNT199)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Move CountVal  To CountErrors
           Move CountVal  To GENACNT199-V
           Move GENACNT199-V To S4
           Exec CICS Query Counter(GENACNT200)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountSuccess = CountSuccess + CountVal
           Move CountVal  To CountAdd
           Move CountVal  To GENACNT200-V
           Move GENACNT200-V To S5
           String TSQpre,
                  '200V' Delimited By Spaces
                  Into WS-TSQname
           Move S5           To NRateVal
           Perform Tran-Rate-Counts
           Exec CICS Query Counter(GENACNT299)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountErrors  = CountErrors + CountVal
           Move CountVal  To GENACNT299-V
           Move GENACNT299-V To S6
           Exec CICS Query Counter(GENACNT300)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountSuccess = CountSuccess + CountVal
           Move CountVal  To GENACNT300-V
           Compute CountInq = CountInq + CountVal
           Move GENACNT300-V To S7
           String TSQpre,
                  '300V' Delimited By Spaces
                  Into WS-TSQname
           Move S7           To NRateVal
           Perform Tran-Rate-Counts
           Exec CICS Query Counter(GENACNT399)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountErrors  = CountErrors + CountVal
           Move CountVal  To GENACNT399-V
           Move GENACNT399-V To S8
           Exec CICS Query Counter(GENACNT400)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountSuccess = CountSuccess + CountVal
           Move CountVal  To GENACNT400-V
           Compute CountAdd = CountAdd + CountVal
           Move GENACNT400-V To S9
           String TSQpre,
                  '400V' Delimited By Spaces
                  Into WS-TSQname
           Move S9           To NRateVal
           Perform Tran-Rate-Counts
           Exec CICS Query Counter(GENACNT499)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountErrors  = CountErrors + CountVal
           Move CountVal  To GENACNT499-V
           Move GENACNT499-V To S10
           Exec CICS Query Counter(GENACNT500)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountSuccess = CountSuccess + CountVal
           Move CountVal  To GENACNT500-V
           Move CountVal  To CountDel
           Move GENACNT500-V To S11
           String TSQpre,
                  '500V' Delimited By Spaces
                  Into WS-TSQname
           Move S11          To NRateVal
           Perform Tran-Rate-Counts
           Exec CICS Query Counter(GENACNT599)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountErrors  = CountErrors + CountVal
           Move CountVal  To GENACNT599-V
           Move GENACNT599-V To S12
           Exec CICS Query Counter(GENACNT600)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountSuccess = CountSuccess + CountVal
           Move CountVal  To GENACNT600-V
           Move CountVal  To CountUpd
           Move GENACNT600-V To S13
           String TSQpre,
                  '600V' Delimited By Spaces
                  Into WS-TSQname
           Move S13          To NRateVal
           Perform Tran-Rate-Counts
           Exec CICS Query Counter(GENACNT699)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountErrors  = CountErrors + CountVal
           Move CountVal  To GENACNT699-V
           Move GENACNT699-V To S14
           Exec CICS Query Counter(GENACNT700)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountSuccess = CountSuccess + CountVal
           Move CountVal  To GENACNT700-V
           Compute CountInq = CountInq + CountVal
           Move GENACNT700-V To S15
           String TSQpre,
                  '700V' Delimited By Spaces
                  Into WS-TSQname
           Move S15          To NRateVal
           Perform Tran-Rate-Counts
           Exec CICS Query Counter(GENACNT799)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountErrors  = CountErrors + CountVal
           Move CountVal  To GENACNT799-V
           Move GENACNT799-V To S16
           Exec CICS Query Counter(GENACNT800)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountSuccess = CountSuccess + CountVal
           Move CountVal  To GENACNT800-V
           Compute CountAdd = CountAdd + CountVal
           Move GENACNT800-V To S17
           String TSQpre,
                  '800V' Delimited By Spaces
                  Into WS-TSQname
           Move S17          To NRateVal
           Perform Tran-Rate-Counts
           Exec CICS Query Counter(GENACNT899)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountErrors  = CountErrors + CountVal
           Move CountVal  To GENACNT899-V
           Move GENACNT899-V To S18
           Exec CICS Query Counter(GENACNT900)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountSuccess = CountSuccess + CountVal
           Move CountVal  To GENACNT900-V
           Compute CountDel = CountDel + CountVal
           Move GENACNT900-V To S19
           String TSQpre,
                  '900V' Delimited By Spaces
                  Into WS-TSQname
           Move S19          To NRateVal
           Perform Tran-Rate-Counts
           Exec CICS Query Counter(GENACNT999)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountErrors  = CountErrors + CountVal
           Move CountVal  To GENACNT999-V
           Move GENACNT999-V To S20
           Exec CICS Query Counter(GENACNTA00)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountSuccess = CountSuccess + CountVal
           Move CountVal  To GENACNTA00-V
           Compute CountUpd = CountUpd + CountVal
           Move GENACNTA00-V To S21
           String TSQpre,
                  'A00V' Delimited By Spaces
                  Into WS-TSQname
           Move S21          To NRateVal
           Perform Tran-Rate-Counts
           Exec CICS Query Counter(GENACNTA99)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountErrors  = CountErrors + CountVal
           Move CountVal  To GENACNTA99-V
           Move GENACNTA99-V To S22
           Exec CICS Query Counter(GENACNTB00)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountSuccess = CountSuccess + CountVal
           Move CountVal  To GENACNTB00-V
           Compute CountInq = CountInq + CountVal
           Move GENACNTB00-V To S23
           String TSQpre,
                  'B00V' Delimited By Spaces
                  Into WS-TSQname
           Move S23          To NRateVal
           Perform Tran-Rate-Counts
           Exec CICS Query Counter(GENACNTB99)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountErrors  = CountErrors + CountVal
           Move CountVal  To GENACNTB99-V
           Move GENACNTB99-V To S24
           Exec CICS Query Counter(GENACNTC00)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountSuccess = CountSuccess + CountVal
           Move CountVal  To GENACNTC00-V
           Compute CountAdd = CountAdd + CountVal
           Move GENACNTC00-V To S25
           String TSQpre,
                  'C00V' Delimited By Spaces
                  Into WS-TSQname
           Move S25          To NRateVal
           Perform Tran-Rate-Counts
           Exec CICS Query Counter(GENACNTC99)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountErrors  = CountErrors + CountVal
           Move CountVal  To GENACNTC99-V
           Move GENACNTC99-V To S26
           Exec CICS Query Counter(GENACNTD00)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountSuccess = CountSuccess + CountVal
           Move CountVal  To GENACNTD00-V
           Compute CountDel = CountDel + CountVal
           Move GENACNTD00-V To S27
           String TSQpre,
                  'D00V' Delimited By Spaces
                  Into WS-TSQname
           Move S27          To NRateVal
           Perform Tran-Rate-Counts
           Exec CICS Query Counter(GENACNTD99)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountErrors  = CountErrors + CountVal
           Move CountVal  To GENACNTD99-V
           Move GENACNTD99-V To S28
           Exec CICS Query Counter(GENACNTE00)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountSuccess = CountSuccess + CountVal
           Move CountVal  To GENACNTE00-V
           Compute CountUpd = CountUpd + CountVal
           Move GENACNTE00-V To S29
           String TSQpre,
                  'E00V' Delimited By Spaces
                  Into WS-TSQname
           Move S29          To NRateVal
           Perform Tran-Rate-Counts
           Exec CICS Query Counter(GENACNTE99)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountErrors  = CountErrors + CountVal
           Move CountVal  To GENACNTE99-V
           Move GENACNTE99-V To S30
           Exec CICS Query Counter(GENACNTF00)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountSuccess = CountSuccess + CountVal
           Move CountVal  To GENACNTF00-V
           Compute CountInq = CountInq + CountVal
           Move GENACNTF00-V To S31
           String TSQpre,
                  'F00V' Delimited By Spaces
                  Into WS-TSQname
           Move S31          To NRateVal
           Perform Tran-Rate-Counts
           Exec CICS Query Counter(GENACNTF99)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountErrors  = CountErrors + CountVal
           Move CountVal  To GENACNTF99-V
           Move GENACNTF99-V To S32
           Exec CICS Query Counter(GENACNTG00)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountSuccess = CountSuccess + CountVal
           Move CountVal  To GENACNTG00-V
           Compute CountAdd = CountAdd + CountVal
           Move GENACNTG00-V To S33
           String TSQpre,
                  'G00V' Delimited By Spaces
                  Into WS-TSQname
           Move S33          To NRateVal
           Perform Tran-Rate-Counts
           Exec CICS Query Counter(GENACNTG99)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountErrors  = CountErrors + CountVal
           Move CountVal  To GENACNTG99-V
           Move GENACNTG99-V To S34
           Exec CICS Query Counter(GENACNTH00)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountSuccess = CountSuccess + CountVal
           Move CountVal  To GENACNTH00-V
           Compute CountDel = CountDel + CountVal
           Move GENACNTH00-V To S35
           String TSQpre,
                  'H00V' Delimited By Spaces
                  Into WS-TSQname
           Move S35          To NRateVal
           Perform Tran-Rate-Counts
           Exec CICS Query Counter(GENACNTH99)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Compute CountErrors  = CountErrors + CountVal
           Move CountVal  To GENACNTH99-V
           Move GENACNTH99-V To S36
           Exec CICS Query Counter(GENACNTI99)
                            Pool(GENApool)
                            Value(CountVal)
                            Resp(WS-RESP)
           End-Exec.
           Move CountVal  To GENACNTI99-V
           Move GENACNTI99-V To S37
           Move CountSuccess To GENAsucces-V
           Move Counterrors  To GENAerrors-V
           Move GENAsucces-V To S38
           Move GENAerrors-V To S39
           String TSQpre,
                  'X00V' Delimited By Spaces
                  Into WS-TSQname
           Move S38          To NRateVal
           Perform Tran-Rate-Counts
           String TSQpre,
                  'X01V' Delimited By Spaces
                  Into WS-TSQname
           Move CountInq     To NRateVal
           Perform Tran-Rate-Counts
           String TSQpre,
                  'X02V' Delimited By Spaces
                  Into WS-TSQname
           Move CountAdd     To NRateVal
           Perform Tran-Rate-Counts
           String TSQpre,
                  'X03V' Delimited By Spaces
                  Into WS-TSQname
           Move CountUpd     To NRateVal
           Perform Tran-Rate-Counts
           String TSQpre,
                  'X04V' Delimited By Spaces
                  Into WS-TSQname
           Move CountDel     To NRateVal
           Perform Tran-Rate-Counts
           EXEC CICS ASSIGN APPLID(WS-APPLID)
           END-EXEC.
           Move WS-APPLID To S1.
           EXEC CICS RETURN
           END-EXEC.
       A-EXIT.
           EXIT.
           GOBACK.
       Tran-Rate-Interval.
           String TSQpre,
                  '000V' Delimited By Spaces
                  Into WS-TSQname
           Exec Cics ReadQ TS Queue(WS-TSQname)
                     Into(WS-OLDV)
                     Item(1)
                     Length(Length of WS-OLDV)
                     Resp(WS-RESP)
           End-Exec.
           If WS-RESP Not = DFHRESP(NORMAL)
            Move '120000' To WS-OLDV.
           Exec Cics DeleteQ TS Queue(WS-TSQNAME)
                     Resp(WS-RESP)
           End-Exec.
           Move WS-TIME   To WS-HHMMSS
           Exec Cics WRITEQ TS Queue(WS-TSQNAME)
                     FROM(WS-HHMMSS)
                     Length(Length of WS-HHMMSS)
                     Resp(WS-RESP)
           End-Exec.
           Move WS-HH     To HHVal
           Move WS-MM     To MMVal
           Move WS-SS     To SSVal
           Compute NCountVal = (HHVal * 3600) +
                               (MMVal * 60)   +
                                SSVal
           Move WS-OLDVHH To HHVal
           Move WS-OLDVMM To MMVal
           Move WS-OLDVSS To SSVal
           Compute OCountVal = (HHVal * 3600) +
                               (MMVal * 60)   +
                                SSVal
           Compute ICountVal = NCountVal - OCountVal
           move ICountVal To WS-NEWV
           String TSQpre,
                  '000V' Delimited By Spaces
                  Into WS-TSQname
           Exec Cics WRITEQ TS Queue(WS-TSQNAME)
                     FROM(WS-NEWV)
                     Length(Length of WS-NEWV)
                     Resp(WS-RESP)
           End-Exec.
           Exec Cics Start Transid('SSST')
                     After
                     Minutes(1)
                     Resp(WS-RESP)
           End-Exec.
           Exit.
       Tran-Rate-Counts.
           Exec Cics ReadQ TS Queue(WS-TSQname)
                     Into(WS-TSQdata)
                     Item(1)
                     Length(Length of WS-TSQdata)
                     Resp(WS-RESP)
           End-Exec.
           Move WS-TSQdata  To ORateVal
           Exec Cics DeleteQ TS Queue(WS-TSQname)
                     Resp(WS-RESP)
           End-Exec.
           Move NRateVal  To WS-TSQdata
           Exec Cics WRITEQ TS Queue(WS-TSQname)
                     FROM(WS-TSQdata)
                     Length(Length of WS-TSQdata)
                     Resp(WS-RESP)
           End-Exec.
           Move ORateVal   To WS-TSQdata
           Exec Cics WRITEQ TS Queue(WS-TSQname)
                     FROM(WS-TSQdata)
                     Length(Length of WS-TSQdata)
                     Resp(WS-RESP)
           End-Exec.
           Compute DRateVal = NRateVal - ORateVal
           Move DRateVal   To WS-TSQdata
           Exec Cics WRITEQ TS Queue(WS-TSQname)
                     FROM(WS-TSQdata)
                     Length(Length of WS-TSQdata)
                     Resp(WS-RESP)
           End-Exec.
           Exit.
","       WORKING-STORAGE SECTION.
       01  CountVal                   PIC S9(8) COMP.
       01  CountSuccess               PIC S9(9) COMP.
       01  CountErrors                PIC S9(8) COMP.
       01  CountInq                   PIC S9(8) COMP.
       01  CountAdd                   PIC S9(8) COMP.
       01  CountUpd                   PIC S9(8) COMP.
       01  CountDel                   PIC S9(8) COMP.
       01  DRateVal                   PIC 9(9).
       01  NRateVal                   PIC 9(9).
       01  ORateVal                   PIC 9(9).
       01  ICountVal                  PIC 9(6).
       01  OCountVal                  PIC 9(6).
       01  NCountVal                  PIC 9(6).
       01  HHval                      PIC 9(6).
       01  MMval                      PIC 9(6).
       01  SSval                      PIC 9(6).
       01  WS-RESP                    PIC S9(8) COMP.
       01  WS-ABSTIME                 PIC S9(8) COMP VALUE +0.
       01  WS-CODE                    Pic 9(4) Comp.
       01  WS-TIME                    Pic X(8).
       01  WS-Startup                 Pic X(40) Value
                     'GENAPP Statistics collector started.'.
       01  TCPservice                Pic X(8) Value 'SSISTAT1'.
       01  TCPaddress                Pic X(15).
       01  TCPaddrLen                Pic S9(8) Comp sync.
       01  Part1                     Pic X(8).
       01  Part2                     Pic X(8).
       01  Part3                     Pic X(8).
       01  Part4                     Pic X(8).
       01  TSQpre                    Pic X(4).
       01  WS-TSQname                 Pic X(8).
       01  WS-TSQdata                 Pic X(9).
       01  WS-TSQstart                Pic X(24).
       01  WS-HHMMSS.
         03  WS-HH                    Pic X(2).
         03  WS-MM                    Pic X(2).
         03  WS-SS                    Pic X(2).
       01  WS-DATE                    PIC X(10) VALUE SPACES.
       01  StatQ                      PIC X(8)  Value 'GENASTAT'.
       01  TemplateName               PIC X(48) Value 'GENAST3TEMP'.
       01  WS-APPLID                  PIC X(8).
       01  WS-TOKEN                   PIC X(16).
       01  WS-TEXT                    PIC X(2)  Value 'OK'.
       01  WS-MTYPE                   Pic X(56) Value 'text/html'.
       01  WS-CHARSET                 Pic X(40) Value 'ISO-8859-1'.
       01  WS-OLDV.
         02 WS-OLDVHH                 Pic X(2).
         02 WS-OLDVMM                 Pic X(2).
         02 WS-OLDVSS                 Pic X(2).
       01  WS-NEWV                    PIC X(6).
       01  WRITE-MSG-H                PIC X(24) Value '  Statistics.'.
       01  WS-HEADER.
          03 WS-EYECATCHER            PIC X(16)
                                       VALUE 'LGWEBST5------WS'.
          03 WS-TRANSID               PIC X(4).
          03 WS-TERMID                PIC X(4).
          03 WS-TASKNUM               PIC 9(7).
          03 WS-CALEN                 PIC 9(7).
       01  SymbList.
          03  Filler                  Pic X(7)  Value 'APPLID='.
          03  S1                      Pic X(8)  Value Spaces.
          03  Filler                  Pic X(13) Value '&GENACount-V='.
          03  S2                      Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNT100-V='.
          03  S3                      Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNT199-V='.
          03  S4                      Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNT200-V='.
          03  S5                      Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNT299-V='.
          03  S6                      Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNT300-V='.
          03  S7                      Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNT399-V='.
          03  S8                      Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNT400-V='.
          03  S9                      Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNT499-V='.
          03  S10                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNT500-V='.
          03  S11                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNT599-V='.
          03  S12                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNT600-V='.
          03  S13                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNT699-V='.
          03  S14                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNT700-V='.
          03  S15                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNT799-V='.
          03  S16                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNT800-V='.
          03  S17                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNT899-V='.
          03  S18                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNT900-V='.
          03  S19                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNT999-V='.
          03  S20                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNTA00-V='.
          03  S21                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNTA99-V='.
          03  S22                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNTB00-V='.
          03  S23                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNTB99-V='.
          03  S24                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNTC00-V='.
          03  S25                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNTC99-V='.
          03  S26                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNTD00-V='.
          03  S27                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNTD99-V='.
          03  S28                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNTE00-V='.
          03  S29                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNTE99-V='.
          03  S30                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNTF00-V='.
          03  S31                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNTF99-V='.
          03  S32                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNTG00-V='.
          03  S33                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNTG99-V='.
          03  S34                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNTH00-V='.
          03  S35                     Pic X(9).
          03  Filler                  Pic X(14) Value '&GENACNTH99-V='.
          03  S36                     Pic Z(8)9.
          03  Filler                  Pic X(14) Value '&GENACNTI99-V='.
          03  S37                     Pic Z(9)9.
          03  Filler                  Pic X(14) Value '&GENAsucces-V='.
          03  S38                     Pic Z(9)9.
          03  Filler                  Pic X(14) Value '&GENAerrors-V='.
          03  S39                     Pic Z(9)9.
          03  Filler                  Pic X(14) Value '&GENAstart='.
          03  S40                     Pic X(16).
       01 GENACount-V                 Pic 9(9)  Display.
       01 GENACNT100-V                Pic 9(9)  Display.
       01 GENACNT199-V                Pic 9(9)  Display.
       01 GENACNT200-V                Pic 9(9)  Display.
       01 GENACNT299-V                Pic 9(9)  Display.
       01 GENACNT300-V                Pic 9(9)  Display.
       01 GENACNT399-V                Pic 9(9)  Display.
       01 GENACNT400-V                Pic 9(9)  Display.
       01 GENACNT499-V                Pic 9(9)  Display.
       01 GENACNT500-V                Pic 9(9)  Display.
       01 GENACNT599-V                Pic 9(9)  Display.
       01 GENACNT600-V                Pic 9(9)  Display.
       01 GENACNT699-V                Pic 9(9)  Display.
       01 GENACNT700-V                Pic 9(9)  Display.
       01 GENACNT799-V                Pic 9(9)  Display.
       01 GENACNT800-V                Pic 9(9)  Display.
       01 GENACNT899-V                Pic 9(9)  Display.
       01 GENACNT900-V                Pic 9(9)  Display.
       01 GENACNT999-V                Pic 9(9)  Display.
       01 GENACNTA00-V                Pic 9(9)  Display.
       01 GENACNTA99-V                Pic 9(9)  Display.
       01 GENACNTB00-V                Pic 9(9)  Display.
       01 GENACNTB99-V                Pic 9(9)  Display.
       01 GENACNTC00-V                Pic 9(9)  Display.
       01 GENACNTC99-V                Pic 9(9)  Display.
       01 GENACNTD00-V                Pic 9(9)  Display.
       01 GENACNTD99-V                Pic 9(9)  Display.
       01 GENACNTE00-V                Pic 9(9)  Display.
       01 GENACNTE99-V                Pic 9(9)  Display.
       01 GENACNTF00-V                Pic 9(9)  Display.
       01 GENACNTF99-V                Pic 9(9)  Display.
       01 GENACNTG00-V                Pic 9(9)  Display.
       01 GENACNTG99-V                Pic 9(9)  Display.
       01 GENACNTH00-V                Pic 9(9)  Display.
       01 GENACNTH99-V                Pic 9(9)  Display.
       01 GENACNTI00-V                Pic 9(9)  Display.
       01 GENACNTI99-V                Pic 9(9)  Display.
       01 GENAsucces-V                Pic 9(9)  Display.
       01 GENAerrors-V                Pic 9(9)  Display.
       01  GENAcount                 PIC X(16) Value 'GENACUSTNUM'.
       01  GENApool                  PIC X(8)  Value 'GENA'.
       01  GENACNT100                PIC X(16) Value 'GENA01ICUS00'.
       01  GENACNT199                PIC X(32) Value 'GENA01ICUS99'.
       01  GENACNT200                PIC X(16) Value 'GENA01ACUS00'.
       01  GENACNT299                PIC X(32) Value 'GENA01ACUS99'.
       01  GENACNT300                PIC X(16) Value 'GENA01IMOT00'.
       01  GENACNT399                PIC X(32) Value 'GENA01IMOT99'.
       01  GENACNT400                PIC X(16) Value 'GENA01AMOT00'.
       01  GENACNT499                PIC X(32) Value 'GENA01AMOT99'.
       01  GENACNT500                PIC X(16) Value 'GENA01DMOT00'.
       01  GENACNT599                PIC X(32) Value 'GENA01DMOT99'.
       01  GENACNT600                PIC X(16) Value 'GENA01UMOT00'.
       01  GENACNT699                PIC X(32) Value 'GENA01UMOT99'.
       01  GENACNT700                PIC X(16) Value 'GENA01IEND00'.
       01  GENACNT799                PIC X(32) Value 'GENA01IEND99'.
       01  GENACNT800                PIC X(16) Value 'GENA01AEND00'.
       01  GENACNT899                PIC X(32) Value 'GENA01AEND99'.
       01  GENACNT900                PIC X(16) Value 'GENA01DEND00'.
       01  GENACNT999                PIC X(32) Value 'GENA01DEND99'.
       01  GENACNTA00                PIC X(16) Value 'GENA01UEND00'.
       01  GENACNTA99                PIC X(32) Value 'GENA01UEND99'.
       01  GENACNTB00                PIC X(16) Value 'GENA01IHOU00'.
       01  GENACNTB99                PIC X(32) Value 'GENA01IHOU99'.
       01  GENACNTC00                PIC X(16) Value 'GENA01AHOU00'.
       01  GENACNTC99                PIC X(32) Value 'GENA01AHOU99'.
       01  GENACNTD00                PIC X(16) Value 'GENA01DHOU00'.
       01  GENACNTD99                PIC X(32) Value 'GENA01DHOU99'.
       01  GENACNTE00                PIC X(16) Value 'GENA01UHOU00'.
       01  GENACNTE99                PIC X(32) Value 'GENA01UHOU99'.
       01  GENACNTF00                PIC X(16) Value 'GENA01ICOM00'.
       01  GENACNTF99                PIC X(32) Value 'GENA01ICOM99'.
       01  GENACNTG00                PIC X(16) Value 'GENA01ACOM00'.
       01  GENACNTG99                PIC X(32) Value 'GENA01ACOM99'.
       01  GENACNTH00                PIC X(16) Value 'GENA01DCOM00'.
       01  GENACNTH99                PIC X(32) Value 'GENA01DCOM99'.
       01  GENACNTI99                PIC X(16) Value 'GENAOTHER   '.
       LINKAGE SECTION.
       01  DFHCOMMAREA.
         03  COMMA-DATA.
           05 Comma-Data-H           Pic X(14).
           05 Comma-Data-High        Pic 9(10).
           05 FILLER                 Pic X(60).
","['MAINLINE', 'A-EXIT', 'Tran-Rate-Interval', 'Tran-Rate-Counts']","Paragraph MAINLINE calls paragraph Tran-Rate-Interval, Tran-Rate-Counts.
",753,Used as repeating transaction for Business Monitor. Obtain values from counters and place statistics data in shared tsq. Will to refresh every 60 seconds���,,,"['WS-TSQNAME', 'WS-TSQname']",Error Long,0.75,1,1,"This COBOL program initializes variables, queries a CICS counter, and performs calculations based on its value, utilizing the Tran-Rate-Interval and Tran-Rate-Counts paragraphs for transaction handling. Tran-Rate-Interval calculates the time between transactions using a transaction status queue, while Tran-Rate-Counts manages queue operations and value differences. The program terminates with an EXIT statement in A-EXIT, ensuring a clean exit after execution, although there is an unused GOBACK statement.",1
